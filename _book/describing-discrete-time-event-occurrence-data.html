<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Describing Discrete-Time Event Occurrence Data | Applied Longitudinal Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Describing Discrete-Time Event Occurrence Data | Applied Longitudinal Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="github-repo" content="ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Describing Discrete-Time Event Occurrence Data | Applied Longitudinal Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-04-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-framework-for-investigating-event-occurrence.html"/>
<link rel="next" href="fitting-basic-discrete-time-hazard-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html"><i class="fa fa-check"></i><b>1</b> A Framework for Investigating Change over Time</a><ul>
<li class="chapter" data-level="1.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#when-might-you-study-change-over-time"><i class="fa fa-check"></i><b>1.1</b> When might you study change over time?</a></li>
<li class="chapter" data-level="1.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#distinguishing-between-two-types-of-questions-about-change"><i class="fa fa-check"></i><b>1.2</b> Distinguishing between two types of questions about change</a></li>
<li class="chapter" data-level="1.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#three-important-features-of-a-study-of-change"><i class="fa fa-check"></i><b>1.3</b> Three important features of a study of change</a><ul>
<li class="chapter" data-level="1.3.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#multiple-waves-of-data."><i class="fa fa-check"></i><b>1.3.1</b> Multiple waves of data.</a></li>
<li class="chapter" data-level="1.3.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-sensible-metric-for-time."><i class="fa fa-check"></i><b>1.3.2</b> A sensible metric for time.</a></li>
<li class="chapter" data-level="1.3.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-continuous-outcome-that-changes-systematically-over-time."><i class="fa fa-check"></i><b>1.3.3</b> A continuous outcome that changes systematically over time.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html"><i class="fa fa-check"></i><b>2</b> Exploring Longitudinal Data on Change</a><ul>
<li class="chapter" data-level="2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#creating-a-longitudinal-data-set"><i class="fa fa-check"></i><b>2.1</b> Creating a longitudinal data set</a><ul>
<li class="chapter" data-level="2.1.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-level-data-set."><i class="fa fa-check"></i><b>2.1.1</b> The person-level data set.</a></li>
<li class="chapter" data-level="2.1.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-period-data-set."><i class="fa fa-check"></i><b>2.1.2</b> The person-period data set.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#descriptive-analysis-of-individual-change-over-time"><i class="fa fa-check"></i><b>2.2</b> Descriptive analysis of individual change over time</a><ul>
<li class="chapter" data-level="2.2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#empirical-growth-plots."><i class="fa fa-check"></i><b>2.2.1</b> Empirical growth plots.</a></li>
<li class="chapter" data-level="2.2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-a-trajectory-to-summarize-each-persons-empirical-growth-record."><i class="fa fa-check"></i><b>2.2.2</b> Using a trajectory to summarize each person’s empirical growth record.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-differences-in-change-across-people"><i class="fa fa-check"></i><b>2.3</b> Exploring differences in change across people</a><ul>
<li class="chapter" data-level="2.3.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#examining-the-entire-set-of-smooth-trajectories."><i class="fa fa-check"></i><b>2.3.1</b> Examining the entire set of smooth trajectories.</a></li>
<li class="chapter" data-level="2.3.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-the-results-of-model-fitting-to-frame-questions-about-change."><i class="fa fa-check"></i><b>2.3.2</b> Using the results of model fitting to frame questions about change.</a></li>
<li class="chapter" data-level="2.3.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-the-relationship-between-change-and-time-invariant-predictors."><i class="fa fa-check"></i><b>2.3.3</b> Exploring the relationship between change and time-invariant predictors.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design"><i class="fa fa-check"></i><b>2.4</b> Improving the precision and reliability of <del>OLS</del> single-level-Bayesian-estimated rates of change: Lessons for research design</a></li>
<li class="chapter" data-level="" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>3</b> Introducing the Multilevel Model for Change</a><ul>
<li class="chapter" data-level="3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#what-is-the-purpose-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>3.1</b> What is the purpose of the multilevel model for change?</a></li>
<li class="chapter" data-level="3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-1-submodel-for-individual-change"><i class="fa fa-check"></i><b>3.2</b> The level-1 submodel for individual change</a><ul>
<li class="chapter" data-level="3.2.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-structural-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.1</b> The structural part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-stochastic-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.2</b> The stochastic part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#relating-the-level-1-submodel-to-the-ols-exploratory-methods-of-chapter-2."><i class="fa fa-check"></i><b>3.2.3</b> Relating the level-1 submodel to the OLS exploratory methods of chapter 2.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-2-submodel-for-systematic-interindividual-differences-in-change"><i class="fa fa-check"></i><b>3.3</b> The level-2 submodel for systematic interindividual differences in change</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#structural-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.1</b> Structural components of the level-2 submodel.</a></li>
<li class="chapter" data-level="3.3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#stochastic-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.2</b> Stochastic components of the level-2 submodel.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#fitting-the-multilevel-model-for-change-to-data"><i class="fa fa-check"></i><b>3.4</b> Fitting the multilevel model for change to data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-advantages-of-maximum-likelihood-bayesian-estimation."><i class="fa fa-check"></i><b>3.4.1</b> The advantages of <del>maximum likelihood</del> Bayesian estimation.</a></li>
<li class="chapter" data-level="3.4.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#using-maximum-likelihood-modern-bayesian-methods-to-fit-a-multilevel-model."><i class="fa fa-check"></i><b>3.4.2</b> Using <del>maximum likelihood</del> modern Bayesian methods to fit a multilevel model.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-fixed-effects"><i class="fa fa-check"></i><b>3.5</b> Examining estimated fixed effects</a><ul>
<li class="chapter" data-level="3.5.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-estimated-fixed-effects."><i class="fa fa-check"></i><b>3.5.1</b> Interpreting estimated fixed effects.</a></li>
<li class="chapter" data-level="3.5.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-fixed-effects."><i class="fa fa-check"></i><b>3.5.2</b> Single parameter tests for the fixed effects.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-variance-components"><i class="fa fa-check"></i><b>3.6</b> Examining estimated variance components</a><ul>
<li class="chapter" data-level="3.6.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-the-estimated-variance-components."><i class="fa fa-check"></i><b>3.6.1</b> Interpreting the estimated variance components.</a></li>
<li class="chapter" data-level="3.6.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-variance-components."><i class="fa fa-check"></i><b>3.6.2</b> Single parameter tests for the variance components.</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#bonus-how-did-you-simulate-that-data"><i class="fa fa-check"></i><b>3.7</b> Bonus: How did you simulate that data?</a></li>
<li class="chapter" data-level="" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>4</b> Doing Data Analysis with the Multilevel Model for Change</a><ul>
<li class="chapter" data-level="4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#example-changes-in-adolescent-alcohol-use"><i class="fa fa-check"></i><b>4.1</b> Example: Changes in adolescent alcohol use</a></li>
<li class="chapter" data-level="4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-composite-specification-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>4.2</b> The composite specification of the multilevel model for change</a><ul>
<li class="chapter" data-level="4.2.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-structural-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.1</b> The structural component of the composite model.</a></li>
<li class="chapter" data-level="4.2.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-stochastic-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.2</b> The stochastic component of the composite model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#methods-of-estimation-revisited"><i class="fa fa-check"></i><b>4.3</b> Methods of estimation, revisited</a></li>
<li class="chapter" data-level="4.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#first-steps-fitting-two-unconditional-multilevel-models-for-change"><i class="fa fa-check"></i><b>4.4</b> First steps: Fitting two unconditional multilevel models for change</a><ul>
<li class="chapter" data-level="4.4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-means-model."><i class="fa fa-check"></i><b>4.4.1</b> The unconditional means model.</a></li>
<li class="chapter" data-level="4.4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-growth-model."><i class="fa fa-check"></i><b>4.4.2</b> The unconditional growth model.</a></li>
<li class="chapter" data-level="4.4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#quantifying-the-proportion-of-outcome-variation-explained."><i class="fa fa-check"></i><b>4.4.3</b> Quantifying the proportion of outcome variation “explained.”</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#practical-data-analytic-strategies-for-model-building"><i class="fa fa-check"></i><b>4.5</b> Practical data analytic strategies for model building</a><ul>
<li class="chapter" data-level="4.5.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#a-taxonomy-of-statistical-models."><i class="fa fa-check"></i><b>4.5.1</b> A taxonomy of statistical models.</a></li>
<li class="chapter" data-level="4.5.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#interpreting-fitted-models."><i class="fa fa-check"></i><b>4.5.2</b> Interpreting fitted models.</a></li>
<li class="chapter" data-level="4.5.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#displaying-prototypical-change-trajectories."><i class="fa fa-check"></i><b>4.5.3</b> Displaying prototypical change trajectories.</a></li>
<li class="chapter" data-level="4.5.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#recentering-predictors-to-improve-interpretation."><i class="fa fa-check"></i><b>4.5.4</b> Recentering predictors to improve interpretation.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#comparing-models-using-deviance-statistics"><i class="fa fa-check"></i><b>4.6</b> Comparing models using deviance statistics</a><ul>
<li class="chapter" data-level="4.6.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-deviance-statistic."><i class="fa fa-check"></i><b>4.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="4.6.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#when-and-how-can-you-compare-deviance-statistics"><i class="fa fa-check"></i><b>4.6.2</b> When and how can you compare deviance statistics?</a></li>
<li class="chapter" data-level="4.6.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#implementing-deviance-based-hypothesis-tests."><i class="fa fa-check"></i><b>4.6.3</b> Implementing deviance-based hypothesis tests.</a></li>
<li class="chapter" data-level="4.6.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#aic-and-bic-waic-and-loo-statistics-comparing-nonnested-models-using-information-criteria-and-cross-validation."><i class="fa fa-check"></i><b>4.6.4</b> <del>AIC and BIC</del> WAIC and LOO statistics: Comparing nonnested models using information criteria [and cross validation].</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#using-wald-statistics-to-test-composite-hypotheses-about-fixed-effects"><i class="fa fa-check"></i><b>4.7</b> Using Wald statistics to test composite hypotheses about fixed effects</a></li>
<li class="chapter" data-level="4.8" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#evaluating-the-tenability-of-a-models-assumptions"><i class="fa fa-check"></i><b>4.8</b> Evaluating the tenability of a model’s assumptions</a><ul>
<li class="chapter" data-level="4.8.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-functional-form."><i class="fa fa-check"></i><b>4.8.1</b> Checking functional form.</a></li>
<li class="chapter" data-level="4.8.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-normality."><i class="fa fa-check"></i><b>4.8.2</b> Checking normality.</a></li>
<li class="chapter" data-level="4.8.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-homoscedasticity."><i class="fa fa-check"></i><b>4.8.3</b> Checking homoscedasticity.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#model-based-empirical-bayes-estimates-of-the-individual-growth-parameters"><i class="fa fa-check"></i><b>4.9</b> Model-based (Empirical Bayes) estimates of the individual growth parameters</a></li>
<li class="chapter" data-level="" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html"><i class="fa fa-check"></i><b>5</b> Treating Time More Flexibly</a><ul>
<li class="chapter" data-level="5.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#variably-spaced-measurement-occasions"><i class="fa fa-check"></i><b>5.1</b> Variably spaced measurement occasions</a><ul>
<li class="chapter" data-level="5.1.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#the-structure-of-variably-spaced-data-sets."><i class="fa fa-check"></i><b>5.1.1</b> The structure of variably spaced data sets.</a></li>
<li class="chapter" data-level="5.1.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#postulating-and-fitting-multilevel-models-with-variably-spaced-waves-of-data."><i class="fa fa-check"></i><b>5.1.2</b> Postulating and fitting multilevel models with variably spaced waves of data.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#varying-numbers-of-measurement-occasions"><i class="fa fa-check"></i><b>5.2</b> Varying numbers of measurement occasions</a><ul>
<li class="chapter" data-level="5.2.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#analyzing-data-sets-in-which-the-number-of-waves-per-person-varies."><i class="fa fa-check"></i><b>5.2.1</b> Analyzing data sets in which the number of waves per person varies.</a></li>
<li class="chapter" data-level="5.2.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#practical-problems-that-may-arise-when-analyzing-unbalanced-data-sets."><i class="fa fa-check"></i><b>5.2.2</b> Practical problems that may arise when analyzing unbalanced data sets.</a></li>
<li class="chapter" data-level="5.2.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#distinguishing-among-different-types-of-missingness."><i class="fa fa-check"></i><b>5.2.3</b> Distinguishing among different types of missingness.</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#time-varying-predictors"><i class="fa fa-check"></i><b>5.3</b> Time-varying predictors</a><ul>
<li class="chapter" data-level="5.3.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#including-the-main-effect-of-a-time-varying-predictor."><i class="fa fa-check"></i><b>5.3.1</b> Including the main effect of a time-varying predictor.</a></li>
<li class="chapter" data-level="5.3.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#allowing-the-effect-of-a-time-varying-predictor-to-vary-over-time."><i class="fa fa-check"></i><b>5.3.2</b> Allowing the effect of a time-varying predictor to vary over time.</a></li>
<li class="chapter" data-level="5.3.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-time-varying-predictors."><i class="fa fa-check"></i><b>5.3.3</b> Recentering time-varying predictors.</a></li>
<li class="chapter" data-level="5.3.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#an-important-caveat-the-problem-of-reciprocal-causation."><i class="fa fa-check"></i><b>5.3.4</b> An important caveat: The problem of reciprocal causation.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-the-effect-of-time"><i class="fa fa-check"></i><b>5.4</b> Recentering the effect of <em>TIME</em></a></li>
<li class="chapter" data-level="" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html"><i class="fa fa-check"></i><b>6</b> Modeling Discontinuous and Nonlinear Change</a><ul>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html"><i class="fa fa-check"></i><b>7</b> Examining the Multilevel Model’s Error Covariance Structure</a><ul>
<li class="chapter" data-level="" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html"><i class="fa fa-check"></i><b>8</b> Modeling Change Using Covariance Structure Analysis</a><ul>
<li class="chapter" data-level="" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html"><i class="fa fa-check"></i><b>9</b> A Framework for Investigating Event Occurrence</a><ul>
<li class="chapter" data-level="9.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#should-you-conduct-a-survival-analysis-the-whether-and-when-test"><i class="fa fa-check"></i><b>9.1</b> Should you conduct a survival analysis? The “whether” and “when” test</a><ul>
<li class="chapter" data-level="9.1.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#time-to-relapse-among-recently-treated-alcoholics."><i class="fa fa-check"></i><b>9.1.1</b> Time to relapse among recently treated alcoholics.</a></li>
<li class="chapter" data-level="9.1.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#length-of-stay-in-teaching."><i class="fa fa-check"></i><b>9.1.2</b> Length of stay in teaching.</a></li>
<li class="chapter" data-level="9.1.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#age-at-first-suicide-ideation."><i class="fa fa-check"></i><b>9.1.3</b> Age at first suicide ideation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#framing-a-research-question-about-event-occurrence"><i class="fa fa-check"></i><b>9.2</b> Framing a research question about event occurrence</a><ul>
<li class="chapter" data-level="9.2.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#defining-event-occurrence."><i class="fa fa-check"></i><b>9.2.1</b> Defining event occurrence.</a></li>
<li class="chapter" data-level="9.2.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#identifying-the-beginning-of-time."><i class="fa fa-check"></i><b>9.2.2</b> Identifying the “beginning of time.”</a></li>
<li class="chapter" data-level="9.2.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#specifying-a-metric-for-time."><i class="fa fa-check"></i><b>9.2.3</b> Specifying a metric for time.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#censoring-how-complete-are-the-data-on-event-occurrence"><i class="fa fa-check"></i><b>9.3</b> Censoring: How complete are the data on event occurrence?</a><ul>
<li class="chapter" data-level="9.3.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-and-why-does-censoring-arise"><i class="fa fa-check"></i><b>9.3.1</b> How and why does censoring arise?</a></li>
<li class="chapter" data-level="9.3.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#different-types-of-censoring."><i class="fa fa-check"></i><b>9.3.2</b> Different types of censoring.</a></li>
<li class="chapter" data-level="9.3.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-does-censoring-affect-statistical-analysis"><i class="fa fa-check"></i><b>9.3.3</b> How does censoring affect statistical analysis?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html"><i class="fa fa-check"></i><b>10</b> Describing Discrete-Time Event Occurrence Data</a><ul>
<li class="chapter" data-level="10.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-life-table"><i class="fa fa-check"></i><b>10.1</b> The life table</a></li>
<li class="chapter" data-level="10.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-framework-for-characterizing-the-distribution-of-discrete-time-event-occurrence-data"><i class="fa fa-check"></i><b>10.2</b> A framework for characterizing the distribution of discrete-time event occurrence data</a><ul>
<li class="chapter" data-level="10.2.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-function."><i class="fa fa-check"></i><b>10.2.1</b> Survivor function.</a></li>
<li class="chapter" data-level="10.2.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#median-lifetime."><i class="fa fa-check"></i><b>10.2.2</b> Median lifetime.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#developing-intuition-about-hazard-functions-survivor-functions-and-median-lifetimes"><i class="fa fa-check"></i><b>10.3</b> Developing intuition about hazard functions, survivor functions, and median lifetimes</a><ul>
<li class="chapter" data-level="10.3.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#identifying-periods-of-high-and-low-risk-using-hazard-functions."><i class="fa fa-check"></i><b>10.3.1</b> Identifying periods of high and low risk using hazard functions.</a></li>
<li class="chapter" data-level="10.3.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-functions-as-a-context-for-evaluating-the-magnitude-of-hazard."><i class="fa fa-check"></i><b>10.3.2</b> Survivor functions as a context for evaluating the magnitude of hazard.</a></li>
<li class="chapter" data-level="10.3.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#strengths-and-limitations-of-estimated-median-lifetimes."><i class="fa fa-check"></i><b>10.3.3</b> Strengths and limitations of estimated median lifetimes.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#quantifying-the-effects-of-sampling-variation"><i class="fa fa-check"></i><b>10.4</b> Quantifying the effects of sampling variation</a><ul>
<li class="chapter" data-level="10.4.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-standard-error-of-the-estimated-hazard-probabilities."><i class="fa fa-check"></i><b>10.4.1</b> The standard error of the estimated hazard probabilities.</a></li>
<li class="chapter" data-level="10.4.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#standard-error-of-the-estimated-survival-probabilities."><i class="fa fa-check"></i><b>10.4.2</b> Standard error of the estimated survival probabilities.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-simple-and-useful-strategy-for-constructing-the-life-table"><i class="fa fa-check"></i><b>10.5</b> A simple and useful strategy for constructing the life table</a><ul>
<li class="chapter" data-level="10.5.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-person-period-data-set.-1"><i class="fa fa-check"></i><b>10.5.1</b> The person-period data set.</a></li>
<li class="chapter" data-level="10.5.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#using-the-person-period-data-set-to-construct-the-life-table."><i class="fa fa-check"></i><b>10.5.2</b> Using the person-period data set to construct the life table.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#bonus-fit-the-discrete-time-hazard-models-with-brms"><i class="fa fa-check"></i><b>10.6</b> Bonus: Fit the discrete-time hazard models with brms</a></li>
<li class="chapter" data-level="" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html"><i class="fa fa-check"></i><b>11</b> Fitting Basic Discrete-Time Hazard Models</a><ul>
<li class="chapter" data-level="11.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#toward-a-statistical-model-for-discrete-time-hazard"><i class="fa fa-check"></i><b>11.1</b> Toward a statistical model for discrete-time hazard</a><ul>
<li class="chapter" data-level="11.1.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#plots-of-within-group-hazard-functions-and-survivor-functions."><i class="fa fa-check"></i><b>11.1.1</b> Plots of within-group hazard functions and survivor functions.</a></li>
<li class="chapter" data-level="11.1.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-kind-of-statistical-model-do-these-graphs-suggest"><i class="fa fa-check"></i><b>11.1.2</b> What kind of statistical model do these graphs suggest?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#formal-representation-of-the-population-discrete-time-hazard-model"><i class="fa fa-check"></i><b>11.2</b> formal representation of the population discrete-time hazard model</a><ul>
<li class="chapter" data-level="11.2.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-do-the-parameters-represent"><i class="fa fa-check"></i><b>11.2.1</b> What do the parameters represent?</a></li>
<li class="chapter" data-level="11.2.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#an-alternative-representation-of-the-model."><i class="fa fa-check"></i><b>11.2.2</b> An alternative representation of the model.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-a-discrete-time-hazard-model-to-data"><i class="fa fa-check"></i><b>11.3</b> Fitting a discrete-time hazard model to data</a><ul>
<li class="chapter" data-level="11.3.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#adding-predictors-to-the-person-period-data-set."><i class="fa fa-check"></i><b>11.3.1</b> Adding predictors to the person-period data set.</a></li>
<li class="chapter" data-level="11.3.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#maximum-likelihood-estimates-and-bayesian-posteriors-for-the-discrete-time-hazard-model."><i class="fa fa-check"></i><b>11.3.2</b> Maximum likelihood estimates [and Bayesian posteriors] for the discrete-time hazard model.</a></li>
<li class="chapter" data-level="11.3.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-the-discrete-time-hazard-model-to-data."><i class="fa fa-check"></i><b>11.3.3</b> Fitting the discrete-time hazard model to data.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#interpreting-parameter-estimates"><i class="fa fa-check"></i><b>11.4</b> Interpreting parameter estimates</a><ul>
<li class="chapter" data-level="11.4.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-time-indicators."><i class="fa fa-check"></i><b>11.4.1</b> The time indicators.</a></li>
<li class="chapter" data-level="11.4.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#dichotomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.2</b> Dichotomous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#continuous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.3</b> Continuous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#polytomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.4</b> Polytomous substantive predictors.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#displaying-fitted-hazard-and-survivor-functions"><i class="fa fa-check"></i><b>11.5</b> Displaying fitted hazard and survivor functions</a><ul>
<li class="chapter" data-level="11.5.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#a-strategy-for-a-single-categorical-substantive-predictor."><i class="fa fa-check"></i><b>11.5.1</b> A strategy for a single categorical substantive predictor.</a></li>
<li class="chapter" data-level="11.5.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#extending-this-strategy-to-multiple-predictors-some-of-which-are-continuous."><i class="fa fa-check"></i><b>11.5.2</b> Extending this strategy to multiple predictors (some of which are continuous).</a></li>
<li class="chapter" data-level="11.5.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#two-cautions-when-interpreting-fitted-hazard-and-survivor-functions."><i class="fa fa-check"></i><b>11.5.3</b> Two cautions when interpreting fitted hazard and survivor functions.</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-models-using-deviance-statistics-and-information-criteria"><i class="fa fa-check"></i><b>11.6</b> Comparing models using <del>deviance statistics and</del> information criteria</a><ul>
<li class="chapter" data-level="11.6.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-deviance-statistic.-1"><i class="fa fa-check"></i><b>11.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="11.6.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-individual-predictors."><i class="fa fa-check"></i><b>11.6.2</b> Deviance-based hypothesis tests for individual predictors.</a></li>
<li class="chapter" data-level="11.6.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-groups-of-predictors."><i class="fa fa-check"></i><b>11.6.3</b> Deviance-based hypothesis tests for groups of predictors.</a></li>
<li class="chapter" data-level="11.6.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-nonnested-models-using-waic-and-loo."><i class="fa fa-check"></i><b>11.6.4</b> Comparing nonnested models using [WAIC and LOO].</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#statistical-inference-using-uncertainty-in-the-bayesian-posterior"><i class="fa fa-check"></i><b>11.7</b> Statistical inference using [uncertainty in the Bayesian posterior]</a><ul>
<li class="chapter" data-level="11.7.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-wald-chi-square-statistic."><i class="fa fa-check"></i><b>11.7.1</b> The <del>Wald chi-square statistic</del>.</a></li>
<li class="chapter" data-level="11.7.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#asymmetric-credible-intervals-for-parameters-and-odds-ratios."><i class="fa fa-check"></i><b>11.7.2</b> [Asymmetric credible intervals] for parameters and odds ratios.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html"><i class="fa fa-check"></i><b>12</b> Extending the Discrete-Time Hazard Model</a><ul>
<li class="chapter" data-level="12.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#alternative-specification-for-the-main-effect-of-time"><i class="fa fa-check"></i><b>12.1</b> Alternative specification for the “main effect” of <em>TIME</em></a><ul>
<li class="chapter" data-level="12.1.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#an-ordered-series-of-polynomial-specifications-for-time."><i class="fa fa-check"></i><b>12.1.1</b> An ordered series of polynomial specifications for <em>TIME</em>.</a></li>
<li class="chapter" data-level="12.1.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#criteria-for-comparing-alternative-specification."><i class="fa fa-check"></i><b>12.1.2</b> Criteria for comparing alternative specification.</a></li>
<li class="chapter" data-level="12.1.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-parameters-from-linear-quadratic-and-cubic-specifications."><i class="fa fa-check"></i><b>12.1.3</b> Interpreting parameters from linear, quadratic, and cubic specifications.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#using-the-complementary-log-log-link-to-specify-a-discrete-time-hazard-model"><i class="fa fa-check"></i><b>12.2</b> Using the complementary log-log link to specify a discrete-time hazard model</a><ul>
<li class="chapter" data-level="12.2.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-clog-log-transformation-when-and-why-it-is-useful."><i class="fa fa-check"></i><b>12.2.1</b> The clog-log transformation: When and why it is useful.</a></li>
<li class="chapter" data-level="12.2.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#a-discrete-time-hazard-model-using-the-complementary-log-log-link."><i class="fa fa-check"></i><b>12.2.2</b> A discrete-time hazard model using the complementary log-log link.</a></li>
<li class="chapter" data-level="12.2.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#choosing-between-logit-and-clog-log-links-for-discrete-time-hazard-models."><i class="fa fa-check"></i><b>12.2.3</b> Choosing between logit and clog-log links for discrete-time hazard models.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#time-varying-predictors-1"><i class="fa fa-check"></i><b>12.3</b> Time-varying predictors</a><ul>
<li class="chapter" data-level="12.3.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#assumptions-underlying-a-model-with-time-varying-predictors."><i class="fa fa-check"></i><b>12.3.1</b> Assumptions underlying a model with time-varying predictors.</a></li>
<li class="chapter" data-level="12.3.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-and-displaying-time-varying-predictors-effects."><i class="fa fa-check"></i><b>12.3.2</b> Interpreting and displaying time-varying predictors’ effects.</a></li>
<li class="chapter" data-level="12.3.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#two-caveats-the-problems-of-state-and-rate-dependence."><i class="fa fa-check"></i><b>12.3.3</b> Two caveats: The problems of state and rate dependence.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-linear-additivity-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.4</b> The linear additivity assumption: Uncovering violations and simple solutions</a><ul>
<li class="chapter" data-level="12.4.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interactions-between-substantive-predictors."><i class="fa fa-check"></i><b>12.4.1</b> Interactions between substantive predictors.</a></li>
<li class="chapter" data-level="12.4.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#nonlinear-effects."><i class="fa fa-check"></i><b>12.4.2</b> Nonlinear effects.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-proportionality-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.5</b> The proportionality assumption: Uncovering violations and simple solutions</a><ul>
<li class="chapter" data-level="12.5.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#discrete-time-hazard-models-that-do-not-invoke-a-proportionality-assumption."><i class="fa fa-check"></i><b>12.5.1</b> Discrete-time hazard models that do not invoke a proportionality assumption.</a></li>
<li class="chapter" data-level="12.5.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#investigating-the-proportionality-assumption-in-practice."><i class="fa fa-check"></i><b>12.5.2</b> Investigating the proportionality assumption in practice.</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-no-unobserved-heterogeneity-assumption-no-simple-solution"><i class="fa fa-check"></i><b>12.6</b> The no unobserved heterogeneity assumption: No simple solution</a></li>
<li class="chapter" data-level="12.7" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#residual-analysis"><i class="fa fa-check"></i><b>12.7</b> Residual analysis</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Applied Longitudinal Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="describing-discrete-time-event-occurrence-data" class="section level1">
<h1><span class="header-section-number">10</span> Describing Discrete-Time Event Occurrence Data</h1>
<blockquote>
<p>In this chapter, [Singer and Willett presented] a framework for describing discrete-time event occurrence data…. As we will [see], the conceptual linchpin for all subsequent survival methods is to approach the analysis on a period-by-period basis. This allows you to examine event occurrence sequentially among those individuals eligible to experience the event at each discrete point in time. (p. 325)</p>
</blockquote>
<div id="the-life-table" class="section level2">
<h2><span class="header-section-number">10.1</span> The life table</h2>
<blockquote>
<p>The fundamental tool for summarizing the sample distribution of event occurrence is the <em>life table</em>. As befits its name, a life table tracks the event histories (the “lives”) of a sample of individuals from the beginning of time (when no one has yet experienced the target event) through the end of data collection. (p. 326, <em>emphasis</em> in the original)</p>
</blockquote>
<p>To make a life table as presented in Table 10.1, we need to load the <code>teachers.csv</code> data.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb747-2" data-line-number="2"></a>
<a class="sourceLine" id="cb747-3" data-line-number="3">teachers &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/teachers.csv&quot;</span>)</a>
<a class="sourceLine" id="cb747-4" data-line-number="4"></a>
<a class="sourceLine" id="cb747-5" data-line-number="5"><span class="kw">glimpse</span>(teachers)</a></code></pre></div>
<pre><code>## Rows: 3,941
## Columns: 3
## $ id     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,…
## $ t      &lt;dbl&gt; 1, 2, 1, 1, 12, 1, 12, 1, 2, 2, 7, 12, 1, 12, 12, 2, 12, 1, 3, 2, 12, 12, 9, 12, 2…
## $ censor &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0…</code></pre>
<p>Perhaps the easiest way to make a life table as presented in Table 10.1 is with help from the <a href="https://CRAN.R-project.org/package=survival"><strong>survival</strong> package</a>.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" data-line-number="1"><span class="co"># install.packages(&quot;survival&quot;, dependencies = T)</span></a>
<a class="sourceLine" id="cb749-2" data-line-number="2"><span class="kw">library</span>(survival)</a></code></pre></div>
<p>Here we’ll use the <code>survfit()</code> function to compute survival curves. Within the <code>survfit()</code> function, we’ll use the <code>Surv()</code> function to make a survival object, which will become the criterion within the model formula. It takes two basic arguments, <code>time</code> and <code>event</code>. With the <code>teachers</code> data, <code>t</code> is time in years. In the data, events are encoded in <code>censor</code>. However, it’s important to understand how the <code>event</code> argument expects the data. From the <a href="https://cran.r-project.org/web/packages/survival/survival.pdf"><strong>survival</strong> reference manual</a>, we read that <code>event</code> is “the status indicator, normally <code>0=alive</code>, <code>1=dead</code>. Other choices are <code>TRUE/FALSE</code> (<code>TRUE = death</code>) or <code>1/2</code> (<code>2=death</code>).” Note that whereas within our data <code>censor</code> is coded <code>0 = event</code> <code>1 = censored</code>, the <code>event</code> argument expects the opposite. A quick way to solve that is to enter <code>1 - censor</code>.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb750-1" data-line-number="1">fit10<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="dt">data =</span> teachers,</a>
<a class="sourceLine" id="cb750-2" data-line-number="2">                   <span class="kw">Surv</span>(t, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>censor) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p>Use the <code>str()</code> function to survey the results.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" data-line-number="1">fit10<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</a></code></pre></div>
<pre><code>## List of 16
##  $ n        : int 3941
##  $ time     : num [1:12] 1 2 3 4 5 6 7 8 9 10 ...
##  $ n.risk   : num [1:12] 3941 3485 3101 2742 2447 ...
##  $ n.event  : num [1:12] 456 384 359 295 218 184 123 79 53 35 ...
##  $ n.censor : num [1:12] 0 0 0 0 0 0 280 307 255 265 ...
##  $ surv     : num [1:12] 0.884 0.787 0.696 0.621 0.566 ...
##  $ std.err  : num [1:12] 0.00576 0.00829 0.01053 0.01245 0.01396 ...
##  $ cumhaz   : num [1:12] 0.116 0.226 0.342 0.449 0.538 ...
##  $ std.chaz : num [1:12] 0.00542 0.00781 0.00992 0.01173 0.01319 ...
##  $ type     : chr &quot;right&quot;
##  $ logse    : logi TRUE
##  $ conf.int : num 0.95
##  $ conf.type: chr &quot;log&quot;
##  $ lower    : num [1:12] 0.874 0.774 0.682 0.606 0.55 ...
##  $ upper    : num [1:12] 0.894 0.8 0.71 0.636 0.581 ...
##  $ call     : language survfit(formula = Surv(t, 1 - censor) ~ 1, data = teachers)
##  - attr(*, &quot;class&quot;)= chr &quot;survfit&quot;</code></pre>
<p>We can retrieve the values for the “Year” column from <code>fit10.1$time</code>. The values in the “Time interval” column are a simple transformation from there.</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb753-1" data-line-number="1">fit10<span class="fl">.1</span><span class="op">$</span>time</a></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12</code></pre>
<p>We can find the values in the “Employed at the beginning of the year” column in <code>fit10.1$n.risk</code> and those in the “Who left during the year” column in <code>fit10.1$n.event</code>.</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb755-1" data-line-number="1">fit10<span class="fl">.1</span><span class="op">$</span>n.risk</a></code></pre></div>
<pre><code>##  [1] 3941 3485 3101 2742 2447 2229 2045 1642 1256  948  648  391</code></pre>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb757-1" data-line-number="1">fit10<span class="fl">.1</span><span class="op">$</span>n.event</a></code></pre></div>
<pre><code>##  [1] 456 384 359 295 218 184 123  79  53  35  16   5</code></pre>
<p>We’ll have to work a little harder to compute the values in the “Censored at the end of the year column.” Here we’ll walk it through in a data frame format.</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb759-1" data-line-number="1"><span class="kw">data.frame</span>(<span class="dt">n_risk  =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.risk,</a>
<a class="sourceLine" id="cb759-2" data-line-number="2">           <span class="dt">n_event =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.event) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb759-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_risk_1 =</span> <span class="kw">lead</span>(n_risk, <span class="dt">default =</span> <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb759-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_censored =</span> n_risk <span class="op">-</span><span class="st"> </span>n_event <span class="op">-</span><span class="st"> </span>n_risk_<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##    n_risk n_event n_risk_1 n_censored
## 1    3941     456     3485          0
## 2    3485     384     3101          0
## 3    3101     359     2742          0
## 4    2742     295     2447          0
## 5    2447     218     2229          0
## 6    2229     184     2045          0
## 7    2045     123     1642        280
## 8    1642      79     1256        307
## 9    1256      53      948        255
## 10    948      35      648        265
## 11    648      16      391        241
## 12    391       5        0        386</code></pre>
<p>That is, to get the number of those censored at the end of a given year, you take the number employed at the beginning of that year, subtract the number of those who left (i.e., the number who experienced the “event”), and then subtract the number of those employed at the beginning of the next year. Notice our use of the <code>dplyr::lead()</code> function to get the number employed in the next year (learn more about that function <a href="https://dplyr.tidyverse.org/reference/lead-lag.html">here</a>).</p>
<p>To get the values in the “Teachers at the beginning of the year who left during the year” column, which is in a proportion metric, we use division.</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb761-1" data-line-number="1">fit10<span class="fl">.1</span><span class="op">$</span>n.event <span class="op">/</span><span class="st"> </span>fit10<span class="fl">.1</span><span class="op">$</span>n.risk</a></code></pre></div>
<pre><code>##  [1] 0.11570667 0.11018651 0.11576911 0.10758570 0.08908868 0.08254823 0.06014670 0.04811206
##  [9] 0.04219745 0.03691983 0.02469136 0.01278772</code></pre>
<p>Finally, to pull the values in the “All teachers still employed at the end of the year” column, we just execute <code>fit10.1$surv</code>.</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb763-1" data-line-number="1">fit10<span class="fl">.1</span><span class="op">$</span>surv</a></code></pre></div>
<pre><code>##  [1] 0.8842933 0.7868561 0.6957625 0.6209084 0.5655925 0.5189038 0.4876935 0.4642295 0.4446402
## [10] 0.4282242 0.4176508 0.4123100</code></pre>
<p>Let’s put that all together in a tibble.</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb765-1" data-line-number="1">most_rows &lt;-</a>
<a class="sourceLine" id="cb765-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">year =</span> fit10<span class="fl">.1</span><span class="op">$</span>time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb765-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">time_int   =</span> <span class="kw">str_c</span>(<span class="st">&quot;[&quot;</span>, year, <span class="st">&quot;, &quot;</span>, year <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>), </a>
<a class="sourceLine" id="cb765-4" data-line-number="4">         <span class="dt">n_employed =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.risk, </a>
<a class="sourceLine" id="cb765-5" data-line-number="5">         <span class="dt">n_left     =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.event) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb765-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_censored   =</span> n_employed <span class="op">-</span><span class="st"> </span>n_left <span class="op">-</span><span class="st"> </span><span class="kw">lead</span>(n_employed, <span class="dt">default =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb765-7" data-line-number="7">         <span class="dt">hazard_fun   =</span> n_left <span class="op">/</span><span class="st"> </span>n_employed,</a>
<a class="sourceLine" id="cb765-8" data-line-number="8">         <span class="dt">survivor_fun =</span> fit10<span class="fl">.1</span><span class="op">$</span>surv)</a>
<a class="sourceLine" id="cb765-9" data-line-number="9"></a>
<a class="sourceLine" id="cb765-10" data-line-number="10">most_rows</a></code></pre></div>
<pre><code>## # A tibble: 12 x 7
##     year time_int n_employed n_left n_censored hazard_fun survivor_fun
##    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
##  1     1 [1, 2)         3941    456          0     0.116         0.884
##  2     2 [2, 3)         3485    384          0     0.110         0.787
##  3     3 [3, 4)         3101    359          0     0.116         0.696
##  4     4 [4, 5)         2742    295          0     0.108         0.621
##  5     5 [5, 6)         2447    218          0     0.0891        0.566
##  6     6 [6, 7)         2229    184          0     0.0825        0.519
##  7     7 [7, 8)         2045    123        280     0.0601        0.488
##  8     8 [8, 9)         1642     79        307     0.0481        0.464
##  9     9 [9, 10)        1256     53        255     0.0422        0.445
## 10    10 [10, 11)        948     35        265     0.0369        0.428
## 11    11 [11, 12)        648     16        241     0.0247        0.418
## 12    12 [12, 13)        391      5        386     0.0128        0.412</code></pre>
<p>The only thing missing from our version of Table 10.1 is we don’t have a row for Year 0. Here’s a quick and dirty way to manually insert those values.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb767-1" data-line-number="1">row_<span class="dv">1</span> &lt;-</a>
<a class="sourceLine" id="cb767-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">year         =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb767-3" data-line-number="3">         <span class="dt">time_int     =</span> <span class="st">&quot;[0, 1)&quot;</span>, </a>
<a class="sourceLine" id="cb767-4" data-line-number="4">         <span class="dt">n_employed   =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.risk[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb767-5" data-line-number="5">         <span class="dt">n_left       =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb767-6" data-line-number="6">         <span class="dt">n_censored   =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb767-7" data-line-number="7">         <span class="dt">hazard_fun   =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb767-8" data-line-number="8">         <span class="dt">survivor_fun =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb767-9" data-line-number="9"></a>
<a class="sourceLine" id="cb767-10" data-line-number="10">d &lt;-</a>
<a class="sourceLine" id="cb767-11" data-line-number="11"><span class="st">  </span><span class="kw">bind_rows</span>(row_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb767-12" data-line-number="12">            most_rows)</a>
<a class="sourceLine" id="cb767-13" data-line-number="13"></a>
<a class="sourceLine" id="cb767-14" data-line-number="14">d</a></code></pre></div>
<pre><code>## # A tibble: 13 x 7
##     year time_int n_employed n_left n_censored hazard_fun survivor_fun
##    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
##  1     0 [0, 1)         3941     NA         NA    NA             1    
##  2     1 [1, 2)         3941    456          0     0.116         0.884
##  3     2 [2, 3)         3485    384          0     0.110         0.787
##  4     3 [3, 4)         3101    359          0     0.116         0.696
##  5     4 [4, 5)         2742    295          0     0.108         0.621
##  6     5 [5, 6)         2447    218          0     0.0891        0.566
##  7     6 [6, 7)         2229    184          0     0.0825        0.519
##  8     7 [7, 8)         2045    123        280     0.0601        0.488
##  9     8 [8, 9)         1642     79        307     0.0481        0.464
## 10     9 [9, 10)        1256     53        255     0.0422        0.445
## 11    10 [10, 11)        948     35        265     0.0369        0.428
## 12    11 [11, 12)        648     16        241     0.0247        0.418
## 13    12 [12, 13)        391      5        386     0.0128        0.412</code></pre>
<p>We might walk out the notation in our <code>time_int</code> column a bit. Those intervals</p>
<blockquote>
<p>reflect a standard partition of time, in which each interval <em>includes</em> the initial time and <em>excludes</em> the concluding time. Adopting common mathematical notation, [brackets] denote inclusions and (parentheses) denote exclusions. Thus, we bracket each interval’s initial time and place a parenthesis around its concluding time. (p. 328, <em>emphasis</em> in the original)</p>
</blockquote>
<p>The values in the <code>n_employed</code> column the <em>risk set</em>, those who are “<em>eligible</em> to experience the event during that interval” (p. 329, <em>emphasis</em> in the original).</p>
</div>
<div id="a-framework-for-characterizing-the-distribution-of-discrete-time-event-occurrence-data" class="section level2">
<h2><span class="header-section-number">10.2</span> A framework for characterizing the distribution of discrete-time event occurrence data</h2>
<blockquote>
<p>The fundamental quantity used to assess the risk of event occurrence in each discrete time period is known as <em>hazard.</em> Denoted by <span class="math inline">\(h(t_{ij})\)</span>, discrete time hazard is the <em>conditional probability that individual</em> <span class="math inline">\(i\)</span> <em>will experience the event time in period</em> <span class="math inline">\(j\)</span>, <em>given that he or she did not experience it in any earlier time period</em>. Because hazard represents the risk of the event occurrence in each discrete time period among those people eligible to experience the event (those in the risk set) hazard tells us precisely what we want to know: whether and when events occurs. (p. 330, <em>emphasis</em> in the original)</p>
</blockquote>
<p>If we let <span class="math inline">\(T_i\)</span> stand for the discrete value in time person <span class="math inline">\(i\)</span> experiences the event, we can express the conditional probability the event might occur in the <span class="math inline">\(j^\text{th}\)</span> interval as</p>
<p><span class="math display">\[h(t_{ij}) = \text{Pr}[T_i = j | T \geq j].\]</span></p>
<p>That last part, <span class="math inline">\(T \geq j\)</span>, clarifies the event can only occur once and, therefore, cannot have occurred in any of the prior levels of <span class="math inline">\(j\)</span>. More plainly put, imagine the event is death and person <span class="math inline">\(i\)</span> died during the period of <span class="math inline">\(T_j = 20\)</span>. In such a case, it’s nonsensical to speak of that <span class="math inline">\(i^\text{th}\)</span> person’s hazard for the period of <span class="math inline">\(T_j = 25\)</span>. They’re already dead.</p>
<p>Also, “the discrete-time hazard probabilities expressed as a function of time–labeled <span class="math inline">\(h(t_{ij})\)</span>–is known as the population <em>discrete-time hazard function</em>” (p 330, <em>emphasis</em> in the original). That was expressed in the 6<sup>th</sup> column in Table 10.1, which we called <code>hazard_fun</code> in our <code>d</code> tibble.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb769-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb769-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(year, hazard_fun)</a></code></pre></div>
<pre><code>## # A tibble: 13 x 2
##     year hazard_fun
##    &lt;dbl&gt;      &lt;dbl&gt;
##  1     0    NA     
##  2     1     0.116 
##  3     2     0.110 
##  4     3     0.116 
##  5     4     0.108 
##  6     5     0.0891
##  7     6     0.0825
##  8     7     0.0601
##  9     8     0.0481
## 10     9     0.0422
## 11    10     0.0369
## 12    11     0.0247
## 13    12     0.0128</code></pre>
<p>You might notice <span class="math inline">\(h(t_{ij})\)</span> is in a proportion metric and it is not cumulative. If you look above in the code, you’ll see we computed that by <code>hazard_fun = n_left / n_employed</code>. More formally and generally, this is an operationalization of</p>
<p><span class="math display">\[\hat h(t_{j}) = \frac{n \text{ events}_j}{n \text{ at risk}_j},\]</span></p>
<p>where <span class="math inline">\(n \text{ events}_j\)</span> is the number of individuals who experienced the event in the <span class="math inline">\(j^{th}\)</span> period and <span class="math inline">\(n \text{ at risk}_j\)</span> is the number within the period who have not (a) already experienced the event and (b) been censored. Also note that by <span class="math inline">\(\hat h(t_{j})\)</span>, we’re indicating we’re talking about the maximum likelihood estimate for <span class="math inline">\(h(t_{j})\)</span>. Because no one is at risk during the initial time point, <span class="math inline">\(h(t_0)\)</span> is undefined (i.e., <code>NA</code>). Here we mimic the top panel of Figure 10.1 and plot our <span class="math inline">\(\hat h(t_{j})\)</span> over time.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb771-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb771-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> hazard_fun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb771-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb771-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;years in teaching&quot;</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">13</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">13</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb771-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="st">&quot;estimated hazard probability, &quot;</span><span class="op">*</span><span class="kw">hat</span>(<span class="kw">italic</span>(h))(<span class="kw">italic</span>(t[j]))), </a>
<a class="sourceLine" id="cb771-6" data-line-number="6">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.15</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb771-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;" /></p>
<div id="survivor-function." class="section level3">
<h3><span class="header-section-number">10.2.1</span> Survivor function.</h3>
<p>The survivor function provides another way of describing the distribution of event occurrence over time. Unlike the hazard function, which assesses the unique risk associated with each time period, the survivor function cumulates these period-by-period risks of event occurrence (or more properly, nonoccurrence) together to assess the probability that a randomly selected individual will survive will not experience the event.</p>
<p>We can formally define the survivor function, <span class="math inline">\(S(t_{ij})\)</span>, as</p>
<p><span class="math display">\[S(t_{ij}) = \text{Pr}[T &gt; j],\]</span></p>
<p>where <span class="math inline">\(S\)</span> is survival as a function of time, <span class="math inline">\(t\)</span>. But since our data are finite, we can only have an estimate of the “true” survivor function, which we call <span class="math inline">\(\hat S(t_{ij})\)</span>. Here it is in a plot, our version of the bottom panel of Figure 10.1.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb772-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb772-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> survivor_fun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb772-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb772-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb772-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;years in teaching&quot;</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">13</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">13</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb772-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="st">&quot;estimated survival probability, &quot;</span><span class="op">*</span><span class="kw">hat</span>(<span class="kw">italic</span>(S))(<span class="kw">italic</span>(t[j]))),</a>
<a class="sourceLine" id="cb772-7" data-line-number="7">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb772-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="median-lifetime." class="section level3">
<h3><span class="header-section-number">10.2.2</span> Median lifetime.</h3>
<blockquote>
<p>Having characterized the <em>distribution</em> of event times using the hazard and survivor functions, we often want to identify the distribution’s center. Were there no censoring, all event times would be known, and we could compute a sample mean. But because of censoring, another estimate of central tendency is preferred: the <em>median lifetime</em>.</p>
<p><em>The estimated median lifetime identifies that value for</em> <span class="math inline">\(T\)</span> <em>for which the value of the estimated survivor function is .5</em>. It is the point in time by which we estimate that half of the sample has experienced the target event, half has not. (p. 337, <em>emphasis</em> in the original)</p>
</blockquote>
<p>If we use <code>filter()</code>, well see our median lifetime rests between years 6 and 7.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb773-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb773-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb773-3" data-line-number="3"><span class="st">  </span><span class="co"># this just simplifies the output</span></a>
<a class="sourceLine" id="cb773-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(year, time_int, survivor_fun)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##    year time_int survivor_fun
##   &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
## 1     6 [6, 7)          0.519
## 2     7 [7, 8)          0.488</code></pre>
<p>Using a simple descriptive approach, we’d just say the median lifetime was between years 6 and 7. We could also follow <a href="https://books.google.com/books/about/Survival_Analysis.html?id=cttQAAAAMAAJ">Miller (1981)</a> and linearly interpolate between the two values of <span class="math inline">\(S(t_j)\)</span> bracketing .5. If we let <span class="math inline">\(m\)</span> be the time interval just before the median lifetime, <span class="math inline">\(\hat S(t_m)\)</span> be the value of the survivor function in that <span class="math inline">\(m^\text{th}\)</span> interval, and <span class="math inline">\(\hat S(t_{m + 1})\)</span> be the survival value in the next interval, the can write</p>
<p><span class="math display">\[\text{Estimated median lifetime} = m + \Bigg [\frac{\hat S(t_m) - .5}{\hat S(t_m) - \hat S(t_{m + 1})} \Bigg ] \big ((m + 1) - m \big).\]</span></p>
<p>We can compute that by hand like so.</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb775-1" data-line-number="1">m        &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb775-2" data-line-number="2">m_plus_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb775-3" data-line-number="3"></a>
<a class="sourceLine" id="cb775-4" data-line-number="4">stm &lt;-</a>
<a class="sourceLine" id="cb775-5" data-line-number="5"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb775-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>m) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb775-7" data-line-number="7"><span class="st">  </span><span class="kw">pull</span>(survivor_fun)</a>
<a class="sourceLine" id="cb775-8" data-line-number="8"></a>
<a class="sourceLine" id="cb775-9" data-line-number="9">stm_plus_<span class="dv">1</span> &lt;-</a>
<a class="sourceLine" id="cb775-10" data-line-number="10"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb775-11" data-line-number="11"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>m_plus_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb775-12" data-line-number="12"><span class="st">  </span><span class="kw">pull</span>(survivor_fun)</a>
<a class="sourceLine" id="cb775-13" data-line-number="13"></a>
<a class="sourceLine" id="cb775-14" data-line-number="14"><span class="co"># compute the interpolated median lifetime and save it as `iml`</span></a>
<a class="sourceLine" id="cb775-15" data-line-number="15">iml &lt;-<span class="st"> </span>m <span class="op">+</span><span class="st"> </span>((stm <span class="op">-</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">/</span><span class="st"> </span>(stm <span class="op">-</span><span class="st"> </span>stm_plus_<span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>((m <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">-</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb775-16" data-line-number="16">iml</a></code></pre></div>
<pre><code>## [1] 6.605691</code></pre>
<p>Now we have the <code>iml</code> value, we can add that information to our version of the lower panel of Figure 10.1.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb777-1" data-line-number="1">line &lt;-</a>
<a class="sourceLine" id="cb777-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">year         =</span> <span class="kw">c</span>(<span class="dv">0</span>, iml, iml),</a>
<a class="sourceLine" id="cb777-3" data-line-number="3">         <span class="dt">survivor_fun =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb777-4" data-line-number="4"></a>
<a class="sourceLine" id="cb777-5" data-line-number="5">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb777-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> survivor_fun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb777-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> line,</a>
<a class="sourceLine" id="cb777-8" data-line-number="8">            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb777-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb777-10" data-line-number="10"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb777-11" data-line-number="11">           <span class="dt">x =</span> iml, <span class="dt">y =</span> <span class="fl">.55</span>,</a>
<a class="sourceLine" id="cb777-12" data-line-number="12">           <span class="dt">label =</span> <span class="st">&quot;All teachers (6.6 years)&quot;</span>,</a>
<a class="sourceLine" id="cb777-13" data-line-number="13">           <span class="dt">hjust =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb777-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;years in teaching&quot;</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">13</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">13</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb777-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="st">&quot;estimated survival probability, &quot;</span><span class="op">*</span><span class="kw">hat</span>(<span class="kw">italic</span>(S))(<span class="kw">italic</span>(t[j]))),</a>
<a class="sourceLine" id="cb777-16" data-line-number="16">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb777-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We can compute the estimates for the 5- and 10-year survival rates as a direct algebraic transformation of the survival function from those years.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb778-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb778-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb778-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(year, survivor_fun) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb778-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">survival rate (%)</span><span class="st">`</span> =<span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span>survivor_fun) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">0</span>))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##    year survivor_fun `survival rate (%)`
##   &lt;dbl&gt;        &lt;dbl&gt;               &lt;dbl&gt;
## 1     5        0.566                  57
## 2    10        0.428                  43</code></pre>
</div>
</div>
<div id="developing-intuition-about-hazard-functions-survivor-functions-and-median-lifetimes" class="section level2">
<h2><span class="header-section-number">10.3</span> Developing intuition about hazard functions, survivor functions, and median lifetimes</h2>
<blockquote>
<p>Developing intuition about these sample statistics requires exposure to estimates computed from a wide range of studies. To jump-start this process, we review results from four studies that differ across three salient dimensions–the type of event investigated, the metric used to record discrete time, and most important, the underlying profile of risk–and discuss how we would examine, and describe, the estimated hazard functions, survivor functions, and median lifetimes. (p. 339)</p>
</blockquote>
<p>Here we load the four relevant data sets.</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb780-1" data-line-number="1">cocaine  &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/cocaine_relapse.csv&quot;</span>)</a>
<a class="sourceLine" id="cb780-2" data-line-number="2">sex      &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/firstsex.csv&quot;</span>)</a>
<a class="sourceLine" id="cb780-3" data-line-number="3">suicide  &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/suicide.csv&quot;</span>)</a>
<a class="sourceLine" id="cb780-4" data-line-number="4">congress &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/congress.csv&quot;</span>)</a>
<a class="sourceLine" id="cb780-5" data-line-number="5"></a>
<a class="sourceLine" id="cb780-6" data-line-number="6"><span class="co"># glimpse(cocaine)</span></a>
<a class="sourceLine" id="cb780-7" data-line-number="7"><span class="co"># glimpse(sex)</span></a>
<a class="sourceLine" id="cb780-8" data-line-number="8"><span class="co"># glimpse(suicide)</span></a>
<a class="sourceLine" id="cb780-9" data-line-number="9"><span class="co"># glimpse(congress)</span></a></code></pre></div>
<p>We have a lot of leg work in front of use before we can recreate Figure 10.2. First, we’ll feed each of the four data sets into the <code>survfit()</code> function.</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb781-1" data-line-number="1">fit10<span class="fl">.2</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb781-2" data-line-number="2"><span class="st">  </span><span class="kw">survfit</span>(<span class="dt">data =</span> cocaine,</a>
<a class="sourceLine" id="cb781-3" data-line-number="3">          <span class="kw">Surv</span>(week, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>censor) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb781-4" data-line-number="4"></a>
<a class="sourceLine" id="cb781-5" data-line-number="5">fit10<span class="fl">.3</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb781-6" data-line-number="6"><span class="st">  </span><span class="kw">survfit</span>(<span class="dt">data =</span> sex,</a>
<a class="sourceLine" id="cb781-7" data-line-number="7">          <span class="kw">Surv</span>(time, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>censor) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb781-8" data-line-number="8"></a>
<a class="sourceLine" id="cb781-9" data-line-number="9">fit10<span class="fl">.4</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb781-10" data-line-number="10"><span class="st">  </span><span class="kw">survfit</span>(<span class="dt">data =</span> suicide,</a>
<a class="sourceLine" id="cb781-11" data-line-number="11">          <span class="kw">Surv</span>(time, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>censor) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb781-12" data-line-number="12"></a>
<a class="sourceLine" id="cb781-13" data-line-number="13">fit10<span class="fl">.5</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb781-14" data-line-number="14"><span class="st">  </span><span class="kw">survfit</span>(<span class="dt">data =</span> congress,</a>
<a class="sourceLine" id="cb781-15" data-line-number="15">          <span class="kw">Surv</span>(time, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>censor) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p>Given the four fits all follow the same basic form and given our end point is to make the same basic plots for each, we can substantially streamline our code by making a series of custom functions. For our first custom function, <code>make_lt()</code>, we’ll save the general steps for making life tables for each data set.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb782-1" data-line-number="1">make_lt &lt;-<span class="st"> </span><span class="cf">function</span>(fit) {</a>
<a class="sourceLine" id="cb782-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb782-3" data-line-number="3">  <span class="co"># arrange the lt data for all rows but the first</span></a>
<a class="sourceLine" id="cb782-4" data-line-number="4">  most_rows &lt;-</a>
<a class="sourceLine" id="cb782-5" data-line-number="5"><span class="st">    </span><span class="kw">tibble</span>(<span class="dt">time =</span> fit<span class="op">$</span>time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb782-6" data-line-number="6"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">time_int =</span> <span class="kw">str_c</span>(<span class="st">&quot;[&quot;</span>, time, <span class="st">&quot;, &quot;</span>, time <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;)&quot;</span>), </a>
<a class="sourceLine" id="cb782-7" data-line-number="7">           <span class="dt">n_risk   =</span> fit<span class="op">$</span>n.risk, </a>
<a class="sourceLine" id="cb782-8" data-line-number="8">           <span class="dt">n_event  =</span> fit<span class="op">$</span>n.event) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb782-9" data-line-number="9"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">hazard_fun   =</span> n_event <span class="op">/</span><span class="st"> </span>n_risk,</a>
<a class="sourceLine" id="cb782-10" data-line-number="10">           <span class="dt">survivor_fun =</span> fit<span class="op">$</span>surv)</a>
<a class="sourceLine" id="cb782-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb782-12" data-line-number="12">  <span class="co"># define the values for t = 2 and t = 1</span></a>
<a class="sourceLine" id="cb782-13" data-line-number="13">  time_<span class="dv">1</span> &lt;-<span class="st"> </span>fit<span class="op">$</span>time[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb782-14" data-line-number="14">  time_<span class="dv">0</span> &lt;-<span class="st"> </span>time_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb782-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb782-16" data-line-number="16">  <span class="co"># define the values for the row for which t = 1</span></a>
<a class="sourceLine" id="cb782-17" data-line-number="17">  row_<span class="dv">1</span> &lt;-</a>
<a class="sourceLine" id="cb782-18" data-line-number="18"><span class="st">    </span><span class="kw">tibble</span>(<span class="dt">time         =</span> time_<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb782-19" data-line-number="19">           <span class="dt">time_int     =</span> <span class="kw">str_c</span>(<span class="st">&quot;[&quot;</span>, time_<span class="dv">0</span>, <span class="st">&quot;, &quot;</span>, time_<span class="dv">1</span>, <span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb782-20" data-line-number="20">           <span class="dt">n_risk       =</span> fit<span class="op">$</span>n.risk[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb782-21" data-line-number="21">           <span class="dt">n_event      =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb782-22" data-line-number="22">           <span class="dt">hazard_fun   =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb782-23" data-line-number="23">           <span class="dt">survivor_fun =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb782-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb782-25" data-line-number="25">  <span class="co"># make the full life table</span></a>
<a class="sourceLine" id="cb782-26" data-line-number="26">  lt &lt;-</a>
<a class="sourceLine" id="cb782-27" data-line-number="27"><span class="st">    </span><span class="kw">bind_rows</span>(row_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb782-28" data-line-number="28">              most_rows)</a>
<a class="sourceLine" id="cb782-29" data-line-number="29">  </a>
<a class="sourceLine" id="cb782-30" data-line-number="30">  lt</a>
<a class="sourceLine" id="cb782-31" data-line-number="31">  </a>
<a class="sourceLine" id="cb782-32" data-line-number="32">}</a></code></pre></div>
<p>Use <code>make_lt()</code> to make the four life tables.</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb783-1" data-line-number="1">lt_cocaine  &lt;-<span class="st"> </span><span class="kw">make_lt</span>(fit10<span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb783-2" data-line-number="2">lt_sex      &lt;-<span class="st"> </span><span class="kw">make_lt</span>(fit10<span class="fl">.3</span>)</a>
<a class="sourceLine" id="cb783-3" data-line-number="3">lt_suicide  &lt;-<span class="st"> </span><span class="kw">make_lt</span>(fit10<span class="fl">.4</span>)</a>
<a class="sourceLine" id="cb783-4" data-line-number="4">lt_congress &lt;-<span class="st"> </span><span class="kw">make_lt</span>(fit10<span class="fl">.5</span>)</a></code></pre></div>
<p>You’ll note that the four survival-curve plots in Figure 10.2 all show the median lifetime using the interpolation method. Here we’ll save the necessary steps to compute that for each model as the <code>make_iml()</code> function.</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb784-1" data-line-number="1">make_iml &lt;-<span class="st"> </span><span class="cf">function</span>(lt) {</a>
<a class="sourceLine" id="cb784-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb784-3" data-line-number="3">  <span class="co"># lt is a generic name for a life table of the </span></a>
<a class="sourceLine" id="cb784-4" data-line-number="4">  <span class="co"># kind we made with our `make_lt()` function</span></a>
<a class="sourceLine" id="cb784-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb784-6" data-line-number="6">  <span class="co"># determine the mth row</span></a>
<a class="sourceLine" id="cb784-7" data-line-number="7">  lt_m &lt;-</a>
<a class="sourceLine" id="cb784-8" data-line-number="8"><span class="st">    </span>lt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb784-9" data-line-number="9"><span class="st">    </span><span class="kw">filter</span>(survivor_fun <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb784-10" data-line-number="10"><span class="st">    </span><span class="kw">slice</span>(<span class="kw">n</span>())</a>
<a class="sourceLine" id="cb784-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb784-12" data-line-number="12">  <span class="co"># determine the row for m + 1</span></a>
<a class="sourceLine" id="cb784-13" data-line-number="13">  lt_m1 &lt;-</a>
<a class="sourceLine" id="cb784-14" data-line-number="14"><span class="st">    </span>lt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb784-15" data-line-number="15"><span class="st">    </span><span class="kw">filter</span>(survivor_fun <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb784-16" data-line-number="16"><span class="st">    </span><span class="kw">slice</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb784-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb784-18" data-line-number="18">  <span class="co"># pull the value for m</span></a>
<a class="sourceLine" id="cb784-19" data-line-number="19">  m  &lt;-<span class="st"> </span><span class="kw">pull</span>(lt_m, time)</a>
<a class="sourceLine" id="cb784-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb784-21" data-line-number="21">  <span class="co"># pull the two survival function values</span></a>
<a class="sourceLine" id="cb784-22" data-line-number="22">  stm  &lt;-<span class="st"> </span><span class="kw">pull</span>(lt_m, survivor_fun)</a>
<a class="sourceLine" id="cb784-23" data-line-number="23">  stm1 &lt;-<span class="st"> </span><span class="kw">pull</span>(lt_m1, survivor_fun)</a>
<a class="sourceLine" id="cb784-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb784-25" data-line-number="25">  <span class="co"># plug the values into Equation 10.6 (page 338)</span></a>
<a class="sourceLine" id="cb784-26" data-line-number="26">  iml &lt;-<span class="st"> </span>m <span class="op">+</span><span class="st"> </span>((stm <span class="op">-</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">/</span><span class="st"> </span>(stm <span class="op">-</span><span class="st"> </span>stm1)) <span class="op">*</span><span class="st"> </span>((m <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">-</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb784-27" data-line-number="27">  </a>
<a class="sourceLine" id="cb784-28" data-line-number="28">  iml</a>
<a class="sourceLine" id="cb784-29" data-line-number="29">  </a>
<a class="sourceLine" id="cb784-30" data-line-number="30">}</a></code></pre></div>
<p>If you want, you can use <code>make_iml()</code> directly like this.</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb785-1" data-line-number="1"><span class="kw">make_iml</span>(lt_cocaine)</a></code></pre></div>
<pre><code>## [1] 7.5</code></pre>
<p>However, our approach will be to wrap it in another function, <code>line_tbl()</code>, with which we will save the coordinates necessary for marking off the median lifetimes and them save them in a tibble.</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb787-1" data-line-number="1">line_tbl &lt;-<span class="st"> </span><span class="cf">function</span>(lt) {</a>
<a class="sourceLine" id="cb787-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb787-3" data-line-number="3">  iml &lt;-<span class="st"> </span><span class="kw">make_iml</span>(lt)</a>
<a class="sourceLine" id="cb787-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb787-5" data-line-number="5">  <span class="kw">tibble</span>(<span class="dt">time         =</span> <span class="kw">c</span>(lt[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(), iml, iml),</a>
<a class="sourceLine" id="cb787-6" data-line-number="6">         <span class="dt">survivor_fun =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb787-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb787-8" data-line-number="8">}</a></code></pre></div>
<p>It works like this.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb788-1" data-line-number="1"><span class="kw">line_tbl</span>(lt_cocaine)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##    time survivor_fun
##   &lt;dbl&gt;        &lt;dbl&gt;
## 1  0             0.5
## 2  7.50          0.5
## 3  7.50          0</code></pre>
<p>If you look closely at the hazard function plots in the left column of Figure 10.2, you’ll note they share many common settings (e.g., the basic shape, the label of the <span class="math inline">\(y\)</span>-axis). But there are several parameters we’ll need to set custom settings for. To my eye, those are:</p>
<ul>
<li>the data;</li>
<li>the <span class="math inline">\(x\)</span>-axis label, break points, and limits; and</li>
<li>the <span class="math inline">\(y\)</span>-axis break points, and limits.</li>
</ul>
<p>With our custom <code>h_plot()</code> function, we’ll leave those parameters free while keeping all the other <strong>ggplot2</strong> parameters the same.</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb790-1" data-line-number="1">h_plot &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">data =</span> data, </a>
<a class="sourceLine" id="cb790-2" data-line-number="2">                   <span class="dt">xlab =</span> xlab, <span class="dt">xbreaks =</span> xbreaks, <span class="dt">xlimits =</span> xlimits,</a>
<a class="sourceLine" id="cb790-3" data-line-number="3">                   <span class="dt">ybreaks =</span> ybreaks, <span class="dt">ylimits =</span> ylimits) {</a>
<a class="sourceLine" id="cb790-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb790-5" data-line-number="5">  <span class="kw">ggplot</span>(<span class="dt">data =</span> data,</a>
<a class="sourceLine" id="cb790-6" data-line-number="6">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> hazard_fun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb790-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb790-8" data-line-number="8"><span class="st">    </span><span class="kw">scale_x_continuous</span>(xlab, <span class="dt">breaks =</span> xbreaks, <span class="dt">limits =</span> xlimits) <span class="op">+</span></a>
<a class="sourceLine" id="cb790-9" data-line-number="9"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="kw">widehat</span>(<span class="kw">italic</span>(<span class="kw">h</span>(t)))), </a>
<a class="sourceLine" id="cb790-10" data-line-number="10">                       <span class="dt">breaks =</span> ybreaks, <span class="dt">limits =</span> ylimits) <span class="op">+</span></a>
<a class="sourceLine" id="cb790-11" data-line-number="11"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb790-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb790-13" data-line-number="13">}</a></code></pre></div>
<p>Now we’ll make a similar custom plotting function, <code>s_plot()</code>, for the hazard function plots on the right column of Figure 10.2.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb791-1" data-line-number="1">s_plot &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">data =</span> data, <span class="dt">xlab =</span> xlab, <span class="dt">xbreaks =</span> xbreaks, <span class="dt">xlimits =</span> xlimits) {</a>
<a class="sourceLine" id="cb791-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb791-3" data-line-number="3">  <span class="co"># compute the imterpolated median life value</span></a>
<a class="sourceLine" id="cb791-4" data-line-number="4">  iml &lt;-<span class="st"> </span><span class="kw">make_iml</span>(data)</a>
<a class="sourceLine" id="cb791-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb791-6" data-line-number="6">  <span class="co"># make the imp line values</span></a>
<a class="sourceLine" id="cb791-7" data-line-number="7">  line &lt;-</a>
<a class="sourceLine" id="cb791-8" data-line-number="8"><span class="st">    </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb791-9" data-line-number="9"><span class="st">    </span><span class="kw">line_tbl</span>()</a>
<a class="sourceLine" id="cb791-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb791-11" data-line-number="11">  <span class="kw">ggplot</span>(<span class="dt">data =</span> data,</a>
<a class="sourceLine" id="cb791-12" data-line-number="12">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> survivor_fun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb791-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_path</span>(<span class="dt">data =</span> line,</a>
<a class="sourceLine" id="cb791-14" data-line-number="14">              <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb791-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb791-16" data-line-number="16"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb791-17" data-line-number="17">             <span class="dt">x =</span> iml, <span class="dt">y =</span> <span class="fl">.6</span>,</a>
<a class="sourceLine" id="cb791-18" data-line-number="18">             <span class="dt">label =</span> <span class="kw">str_c</span>(<span class="st">&quot;widehat(ML)==&quot;</span>, iml <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb791-19" data-line-number="19">             <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">parse =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb791-20" data-line-number="20"><span class="st">    </span><span class="kw">scale_x_continuous</span>(xlab, <span class="dt">breaks =</span> xbreaks, <span class="dt">limits =</span> xlimits) <span class="op">+</span></a>
<a class="sourceLine" id="cb791-21" data-line-number="21"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="kw">widehat</span>(<span class="kw">italic</span>(<span class="kw">S</span>(t)))),</a>
<a class="sourceLine" id="cb791-22" data-line-number="22">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb791-23" data-line-number="23"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb791-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb791-25" data-line-number="25">}</a></code></pre></div>
<p>Now we make the eight subplots in bulk, naming them <code>p1</code>, <code>p2</code>, and so on.</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb792-1" data-line-number="1"><span class="co"># cocaine</span></a>
<a class="sourceLine" id="cb792-2" data-line-number="2">p1 &lt;-</a>
<a class="sourceLine" id="cb792-3" data-line-number="3"><span class="st">  </span>lt_cocaine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-4" data-line-number="4"><span class="st">  </span><span class="kw">h_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Weeks after release&quot;</span>, </a>
<a class="sourceLine" id="cb792-5" data-line-number="5">         <span class="dt">xbreaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb792-6" data-line-number="6">         <span class="dt">ybreaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.15</span>), <span class="dt">ylimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.15</span>))</a>
<a class="sourceLine" id="cb792-7" data-line-number="7"></a>
<a class="sourceLine" id="cb792-8" data-line-number="8">p2 &lt;-</a>
<a class="sourceLine" id="cb792-9" data-line-number="9"><span class="st">  </span>lt_cocaine <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-10" data-line-number="10"><span class="st">  </span><span class="kw">s_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Weeks after release&quot;</span>, </a>
<a class="sourceLine" id="cb792-11" data-line-number="11">         <span class="dt">xbreaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb792-12" data-line-number="12"></a>
<a class="sourceLine" id="cb792-13" data-line-number="13"><span class="co"># sex</span></a>
<a class="sourceLine" id="cb792-14" data-line-number="14">p3 &lt;-</a>
<a class="sourceLine" id="cb792-15" data-line-number="15"><span class="st">  </span>lt_sex <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-16" data-line-number="16"><span class="st">  </span><span class="kw">h_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Grade&quot;</span>, </a>
<a class="sourceLine" id="cb792-17" data-line-number="17">         <span class="dt">xbreaks =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb792-18" data-line-number="18">         <span class="dt">ybreaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">ylimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.325</span>))</a>
<a class="sourceLine" id="cb792-19" data-line-number="19"></a>
<a class="sourceLine" id="cb792-20" data-line-number="20">p4 &lt;-</a>
<a class="sourceLine" id="cb792-21" data-line-number="21"><span class="st">  </span>lt_sex <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-22" data-line-number="22"><span class="st">  </span><span class="kw">s_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Grade&quot;</span>, </a>
<a class="sourceLine" id="cb792-23" data-line-number="23">         <span class="dt">xbreaks =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb792-24" data-line-number="24"></a>
<a class="sourceLine" id="cb792-25" data-line-number="25"><span class="co"># suicide</span></a>
<a class="sourceLine" id="cb792-26" data-line-number="26">p5 &lt;-</a>
<a class="sourceLine" id="cb792-27" data-line-number="27"><span class="st">  </span>lt_suicide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-28" data-line-number="28"><span class="st">  </span><span class="kw">h_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, </a>
<a class="sourceLine" id="cb792-29" data-line-number="29">         <span class="dt">xbreaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">22</span>),</a>
<a class="sourceLine" id="cb792-30" data-line-number="30">         <span class="dt">ybreaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.15</span>), <span class="dt">ylimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.16</span>))</a>
<a class="sourceLine" id="cb792-31" data-line-number="31"></a>
<a class="sourceLine" id="cb792-32" data-line-number="32">p6 &lt;-</a>
<a class="sourceLine" id="cb792-33" data-line-number="33"><span class="st">  </span>lt_suicide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-34" data-line-number="34"><span class="st">  </span><span class="kw">s_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, </a>
<a class="sourceLine" id="cb792-35" data-line-number="35">         <span class="dt">xbreaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">22</span>))</a>
<a class="sourceLine" id="cb792-36" data-line-number="36"></a>
<a class="sourceLine" id="cb792-37" data-line-number="37"><span class="co"># congress</span></a>
<a class="sourceLine" id="cb792-38" data-line-number="38">p7 &lt;-</a>
<a class="sourceLine" id="cb792-39" data-line-number="39"><span class="st">  </span>lt_congress <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-40" data-line-number="40"><span class="st">  </span><span class="kw">h_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Terms in office&quot;</span>, </a>
<a class="sourceLine" id="cb792-41" data-line-number="41">         <span class="dt">xbreaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">8</span>),</a>
<a class="sourceLine" id="cb792-42" data-line-number="42">         <span class="dt">ybreaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">ylimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.3</span>))</a>
<a class="sourceLine" id="cb792-43" data-line-number="43"></a>
<a class="sourceLine" id="cb792-44" data-line-number="44">p8 &lt;-</a>
<a class="sourceLine" id="cb792-45" data-line-number="45"><span class="st">  </span>lt_congress <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb792-46" data-line-number="46"><span class="st">  </span><span class="kw">s_plot</span>(<span class="dt">xlab =</span> <span class="st">&quot;Terms in office&quot;</span>, </a>
<a class="sourceLine" id="cb792-47" data-line-number="47">         <span class="dt">xbreaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">xlimits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</a></code></pre></div>
<p>Now we’ll use some functions and syntax from the <strong>patchwork</strong> package to combine the subplots and make Figure 10.2.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb793-1" data-line-number="1"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb793-2" data-line-number="2"></a>
<a class="sourceLine" id="cb793-3" data-line-number="3">p12 &lt;-<span class="st"> </span>(p1 <span class="op">+</span><span class="st"> </span>p2) <span class="op">+</span><span class="st"> </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;A&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</a>
<a class="sourceLine" id="cb793-4" data-line-number="4">p34 &lt;-<span class="st"> </span>(p3 <span class="op">+</span><span class="st"> </span>p4) <span class="op">+</span><span class="st"> </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;B&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</a>
<a class="sourceLine" id="cb793-5" data-line-number="5">p56 &lt;-<span class="st"> </span>(p5 <span class="op">+</span><span class="st"> </span>p6) <span class="op">+</span><span class="st"> </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;C&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</a>
<a class="sourceLine" id="cb793-6" data-line-number="6">p78 &lt;-<span class="st"> </span>(p7 <span class="op">+</span><span class="st"> </span>p8) <span class="op">+</span><span class="st"> </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;D&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</a>
<a class="sourceLine" id="cb793-7" data-line-number="7"></a>
<a class="sourceLine" id="cb793-8" data-line-number="8">(<span class="kw">wrap_elements</span>(p12) <span class="op">/</span></a>
<a class="sourceLine" id="cb793-9" data-line-number="9"><span class="st">  </span><span class="kw">wrap_elements</span>(p34) <span class="op">/</span></a>
<a class="sourceLine" id="cb793-10" data-line-number="10"><span class="st">  </span><span class="kw">wrap_elements</span>(p56) <span class="op">/</span></a>
<a class="sourceLine" id="cb793-11" data-line-number="11"><span class="st">  </span><span class="kw">wrap_elements</span>(p78))</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Boom! Looks like a dream.</p>
<div id="identifying-periods-of-high-and-low-risk-using-hazard-functions." class="section level3">
<h3><span class="header-section-number">10.3.1</span> Identifying periods of high and low risk using hazard functions.</h3>
<p>It can be useful to evaluate hazard functions based on whether they are <em>monotonic</em> (i.e., have a single distinctive peak and single distinctive trough) and <em>nonmonotonic</em> (i.e., have multiple distinctive peaks or troughs). Globally speaking, the hazard functions for rows <code>A</code> and <code>B</code> are monotonic and the remaining two are nonmonotonic.</p>
<p>Singer and Willett remarked “monotonically increasing hazard functions are common when studying events that are ultimately inevitable (or near universal)…. [However,] nonmonotonic hazard functions, like those in Panels C and D, generally arise in studies of long duration” (p. 342).</p>
<p>However, when risk is constant over time, hazard functions will not have peaks or troughs.</p>
</div>
<div id="survivor-functions-as-a-context-for-evaluating-the-magnitude-of-hazard." class="section level3">
<h3><span class="header-section-number">10.3.2</span> Survivor functions as a context for evaluating the magnitude of hazard.</h3>
<p>Unlike with hazard functions, all survivor functions decrease or stay constant over time. They are monotonic (i.e., they never switch direction, they never increase). From the text (p. 344), we learn three ways hazard functions relate to survival functions:</p>
<ul>
<li><em>When hazard is high, the survivor function drops rapidly</em>.</li>
<li><em>When hazard is low, the survivor function drops slowly</em>.</li>
<li><em>When hazard is zero, the survivor function remains unchanged</em>.</li>
</ul>
</div>
<div id="strengths-and-limitations-of-estimated-median-lifetimes." class="section level3">
<h3><span class="header-section-number">10.3.3</span> Strengths and limitations of estimated median lifetimes.</h3>
<blockquote>
<p>When examining a median lifetime, we find it helpful to remember three important limitations on its interpretation. First, it identifies only an “average” event time; it tells us little about the distribution of even times and is relatively insensitive to extreme values. Second, the median lifetime is not necessarily a moment when the target event is <em>especially</em> likely to occur…. Third, the median lifetime reveals little about the distribution of risk over time; identical median lifetimes can result from dramatically different survivor and hazard functions. (pp. 345–346, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Without access to Singer and Willett’s hypothetical data, we’re not in a good position to recreate their Figure 10.3. Even the <a href="https://stats.idre.ucla.edu/r/examples/alda/r-applied-longitudinal-data-analysis-ch-10/">good folks at IDRE</a> gave up on that one.</p>
</div>
</div>
<div id="quantifying-the-effects-of-sampling-variation" class="section level2">
<h2><span class="header-section-number">10.4</span> Quantifying the effects of sampling variation</h2>
<p>We can quantify the uncertainty in the estimates with standard errors.</p>
<div id="the-standard-error-of-the-estimated-hazard-probabilities." class="section level3">
<h3><span class="header-section-number">10.4.1</span> The standard error of the estimated hazard probabilities.</h3>
<p>The formula for the frequentist standard errors for the hazard probabilities follows the form</p>
<p><span class="math display">\[se \big (\hat h(t_j) \big) = \sqrt{\frac{\hat h(t_j) \big (1 - \hat h(t_j) \big)}{n \text{ at risk}_j}}.\]</span></p>
<p>We can express that equation <strong>R</strong> code to recreate the first four columns of Table 10.2. We’ll be pulling much of the information from <code>fit10.1</code>. But to show our work within a tibble format, we’ll be adding a column after <span class="math inline">\(n_j\)</span>. Our additional <code>n_event</code> column will contain the information pulled from <code>fit10.1$n.event</code>, which we’ll use to compute the <span class="math inline">\(\hat h(t_j)\)</span>.</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb794-1" data-line-number="1">se_h_hat &lt;-</a>
<a class="sourceLine" id="cb794-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">year    =</span> fit10<span class="fl">.1</span><span class="op">$</span>time,</a>
<a class="sourceLine" id="cb794-3" data-line-number="3">         <span class="dt">n_j     =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.risk,</a>
<a class="sourceLine" id="cb794-4" data-line-number="4">         <span class="dt">n_event =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.event) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb794-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">h_hat =</span> n_event <span class="op">/</span><span class="st"> </span>n_j) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb794-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se_h_hat =</span> <span class="kw">sqrt</span>((h_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h_hat)) <span class="op">/</span><span class="st"> </span>n_j))</a>
<a class="sourceLine" id="cb794-7" data-line-number="7"></a>
<a class="sourceLine" id="cb794-8" data-line-number="8">se_h_hat</a></code></pre></div>
<pre><code>## # A tibble: 12 x 5
##     year   n_j n_event  h_hat se_h_hat
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1     1  3941     456 0.116   0.00510
##  2     2  3485     384 0.110   0.00530
##  3     3  3101     359 0.116   0.00575
##  4     4  2742     295 0.108   0.00592
##  5     5  2447     218 0.0891  0.00576
##  6     6  2229     184 0.0825  0.00583
##  7     7  2045     123 0.0601  0.00526
##  8     8  1642      79 0.0481  0.00528
##  9     9  1256      53 0.0422  0.00567
## 10    10   948      35 0.0369  0.00612
## 11    11   648      16 0.0247  0.00610
## 12    12   391       5 0.0128  0.00568</code></pre>
<p>As in the text, our standard errors are pretty small. To get a better sense, here they are in a rug plot.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb796-1" data-line-number="1">se_h_hat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb796-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> se_h_hat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb796-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_rug</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.25</span>, <span class="st">&quot;in&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb796-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(se)(<span class="kw">hat</span>(<span class="kw">italic</span>(h))(<span class="kw">italic</span>(t[j])))), <span class="dt">limits =</span> <span class="kw">c</span>(.<span class="dv">004</span>, <span class="fl">.007</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb796-5" data-line-number="5"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>),</a>
<a class="sourceLine" id="cb796-6" data-line-number="6">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-31-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Standard errors for discrete hazards probabilities share a property with those for other probabilities: they are less certain (i.e., larger) for probability values near .5 and increasingly certain (i.e., smaller) for probability values approaching 0 and 1. To give a sense of that, here are the corresonding <span class="math inline">\(se \big (\hat h(t_j) \big)\)</span> for a series of <span class="math inline">\(\hat h(t_j)\)</span> values ranging from 0 to 1, with <span class="math inline">\(n_j\)</span> held constant at 1,000.</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb797-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">n_j   =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb797-2" data-line-number="2">       <span class="dt">h_hat =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb797-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se_h_hat =</span> <span class="kw">sqrt</span>((h_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h_hat)) <span class="op">/</span><span class="st"> </span>n_j)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb797-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb797-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> h_hat, <span class="dt">y =</span> se_h_hat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb797-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb797-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(<span class="kw">italic</span>(h))(<span class="kw">italic</span>(t[j]))),</a>
<a class="sourceLine" id="cb797-8" data-line-number="8">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">italic</span>(se)(<span class="kw">hat</span>(<span class="kw">italic</span>(h))(<span class="kw">italic</span>(t[j]))))) <span class="op">+</span></a>
<a class="sourceLine" id="cb797-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>),</a>
<a class="sourceLine" id="cb797-10" data-line-number="10">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-32-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Also, as the size of the risk set, <span class="math inline">\(n_j\)</span>, influences the standard errors in the typical way. All things equal, a larger <span class="math inline">\(n\)</span> will make for a smaller <span class="math inline">\(se\)</span>. To give a sense, here’s the same basic plot from above, but this time with <span class="math inline">\(n_j = 100, 1,000, \text{ and } 10,000\)</span>.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb798-1" data-line-number="1"><span class="kw">crossing</span>(<span class="dt">n_j   =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>),</a>
<a class="sourceLine" id="cb798-2" data-line-number="2">         <span class="dt">h_hat =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb798-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se_h_hat =</span> <span class="kw">sqrt</span>((h_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h_hat)) <span class="op">/</span><span class="st"> </span>n_j),</a>
<a class="sourceLine" id="cb798-4" data-line-number="4">         <span class="dt">n_j      =</span> <span class="kw">str_c</span>(<span class="st">&quot;italic(n[j])==&quot;</span>, n_j)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb798-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb798-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> h_hat, <span class="dt">y =</span> se_h_hat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb798-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb798-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(<span class="kw">italic</span>(h))(<span class="kw">italic</span>(t[j]))),</a>
<a class="sourceLine" id="cb798-9" data-line-number="9">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">italic</span>(se)(<span class="kw">hat</span>(<span class="kw">italic</span>(h))(<span class="kw">italic</span>(t[j]))))) <span class="op">+</span></a>
<a class="sourceLine" id="cb798-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>),</a>
<a class="sourceLine" id="cb798-11" data-line-number="11">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb798-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>n_j, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-33-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="standard-error-of-the-estimated-survival-probabilities." class="section level3">
<h3><span class="header-section-number">10.4.2</span> Standard error of the estimated survival probabilities.</h3>
<p>Computing the frequentist standard errors for estimated survival probabilities is more difficult because these are the products of (1 - hazard) for the current and all previous survival probabilities. Computing them is such a pain, Singer and Willett recommend you rely on Greenwood’s (<a href="https://www.cabdirect.org/cabdirect/abstract/19272700028">1926</a>) approximation. This follows the form</p>
<p><span class="math display">\[se \big (\hat S(t_j) \big) = \hat S(t_j)  \sqrt{\frac{\hat h(t_1)}{n_1 \big (1 - \hat h(t_1) \big)} + \frac{\hat h(t_2)}{n_2 \big (1 - \hat h(t_2) \big)} + \cdots + \frac{\hat h(t_j)}{n_j \big (1 - \hat h(t_j) \big)}}.\]</span></p>
<p>Here we put the formula to work and finish our version of Table 10.2. For the sake of sanity, we’re simply calling our “Term under the square root sign” column <code>term</code>. Note our use of the <code>cumsum()</code> function.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb799-1" data-line-number="1"><span class="co"># suspend scientific notation</span></a>
<a class="sourceLine" id="cb799-2" data-line-number="2"><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb799-3" data-line-number="3"></a>
<a class="sourceLine" id="cb799-4" data-line-number="4"><span class="kw">tibble</span>(<span class="dt">year    =</span> fit10<span class="fl">.1</span><span class="op">$</span>time,</a>
<a class="sourceLine" id="cb799-5" data-line-number="5">       <span class="dt">n_j     =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.risk,</a>
<a class="sourceLine" id="cb799-6" data-line-number="6">       <span class="dt">n_event =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.event) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb799-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">h_hat =</span> n_event <span class="op">/</span><span class="st"> </span>n_j) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb799-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se_h_hat =</span> <span class="kw">sqrt</span>((h_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h_hat)) <span class="op">/</span><span class="st"> </span>n_j),</a>
<a class="sourceLine" id="cb799-9" data-line-number="9">         <span class="dt">s_hat    =</span> fit10<span class="fl">.1</span><span class="op">$</span>surv,</a>
<a class="sourceLine" id="cb799-10" data-line-number="10">         <span class="dt">term     =</span> <span class="kw">cumsum</span>(h_hat <span class="op">/</span><span class="st"> </span>(n_j <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h_hat)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb799-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se_s_hat =</span> s_hat <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(term),</a>
<a class="sourceLine" id="cb799-12" data-line-number="12">         <span class="dt">std.err  =</span> fit10<span class="fl">.1</span><span class="op">$</span>std.err)</a></code></pre></div>
<pre><code>## # A tibble: 12 x 9
##     year   n_j n_event  h_hat se_h_hat s_hat      term se_s_hat std.err
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
##  1     1  3941     456 0.116   0.00510 0.884 0.0000332  0.00510 0.00576
##  2     2  3485     384 0.110   0.00530 0.787 0.0000687  0.00652 0.00829
##  3     3  3101     359 0.116   0.00575 0.696 0.000111   0.00733 0.0105 
##  4     4  2742     295 0.108   0.00592 0.621 0.000155   0.00773 0.0124 
##  5     5  2447     218 0.0891  0.00576 0.566 0.000195   0.00790 0.0140 
##  6     6  2229     184 0.0825  0.00583 0.519 0.000235   0.00796 0.0153 
##  7     7  2045     123 0.0601  0.00526 0.488 0.000267   0.00796 0.0163 
##  8     8  1642      79 0.0481  0.00528 0.464 0.000297   0.00800 0.0172 
##  9     9  1256      53 0.0422  0.00567 0.445 0.000332   0.00811 0.0182 
## 10    10   948      35 0.0369  0.00612 0.428 0.000373   0.00827 0.0193 
## 11    11   648      16 0.0247  0.00610 0.418 0.000412   0.00848 0.0203 
## 12    12   391       5 0.0128  0.00568 0.412 0.000445   0.00870 0.0211</code></pre>
<p>For comparisson, we also added the <span class="math inline">\(se \big (\hat S(t_j) \big)\)</span> values coputed by the <strong>survivor</strong> package in the final column, <code>std.err</code>.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb801-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">year    =</span> fit10<span class="fl">.1</span><span class="op">$</span>time,</a>
<a class="sourceLine" id="cb801-2" data-line-number="2">       <span class="dt">n_j     =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.risk,</a>
<a class="sourceLine" id="cb801-3" data-line-number="3">       <span class="dt">n_event =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.event) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb801-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">h_hat =</span> n_event <span class="op">/</span><span class="st"> </span>n_j) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb801-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se_h_hat =</span> <span class="kw">sqrt</span>((h_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h_hat)) <span class="op">/</span><span class="st"> </span>n_j),</a>
<a class="sourceLine" id="cb801-6" data-line-number="6">         <span class="dt">s_hat    =</span> fit10<span class="fl">.1</span><span class="op">$</span>surv,</a>
<a class="sourceLine" id="cb801-7" data-line-number="7">         <span class="dt">term     =</span> <span class="kw">cumsum</span>(h_hat <span class="op">/</span><span class="st"> </span>(n_j <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>h_hat)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb801-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Greenwood =</span> s_hat <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(term),</a>
<a class="sourceLine" id="cb801-9" data-line-number="9">         <span class="st">`</span><span class="dt">survival package</span><span class="st">`</span>  =<span class="st"> </span>fit10<span class="fl">.1</span><span class="op">$</span>std.err) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb801-10" data-line-number="10"><span class="st">  </span><span class="kw">pivot_longer</span>(Greenwood<span class="op">:</span><span class="st">`</span><span class="dt">survival package</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb801-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb801-12" data-line-number="12">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;survival package&quot;</span>, <span class="st">&quot;Greenwood&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb801-13" data-line-number="13"><span class="st">  </span></a>
<a class="sourceLine" id="cb801-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> value, <span class="dt">color =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb801-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb801-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="ot">NULL</span>, <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">end =</span> <span class="fl">.55</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb801-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb801-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(se)), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.025</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb801-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</a>
<a class="sourceLine" id="cb801-20" data-line-number="20">        <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>),</a>
<a class="sourceLine" id="cb801-21" data-line-number="21">        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">125</span>, <span class="fl">.9</span>),</a>
<a class="sourceLine" id="cb801-22" data-line-number="22">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-35-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>It’s out of my expertise to comment on which should we should trust more. But Singer and Willett did note that “as an approximation, Greenwood’s formula is accurate only asymptotically” (p. 351).</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb802-1" data-line-number="1"><span class="co"># turn scientific notation back on (R default)</span></a>
<a class="sourceLine" id="cb802-2" data-line-number="2"><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">0</span>)</a></code></pre></div>
</div>
</div>
<div id="a-simple-and-useful-strategy-for-constructing-the-life-table" class="section level2">
<h2><span class="header-section-number">10.5</span> A simple and useful strategy for constructing the life table</h2>
<blockquote>
<p>How can you construct a life table for <em>your</em> data set? For preliminary analyses, it is easy to use the prepackaged routines available in the major statistical packages. If you choose this approach, be sure to check whether your package allows you to: (1) select the partition of time; and (2) ignore any actuarial corrections invoked due to continuous-time assumptions (that do not hold in discrete time). When event times have been measured using a discrete-time scale, actuarial corrections (discussed in chapter13) are inappropriate. Although most packages clearly document the algorithm being used, we suggest that you double-check by comparing results with one or two estimates computed by hand. (p. 351, <em>emphasis</em> in the original)</p>
</blockquote>
<p>For more information about the methods we’ve been using via the <strong>survival</strong> package, browse through the documentation listed on the CRAN page, <a href="https://CRAN.R-project.org/package=survival">https://CRAN.R-project.org/package=survival</a>, with a paticular emphasis on the <a href="https://CRAN.R-project.org/package=survival/survival.pdf">reference manual</a> and <a href="https://CRAN.R-project.org/package=survival/vignettes/survival.pdf"><em>A package for survival analysis in R</em></a>. But back to the text:</p>
<blockquote>
<p>Despite the simplicity of preprogrammed algorithms, [Singer and Willett] prefer an alternative approach for life table construction. This approach requires construction of a person-period data set, much like the period-period data set used for growth modeling. Once you create the person-period data set, you can compute descriptive statistics sing any standard cross-tabulation routine. (p. 351)</p>
</blockquote>
<div id="the-person-period-data-set.-1" class="section level3">
<h3><span class="header-section-number">10.5.1</span> The person-period data set.</h3>
<p>Here is the person-level data set displayed in Figure 10.4; it’s just a subset of the <code>teachers</code> data.</p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb803-1" data-line-number="1">teachers <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb803-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">126</span>, <span class="dv">129</span>))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##      id     t censor
##   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1    20     3      0
## 2   126    12      0
## 3   129    12      1</code></pre>
<p>You can transform the person-level survival data set into the person-period variant shown on the right panel of Figure 10.4 with a workflow like this.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb805-1" data-line-number="1">teachers_pp &lt;-</a>
<a class="sourceLine" id="cb805-2" data-line-number="2"><span class="st">  </span>teachers <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb805-3" data-line-number="3"><span class="st">  </span><span class="kw">uncount</span>(<span class="dt">weights =</span> t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb805-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb805-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">period =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb805-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">event =</span> <span class="kw">if_else</span>(period <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(period) <span class="op">&amp;</span><span class="st"> </span>censor <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb805-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>censor) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb805-8" data-line-number="8"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb805-9" data-line-number="9"></a>
<a class="sourceLine" id="cb805-10" data-line-number="10">teachers_pp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb805-11" data-line-number="11"><span class="st">  </span><span class="kw">filter</span>(id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">126</span>, <span class="dv">129</span>))</a></code></pre></div>
<pre><code>## # A tibble: 27 x 3
##       id period event
##    &lt;dbl&gt;  &lt;int&gt; &lt;dbl&gt;
##  1    20      1     0
##  2    20      2     0
##  3    20      3     1
##  4   126      1     0
##  5   126      2     0
##  6   126      3     0
##  7   126      4     0
##  8   126      5     0
##  9   126      6     0
## 10   126      7     0
## # … with 17 more rows</code></pre>
<p>You don’t necessarily need to use <code>ungroup()</code> at the end, but it’s probably a good idea. Anyway, note how the information previously contained in the <code>censor</code> column has been transformed to the <code>event</code> column, which is coded 0 = no event, 1 = event. With this coding, we know a participant has been censored when <code>event == 0</code> on their <code>max(period)</code> row.</p>
<p>We can count the number of teachers in the sample like this.</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb807-1" data-line-number="1">teachers <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb807-2" data-line-number="2"><span class="st">  </span><span class="kw">distinct</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb807-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1  3941</code></pre>
<p>To get a sense of the difference in the data structures, here are the number of rows for the original person-level <code>teachers</code> data and for our person-period transformation.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb809-1" data-line-number="1"><span class="co"># person-level</span></a>
<a class="sourceLine" id="cb809-2" data-line-number="2">teachers <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb809-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1  3941</code></pre>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb811-1" data-line-number="1"><span class="co"># person-period</span></a>
<a class="sourceLine" id="cb811-2" data-line-number="2">teachers_pp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb811-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>()</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1 24875</code></pre>
<p>Here is the breakdown of the number of rows in the person-period <code>teachers</code> data for which <code>event == 1</code> or <code>event == 0</code>.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb813-1" data-line-number="1">teachers_pp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb813-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(event)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   event     n
##   &lt;dbl&gt; &lt;int&gt;
## 1     0 22668
## 2     1  2207</code></pre>
</div>
<div id="using-the-person-period-data-set-to-construct-the-life-table." class="section level3">
<h3><span class="header-section-number">10.5.2</span> Using the person-period data set to construct the life table.</h3>
<p>“All the life table’s essential elements can be computed through cross-tabulation of <em>PERIOD</em> and <em>EVENT</em> in the person-period data set” (p. 354, <em>emphasis</em> in the original). Here’s how we might use the <strong>tidyverse</strong> do that with <code>teachers_pp</code>.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb815-1" data-line-number="1">teachers_lt &lt;-</a>
<a class="sourceLine" id="cb815-2" data-line-number="2"><span class="st">  </span>teachers_pp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb815-3" data-line-number="3"><span class="st">  </span><span class="co"># change the coding for `event` in anticipation of the final format</span></a>
<a class="sourceLine" id="cb815-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">event =</span> <span class="kw">str_c</span>(<span class="st">&quot;event = &quot;</span>, event)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb815-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(period) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb815-6" data-line-number="6"><span class="st">  </span><span class="kw">count</span>(event) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb815-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb815-8" data-line-number="8"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> event,</a>
<a class="sourceLine" id="cb815-9" data-line-number="9">              <span class="dt">values_from =</span> n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb815-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="st">`</span><span class="dt">event = 0</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">event = 1</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb815-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_e_1 =</span> (<span class="st">`</span><span class="dt">event = 1</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span>total) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb815-12" data-line-number="12"></a>
<a class="sourceLine" id="cb815-13" data-line-number="13">teachers_lt</a></code></pre></div>
<pre><code>## # A tibble: 12 x 5
##    period `event = 0` `event = 1` total prop_e_1
##     &lt;int&gt;       &lt;int&gt;       &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
##  1      1        3485         456  3941   0.116 
##  2      2        3101         384  3485   0.110 
##  3      3        2742         359  3101   0.116 
##  4      4        2447         295  2742   0.108 
##  5      5        2229         218  2447   0.0891
##  6      6        2045         184  2229   0.0825
##  7      7        1922         123  2045   0.0601
##  8      8        1563          79  1642   0.0481
##  9      9        1203          53  1256   0.0422
## 10     10         913          35   948   0.0369
## 11     11         632          16   648   0.0247
## 12     12         386           5   391   0.0128</code></pre>
<p>Here are the totals Singer and Willett displayed in the bottom row.</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb817-1" data-line-number="1">teachers_lt  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb817-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">event = 0</span><span class="st">`</span><span class="op">:</span>total) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb817-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb817-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">total =</span> <span class="kw">sum</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb817-5" data-line-number="5"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> name,</a>
<a class="sourceLine" id="cb817-6" data-line-number="6">              <span class="dt">values_from =</span> total)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   `event = 0` `event = 1` total
##         &lt;int&gt;       &lt;int&gt; &lt;int&gt;
## 1       22668        2207 24875</code></pre>
<blockquote>
<p>The ability to construct a life table using the person-period data set provides a simple strategy for conducting the descriptive analyses outlined in this chapter. This strategy yields appropriate statistics regardless of the amount, or pattern, of censoring. Perhaps even more important, the person-period data set is the fundamental tool for fitting discrete-time hazard models to data, using methods that we describe in the next chapter. (p. 356)</p>
</blockquote>
</div>
</div>
<div id="bonus-fit-the-discrete-time-hazard-models-with-brms" class="section level2">
<h2><span class="header-section-number">10.6</span> Bonus: Fit the discrete-time hazard models with brms</h2>
<p>The frequentists aren’t the only ones who can discrete-time hazard models. Bayesians can get in on the fun, too. The first step is to decide on an appropriate likelihood function. Why? Because Bayes’ formula requires that we define the likelihood and the priors. As all the parameters in the model are seen through the lens of the likelihood, it’s important we consider it with care.</p>
<p>Happily, the exercises in the last section did a great job preparing us for the task. In Table 10.3, Singer and Willett hand computed the discrete hazards (i.e., the values in the “Proportion <em>EVENT</em> = 1” column) by dividing the valued in the “<em>EVENT</em> = 1” column by those in the “Total” column. Discrete hazards are proportions. Proportions have two important characteristics; they are continuous and necessarily range between 0 and 1. You know what else has those characteristics? Probabilities.</p>
<p>So far in this text, we have primarily focused on models using the Gaussian likelihood. Though it’s a workhorse, the Gaussian is inappropriate for modeling proportions/probabilities. Good old Gauss is great at modeling unbounded continuous data, but it can fail miserably when working with bounded data and our proportions/probabilities are most certainly bounded. The binomial likelihood, however, is well-suited for handling probabilities. Imagine you have data that can take on values of 0 and 1, such as failures/successes, no’s/yesses, fails/passes, and no-events/events. If you sum up all the 1’s and divide them by the total cases, you get a proportion/probability. The simple binomial model takes just that kind of data—the number of 1’s and the number of total cases. The formula for the binomial likelihood is</p>
<p><span class="math display">\[\operatorname{Pr} (z | n, p) = \frac{n!}{z!(n - z)!} p^z (1 - p)^{n - z},\]</span></p>
<p>where <span class="math inline">\(z\)</span> is the number of cases for which the value is 1, <span class="math inline">\(n\)</span> is the total number of cases, and <span class="math inline">\(p\)</span> is the probability of a 1 across cases. As the data provide us with <span class="math inline">\(z\)</span> and <span class="math inline">\(n\)</span>, we end up estimating <span class="math inline">\(p\)</span>. If we’re willing to use what’s called a <em>link function</em>, we can estimate <span class="math inline">\(p\)</span> with a linear model with any number of predictors. When fitting binomial regression models, you can take your choice among several link functions, the most popular of which is the logit. This will be our approach. As you may have guesses, using the logit link to fit a binomial model is often termed <em>logistic regression</em>. Welcome to the generalized linear model.</p>
<p>Let’s fire up <strong>brms</strong>.</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb819-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>Before we fit the model, it will make our lives easier if we redefine <code>period</code> as a factor and rename our <code>event = 1</code> column as <code>event</code>. We defined <code>period</code> as a factor because we want to fit a model with discrete time. Renaming <code>event = 1</code> column as <code>event</code> just makes it easier on the <code>brm()</code> function to read the variable.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb820-1" data-line-number="1">teachers_lt &lt;-</a>
<a class="sourceLine" id="cb820-2" data-line-number="2"><span class="st">  </span>teachers_lt <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb820-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">period =</span> <span class="kw">factor</span>(period),</a>
<a class="sourceLine" id="cb820-4" data-line-number="4">         <span class="dt">event  =</span> <span class="st">`</span><span class="dt">event = 1</span><span class="st">`</span>)</a></code></pre></div>
<p>With this formulation, <code>event</code> is our <span class="math inline">\(z\)</span> term and <code>total</code> is our <span class="math inline">\(n\)</span> term. We’re estimating <span class="math inline">\(p\)</span>. Behold the mode syntax.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb821-1" data-line-number="1">fit10<span class="fl">.6</span> &lt;-</a>
<a class="sourceLine" id="cb821-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> teachers_lt,</a>
<a class="sourceLine" id="cb821-3" data-line-number="3">      <span class="dt">family =</span> binomial,</a>
<a class="sourceLine" id="cb821-4" data-line-number="4">      event <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(total) <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>period,</a>
<a class="sourceLine" id="cb821-5" data-line-number="5">      <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb821-6" data-line-number="6">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">1</span>, <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb821-7" data-line-number="7">      <span class="dt">seed =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb821-8" data-line-number="8">      <span class="dt">file =</span> <span class="st">&quot;fits/fit10.06&quot;</span>)</a></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb822-1" data-line-number="1"><span class="kw">print</span>(fit10<span class="fl">.6</span>)</a></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(total) ~ 0 + period 
##    Data: teachers_lt (Number of observations: 12) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## period1     -2.04      0.05    -2.13    -1.94 1.00     9137     2606
## period2     -2.09      0.05    -2.20    -1.98 1.00     8729     2940
## period3     -2.03      0.06    -2.15    -1.92 1.00     7900     2844
## period4     -2.12      0.06    -2.24    -2.00 1.00     8786     3296
## period5     -2.33      0.07    -2.47    -2.19 1.00    10265     3263
## period6     -2.41      0.07    -2.55    -2.26 1.00     8986     2771
## period7     -2.75      0.09    -2.94    -2.57 1.00     8836     2904
## period8     -2.99      0.11    -3.22    -2.77 1.00     7321     3070
## period9     -3.13      0.14    -3.41    -2.86 1.00     8581     2945
## period10    -3.27      0.18    -3.64    -2.94 1.00     9343     3194
## period11    -3.68      0.26    -4.20    -3.23 1.00     8858     2801
## period12    -4.38      0.44    -5.34    -3.61 1.00     7155     2713
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Because we used the <code>0 + Intercept</code> syntax in the presence of a factor predictor, <code>period</code>, we suppressed the default intercept. Instead, we have separate “intercepts” for each of the 12 levels <code>period</code>. Because we used the conventional logit link, the parameters are all on the log-odds scale. Happily, we can use the <code>brms::inv_logit_scaled()</code> function to convert them back into the probability metric. Here’s a quick and dirty conversion using the output from <code>fixef()</code>.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb824-1" data-line-number="1"><span class="kw">fixef</span>(fit10<span class="fl">.6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inv_logit_scaled</span>()</a></code></pre></div>
<pre><code>##            Estimate Est.Error        Q2.5      Q97.5
## period1  0.11556681 0.5127071 0.105893972 0.12577169
## period2  0.11016816 0.5137191 0.099802929 0.12091456
## period3  0.11565147 0.5141849 0.104605310 0.12776431
## period4  0.10751864 0.5149124 0.096579461 0.11886693
## period5  0.08900044 0.5175769 0.078091779 0.10030044
## period6  0.08249433 0.5185773 0.072114919 0.09410460
## period7  0.06007781 0.5235268 0.050259573 0.07110459
## period8  0.04789439 0.5286891 0.038575357 0.05903044
## period9  0.04201526 0.5356367 0.031835698 0.05406505
## period10 0.03650190 0.5439742 0.025697642 0.05032226
## period11 0.02448447 0.5638504 0.014804677 0.03823187
## period12 0.01232412 0.6089401 0.004763989 0.02642533</code></pre>
<p>Compare these <code>Estimate</code> values with the values in the “Estimated hazard probability” column from Table 10.2 in the text (p. 349). They are very close. We can go further and look at these hazard estimates in a plot. We’ll use the <code>tidybayes::stat_lineribbon()</code> function to plot their posterior means atop their 50% and 95% intervals.</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb826-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb826-2" data-line-number="2"></a>
<a class="sourceLine" id="cb826-3" data-line-number="3"><span class="kw">posterior_samples</span>(fit10<span class="fl">.6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb826-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;b_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb826-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb826-6" data-line-number="6"><span class="st">  </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb826-7" data-line-number="7"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb826-8" data-line-number="8">               <span class="dt">names_to =</span> <span class="st">&quot;period&quot;</span>,</a>
<a class="sourceLine" id="cb826-9" data-line-number="9">               <span class="dt">values_to =</span> <span class="st">&quot;hazard&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb826-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">period =</span> period <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.double</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb826-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb826-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> hazard)) <span class="op">+</span></a>
<a class="sourceLine" id="cb826-13" data-line-number="13"><span class="st">  </span><span class="kw">stat_lineribbon</span>(<span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>), <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb826-14" data-line-number="14"><span class="st">  </span><span class="co"># add the hazard estimates from `survival::survfit()`</span></a>
<a class="sourceLine" id="cb826-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">period =</span> fit10<span class="fl">.1</span><span class="op">$</span>time,</a>
<a class="sourceLine" id="cb826-16" data-line-number="16">                           <span class="dt">hazard =</span> fit10<span class="fl">.1</span><span class="op">$</span>n.event <span class="op">/</span><span class="st"> </span>fit10<span class="fl">.1</span><span class="op">$</span>n.risk),</a>
<a class="sourceLine" id="cb826-17" data-line-number="17">             <span class="kw">aes</span>(<span class="dt">y =</span> hazard),</a>
<a class="sourceLine" id="cb826-18" data-line-number="18">             <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;violetred1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb826-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;CI&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;grey75&quot;</span>, <span class="st">&quot;grey60&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb826-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb826-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</a>
<a class="sourceLine" id="cb826-22" data-line-number="22">        <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>),</a>
<a class="sourceLine" id="cb826-23" data-line-number="23">        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">925</span>, <span class="fl">.825</span>),</a>
<a class="sourceLine" id="cb826-24" data-line-number="24">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-48-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>For comparison sake, those violet dots in the foreground are the hazard estimates from the frequentist <code>survival::survfit()</code> function. Turns out our Bayesian results are very similar to the frequentist ones. Hopefully this isn’t a surprise. There was a lot of data and we used fairly weak priors. For simple models under those conditions, frequentist and Bayesian results should be pretty close.</p>
<p>Remember that <span class="math inline">\(se \big (\hat h(t_j) \big)\)</span> formula from back in section 10.4.1? That doesn’t quite apply to the posterior standard deviations from our Bayesian model. Even so, our posterior <span class="math inline">\(SD\)</span>s will be very similar to the ML standard errors. Let’s compare those in a plot, too.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb827-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit10<span class="fl">.6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;b_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-4" data-line-number="4"><span class="st">  </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-5" data-line-number="5"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb827-6" data-line-number="6">               <span class="dt">names_to =</span> <span class="st">&quot;period&quot;</span>,</a>
<a class="sourceLine" id="cb827-7" data-line-number="7">               <span class="dt">values_to =</span> <span class="st">&quot;hazard&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">period =</span> period <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.double</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(period) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-10" data-line-number="10"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sd =</span> <span class="kw">sd</span>(hazard)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-11" data-line-number="11"><span class="st">  </span><span class="kw">bind_cols</span>(se_h_hat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(se_h_hat)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-12" data-line-number="12"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>period) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb827-14" data-line-number="14">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;sd&quot;</span>, <span class="st">&quot;se_h_hat&quot;</span>),</a>
<a class="sourceLine" id="cb827-15" data-line-number="15">                       <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Bayesian&quot;</span>, <span class="st">&quot;ML&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb827-16" data-line-number="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb827-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> value, <span class="dt">color =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb827-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb827-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="ot">NULL</span>, <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">end =</span> <span class="fl">.55</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb827-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb827-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(se)), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb827-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</a>
<a class="sourceLine" id="cb827-23" data-line-number="23">        <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>),</a>
<a class="sourceLine" id="cb827-24" data-line-number="24">        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">09</span>, <span class="fl">.9</span>),</a>
<a class="sourceLine" id="cb827-25" data-line-number="25">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-49-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Man those are close.</p>
<p>We can also use our <strong>brms</strong> output to depict the survivor function. On page 337 in the text (Equation 10.5), Singer and Willett demonstrated how to define the survivor function in terms of the hazard function. It follows the form</p>
<p><span class="math display">\[\hat S (t_j) = [1 - \hat h (t_j)][1 - \hat h (t_{j - 1})][1 - \hat h (t_{j - 2})]...[1 - \hat h (t_1)].\]</span></p>
<p>In words, “each year’s estimated survival probability is the successive product of the complement of the estimated hazard function probabilities across <em>this</em> and <em>all previous</em> years” (p. 337, <em>emphasis</em> in the original). Here’s how you might do that with the output from <code>posterior_samples()</code>.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb828-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb828-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit10<span class="fl">.6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb828-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;b_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb828-4" data-line-number="4"><span class="st">  </span><span class="co"># transform the hazards from the log-odds metric to probabilities</span></a>
<a class="sourceLine" id="cb828-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb828-6" data-line-number="6"><span class="st">  </span><span class="kw">set_names</span>(<span class="kw">str_c</span>(<span class="st">&quot;h&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb828-7" data-line-number="7"><span class="st">  </span><span class="co"># take the &quot;complement&quot; of each hazard</span></a>
<a class="sourceLine" id="cb828-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="op">~</span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb828-9" data-line-number="9"><span class="st">  </span><span class="co"># apply Equation 10.5</span></a>
<a class="sourceLine" id="cb828-10" data-line-number="10"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">s0  =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb828-11" data-line-number="11">            <span class="dt">s1  =</span> h1, </a>
<a class="sourceLine" id="cb828-12" data-line-number="12">            <span class="dt">s2  =</span> h1 <span class="op">*</span><span class="st"> </span>h2, </a>
<a class="sourceLine" id="cb828-13" data-line-number="13">            <span class="dt">s3  =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3, </a>
<a class="sourceLine" id="cb828-14" data-line-number="14">            <span class="dt">s4  =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4, </a>
<a class="sourceLine" id="cb828-15" data-line-number="15">            <span class="dt">s5  =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5, </a>
<a class="sourceLine" id="cb828-16" data-line-number="16">            <span class="dt">s6  =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5 <span class="op">*</span><span class="st"> </span>h6, </a>
<a class="sourceLine" id="cb828-17" data-line-number="17">            <span class="dt">s7  =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5 <span class="op">*</span><span class="st"> </span>h6 <span class="op">*</span><span class="st"> </span>h7, </a>
<a class="sourceLine" id="cb828-18" data-line-number="18">            <span class="dt">s8  =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5 <span class="op">*</span><span class="st"> </span>h6 <span class="op">*</span><span class="st"> </span>h7 <span class="op">*</span><span class="st"> </span>h8, </a>
<a class="sourceLine" id="cb828-19" data-line-number="19">            <span class="dt">s9  =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5 <span class="op">*</span><span class="st"> </span>h6 <span class="op">*</span><span class="st"> </span>h7 <span class="op">*</span><span class="st"> </span>h8 <span class="op">*</span><span class="st"> </span>h9, </a>
<a class="sourceLine" id="cb828-20" data-line-number="20">            <span class="dt">s10 =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5 <span class="op">*</span><span class="st"> </span>h6 <span class="op">*</span><span class="st"> </span>h7 <span class="op">*</span><span class="st"> </span>h8 <span class="op">*</span><span class="st"> </span>h9 <span class="op">*</span><span class="st"> </span>h10, </a>
<a class="sourceLine" id="cb828-21" data-line-number="21">            <span class="dt">s11 =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5 <span class="op">*</span><span class="st"> </span>h6 <span class="op">*</span><span class="st"> </span>h7 <span class="op">*</span><span class="st"> </span>h8 <span class="op">*</span><span class="st"> </span>h9 <span class="op">*</span><span class="st"> </span>h10 <span class="op">*</span><span class="st"> </span>h11, </a>
<a class="sourceLine" id="cb828-22" data-line-number="22">            <span class="dt">s12 =</span> h1 <span class="op">*</span><span class="st"> </span>h2 <span class="op">*</span><span class="st"> </span>h3 <span class="op">*</span><span class="st"> </span>h4 <span class="op">*</span><span class="st"> </span>h5 <span class="op">*</span><span class="st"> </span>h6 <span class="op">*</span><span class="st"> </span>h7 <span class="op">*</span><span class="st"> </span>h8 <span class="op">*</span><span class="st"> </span>h9 <span class="op">*</span><span class="st"> </span>h10 <span class="op">*</span><span class="st"> </span>h11 <span class="op">*</span><span class="st"> </span>h12)</a>
<a class="sourceLine" id="cb828-23" data-line-number="23"></a>
<a class="sourceLine" id="cb828-24" data-line-number="24"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Rows: 4,000
## Columns: 13
## $ s0  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ s1  &lt;dbl&gt; 0.8759833, 0.8928610, 0.8770696, 0.8916896, 0.8940710, 0.8768920, 0.8790859, 0.888935…
## $ s2  &lt;dbl&gt; 0.7784079, 0.7997735, 0.7751955, 0.7981630, 0.7986837, 0.7753155, 0.7782731, 0.794978…
## $ s3  &lt;dbl&gt; 0.6892693, 0.7111279, 0.6814154, 0.7090891, 0.7105205, 0.6878702, 0.6898066, 0.702378…
## $ s4  &lt;dbl&gt; 0.6192489, 0.6372226, 0.6052336, 0.6377087, 0.6423957, 0.6073570, 0.6227674, 0.615946…
## $ s5  &lt;dbl&gt; 0.5624273, 0.5825095, 0.5481830, 0.5836618, 0.5857847, 0.5510695, 0.5659978, 0.562662…
## $ s6  &lt;dbl&gt; 0.5159581, 0.5327154, 0.5010668, 0.5375498, 0.5363627, 0.5098096, 0.5224954, 0.512750…
## $ s7  &lt;dbl&gt; 0.4844501, 0.5033074, 0.4703992, 0.5058764, 0.5010981, 0.4804348, 0.4910555, 0.481777…
## $ s8  &lt;dbl&gt; 0.4609974, 0.4809437, 0.4504937, 0.4836799, 0.4799726, 0.4569260, 0.4711993, 0.453072…
## $ s9  &lt;dbl&gt; 0.4444808, 0.4633637, 0.4294656, 0.4651418, 0.4634998, 0.4336775, 0.4475742, 0.437006…
## $ s10 &lt;dbl&gt; 0.4292414, 0.4430966, 0.4179325, 0.4418124, 0.4437674, 0.4195906, 0.4227990, 0.426975…
## $ s11 &lt;dbl&gt; 0.4141679, 0.4317032, 0.4061066, 0.4321481, 0.4326038, 0.4119427, 0.4132678, 0.415482…
## $ s12 &lt;dbl&gt; 0.4113961, 0.4185036, 0.4043163, 0.4190495, 0.4252176, 0.4072654, 0.4037310, 0.412529…</code></pre>
<p>We’ll learn how to simplify that syntax with help from the <code>cumprod()</code> function in the next chapter. Now we have our survival estimates, we can make our Bayesian version of the lower panel of Figure 10.1.</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb830-1" data-line-number="1"><span class="co"># this will help us depict the median lifetime</span></a>
<a class="sourceLine" id="cb830-2" data-line-number="2">line &lt;-</a>
<a class="sourceLine" id="cb830-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">period   =</span> <span class="kw">c</span>(<span class="dv">0</span>, iml, iml),</a>
<a class="sourceLine" id="cb830-4" data-line-number="4">         <span class="dt">survival =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb830-5" data-line-number="5"></a>
<a class="sourceLine" id="cb830-6" data-line-number="6"><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb830-7" data-line-number="7">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb830-8" data-line-number="8"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb830-9" data-line-number="9">               <span class="dt">values_to =</span> <span class="st">&quot;survival&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb830-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">period =</span> <span class="kw">str_remove</span>(name, <span class="st">&quot;s&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.double</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb830-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb830-12" data-line-number="12"><span class="st">  </span><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb830-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> survival)) <span class="op">+</span></a>
<a class="sourceLine" id="cb830-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> line,</a>
<a class="sourceLine" id="cb830-15" data-line-number="15">            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb830-16" data-line-number="16"><span class="st">  </span><span class="kw">stat_lineribbon</span>(<span class="dt">.width =</span> <span class="fl">.95</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb830-17" data-line-number="17"><span class="st">  </span><span class="co"># add the survival estimates from `survival::survfit()`</span></a>
<a class="sourceLine" id="cb830-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">period   =</span> fit10<span class="fl">.1</span><span class="op">$</span>time,</a>
<a class="sourceLine" id="cb830-19" data-line-number="19">                           <span class="dt">survival =</span> fit10<span class="fl">.1</span><span class="op">$</span>surv),</a>
<a class="sourceLine" id="cb830-20" data-line-number="20">             <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;violetred1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb830-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;years in teaching&quot;</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">13</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">13</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb830-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="st">&quot;estimated survival probability, &quot;</span><span class="op">*</span><span class="kw">hat</span>(<span class="kw">italic</span>(S))(<span class="kw">italic</span>(t[j]))),</a>
<a class="sourceLine" id="cb830-23" data-line-number="23">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb830-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="10_files/figure-gfm/unnamed-chunk-51-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Like we did with our hazard plot above, we superimposed the frequentist estimates as violet dots atop the Bayesian posterior means and intervals. Because of how narrow the posteriors were, we only showed the 95% intervals, here. As with the hazard estimates, our Bayesian survival estimates are very close to the ones we computed with ML.</p>
</div>
<div id="reference-9" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://www.oxfordscholarship.com/view/10.1093/acprof:oso/9780195152968.001.0001/acprof-9780195152968">Singer, J. D., &amp; Willett, J. B. (2003). <em>Applied longitudinal data analysis: Modeling change and event occurrence</em>. New York, NY, US: Oxford University Press.</a></p>
</div>
<div id="session-info-9" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb831-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.3
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidybayes_2.0.3 brms_2.12.0     Rcpp_1.0.4.6    patchwork_1.0.0 survival_3.1-12 forcats_0.5.0  
##  [7] stringr_1.4.0   dplyr_0.8.5     purrr_0.3.3     readr_1.3.1     tidyr_1.0.2     tibble_3.0.0   
## [13] ggplot2_3.3.0   tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1     ellipsis_0.3.0       ggridges_0.5.2       rsconnect_0.8.16    
##   [5] markdown_1.1         base64enc_0.1-3      fs_1.4.1             rstudioapi_0.11     
##   [9] farver_2.0.3         rstan_2.19.3         svUnit_0.7-12        DT_0.13             
##  [13] fansi_0.4.1          mvtnorm_1.1-0        lubridate_1.7.8      xml2_1.3.1          
##  [17] bridgesampling_1.0-0 splines_3.6.3        knitr_1.28           shinythemes_1.1.2   
##  [21] bayesplot_1.7.1      jsonlite_1.6.1       broom_0.5.5          dbplyr_1.4.2        
##  [25] shiny_1.4.0.2        compiler_3.6.3       httr_1.4.1           backports_1.1.6     
##  [29] assertthat_0.2.1     Matrix_1.2-18        fastmap_1.0.1        cli_2.0.2           
##  [33] later_1.0.0          prettyunits_1.1.1    htmltools_0.4.0      tools_3.6.3         
##  [37] igraph_1.2.5         coda_0.19-3          gtable_0.3.0         glue_1.4.0          
##  [41] reshape2_1.4.4       cellranger_1.1.0     vctrs_0.2.4          nlme_3.1-144        
##  [45] crosstalk_1.1.0.1    xfun_0.13            ps_1.3.2             rvest_0.3.5         
##  [49] mime_0.9             miniUI_0.1.1.1       lifecycle_0.2.0      gtools_3.8.2        
##  [53] zoo_1.8-7            scales_1.1.0         colourpicker_1.0     hms_0.5.3           
##  [57] promises_1.1.0       Brobdingnag_1.2-6    parallel_3.6.3       inline_0.3.15       
##  [61] shinystan_2.5.0      yaml_2.2.1           gridExtra_2.3        StanHeaders_2.21.0-1
##  [65] loo_2.2.0            stringi_1.4.6        dygraphs_1.1.1.6     pkgbuild_1.0.6      
##  [69] rlang_0.4.5          pkgconfig_2.0.3      matrixStats_0.56.0   evaluate_0.14       
##  [73] lattice_0.20-38      rstantools_2.0.0     htmlwidgets_1.5.1    labeling_0.3        
##  [77] tidyselect_1.0.0     processx_3.4.2       plyr_1.8.6           magrittr_1.5        
##  [81] bookdown_0.18        R6_2.4.1             generics_0.0.2       DBI_1.1.0           
##  [85] pillar_1.4.3         haven_2.2.0          withr_2.1.2          xts_0.12-0          
##  [89] abind_1.4-5          modelr_0.1.6         crayon_1.3.4         arrayhelpers_1.1-0  
##  [93] utf8_1.1.4           rmarkdown_2.1        grid_3.6.3           readxl_1.3.1        
##  [97] callr_3.4.3          threejs_0.3.3        reprex_0.3.0         digest_0.6.25       
## [101] xtable_1.8-4         httpuv_1.5.2         stats4_3.6.3         munsell_0.5.0       
## [105] viridisLite_0.3.0    shinyjs_1.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-framework-for-investigating-event-occurrence.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fitting-basic-discrete-time-hazard-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
