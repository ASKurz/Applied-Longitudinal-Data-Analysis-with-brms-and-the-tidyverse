<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Exploring Longitudinal Data on Change – *Applied longitudinal data analysis* in brms and the tidyverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03.html" rel="next">
<link href="./01.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7d082c015fa132ca880f975003d7bf2f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="2&nbsp; Exploring Longitudinal Data on Change – Applied longitudinal data analysis in brms and the tidyverse">
<meta property="og:description" content="">
<meta property="og:image" content="https://solomon.quarto.pub/alda/02_files/figure-html/unnamed-chunk-5-1.png">
<meta property="og:site_name" content="*Applied longitudinal data analysis* in brms and the tidyverse">
<meta property="og:image:height" content="432">
<meta property="og:image:width" content="720">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploring Longitudinal Data on Change</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"><em>Applied longitudinal data analysis</em> in brms and the tidyverse</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What and why</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">A Framework for Investigating Change over Time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploring Longitudinal Data on Change</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducing the Multilevel Model for Change</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Doing Data Analysis with the Multilevel Model for Change</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Treating Time More Flexibly</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modeling Discontinuous and Nonlinear Change</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Examining the Multilevel Model’s Error Covariance Structure</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modeling Change Using Covariance Structure Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">A Framework for Investigating Event Occurrence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Describing Discrete-Time Event Occurrence Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fitting Basic Discrete-Time Hazard Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Extending the Discrete-Time Hazard Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Describing Continuous-Time Event Occurrence Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#creating-a-longitudinal-data-set" id="toc-creating-a-longitudinal-data-set" class="nav-link active" data-scroll-target="#creating-a-longitudinal-data-set"><span class="header-section-number">2.1</span> Creating a longitudinal data set</a>
  <ul>
  <li><a href="#the-person-level-data-set" id="toc-the-person-level-data-set" class="nav-link" data-scroll-target="#the-person-level-data-set"><span class="header-section-number">2.1.1</span> The person-level data set</a></li>
  <li><a href="#the-person-period-data-set" id="toc-the-person-period-data-set" class="nav-link" data-scroll-target="#the-person-period-data-set"><span class="header-section-number">2.1.2</span> The person-period data set</a></li>
  </ul></li>
  <li><a href="#descriptive-analysis-of-individual-change-over-time" id="toc-descriptive-analysis-of-individual-change-over-time" class="nav-link" data-scroll-target="#descriptive-analysis-of-individual-change-over-time"><span class="header-section-number">2.2</span> Descriptive analysis of individual change over time</a>
  <ul>
  <li><a href="#empirical-growth-plots" id="toc-empirical-growth-plots" class="nav-link" data-scroll-target="#empirical-growth-plots"><span class="header-section-number">2.2.1</span> Empirical growth plots</a></li>
  <li><a href="#using-a-trajectory-to-summarize-each-persons-empirical-growth-record" id="toc-using-a-trajectory-to-summarize-each-persons-empirical-growth-record" class="nav-link" data-scroll-target="#using-a-trajectory-to-summarize-each-persons-empirical-growth-record"><span class="header-section-number">2.2.2</span> Using a trajectory to summarize each person’s empirical growth record</a>
  <ul>
  <li><a href="#smoothing-the-empirical-growth-trajectory-nonparametrically" id="toc-smoothing-the-empirical-growth-trajectory-nonparametrically" class="nav-link" data-scroll-target="#smoothing-the-empirical-growth-trajectory-nonparametrically"><span class="header-section-number">2.2.2.1</span> Smoothing the empirical growth trajectory nonparametrically</a></li>
  <li><a href="#smoothing-the-empirical-growth-trajectory-using-ols-single-level-bayesian-regression" id="toc-smoothing-the-empirical-growth-trajectory-using-ols-single-level-bayesian-regression" class="nav-link" data-scroll-target="#smoothing-the-empirical-growth-trajectory-using-ols-single-level-bayesian-regression"><span class="header-section-number">2.2.2.2</span> Smoothing the empirical growth trajectory using <del>OLS</del> single-level Bayesian regression</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exploring-differences-in-change-across-people" id="toc-exploring-differences-in-change-across-people" class="nav-link" data-scroll-target="#exploring-differences-in-change-across-people"><span class="header-section-number">2.3</span> Exploring differences in change across people</a>
  <ul>
  <li><a href="#examining-the-entire-set-of-smooth-trajectories" id="toc-examining-the-entire-set-of-smooth-trajectories" class="nav-link" data-scroll-target="#examining-the-entire-set-of-smooth-trajectories"><span class="header-section-number">2.3.1</span> Examining the entire set of smooth trajectories</a></li>
  <li><a href="#using-the-results-of-model-fitting-to-frame-questions-about-change" id="toc-using-the-results-of-model-fitting-to-frame-questions-about-change" class="nav-link" data-scroll-target="#using-the-results-of-model-fitting-to-frame-questions-about-change"><span class="header-section-number">2.3.2</span> Using the results of model fitting to frame questions about change</a></li>
  <li><a href="#exploring-the-relationship-between-change-and-time-invariant-predictors" id="toc-exploring-the-relationship-between-change-and-time-invariant-predictors" class="nav-link" data-scroll-target="#exploring-the-relationship-between-change-and-time-invariant-predictors"><span class="header-section-number">2.3.3</span> Exploring the relationship between change and time-invariant predictors</a>
  <ul>
  <li><a href="#graphically-examining-groups-of-smoothed-individual-growth-trajectories" id="toc-graphically-examining-groups-of-smoothed-individual-growth-trajectories" class="nav-link" data-scroll-target="#graphically-examining-groups-of-smoothed-individual-growth-trajectories"><span class="header-section-number">2.3.3.1</span> Graphically examining groups of smoothed individual growth trajectories</a></li>
  <li><a href="#the-relationship-between-ols-estimated-single-level-bayesian-trajectories-and-substantive-predictors" id="toc-the-relationship-between-ols-estimated-single-level-bayesian-trajectories-and-substantive-predictors" class="nav-link" data-scroll-target="#the-relationship-between-ols-estimated-single-level-bayesian-trajectories-and-substantive-predictors"><span class="header-section-number">2.3.3.2</span> The relationship between <del>OLS-Estimated</del> single-level Bayesian trajectories and substantive predictors</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design" id="toc-improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design" class="nav-link" data-scroll-target="#improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design"><span class="header-section-number">2.4</span> Improving the precision and reliability of <del>OLS</del> single-level-Bayesian-estimated rates of change: Lessons for research design</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  <li><a href="#comments" id="toc-comments" class="nav-link" data-scroll-target="#comments">Comments</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploring Longitudinal Data on Change</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Wise researchers conduct descriptive exploratory analyses of their data before fitting statistical models. As when working with cross-sectional data, exploratory analyses of longitudinal data con reveal general patterns, provide insight into functional form, and identify individuals whose data do not conform to the general pattern. The exploratory analyses presented in this chapter are based on numerical and graphical strategies already familiar from cross-sectional work. Owing to the nature of longitudinal data, however, they are inevitably more complex in this new setting. <span class="citation" data-cites="singerAppliedLongitudinalData2003">(<a href="references.html#ref-singerAppliedLongitudinalData2003" role="doc-biblioref">Singer &amp; Willett, 2003, p. 16</a>)</span></p>
</blockquote>
<section id="creating-a-longitudinal-data-set" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="creating-a-longitudinal-data-set"><span class="header-section-number">2.1</span> Creating a longitudinal data set</h2>
<blockquote class="blockquote">
<p>In longitudinal work, data-set organization is less straightforward because you can use two very different arrangements:</p>
<blockquote class="blockquote">
<ul>
<li><em>A person-level data set</em>, in which each person has one record and multiple variables contain the data from each measurement occasion</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<ul>
<li><em>A person-period data set</em>, in which each person has multiple records—one for each measurement occasion (p.&nbsp;17, <em>emphasis</em> in the original)</li>
</ul>
</blockquote>
</blockquote>
<p>These are also sometimes referred to as the wide and long data formats, respectively.</p>
<p>As you will see, we will use two primary functions from the <strong>tidyverse</strong> to convert data from one format to another.</p>
<section id="the-person-level-data-set" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="the-person-level-data-set"><span class="header-section-number">2.1.1</span> The person-level data set</h3>
<p>Here we load the person-level data from <a href="https://stats.idre.ucla.edu/r/examples/alda/r-applied-longitudinal-data-analysis-ch-2/">this UCLA web site</a>. These are the NLY data <span class="citation" data-cites="raudenbushGrowthCurveAnalysis2016">(see <a href="references.html#ref-raudenbushGrowthCurveAnalysis2016" role="doc-biblioref">Raudenbush &amp; Chan, 2016</a>)</span> shown in the top of Figure 2.1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>tolerance <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://stats.idre.ucla.edu/wp-content/uploads/2016/02/tolerance1.txt"</span>, <span class="at">col_names =</span> T)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tolerance, <span class="at">n =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 8
      id tol11 tol12 tol13 tol14 tol15  male exposure
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1     9  2.23  1.79  1.9   2.12  2.66     0     1.54
 2    45  1.12  1.45  1.45  1.45  1.99     1     1.16
 3   268  1.45  1.34  1.99  1.79  1.34     1     0.9 
 4   314  1.22  1.22  1.55  1.12  1.12     0     0.81
 5   442  1.45  1.99  1.45  1.67  1.9      0     1.13
 6   514  1.34  1.67  2.23  2.12  2.44     1     0.9 
 7   569  1.79  1.9   1.9   1.99  1.99     0     1.99
 8   624  1.12  1.12  1.22  1.12  1.22     1     0.98
 9   723  1.22  1.34  1.12  1     1.12     0     0.81
10   918  1     1     1.22  1.99  1.22     0     1.21
11   949  1.99  1.55  1.12  1.45  1.55     1     0.93
12   978  1.22  1.34  2.12  3.46  3.32     1     1.59
13  1105  1.34  1.9   1.99  1.9   2.12     1     1.38
14  1542  1.22  1.22  1.99  1.79  2.12     0     1.44
15  1552  1     1.12  2.23  1.55  1.55     0     1.04
16  1653  1.11  1.11  1.34  1.55  2.12     0     1.25</code></pre>
</div>
</div>
<p>With person-level data, each participant has a single row. In these data, participants are indexed by their <code>id</code> number. To see how many participants are in these data, just <code>count()</code> the rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tolerance <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    16</code></pre>
</div>
</div>
<p>The <code>nrow()</code> function will work, too.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tolerance <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
</div>
<p>With the base <strong>R</strong> <code>cor()</code> function, you can get the Pearson’s correlation matrix shown in Table 2.1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tolerance[ , <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      tol11 tol12 tol13 tol14 tol15
tol11  1.00  0.66  0.06  0.14  0.26
tol12  0.66  1.00  0.25  0.21  0.39
tol13  0.06  0.25  1.00  0.59  0.57
tol14  0.14  0.21  0.59  1.00  0.83
tol15  0.26  0.39  0.57  0.83  1.00</code></pre>
</div>
</div>
<p>We used the <code>round()</code> function to limit the number of decimal places in the output. Leave it off and you’ll see <code>cor()</code> returns up to seven decimal places instead. It can be hard to see the patters within a matrix of numerals. It might be easier in a plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tolerance[ , <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"row"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>row,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"column"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"correlation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">factor</span>(row) <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> column, <span class="at">y =</span> row)) <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> correlation)) <span class="sc">+</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(correlation, <span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red4"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">position =</span> <span class="st">"top"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="360"></p>
</figure>
</div>
</div>
</div>
<p>If all you wanted was the lower diagonal, you could use the <code>lowerCor()</code> function from the <a href="https://CRAN.R-project.org/package=psych"><strong>psych</strong> package</a> <span class="citation" data-cites="R-psych">(<a href="references.html#ref-R-psych" role="doc-biblioref">Revelle, 2022</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">lowerCor</span>(tolerance[ , <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      tol11 tol12 tol13 tol14 tol15
tol11 1.00                         
tol12 0.66  1.00                   
tol13 0.06  0.25  1.00             
tol14 0.14  0.21  0.59  1.00       
tol15 0.26  0.39  0.57  0.83  1.00 </code></pre>
</div>
</div>
<p>For more ways to compute, organize, and visualize correlations within the <strong>tidyverse</strong> paradigm, check out the <a href="https://tidymodels.github.io/corrr/"><strong>corrr</strong> package</a> <span class="citation" data-cites="R-corrr">(<a href="references.html#ref-R-corrr" role="doc-biblioref">Kuhn et al., 2020</a>)</span>.</p>
</section>
<section id="the-person-period-data-set" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="the-person-period-data-set"><span class="header-section-number">2.1.2</span> The person-period data set</h3>
<p>Here are the person-period data (i.e., those shown in the bottom of Figure 2.1).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://stats.idre.ucla.edu/wp-content/uploads/2016/02/tolerance1_pp.txt"</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> T)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">76</span><span class="sc">:</span><span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
      id   age tolerance  male exposure  time
   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1     9    11      2.23     0     1.54     0
 2     9    12      1.79     0     1.54     1
 3     9    13      1.9      0     1.54     2
 4     9    14      2.12     0     1.54     3
 5     9    15      2.66     0     1.54     4
 6    45    11      1.12     1     1.16     0
 7    45    12      1.45     1     1.16     1
 8    45    13      1.45     1     1.16     2
 9    45    14      1.45     1     1.16     3
10  1653    11      1.11     0     1.25     0
11  1653    12      1.11     0     1.25     1
12  1653    13      1.34     0     1.25     2
13  1653    14      1.55     0     1.25     3
14  1653    15      2.12     0     1.25     4</code></pre>
</div>
</div>
<p>With data like these, the simple use of <code>count()</code> or <code>nrow()</code> won’t help us discover how many participants there are in the <code>tolerance_pp</code> data. One quick way is to <code>count()</code> the number of <code>distinct()</code> <code>id</code> values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    16</code></pre>
</div>
</div>
<p>A fundamental skill is knowing how to convert longitudinal data in one format to the other. If you’re using packages within the <strong>tidyverse</strong>, the <code>pivot_longer()</code> function will get you from the person-level format to the person-period format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tolerance <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this is the main event</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(id, male, exposure),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"age"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"tolerance"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we remove the `tol` prefix from the `age` values and then save the numbers as integers</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">str_remove</span>(age, <span class="st">"tol"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># these last two lines just make the results look more like those in the last code chunk</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, age) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">76</span><span class="sc">:</span><span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 5
      id  male exposure   age tolerance
   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;
 1     9     0     1.54    11      2.23
 2     9     0     1.54    12      1.79
 3     9     0     1.54    13      1.9 
 4     9     0     1.54    14      2.12
 5     9     0     1.54    15      2.66
 6    45     1     1.16    11      1.12
 7    45     1     1.16    12      1.45
 8    45     1     1.16    13      1.45
 9    45     1     1.16    14      1.45
10  1653     0     1.25    11      1.11
11  1653     0     1.25    12      1.11
12  1653     0     1.25    13      1.34
13  1653     0     1.25    14      1.55
14  1653     0     1.25    15      2.12</code></pre>
</div>
</div>
<p>You can learn more about the <code>pivot_longer()</code> function <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">here</a> and <a href="https://tidyr.tidyverse.org/articles/pivot.html">here</a>.</p>
<p>As hinted at in the above hyperlinks, the opposite of the <code>pivot_longer()</code> function is <code>pivot_wider()</code>. We can use <code>pivot_wider()</code> to convert the person-period <code>tolerance_pp</code> data to the same format as the person-level <code>tolerance</code> data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we'll want to add that `tol` prefix back to the `age` values</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">str_c</span>(<span class="st">"tol"</span>, age)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this variable is just in the way. we'll drop it</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>time) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here's the main action</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> age, <span class="at">values_from =</span> tolerance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 8
      id  male exposure tol11 tol12 tol13 tol14 tol15
   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     9     0     1.54  2.23  1.79  1.9   2.12  2.66
 2    45     1     1.16  1.12  1.45  1.45  1.45  1.99
 3   268     1     0.9   1.45  1.34  1.99  1.79  1.34
 4   314     0     0.81  1.22  1.22  1.55  1.12  1.12
 5   442     0     1.13  1.45  1.99  1.45  1.67  1.9 
 6   514     1     0.9   1.34  1.67  2.23  2.12  2.44
 7   569     0     1.99  1.79  1.9   1.9   1.99  1.99
 8   624     1     0.98  1.12  1.12  1.22  1.12  1.22
 9   723     0     0.81  1.22  1.34  1.12  1     1.12
10   918     0     1.21  1     1     1.22  1.99  1.22
11   949     1     0.93  1.99  1.55  1.12  1.45  1.55
12   978     1     1.59  1.22  1.34  2.12  3.46  3.32
13  1105     1     1.38  1.34  1.9   1.99  1.9   2.12
14  1542     0     1.44  1.22  1.22  1.99  1.79  2.12
15  1552     0     1.04  1     1.12  2.23  1.55  1.55
16  1653     0     1.25  1.11  1.11  1.34  1.55  2.12</code></pre>
</div>
</div>
</section>
</section>
<section id="descriptive-analysis-of-individual-change-over-time" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="descriptive-analysis-of-individual-change-over-time"><span class="header-section-number">2.2</span> Descriptive analysis of individual change over time</h2>
<p>The following “descriptive analyses [are intended to] reveal the nature and idiosyncrasies of each person’s temporal pattern of growth, addressing the question: How does each person change over time” (p.&nbsp;23)?</p>
<section id="empirical-growth-plots" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="empirical-growth-plots"><span class="header-section-number">2.2.1</span> Empirical growth plots</h3>
<p><em>Empirical growth plots</em> show individual-level sequence in a variable of interest over time. We’ll put <code>age</code> on the <span class="math inline">\(x\)</span>-axis, <code>tolerance</code> on the y-axis, and make our variant of Figure 2.2 with <code>geom_point()</code>. It’s the <code>facet_wrap()</code> part of the code that splits the plot up by <code>id</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>By default, <strong>ggplot2</strong> sets the scales of the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>-axes to the same values across subpanels. If you’d like to free that constraint, play around with the <code>scales</code> argument within <code>facet_wrap()</code>.</p>
</section>
<section id="using-a-trajectory-to-summarize-each-persons-empirical-growth-record" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="using-a-trajectory-to-summarize-each-persons-empirical-growth-record"><span class="header-section-number">2.2.2</span> Using a trajectory to summarize each person’s empirical growth record</h3>
<p>If we wanted to connect the dots, we might just add a <code>geom_line()</code> line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>However, Singer and Willett recommend two other approaches:</p>
<ul>
<li>nonparametric smoothing</li>
<li>parametric functions</li>
</ul>
<section id="smoothing-the-empirical-growth-trajectory-nonparametrically" class="level4" data-number="2.2.2.1">
<h4 data-number="2.2.2.1" class="anchored" data-anchor-id="smoothing-the-empirical-growth-trajectory-nonparametrically"><span class="header-section-number">2.2.2.1</span> Smoothing the empirical growth trajectory nonparametrically</h4>
<p>For our version of Figure 2.3, we’ll use a loess smoother. When using the <code>stat_smooth()</code> function in <strong>ggplot2</strong>, you can control how smooth or wiggly the line is with the <code>span</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> F, <span class="at">span =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="smoothing-the-empirical-growth-trajectory-using-ols-single-level-bayesian-regression" class="level4" data-number="2.2.2.2">
<h4 data-number="2.2.2.2" class="anchored" data-anchor-id="smoothing-the-empirical-growth-trajectory-using-ols-single-level-bayesian-regression"><span class="header-section-number">2.2.2.2</span> Smoothing the empirical growth trajectory using <del>OLS</del> single-level Bayesian regression</h4>
<p>Although “fitting person-specific regression models, one individual at a time, is hardly the most efficient use of longitudinal data” (p.&nbsp;28), we may as well play along with the text. It’ll have pedagogical utility. You’ll see.</p>
<p>For this section, we’ll take a <a href="https://www.youtube.com/watch?v=rz3_FDVt9eg&amp;t=3458s">cue from Hadley Wickham</a> and use <code>group_by()</code> and <code>nest()</code> to make a tibble composed of tibbles (i.e., a nested tibble).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>by_id <span class="ot">&lt;-</span> tolerance_pp <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can get a sense of what we did with <code>head()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>by_id <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
# Groups:   id [6]
     id data            
  &lt;dbl&gt; &lt;list&gt;          
1     9 &lt;tibble [5 × 5]&gt;
2    45 &lt;tibble [5 × 5]&gt;
3   268 &lt;tibble [5 × 5]&gt;
4   314 &lt;tibble [5 × 5]&gt;
5   442 &lt;tibble [5 × 5]&gt;
6   514 &lt;tibble [5 × 5]&gt;</code></pre>
</div>
</div>
<p>As indexed by <code>id</code>, each participant now has their own data set stored in the <code>data</code> column. To get a better sense, we’ll use our double-bracket subsetting skills to open up the first data set, the one for <code>id == 9</code>. If you’re not familiar with this skill, you can learn more from <a href="https://bookdown.org/rdpeng/rprogdatascience/subsetting-r-objects.html">Chapter 9</a> of <a href="https://twitter.com/rdpeng?lang=en">Roger Peng</a>’s great <span class="citation" data-cites="pengProgrammingDataScience2019">(<a href="references.html#ref-pengProgrammingDataScience2019" role="doc-biblioref">2019</a>)</span> online book, <a href="https://bookdown.org/rdpeng/rprogdatascience/"><em>R programming for data science</em></a>, or <a href="https://twitter.com/JennyBryan">Jenny Bryan</a>’s fun and useful talk, <a href="https://www.youtube.com/watch?v=4MfUCX_KpdE"><em>Behind every great plot there’s a great deal of wrangling</em></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>by_id<span class="sc">$</span>data[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
    age tolerance  male exposure  time
  &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
1    11      2.23     0     1.54     0
2    12      1.79     0     1.54     1
3    13      1.9      0     1.54     2
4    14      2.12     0     1.54     3
5    15      2.66     0     1.54     4</code></pre>
</div>
</div>
<p>Our <code>by_id</code> data object has many data sets stored in a higher-level data set. The code we used is verbose, but that’s what made it human-readable. Now we have our nested tibble, we can make a function that will fit the simple linear model <code>tolerance ~ 1 + time</code> to each id-level data set. <em>Why use <code>time</code> as the predictor?</em> you ask. On page 29 in the text, Singer and Willett clarified they fit their individual models with <span class="math inline">\((\text{age} - 11)\)</span> in order to have the model intercepts centered at 11 years old rather than 0. If we wanted to, we could make an <span class="math inline">\((\text{age} - 11)\)</span> variable like so.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>by_id<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_minus_11 =</span> age <span class="sc">-</span> <span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
    age tolerance  male exposure  time age_minus_11
  &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
1    11      2.23     0     1.54     0            0
2    12      1.79     0     1.54     1            1
3    13      1.9      0     1.54     2            2
4    14      2.12     0     1.54     3            3
5    15      2.66     0     1.54     4            4</code></pre>
</div>
</div>
<p>Did you notice how our <code>age_minus_11</code> variable is the same as the <code>time</code> variable already in the data set? Yep, that’s why we’ll be using <code>time</code> in the model. In our data, <span class="math inline">\((\text{age} - 11)\)</span> is encoded as <code>time</code>.</p>
<p>Singer and Willett used OLS to fit their exploratory models. We could do that to with the <code>lm()</code> function and we will do a little of that in this project. But let’s get frisky and fit the models as Bayesians, instead. Our primary statistical package for fitting Bayesian models will be <a href="https://twitter.com/paulbuerkner?lang=en">Paul Bürkner</a>’s <a href="https://github.com/paul-buerkner/brms"><strong>brms</strong></a>. Let’s open it up.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since this is our first Bayesian model, we should start slow. The primary model-fitting function in <strong>brms</strong> is <code>brm()</code>. The function is astonishingly general and includes numerous arguments, most of which have sensible defaults. The primary two arguments are <code>data</code> and <code>formula</code>. I’m guessing they’re self-explanatory. I’m not going to go into detail on the three arguments at the bottom of the code. We’ll go over them later. For simple models like these, I would have omitted them entirely, but given the sparsity of the data (i.e., 5 data points per model), I wanted to make sure we gave the algorithm a good chance to arrive at reasonable estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> by_id<span class="sc">$</span>data[[<span class="dv">1</span>]],</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> tolerance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> b),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/fit02.01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We just fit a single-level Bayesian regression model for our first participant. We saved the results as an object named <code>fit2.1</code>. We can return a useful summary of <code>fit2.1</code> with either <code>print()</code> or <code>summary()</code>. Since it’s less typing, we’ll use <code>print()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit2<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: tolerance ~ 1 + time 
   Data: by_id$data[[1]] (Number of observations: 5) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.90      0.56     0.70     3.09 1.00     3912     2327
time          0.12      0.23    -0.34     0.60 1.00     3919     2322

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.60      0.45     0.21     1.85 1.00     1460     2085

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>The ‘Intercept’ and ‘time’ coefficients are the primary regression parameters. Also notice ‘sigma’, which is our variant of the residual standard error you might get from an OLS output (e.g., from base <strong>R</strong> <code>lm()</code>). Since we’re Bayesians, the output summaries do not contain <span class="math inline">\(p\)</span>-values. But we do get posterior standard deviations (i.e., the ‘Est.Error’ column) and the upper- and lower-levels of the percentile-based 95% intervals.</p>
<p>You probably heard somewhere that Bayesian statistics require priors. We can see what those were by pulling them out of our <code>fit2.1</code> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="fl">.1</span><span class="sc">$</span>prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class coef group resp dpar nlpar lb ub tag       source
           normal(0, 2)         b                                              user
           normal(0, 2)         b time                                 (vectorized)
 student_t(3, 2.1, 2.5) Intercept                                           default
   student_t(3, 0, 2.5)     sigma                             0             default</code></pre>
</div>
</div>
<p>The prior in the top line, <code>normal(0, 2)</code>, is for all parameters of <code>class = b</code>. We actually specified this in our <code>brm()</code> code, above, with the code snip: <code>prior = prior(normal(0, 2), class = b)</code>. At this stage in the project, my initial impulse was to leave this line blank and save the discussion of how to set priors by hand for later. However, the difficulty is that the first several models we’re fitting are all of <span class="math inline">\(n = 5\)</span>. Bayesian statistics handle small-<span class="math inline">\(n\)</span> models just fine. However, when your <span class="math inline">\(n\)</span> gets small, the algorithms we use to implement our Bayesian models benefit from priors that are at least modestly informative. As it turns out, the <strong>brms</strong> default priors are flat for parameters of <code>class = b</code>. They offer no information beyond that contained in the likelihood. To stave off algorithm problems with our extremely-small-<span class="math inline">\(n\)</span> data subsets, we used <code>normal(0, 2)</code> instead. In our model, the only parameter of <code>class = b</code> is the regression slope for <code>time</code>. On the scale of the data, <code>normal(0, 2)</code> is a vary-permissive prior for our <code>time</code> slope.</p>
<p>In addition to our <code>time</code> slope parameter, our model contained an intercept and a residual variance. From the <code>fit2.1$prior</code> output, we can see those were <code>student_t(3, 2.1, 2.5)</code> and <code>student_t(3, 0, 2.5)</code>, respectively. <strong>brms</strong> default priors are designed to be weakly informative. Given the data and the model, these priors have a minimal influence on the results. We’ll focus more on priors later in the project. For now just recognize that even if you don’t specify your priors, you can’t escape using some priors when using <code>brm()</code>. This is a good thing.</p>
<p>Okay, so that was the model for just one participant. We want to do that for all 16. Instead of repeating that code 15 times, we can work in bulk. With <strong>brms</strong>, you can reuse a model with the <code>update()</code> function. Here’s how to do that with the data from our second participant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  fit2<span class="fl">.1</span>, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> by_id<span class="sc">$</span>data[[<span class="dv">2</span>]],</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/fit02.02"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Peek at the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit2<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: tolerance ~ 1 + time 
   Data: by_id$data[[2]] (Number of observations: 5) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.15      0.33     0.51     1.82 1.00     3658     2470
time          0.17      0.14    -0.09     0.43 1.00     3388     2474

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.34      0.31     0.11     1.13 1.00     1435     1668

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Different participants yield different model results.</p>
<p>Looking ahead a bit, we’ll need to know how to get the <span class="math inline">\(R^2\)</span> for a single-level Gaussian model. With <strong>brms</strong>, you do that with the <code>bayes_R2()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_R2</span>(fit2<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate Est.Error       Q2.5     Q97.5
R2 0.6261212 0.2472922 0.01118864 0.8148438</code></pre>
</div>
</div>
<p>Though the default spits out summary statistics, you can get the full posterior distribution for the <span class="math inline">\(R^2\)</span> by specifying <code>summary = F</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_R2</span>(fit2<span class="fl">.2</span>, <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:8000, 1] 0.519 0.779 0.742 0.59 0.554 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr "R2"</code></pre>
</div>
</div>
<p>Our code returned a numeric vector. If you’d like to plot the results with <strong>ggplot2</strong>, you’ll need to convert the vector to a data frame.</p>
<div class="cell" data-fit.width="4">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_R2</span>(fit2<span class="fl">.2</span>, <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> R2)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(R)[Bayesian]<span class="sc">^</span><span class="dv">2</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You’ll note how non-Gaussian the Bayesian <span class="math inline">\(R^2\)</span> can be. Also, with the combination of default minimally-informative priors and only 5 data points, there’ massive uncertainty in the shape. As such, the value of central tendency will vary widely based on which statistic you use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_R2</span>(fit2<span class="fl">.2</span>, <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean   =</span> <span class="fu">mean</span>(R2),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(R2),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mode   =</span> tidybayes<span class="sc">::</span><span class="fu">Mode</span>(R2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       mean    median      mode
1 0.6261212 0.7504917 0.8149813</code></pre>
</div>
</div>
<p>By default, <code>bayes_R2()</code> returns the mean. You can get the median with the <code>robust = TRUE</code> argument. To pull the mode, you’ll need to use <code>summary = F</code> and feed the results into a mode function, like <code>tidybayes::Mode()</code>.</p>
<p>I should also point out the <strong>brms</strong> package did not get these <span class="math inline">\(R^2\)</span> values by traditional method used in, say, OLS estimation. To learn more about how the Bayesian <span class="math inline">\(R^2\)</span> sausage is made, check out Gelman, Goodrich, Gabry, and Vehtari’s <span class="citation" data-cites="gelmanRsquaredBayesianRegression2019">(<a href="references.html#ref-gelmanRsquaredBayesianRegression2019" role="doc-biblioref">2019</a>)</span> paper, [<em>R-squared for Bayesian regression models</em>]https://www.tandfonline.com/doi/full/10.1080/00031305.2018.1549100).</p>
<p>With a little tricky programming, we can use the <code>purrr::map()</code> function to serially fit this model to each of our participant-level data sets. We’ll save the results as <code>fits</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> by_id <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">update</span>(fit2<span class="fl">.1</span>, <span class="at">newdata =</span> ., <span class="at">seed =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s walk through what we did. The <code>map()</code> function takes two primary arguments, <code>.x</code> and <code>.f</code>, respectively. We set <code>.x = data</code>, which meant we wanted to iterate over the contents in our <code>data</code> vector. Recall that each row of <code>data</code> itself contained an entire data set–one for each of the 16 participants. It’s with the second argument <code>.f</code> that we indicated what we wanted to do with our rows of <code>data</code>. We set that to <code>.f = ~update(fit2.1, newdata = ., seed = 2)</code>. With the <code>~</code> syntax, we entered in a formula, which was <code>update(fit2.1, newdata = ., seed = 2)</code>. Just like we did with <code>fit2.2</code>, above, we reused the model formula and other technical specs from <code>fit2.1</code>. Now notice the middle part of the formula, <code>newdata = .</code>. That little <code>.</code> refers to the element we specified in the <code>.x</code> argument. What this combination means is that for each of the 16 rows of our nested <code>by_id</code> tibble, we plugged in the <code>id</code>-specific data set into <code>update(fit, newdata[[i]])</code> where <code>i</code> is simply meant as a row index. The new column, <code>model</code>, contains the output of each of the 16 iterations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 3
# Groups:   id [16]
      id data             model    
   &lt;dbl&gt; &lt;list&gt;           &lt;list&gt;   
 1     9 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 2    45 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 3   268 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 4   314 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 5   442 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 6   514 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 7   569 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 8   624 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
 9   723 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
10   918 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
11   949 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
12   978 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
13  1105 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
14  1542 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
15  1552 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;
16  1653 &lt;tibble [5 × 5]&gt; &lt;brmsfit&gt;</code></pre>
</div>
</div>
<p>Next, we’ll want to extract the necessary summary information from our <code>fits</code> to remake our version of Table 2.2. There’s a lot of info in that table, so let’s take it step by step. First, we’ll extract the posterior means (i.e., “Estimate”) and standard deviations (i.e., “se”) for the initial status and rate of change of each model. We’ll also do the same for sigma (i.e., the square of the “Residual variance”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mean_structure <span class="ot">&lt;-</span> fits <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coefs =</span> <span class="fu">map</span>(model, <span class="sc">~</span> <span class="fu">posterior_summary</span>(.)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">rownames_to_column</span>(<span class="st">"coefficients"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(coefs) <span class="sc">%&gt;%</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data, <span class="sc">-</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(temp, Estimate, Est.Error) <span class="sc">%&gt;%</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> coefficients,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> temp) <span class="sc">%&gt;%</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(b_Intercept, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"init_stat_est"</span>, <span class="st">"init_stat_sd"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(b_time, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"rate_change_est"</span>, <span class="st">"rate_change_sd"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, <span class="sc">~</span> <span class="fu">as.double</span>(.) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mean_structure)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id init_stat_est init_stat_sd rate_change_est rate_change_sd
  &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;
1     9          1.9          0.56            0.12           0.23
2    45          1.15         0.34            0.18           0.14
3   268          1.55         0.57            0.03           0.23
4   314          1.31         0.36           -0.03           0.14
5   442          1.57         0.47            0.06           0.19
6   514          1.43         0.35            0.26           0.14</code></pre>
</div>
</div>
<p>It’s simpler to extract the residual variance. Recall that because <strong>brms</strong> gives that in the standard deviation metric (i.e., <span class="math inline">\(\sigma\)</span>), you need to square it to return it in a variance metric (i.e., <span class="math inline">\(\sigma^2\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>residual_variance <span class="ot">&lt;-</span> fits <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residual_variance =</span> <span class="fu">map_dbl</span>(model, <span class="sc">~</span> <span class="fu">posterior_summary</span>(.)[<span class="dv">3</span>, <span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, residual_variance)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(residual_variance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
# Groups:   id [6]
     id residual_variance
  &lt;dbl&gt;             &lt;dbl&gt;
1     9              0.36
2    45              0.11
3   268              0.38
4   314              0.14
5   442              0.25
6   514              0.12</code></pre>
</div>
</div>
<p>We’ll extract our Bayesian <span class="math inline">\(R^2\)</span> summaries, next. Given how nonnormal these are, we’ll use the posterior median rather than the mean. We get that by using the <code>robust = T</code> argument within the <code>bayes_R2()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> fits <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r2 =</span> <span class="fu">map_dbl</span>(model, <span class="sc">~</span> <span class="fu">bayes_R2</span>(., <span class="at">robust =</span> T)[<span class="dv">1</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, r2)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
# Groups:   id [6]
     id    r2
  &lt;dbl&gt; &lt;dbl&gt;
1     9  0.34
2    45  0.75
3   268  0.19
4   314  0.22
5   442  0.24
6   514  0.86</code></pre>
</div>
</div>
<p>Here we combine all the components with a series of <code>left_join()</code> statements and present it in a <a href="https://cran.r-project.org/web/packages/flextable/index.html"><strong>flextable</strong></a>-type table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> fits <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, male, exposure) <span class="sc">%&gt;%</span> </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mean_structure,    <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(residual_variance, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(r2,                <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">residual_var =</span> residual_variance) <span class="sc">%&gt;%</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, init_stat_est<span class="sc">:</span>r2, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-06598c4c{}.cl-06553f98{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0656e33e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0656f298{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0656f2a2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0656f2a3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-06598c4c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">id</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">init_stat_est</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">init_stat_sd</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">rate_change_est</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">rate_change_sd</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">residual_var</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">r2</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">male</span></p></th><th class="cl-0656f298"><p class="cl-0656e33e"><span class="cl-06553f98">exposure</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">9</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.90</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.56</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.12</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.23</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.36</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.34</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.54</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">45</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.15</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.34</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.18</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.14</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.11</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.75</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.16</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">268</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.55</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.57</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.03</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.23</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.38</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.19</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">314</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.31</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.36</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">-0.03</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.14</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.14</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.22</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.81</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">442</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.57</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.47</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.06</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.19</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.25</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.24</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.13</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">514</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.43</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.35</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.26</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.14</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.12</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.86</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">569</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.82</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.09</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.05</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.03</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.01</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.85</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.99</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">624</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.12</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.15</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.02</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.06</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.01</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.37</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">723</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.27</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.22</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">-0.05</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.09</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.05</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.45</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.81</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">918</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.04</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.59</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.14</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.24</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.47</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.32</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.21</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">949</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.74</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.53</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">-0.10</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.22</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.33</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.29</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">978</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.03</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.63</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.62</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.26</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.51</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.87</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.59</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1,105</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.55</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.36</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.16</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.15</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.14</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.67</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.38</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1,542</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.22</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.45</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.23</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.18</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.20</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.75</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.44</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1,552</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.21</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.70</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.15</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.30</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.68</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0.28</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a2"><p class="cl-0656e33e"><span class="cl-06553f98">1.04</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">1,653</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">0.96</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">0.35</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">0.25</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">0.14</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">0.12</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">0.84</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">0</span></p></td><td class="cl-0656f2a3"><p class="cl-0656e33e"><span class="cl-06553f98">1.25</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We can make the four stem-and-leaf plots of Figure 2.4 with serial combinations of <code>pull()</code> and <code>stem()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted initial status</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(init_stat_est) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stem</span>(<span class="at">scale =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the left of the |

   9 | 6
  10 | 34
  11 | 25
  12 | 127
  13 | 1
  14 | 3
  15 | 557
  16 | 
  17 | 4
  18 | 2
  19 | 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted rate of change</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rate_change_est) <span class="sc">%&gt;%</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stem</span>(<span class="at">scale =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the left of the |

  -1 | 0
  -0 | 53
   0 | 2356
   1 | 24568
   2 | 356
   3 | 
   4 | 
   5 | 
   6 | 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residual variance</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(residual_var) <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stem</span>(<span class="at">scale =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the left of the |

  0 | 115
  1 | 12244
  2 | 05
  3 | 368
  4 | 7
  5 | 1
  6 | 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># r2 statistic</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>table <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(r2) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stem</span>(<span class="at">scale =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  The decimal point is 1 digit(s) to the left of the |

  1 | 9
  2 | 2489
  3 | 247
  4 | 5
  5 | 
  6 | 7
  7 | 55
  8 | 4567</code></pre>
</div>
</div>
<p>To make Figure 2.5, we’ll combine information from the original data and the ‘Estimates’ (i.e., posterior means) from our Bayesian models we’ve encoded in <code>mean_structure</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>by_id <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> tolerance, <span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> mean_structure,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> init_stat_est,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> rate_change_est, <span class="at">group =</span> id),</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">+</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="exploring-differences-in-change-across-people" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="exploring-differences-in-change-across-people"><span class="header-section-number">2.3</span> Exploring differences in change across people</h2>
<p>“Having summarized how each individual changes over time, we now examine similarities and differences in these changes across people” (p.&nbsp;33).</p>
<section id="examining-the-entire-set-of-smooth-trajectories" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="examining-the-entire-set-of-smooth-trajectories"><span class="header-section-number">2.3.1</span> Examining the entire set of smooth trajectories</h3>
<p>The key to making our version of the left-hand side of Figure 2.6 is two <code>stat_smooth()</code> lines. The first one will produce the overall smooth. The second one, the one including the <code>aes(group = id)</code> argument, will give the <code>id</code>-specific smooths.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> F, <span class="at">span =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> id),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> F, <span class="at">span =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
<p>To get the linear OLS trajectories, just switch <code>method = "loess"</code> <code>to method = "lm"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance)) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F, <span class="at">span =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> id),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F, <span class="at">span =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
<p>But we wanted to be Bayesians. We already have the <code>id</code>-specific trajectories. All we need now is one based on all the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  fit2<span class="fl">.1</span>, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> tolerance_pp,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/fit02.03"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s the model summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: tolerance ~ 1 + time 
   Data: tolerance_pp (Number of observations: 80) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.36      0.09     1.18     1.54 1.00     7617     5339
time          0.13      0.04     0.06     0.20 1.00     7805     5825

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.47      0.04     0.40     0.55 1.00     7905     6368

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Before, we used <code>posterior_summary()</code> to isolate the posterior means and <span class="math inline">\(SD\)</span>s. We can also use the <code>fixef()</code> function for that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit2<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Estimate  Est.Error       Q2.5     Q97.5
Intercept 1.3581349 0.09174200 1.17909618 1.5388820
time      0.1308509 0.03696973 0.05924085 0.2023267</code></pre>
</div>
</div>
<p>With a little subsetting, we can extract just the means from each.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit2<span class="fl">.3</span>)[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.358135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit2<span class="fl">.3</span>)[<span class="dv">2</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1308509</code></pre>
</div>
</div>
<p>For this plot, we’ll work more directly with the model formulas to plot the trajectories. We can use <code>init_stat_est</code> and <code>rate_change_est</code> from the <code>mean_structure</code> object as stand-ins for <span class="math inline">\(\beta_{0i}\)</span> and <span class="math inline">\(\beta_{1i}\)</span> from our model equation,</p>
<p><span class="math display">\[\text{tolerance}_{ij} = \beta_{0i} + \beta_{1i} \cdot \text{time}_{ij} + \epsilon_{ij},\]</span></p>
<p>where <span class="math inline">\(i\)</span> indexes children and <span class="math inline">\(j\)</span> indexes time points. All we need to do is plug in the appropriate values for <code>time</code> and we’ll have the fitted <code>tolerance</code> values for each level of <code>id</code>. After a little wrangling, the data will be in good shape for plotting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>tol_fitted <span class="ot">&lt;-</span> mean_structure <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">11</span><span class="st">`</span> <span class="ot">=</span> init_stat_est <span class="sc">+</span> rate_change_est <span class="sc">*</span> <span class="dv">0</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">15</span><span class="st">`</span> <span class="ot">=</span> init_stat_est <span class="sc">+</span> rate_change_est <span class="sc">*</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, <span class="st">`</span><span class="at">11</span><span class="st">`</span>, <span class="st">`</span><span class="at">15</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>id, </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"age"</span>, </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"tolerance"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.integer</span>(age))</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tol_fitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     id   age tolerance
  &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;
1     9    11      1.9 
2     9    15      2.38
3    45    11      1.15
4    45    15      1.87
5   268    11      1.55
6   268    15      1.67</code></pre>
</div>
</div>
<p>We’ll plot the <code>id</code>-level trajectories with those values and <code>geom_line()</code>. To get the overall trajectory, we’ll get tricky with <code>fixef(fit2.3)</code> and <code>geom_abline()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>tol_fitted <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance, <span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">fixef</span>(fit2<span class="fl">.3</span>)[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">fixef</span>(fit2<span class="fl">.3</span>)[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">11</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope     =</span> <span class="fu">fixef</span>(fit2<span class="fl">.3</span>)[<span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-the-results-of-model-fitting-to-frame-questions-about-change" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="using-the-results-of-model-fitting-to-frame-questions-about-change"><span class="header-section-number">2.3.2</span> Using the results of model fitting to frame questions about change</h3>
<p>If you’re new to the multilevel model, the ideas in this section are foundational.</p>
<blockquote class="blockquote">
<p>To learn about the observed <em>average</em> pattern of change, we examine the sample averages of the fitted intercepts and slopes; these tell us about the average initial status and the average annual rate of change in the sample as a whole. To learn about the observed <em>individual differences</em> in change, we examine the sample <em>variances</em> and <em>standard deviations</em> of the intercepts and slopes; these tell us about the observed variability in initial status. And to learn about the observed relationship between initial status and the rate of change, we can examine the sample <em>covariance</em> or <em>correlation</em> between intercepts and slopes.</p>
<p>Formal answers to these questions require the multilevel model for change of chapter 3. But we can presage this work by conducting simple descriptive analyses of the estimated intercepts and slopes. (p.&nbsp;36, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Here are the means and standard deviations presented in Table 2.3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>mean_structure <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">ends_with</span>(<span class="st">"est"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  name             mean    sd
  &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;
1 init_stat_est    1.37  0.29
2 rate_change_est  0.13  0.17</code></pre>
</div>
</div>
<p>Here’s how to get the Pearson’s correlation coefficient.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>mean_structure <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(init_stat_est, rate_change_est) <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                init_stat_est rate_change_est
init_stat_est            1.00           -0.45
rate_change_est         -0.45            1.00</code></pre>
</div>
</div>
</section>
<section id="exploring-the-relationship-between-change-and-time-invariant-predictors" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="exploring-the-relationship-between-change-and-time-invariant-predictors"><span class="header-section-number">2.3.3</span> Exploring the relationship between change and time-invariant predictors</h3>
<p>“Evaluating the impact of predictors helps you uncover systematic patterns in the individual change trajectories corresponding to interindividual variation in personal characteristics” (p.&nbsp;37).</p>
<section id="graphically-examining-groups-of-smoothed-individual-growth-trajectories" class="level4" data-number="2.3.3.1">
<h4 data-number="2.3.3.1" class="anchored" data-anchor-id="graphically-examining-groups-of-smoothed-individual-growth-trajectories"><span class="header-section-number">2.3.3.1</span> Graphically examining groups of smoothed individual growth trajectories</h4>
<p>If we’d like Bayesian estimates differing by <code>male</code>, we’ll need to fit an interaction model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  fit2<span class="fl">.1</span>, </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> tolerance_pp,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  tolerance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> male <span class="sc">+</span> time<span class="sc">:</span>male,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/fit02.04"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check the model summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit2<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: tolerance ~ time + male + time:male 
   Data: tolerance_pp (Number of observations: 80) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     1.36      0.12     1.12     1.59 1.00     4013     4991
time          0.10      0.05     0.01     0.20 1.00     3938     5234
male          0.01      0.18    -0.34     0.37 1.00     3654     4641
time:male     0.06      0.07    -0.08     0.21 1.00     3242     4378

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.47      0.04     0.40     0.55 1.00     6365     5182

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Here’s how to use <code>fixef()</code> and the model equation to get fitted values for <code>tolerance</code> based on specific values for <code>time</code> and <code>male</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>tol_fitted_male <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">male =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age  =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">15</span>), <span class="at">times =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> age <span class="sc">-</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tolerance =</span> <span class="fu">fixef</span>(fit2<span class="fl">.4</span>)[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fixef</span>(fit2<span class="fl">.4</span>)[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> time <span class="sc">+</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fixef</span>(fit2<span class="fl">.4</span>)[<span class="dv">3</span>, <span class="dv">1</span>] <span class="sc">*</span> male <span class="sc">+</span> </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fixef</span>(fit2<span class="fl">.4</span>)[<span class="dv">4</span>, <span class="dv">1</span>] <span class="sc">*</span> time <span class="sc">*</span> male)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>tol_fitted_male</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
   male   age  time tolerance
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1     0    11     0      1.36
2     0    15     4      1.77
3     1    11     0      1.36
4     1    15     4      2.03</code></pre>
</div>
</div>
<p>Now we’re ready to make our Bayesian version of the top panels of Figure 2.7.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>tol_fitted <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we need to add `male` values to `tol_fitted`</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tolerance_pp <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, male),</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance, <span class="at">color =</span> <span class="fu">factor</span>(male))) <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id),</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> tol_fitted_male,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> male)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Before we can do the same thing with <code>exposure</code>, we’ll need to dichotomize it by its median. A simple way is with a conditional statement within the <code>if_else()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>tolerance_pp <span class="ot">&lt;-</span> tolerance_pp <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exposure_01 =</span> <span class="fu">if_else</span>(exposure <span class="sc">&gt;</span> <span class="fu">median</span>(exposure), <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now fit the second interaction model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  fit2<span class="fl">.4</span>, </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> tolerance_pp,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  tolerance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> exposure_01 <span class="sc">+</span> time<span class="sc">:</span>exposure_01,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"fits/fit02.05"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s the summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit2<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: tolerance ~ time + exposure_01 + time:exposure_01 
   Data: tolerance_pp (Number of observations: 80) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            1.39      0.12     1.17     1.63 1.00     3947     5198
time                 0.04      0.05    -0.05     0.14 1.00     3484     4418
exposure_01         -0.07      0.17    -0.40     0.26 1.00     3299     4563
time:exposure_01     0.18      0.07     0.04     0.31 1.00     3052     4303

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.43      0.04     0.37     0.51 1.00     6192     5346

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Now use <code>fixef()</code> and the model equation to get fitted values for <code>tolerance</code> based on specific values for <code>time</code> and <code>exposure_01</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>tol_fitted_exposure <span class="ot">&lt;-</span> <span class="fu">crossing</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure_01 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age         =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">15</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> age <span class="sc">-</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tolerance =</span> <span class="fu">fixef</span>(fit2<span class="fl">.5</span>)[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fixef</span>(fit2<span class="fl">.5</span>)[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> time <span class="sc">+</span> </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fixef</span>(fit2<span class="fl">.5</span>)[<span class="dv">3</span>, <span class="dv">1</span>] <span class="sc">*</span> exposure_01 <span class="sc">+</span> </span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fixef</span>(fit2<span class="fl">.5</span>)[<span class="dv">4</span>, <span class="dv">1</span>] <span class="sc">*</span> time <span class="sc">*</span> exposure_01,</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">exposure =</span> <span class="fu">if_else</span>(exposure_01 <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"high exposure"</span>, <span class="st">"low exposure"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"low exposure"</span>, <span class="st">"high exposure"</span>)))</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>tol_fitted_exposure</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  exposure_01   age  time tolerance exposure     
        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;        
1           0    11     0      1.39 low exposure 
2           0    15     4      1.56 low exposure 
3           1    11     0      1.32 high exposure
4           1    15     4      2.20 high exposure</code></pre>
</div>
</div>
<p>Did you notice in the last lines in the second <code>mutate()</code> how we made a version of <code>exposure</code> that is a factor? That will come in handy for labeling and ordering the subplots. Now make our Bayesian version of the bottom panels of Figure 2.7.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>tol_fitted <span class="sc">%&gt;%</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we need to add `exposure_01` values to `tol_fitted`</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tolerance_pp <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, exposure_01),</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exposure =</span> <span class="fu">if_else</span>(exposure_01 <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"high exposure"</span>, <span class="st">"low exposure"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"low exposure"</span>, <span class="st">"high exposure"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> tolerance, <span class="at">color =</span> exposure)) <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id),</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> tol_fitted_exposure,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">end =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> exposure)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-relationship-between-ols-estimated-single-level-bayesian-trajectories-and-substantive-predictors" class="level4" data-number="2.3.3.2">
<h4 data-number="2.3.3.2" class="anchored" data-anchor-id="the-relationship-between-ols-estimated-single-level-bayesian-trajectories-and-substantive-predictors"><span class="header-section-number">2.3.3.2</span> The relationship between <del>OLS-Estimated</del> single-level Bayesian trajectories and substantive predictors</h4>
<p>“To investigate whether fitted trajectories vary systematically with predictors, we can treat the estimated intercepts and slopes as outcomes and explore the relationship between them and predictors” (p.&nbsp;39). Here are the left panels of Figure 2.8.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> mean_structure <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">ends_with</span>(<span class="st">"est"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fitted inital status"</span>, <span class="st">"Fitted rate of change"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we need to add `male` values to `tol_fitted`</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tolerance_pp <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, male),</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(male), <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"B"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"male"</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scale =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
<p>Here are the right panels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> mean_structure <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">ends_with</span>(<span class="st">"est"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fitted inital status"</span>, <span class="st">"Fitted rate of change"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we need to add `male` values to `tol_fitted`</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tolerance_pp <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, exposure),</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exposure, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"B"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.4</span>)) <span class="sc">+</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scale =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
<p>Did you notice how we saved those last two plots as <code>p1</code> and <code>p2</code>? We can use syntax from the <a href="https://patchwork.data-imaginist.com/"><strong>patchwork</strong> package</a> <span class="citation" data-cites="R-patchwork">(<a href="references.html#ref-R-patchwork" role="doc-biblioref">Pedersen, 2022</a>)</span> to combine them into one compound plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>As interesting as these plots are, do remember that “the need for ad hoc correlations has been effectively replaced by the widespread availability of computer software for fitting the multilevel model for change directly” (pp.&nbsp;41–42). As you’ll see, Bürkner’s <strong>brms</strong> package is one of the foremost in that regard.</p>
</section>
</section>
</section>
<section id="improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design"><span class="header-section-number">2.4</span> Improving the precision and reliability of <del>OLS</del> single-level-Bayesian-estimated rates of change: Lessons for research design</h2>
<blockquote class="blockquote">
<p>Statisticians assess the precision of a parameter estimate in terms of its <em>sampling variation</em>, a measure of the variability that would be found across infinite resamplings from the same population. The most common measure of sampling variability is an estimate’s <em>standard error</em>, the square root of its estimated sampling variance. Precision and standard error have an inverse relationship; the smaller the standard error, the more precise the estimate. (p.&nbsp;41, <em>emphasis</em> in the original)</p>
</blockquote>
<p>So here’s the deal: When Singer and Willett wrote “Statisticians assess…” a more complete expression would have been ‘Frequentist statisticians assess…’ Bayesian statistics are not based on asymptotic theory. They do not presume an idealized infinite distribution of replications. Rather, Bayesian statistics use Bayes theorem to estimate the probability of the parameters given the data. That probability has a distribution. Analogous to frequentist statistics, we often summarize that distribution (i.e., the posterior distribution) in terms of central tendency (e.g., posterior mean, posterior median, posterior mode) and spread. <em>Spread?</em> you say. We typically express spread in one or both of two ways. One typical expression of spread is the 95% intervals. In the Bayesian world, these are often called credible or probability intervals. The other typical expression of spread is the <em>posterior standard deviation</em>. In <strong>brms</strong>, this of typically summarized in the ‘Est.error’ column of the output of functions like <code>print()</code> and <code>posterior_summary()</code> and so on. The posterior standard deviation is analogous to the frequentist standard error. Philosophically and mechanically, they are <em>not</em> the same. But in practice, they are often quite similar.</p>
<p>Later we read:</p>
<blockquote class="blockquote">
<p>Unlike precision which describes how well an individual slope estimate measures that person’s true rate of change, reliability describes how much the rate of change varies across people. Precision has meaning for the individual; reliability has meaning for the group. (p.&nbsp;42)</p>
</blockquote>
<p>I have to protest. True, if we were working within a Classical Test Theory paradigm, this would be correct. But this places reliability with the context of group-based cross-sectional design. Though this is a popular design, it is not the whole story (i.e., see this book!). For introductions to more expansive and person-specific notions of reliability, check out <a href="https://en.wikipedia.org/wiki/Lee_Cronbach">Lee Cronbach</a>’s Generalizability Theory <span class="citation" data-cites="cronbachDependabilityBehavioralMeasurements1972 brennanGeneralizabilityTheory2001 cranfordProcedureEvaluatingSensitivity2006 lopilatoUpdatingGeneralizabilityTheory2015 shroutPsychometrics2012">(<a href="references.html#ref-brennanGeneralizabilityTheory2001" role="doc-biblioref">Brennan, 2001</a>; <a href="references.html#ref-cronbachDependabilityBehavioralMeasurements1972" role="doc-biblioref">Cronbach et al., 1972</a>; also <a href="references.html#ref-cranfordProcedureEvaluatingSensitivity2006" role="doc-biblioref">Cranford et al., 2006</a>; <a href="references.html#ref-lopilatoUpdatingGeneralizabilityTheory2015" role="doc-biblioref">LoPilato et al., 2015</a>; <a href="references.html#ref-shroutPsychometrics2012" role="doc-biblioref">Shrout &amp; Lane, 2012</a>)</span>.</p>
</section>
<section id="session-info" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="session-info">Session info</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.1 (2025-06-13)
Platform: aarch64-apple-darwin20
Running under: macOS Ventura 13.4

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] patchwork_1.3.2 brms_2.23.0     Rcpp_1.1.0      lubridate_1.9.4 forcats_1.0.1   stringr_1.6.0   dplyr_1.1.4    
 [8] purrr_1.2.1     readr_2.1.5     tidyr_1.3.2     tibble_3.3.1    ggplot2_4.0.1   tidyverse_2.0.0

loaded via a namespace (and not attached):
  [1] mnormt_2.1.1            gridExtra_2.3           inline_0.3.21           sandwich_3.1-1          rlang_1.1.7            
  [6] magrittr_2.0.4          multcomp_1.4-29         matrixStats_1.5.0       compiler_4.5.1          mgcv_1.9-3             
 [11] loo_2.9.0.9000          systemfonts_1.3.1       vctrs_0.7.0             reshape2_1.4.5          pkgconfig_2.0.3        
 [16] arrayhelpers_1.1-0      crayon_1.5.3            fastmap_1.2.0           backports_1.5.0         labeling_0.4.3         
 [21] utf8_1.2.6              rmarkdown_2.30          tzdb_0.5.0              ragg_1.5.0              bit_4.6.0              
 [26] xfun_0.55               jsonlite_2.0.0          tidybayes_3.0.7         uuid_1.2-1              psych_2.5.6            
 [31] parallel_4.5.1          R6_2.6.1                stringi_1.8.7           RColorBrewer_1.1-3      StanHeaders_2.36.0.9000
 [36] estimability_1.5.1      rstan_2.36.0.9000       knitr_1.51              zoo_1.8-14              bayesplot_1.15.0.9000  
 [41] Matrix_1.7-3            splines_4.5.1           timechange_0.3.0        tidyselect_1.2.1        rstudioapi_0.17.1      
 [46] abind_1.4-8             codetools_0.2-20        curl_7.0.0              pkgbuild_1.4.8          lattice_0.22-7         
 [51] plyr_1.8.9              withr_3.0.2             bridgesampling_1.2-1    S7_0.2.1                flextable_0.9.10       
 [56] askpass_1.2.1           posterior_1.6.1.9000    coda_0.19-4.1           evaluate_1.0.5          survival_3.8-3         
 [61] RcppParallel_5.1.11-1   zip_2.3.3               xml2_1.4.0              ggdist_3.3.3            pillar_1.11.1          
 [66] tensorA_0.36.2.1        checkmate_2.3.3         stats4_4.5.1            distributional_0.5.0    generics_0.1.4         
 [71] vroom_1.6.6             hms_1.1.4               rstantools_2.5.0.9000   scales_1.4.0            xtable_1.8-4           
 [76] glue_1.8.0              gdtools_0.4.4           emmeans_1.11.2-8        tools_4.5.1             data.table_1.17.8      
 [81] mvtnorm_1.3-3           grid_4.5.1              QuickJSR_1.8.1          nlme_3.1-168            cli_3.6.5              
 [86] textshaping_1.0.4       officer_0.7.2           fontBitstreamVera_0.1.1 svUnit_1.0.8            viridisLite_0.4.2      
 [91] Brobdingnag_1.2-9       V8_8.0.1                gtable_0.3.6            digest_0.6.39           fontquiver_0.2.1       
 [96] TH.data_1.1-4           htmlwidgets_1.6.4       farver_2.1.2            htmltools_0.5.9         lifecycle_1.0.5        
[101] fontLiberation_0.1.0    openssl_2.3.4           bit64_4.6.0-1           MASS_7.3-65            </code></pre>
</div>
</div>
</section>
<section id="comments" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="comments">Comments</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-brennanGeneralizabilityTheory2001" class="csl-entry" role="listitem">
Brennan, R. L. (2001). <em>Generalizability <span>Theory</span></em>. Springer-Verlag. <a href="https://doi.org/10.1007/978-1-4757-3456-0">https://doi.org/10.1007/978-1-4757-3456-0</a>
</div>
<div id="ref-cranfordProcedureEvaluatingSensitivity2006" class="csl-entry" role="listitem">
Cranford, J. A., Shrout, P. E., Iida, M., Rafaeli, E., Yip, T., &amp; Bolger, N. (2006). A procedure for evaluating sensitivity to within-person change: <span>Can</span> mood measures in diary studies detect change reliably? <em>Personality and Social Psychology Bulletin</em>, <em>32</em>(7), 917–929. <a href="https://doi.org/10.1177/0146167206287721">https://doi.org/10.1177/0146167206287721</a>
</div>
<div id="ref-cronbachDependabilityBehavioralMeasurements1972" class="csl-entry" role="listitem">
Cronbach, L. J., Gleser, G. C., Nanda, H., &amp; Rajaratnam, N. (1972). <em>The dependability of behavioral measurements: <span>Theory</span> of generalizability for scores and profiles</em>. John Wiley &amp; Sons. <a href="https://www.amazon.com/Dependability-Behavioral-Measurements-Generalizability-Profiles/dp/0471188506">https://www.amazon.com/Dependability-Behavioral-Measurements-Generalizability-Profiles/dp/0471188506</a>
</div>
<div id="ref-gelmanRsquaredBayesianRegression2019" class="csl-entry" role="listitem">
Gelman, A., Goodrich, B., Gabry, J., &amp; Vehtari, A. (2019). R-squared for <span>Bayesian</span> regression models. <em>The American Statistician</em>, <em>73</em>(3), 307–309. <a href="https://doi.org/10.1080/00031305.2018.1549100">https://doi.org/10.1080/00031305.2018.1549100</a>
</div>
<div id="ref-R-corrr" class="csl-entry" role="listitem">
Kuhn, M., Jackson, S., &amp; Cimentada, J. (2020). <em><span class="nocase">corrr</span>: <span>Correlations</span> in <span>R</span></em> [Manual]. <a href="https://CRAN.R-project.org/package=corrr">https://CRAN.R-project.org/package=corrr</a>
</div>
<div id="ref-lopilatoUpdatingGeneralizabilityTheory2015" class="csl-entry" role="listitem">
LoPilato, A. C., Carter, N. T., &amp; Wang, M. (2015). Updating generalizability theory in management research: <span>Bayesian</span> estimation of variance components. <em>Journal of Management</em>, <em>41</em>(2), 692–717. <a href="https://doi.org/10.1177/0149206314554215">https://doi.org/10.1177/0149206314554215</a>
</div>
<div id="ref-R-patchwork" class="csl-entry" role="listitem">
Pedersen, T. L. (2022). <em><span class="nocase">patchwork</span>: <span>The</span> composer of plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>
</div>
<div id="ref-pengProgrammingDataScience2019" class="csl-entry" role="listitem">
Peng, R. D. (2019). <em>R programming for data science</em>. <a href="https://bookdown.org/rdpeng/rprogdatascience/">https://bookdown.org/rdpeng/rprogdatascience/</a>
</div>
<div id="ref-raudenbushGrowthCurveAnalysis2016" class="csl-entry" role="listitem">
Raudenbush, S. W., &amp; Chan, W.-S. (2016). Growth curve analysis in accelerated longitudinal designs. <em>Journal of Research in Crime and Delinquency</em>, <em>29</em>(4), 387–411. <a href="https://doi.org/10.1177/0022427892029004001">https://doi.org/10.1177/0022427892029004001</a>
</div>
<div id="ref-R-psych" class="csl-entry" role="listitem">
Revelle, W. (2022). <em><span class="nocase">psych</span>: <span>Procedures</span> for psychological, psychometric, and personality research</em>. <a href="https://CRAN.R-project.org/package=psych">https://CRAN.R-project.org/package=psych</a>
</div>
<div id="ref-shroutPsychometrics2012" class="csl-entry" role="listitem">
Shrout, P. E., &amp; Lane, S. P. (2012). Psychometrics. In M. R. Mehl &amp; T. S. Conner (Eds.), <em>Handbook of research methods for studying daily life</em> (pp. 302–320). The Guilford Press. <a href="https://www.guilford.com/books/Handbook-of-Research-Methods-for-Studying-Daily-Life/Mehl-Conner/9781462513055">https://www.guilford.com/books/Handbook-of-Research-Methods-for-Studying-Daily-Life/Mehl-Conner/9781462513055</a>
</div>
<div id="ref-singerAppliedLongitudinalData2003" class="csl-entry" role="listitem">
Singer, J. D., &amp; Willett, J. B. (2003). <em>Applied longitudinal data analysis: <span>Modeling</span> change and event occurrence</em>. Oxford University Press, USA. <a href="https://oxford.universitypressscholarship.com/view/10.1093/acprof:oso/9780195152968.001.0001/acprof-9780195152968">https://oxford.universitypressscholarship.com/view/10.1093/acprof:oso/9780195152968.001.0001/acprof-9780195152968</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/solomon\.quarto\.pub\/alda\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse";
    script.dataset.repoId = "MDEwOlJlcG9zaXRvcnkxODg5MTU1MTM=";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOC0KfOc4C1eQu";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01.html" class="pagination-link" aria-label="A Framework for Investigating Change over Time">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">A Framework for Investigating Change over Time</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03.html" class="pagination-link" aria-label="Introducing the Multilevel Model for Change">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducing the Multilevel Model for Change</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>