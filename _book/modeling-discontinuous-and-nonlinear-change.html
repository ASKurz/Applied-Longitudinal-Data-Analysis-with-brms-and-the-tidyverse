<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Modeling Discontinuous and Nonlinear Change | Applied longitudinal data analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Modeling Discontinuous and Nonlinear Change | Applied longitudinal data analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="github-repo" content="ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Modeling Discontinuous and Nonlinear Change | Applied longitudinal data analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2021-04-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="treating-time-more-flexibly.html"/>
<link rel="next" href="examining-the-multilevel-models-error-covariance-structure.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
<li><a href="index.html#r-setup"><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html"><i class="fa fa-check"></i><b>1</b> A Framework for Investigating Change over Time</a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#when-might-you-study-change-over-time"><i class="fa fa-check"></i><b>1.1</b> When might you study change over time?</a></li>
<li class="chapter" data-level="1.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#distinguishing-between-two-types-of-questions-about-change"><i class="fa fa-check"></i><b>1.2</b> Distinguishing between two types of questions about change</a></li>
<li class="chapter" data-level="1.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#three-important-features-of-a-study-of-change"><i class="fa fa-check"></i><b>1.3</b> Three important features of a study of change</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#multiple-waves-of-data."><i class="fa fa-check"></i><b>1.3.1</b> Multiple waves of data.</a></li>
<li class="chapter" data-level="1.3.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-sensible-metric-for-time."><i class="fa fa-check"></i><b>1.3.2</b> A sensible metric for time.</a></li>
<li class="chapter" data-level="1.3.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-continuous-outcome-that-changes-systematically-over-time."><i class="fa fa-check"></i><b>1.3.3</b> A continuous outcome that changes systematically over time.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html"><i class="fa fa-check"></i><b>2</b> Exploring Longitudinal Data on Change</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#creating-a-longitudinal-data-set"><i class="fa fa-check"></i><b>2.1</b> Creating a longitudinal data set</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-level-data-set."><i class="fa fa-check"></i><b>2.1.1</b> The person-level data set.</a></li>
<li class="chapter" data-level="2.1.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-period-data-set."><i class="fa fa-check"></i><b>2.1.2</b> The person-period data set.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#descriptive-analysis-of-individual-change-over-time"><i class="fa fa-check"></i><b>2.2</b> Descriptive analysis of individual change over time</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#empirical-growth-plots."><i class="fa fa-check"></i><b>2.2.1</b> Empirical growth plots.</a></li>
<li class="chapter" data-level="2.2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-a-trajectory-to-summarize-each-persons-empirical-growth-record."><i class="fa fa-check"></i><b>2.2.2</b> Using a trajectory to summarize each person’s empirical growth record.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-differences-in-change-across-people"><i class="fa fa-check"></i><b>2.3</b> Exploring differences in change across people</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#examining-the-entire-set-of-smooth-trajectories."><i class="fa fa-check"></i><b>2.3.1</b> Examining the entire set of smooth trajectories.</a></li>
<li class="chapter" data-level="2.3.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-the-results-of-model-fitting-to-frame-questions-about-change."><i class="fa fa-check"></i><b>2.3.2</b> Using the results of model fitting to frame questions about change.</a></li>
<li class="chapter" data-level="2.3.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-the-relationship-between-change-and-time-invariant-predictors."><i class="fa fa-check"></i><b>2.3.3</b> Exploring the relationship between change and time-invariant predictors.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design"><i class="fa fa-check"></i><b>2.4</b> Improving the precision and reliability of <del>OLS</del> single-level-Bayesian-estimated rates of change: Lessons for research design</a></li>
<li class="chapter" data-level="" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>3</b> Introducing the Multilevel Model for Change</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#what-is-the-purpose-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>3.1</b> What is the purpose of the multilevel model for change?</a></li>
<li class="chapter" data-level="3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-1-submodel-for-individual-change"><i class="fa fa-check"></i><b>3.2</b> The level-1 submodel for individual change</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-structural-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.1</b> The structural part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-stochastic-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.2</b> The stochastic part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#relating-the-level-1-submodel-to-the-ols-exploratory-methods-of-chapter-2."><i class="fa fa-check"></i><b>3.2.3</b> Relating the level-1 submodel to the OLS exploratory methods of chapter 2.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-2-submodel-for-systematic-interindividual-differences-in-change"><i class="fa fa-check"></i><b>3.3</b> The level-2 submodel for systematic interindividual differences in change</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#structural-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.1</b> Structural components of the level-2 submodel.</a></li>
<li class="chapter" data-level="3.3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#stochastic-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.2</b> Stochastic components of the level-2 submodel.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#fitting-the-multilevel-model-for-change-to-data"><i class="fa fa-check"></i><b>3.4</b> Fitting the multilevel model for change to data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-advantages-of-maximum-likelihood-bayesian-estimation."><i class="fa fa-check"></i><b>3.4.1</b> The advantages of <del>maximum likelihood</del> Bayesian estimation.</a></li>
<li class="chapter" data-level="3.4.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#using-maximum-likelihood-modern-bayesian-methods-to-fit-a-multilevel-model."><i class="fa fa-check"></i><b>3.4.2</b> Using <del>maximum likelihood</del> modern Bayesian methods to fit a multilevel model.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-fixed-effects"><i class="fa fa-check"></i><b>3.5</b> Examining estimated fixed effects</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-estimated-fixed-effects."><i class="fa fa-check"></i><b>3.5.1</b> Interpreting estimated fixed effects.</a></li>
<li class="chapter" data-level="3.5.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-fixed-effects."><i class="fa fa-check"></i><b>3.5.2</b> Single parameter tests for the fixed effects.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-variance-components"><i class="fa fa-check"></i><b>3.6</b> Examining estimated variance components</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-the-estimated-variance-components."><i class="fa fa-check"></i><b>3.6.1</b> Interpreting the estimated variance components.</a></li>
<li class="chapter" data-level="3.6.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-variance-components."><i class="fa fa-check"></i><b>3.6.2</b> Single parameter tests for the variance components.</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#bonus-how-did-you-simulate-that-data"><i class="fa fa-check"></i><b>3.7</b> Bonus: How did you simulate that data?</a></li>
<li class="chapter" data-level="" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>4</b> Doing Data Analysis with the Multilevel Model for Change</a>
<ul>
<li class="chapter" data-level="4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#example-changes-in-adolescent-alcohol-use"><i class="fa fa-check"></i><b>4.1</b> Example: Changes in adolescent alcohol use</a></li>
<li class="chapter" data-level="4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-composite-specification-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>4.2</b> The composite specification of the multilevel model for change</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-structural-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.1</b> The structural component of the composite model.</a></li>
<li class="chapter" data-level="4.2.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-stochastic-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.2</b> The stochastic component of the composite model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#methods-of-estimation-revisited"><i class="fa fa-check"></i><b>4.3</b> Methods of estimation, revisited</a></li>
<li class="chapter" data-level="4.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#first-steps-fitting-two-unconditional-multilevel-models-for-change"><i class="fa fa-check"></i><b>4.4</b> First steps: Fitting two unconditional multilevel models for change</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-means-model."><i class="fa fa-check"></i><b>4.4.1</b> The unconditional means model.</a></li>
<li class="chapter" data-level="4.4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-growth-model."><i class="fa fa-check"></i><b>4.4.2</b> The unconditional growth model.</a></li>
<li class="chapter" data-level="4.4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#quantifying-the-proportion-of-outcome-variation-explained."><i class="fa fa-check"></i><b>4.4.3</b> Quantifying the proportion of outcome variation “explained.”</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#practical-data-analytic-strategies-for-model-building"><i class="fa fa-check"></i><b>4.5</b> Practical data analytic strategies for model building</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#a-taxonomy-of-statistical-models."><i class="fa fa-check"></i><b>4.5.1</b> A taxonomy of statistical models.</a></li>
<li class="chapter" data-level="4.5.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#interpreting-fitted-models."><i class="fa fa-check"></i><b>4.5.2</b> Interpreting fitted models.</a></li>
<li class="chapter" data-level="4.5.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#displaying-prototypical-change-trajectories."><i class="fa fa-check"></i><b>4.5.3</b> Displaying prototypical change trajectories.</a></li>
<li class="chapter" data-level="4.5.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#recentering-predictors-to-improve-interpretation."><i class="fa fa-check"></i><b>4.5.4</b> Recentering predictors to improve interpretation.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#comparing-models-using-deviance-statistics"><i class="fa fa-check"></i><b>4.6</b> Comparing models using deviance statistics</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-deviance-statistic."><i class="fa fa-check"></i><b>4.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="4.6.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#when-and-how-can-you-compare-deviance-statistics"><i class="fa fa-check"></i><b>4.6.2</b> When and how can you compare deviance statistics?</a></li>
<li class="chapter" data-level="4.6.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#implementing-deviance-based-hypothesis-tests."><i class="fa fa-check"></i><b>4.6.3</b> Implementing deviance-based hypothesis tests.</a></li>
<li class="chapter" data-level="4.6.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#aic-and-bic-waic-and-loo-statistics-comparing-nonnested-models-using-information-criteria-and-cross-validation."><i class="fa fa-check"></i><b>4.6.4</b> <del>AIC and BIC</del> WAIC and LOO statistics: Comparing nonnested models using information criteria [and cross validation].</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#using-wald-statistics-to-test-composite-hypotheses-about-fixed-effects"><i class="fa fa-check"></i><b>4.7</b> Using Wald statistics to test composite hypotheses about fixed effects</a></li>
<li class="chapter" data-level="4.8" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#evaluating-the-tenability-of-a-models-assumptions"><i class="fa fa-check"></i><b>4.8</b> Evaluating the tenability of a model’s assumptions</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-functional-form."><i class="fa fa-check"></i><b>4.8.1</b> Checking functional form.</a></li>
<li class="chapter" data-level="4.8.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-normality."><i class="fa fa-check"></i><b>4.8.2</b> Checking normality.</a></li>
<li class="chapter" data-level="4.8.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-homoscedasticity."><i class="fa fa-check"></i><b>4.8.3</b> Checking homoscedasticity.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#model-based-empirical-bayes-estimates-of-the-individual-growth-parameters"><i class="fa fa-check"></i><b>4.9</b> Model-based (Empirical Bayes) estimates of the individual growth parameters</a></li>
<li class="chapter" data-level="" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html"><i class="fa fa-check"></i><b>5</b> Treating Time More Flexibly</a>
<ul>
<li class="chapter" data-level="5.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#variably-spaced-measurement-occasions"><i class="fa fa-check"></i><b>5.1</b> Variably spaced measurement occasions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#the-structure-of-variably-spaced-data-sets."><i class="fa fa-check"></i><b>5.1.1</b> The structure of variably spaced data sets.</a></li>
<li class="chapter" data-level="5.1.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#postulating-and-fitting-multilevel-models-with-variably-spaced-waves-of-data."><i class="fa fa-check"></i><b>5.1.2</b> Postulating and fitting multilevel models with variably spaced waves of data.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#varying-numbers-of-measurement-occasions"><i class="fa fa-check"></i><b>5.2</b> Varying numbers of measurement occasions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#analyzing-data-sets-in-which-the-number-of-waves-per-person-varies."><i class="fa fa-check"></i><b>5.2.1</b> Analyzing data sets in which the number of waves per person varies.</a></li>
<li class="chapter" data-level="5.2.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#practical-problems-that-may-arise-when-analyzing-unbalanced-data-sets."><i class="fa fa-check"></i><b>5.2.2</b> Practical problems that may arise when analyzing unbalanced data sets.</a></li>
<li class="chapter" data-level="5.2.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#distinguishing-among-different-types-of-missingness."><i class="fa fa-check"></i><b>5.2.3</b> Distinguishing among different types of missingness.</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#time-varying-predictors"><i class="fa fa-check"></i><b>5.3</b> Time-varying predictors</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#including-the-main-effect-of-a-time-varying-predictor."><i class="fa fa-check"></i><b>5.3.1</b> Including the main effect of a time-varying predictor.</a></li>
<li class="chapter" data-level="5.3.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#allowing-the-effect-of-a-time-varying-predictor-to-vary-over-time."><i class="fa fa-check"></i><b>5.3.2</b> Allowing the effect of a time-varying predictor to vary over time.</a></li>
<li class="chapter" data-level="5.3.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-time-varying-predictors."><i class="fa fa-check"></i><b>5.3.3</b> Recentering time-varying predictors.</a></li>
<li class="chapter" data-level="5.3.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#an-important-caveat-the-problem-of-reciprocal-causation."><i class="fa fa-check"></i><b>5.3.4</b> An important caveat: The problem of reciprocal causation.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-the-effect-of-time"><i class="fa fa-check"></i><b>5.4</b> Recentering the effect of <em>TIME</em></a></li>
<li class="chapter" data-level="" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html"><i class="fa fa-check"></i><b>6</b> Modeling Discontinuous and Nonlinear Change</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#discontinuous-individual-change"><i class="fa fa-check"></i><b>6.1</b> Discontinuous individual change</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#alternative-discontinuous-level-1-models-for-change."><i class="fa fa-check"></i><b>6.1.1</b> Alternative discontinuous level-1 models for change.</a></li>
<li class="chapter" data-level="6.1.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#selecting-among-the-alternative-discontinuous-models."><i class="fa fa-check"></i><b>6.1.2</b> Selecting among the alternative discontinuous models.</a></li>
<li class="chapter" data-level="6.1.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#further-extensions-of-the-discontinuous-growth-model."><i class="fa fa-check"></i><b>6.1.3</b> Further extensions of the discontinuous growth model.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#using-transformations-to-model-nonlinear-individual-change"><i class="fa fa-check"></i><b>6.2</b> Using transformations to model nonlinear individual change</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-ladder-of-transformations-and-the-rule-of-the-bulge."><i class="fa fa-check"></i><b>6.2.1</b> The ladder of transformations and the rule of the bulge.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#representing-individual-change-using-a-polynomial-function-of-time"><i class="fa fa-check"></i><b>6.3</b> Representing individual change using a polynomial function of TIME</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-shapes-of-polynomial-individual-change-trajectories."><i class="fa fa-check"></i><b>6.3.1</b> The shapes of polynomial individual change trajectories.</a></li>
<li class="chapter" data-level="6.3.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#selecting-a-suitable-level-1-polynomial-trajectory-for-change."><i class="fa fa-check"></i><b>6.3.2</b> Selecting a suitable level-1 polynomial trajectory for change.</a></li>
<li class="chapter" data-level="6.3.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#testing-higher-order-terms-in-a-polynomial-level-1-model."><i class="fa fa-check"></i><b>6.3.3</b> Testing higher order terms in a polynomial level-1 model.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#truly-nonlinear-trajectories"><i class="fa fa-check"></i><b>6.4</b> Truly nonlinear trajectories</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#what-do-we-mean-by-truly-nonlinear-models"><i class="fa fa-check"></i><b>6.4.1</b> What do we mean by truly nonlinear models?</a></li>
<li class="chapter" data-level="6.4.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-logistic-individual-growth-curve."><i class="fa fa-check"></i><b>6.4.2</b> The logistic individual growth curve.</a></li>
<li class="chapter" data-level="6.4.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#a-survey-of-truly-nonlinear-change-trajectories."><i class="fa fa-check"></i><b>6.4.3</b> A survey of truly nonlinear change trajectories.</a></li>
<li class="chapter" data-level="6.4.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#from-substantive-theory-to-mathematical-representations-of-individual-growth."><i class="fa fa-check"></i><b>6.4.4</b> From substantive theory to mathematical representations of individual growth.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#bonus-the-logistic-growth-model"><i class="fa fa-check"></i><b>6.5</b> Bonus: The logistic growth model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#we-need-data."><i class="fa fa-check"></i><b>6.5.1</b> We need data.</a></li>
<li class="chapter" data-level="6.5.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#have-you-heard-of-the-generalized-linear-mixed-model"><i class="fa fa-check"></i><b>6.5.2</b> Have you heard of the generalized linear [mixed] model?</a></li>
<li class="chapter" data-level="6.5.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#define-the-simple-logistic-multilevel-growth-model."><i class="fa fa-check"></i><b>6.5.3</b> Define the simple logistic multilevel growth model.</a></li>
<li class="chapter" data-level="6.5.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#ease-into-the-model-with-a-prior-predictive-check."><i class="fa fa-check"></i><b>6.5.4</b> Ease into the model with a prior predictive check.</a></li>
<li class="chapter" data-level="6.5.5" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#you-may-want-more."><i class="fa fa-check"></i><b>6.5.5</b> You may want more.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html"><i class="fa fa-check"></i><b>7</b> Examining the Multilevel Model’s Error Covariance Structure</a>
<ul>
<li class="chapter" data-level="" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html"><i class="fa fa-check"></i><b>8</b> Modeling Change Using Covariance Structure Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html"><i class="fa fa-check"></i><b>9</b> A Framework for Investigating Event Occurrence</a>
<ul>
<li class="chapter" data-level="9.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#should-you-conduct-a-survival-analysis-the-whether-and-when-test"><i class="fa fa-check"></i><b>9.1</b> Should you conduct a survival analysis? The “whether” and “when” test</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#time-to-relapse-among-recently-treated-alcoholics."><i class="fa fa-check"></i><b>9.1.1</b> Time to relapse among recently treated alcoholics.</a></li>
<li class="chapter" data-level="9.1.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#length-of-stay-in-teaching."><i class="fa fa-check"></i><b>9.1.2</b> Length of stay in teaching.</a></li>
<li class="chapter" data-level="9.1.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#age-at-first-suicide-ideation."><i class="fa fa-check"></i><b>9.1.3</b> Age at first suicide ideation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#framing-a-research-question-about-event-occurrence"><i class="fa fa-check"></i><b>9.2</b> Framing a research question about event occurrence</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#defining-event-occurrence."><i class="fa fa-check"></i><b>9.2.1</b> Defining event occurrence.</a></li>
<li class="chapter" data-level="9.2.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#identifying-the-beginning-of-time."><i class="fa fa-check"></i><b>9.2.2</b> Identifying the “beginning of time.”</a></li>
<li class="chapter" data-level="9.2.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#specifying-a-metric-for-time."><i class="fa fa-check"></i><b>9.2.3</b> Specifying a metric for time.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#censoring-how-complete-are-the-data-on-event-occurrence"><i class="fa fa-check"></i><b>9.3</b> Censoring: How complete are the data on event occurrence?</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-and-why-does-censoring-arise"><i class="fa fa-check"></i><b>9.3.1</b> How and why does censoring arise?</a></li>
<li class="chapter" data-level="9.3.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#different-types-of-censoring."><i class="fa fa-check"></i><b>9.3.2</b> Different types of censoring.</a></li>
<li class="chapter" data-level="9.3.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-does-censoring-affect-statistical-analysis"><i class="fa fa-check"></i><b>9.3.3</b> How does censoring affect statistical analysis?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html"><i class="fa fa-check"></i><b>10</b> Describing Discrete-Time Event Occurrence Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-life-table"><i class="fa fa-check"></i><b>10.1</b> The life table</a></li>
<li class="chapter" data-level="10.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-framework-for-characterizing-the-distribution-of-discrete-time-event-occurrence-data"><i class="fa fa-check"></i><b>10.2</b> A framework for characterizing the distribution of discrete-time event occurrence data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-function."><i class="fa fa-check"></i><b>10.2.1</b> Survivor function.</a></li>
<li class="chapter" data-level="10.2.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#median-lifetime."><i class="fa fa-check"></i><b>10.2.2</b> Median lifetime.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#developing-intuition-about-hazard-functions-survivor-functions-and-median-lifetimes"><i class="fa fa-check"></i><b>10.3</b> Developing intuition about hazard functions, survivor functions, and median lifetimes</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#identifying-periods-of-high-and-low-risk-using-hazard-functions."><i class="fa fa-check"></i><b>10.3.1</b> Identifying periods of high and low risk using hazard functions.</a></li>
<li class="chapter" data-level="10.3.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-functions-as-a-context-for-evaluating-the-magnitude-of-hazard."><i class="fa fa-check"></i><b>10.3.2</b> Survivor functions as a context for evaluating the magnitude of hazard.</a></li>
<li class="chapter" data-level="10.3.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#strengths-and-limitations-of-estimated-median-lifetimes."><i class="fa fa-check"></i><b>10.3.3</b> Strengths and limitations of estimated median lifetimes.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#quantifying-the-effects-of-sampling-variation"><i class="fa fa-check"></i><b>10.4</b> Quantifying the effects of sampling variation</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-standard-error-of-the-estimated-hazard-probabilities."><i class="fa fa-check"></i><b>10.4.1</b> The standard error of the estimated hazard probabilities.</a></li>
<li class="chapter" data-level="10.4.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#standard-error-of-the-estimated-survival-probabilities."><i class="fa fa-check"></i><b>10.4.2</b> Standard error of the estimated survival probabilities.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-simple-and-useful-strategy-for-constructing-the-life-table"><i class="fa fa-check"></i><b>10.5</b> A simple and useful strategy for constructing the life table</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-person-period-data-set.-1"><i class="fa fa-check"></i><b>10.5.1</b> The person-period data set.</a></li>
<li class="chapter" data-level="10.5.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#using-the-person-period-data-set-to-construct-the-life-table."><i class="fa fa-check"></i><b>10.5.2</b> Using the person-period data set to construct the life table.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#bonus-fit-the-discrete-time-hazard-models-with-brms"><i class="fa fa-check"></i><b>10.6</b> Bonus: Fit the discrete-time hazard models with <strong>brms</strong></a></li>
<li class="chapter" data-level="" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html"><i class="fa fa-check"></i><b>11</b> Fitting Basic Discrete-Time Hazard Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#toward-a-statistical-model-for-discrete-time-hazard"><i class="fa fa-check"></i><b>11.1</b> Toward a statistical model for discrete-time hazard</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#plots-of-within-group-hazard-functions-and-survivor-functions."><i class="fa fa-check"></i><b>11.1.1</b> Plots of within-group hazard functions and survivor functions.</a></li>
<li class="chapter" data-level="11.1.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-kind-of-statistical-model-do-these-graphs-suggest"><i class="fa fa-check"></i><b>11.1.2</b> What kind of statistical model do these graphs suggest?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#formal-representation-of-the-population-discrete-time-hazard-model"><i class="fa fa-check"></i><b>11.2</b> Formal representation of the population discrete-time hazard model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-do-the-parameters-represent"><i class="fa fa-check"></i><b>11.2.1</b> What do the parameters represent?</a></li>
<li class="chapter" data-level="11.2.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#an-alternative-representation-of-the-model."><i class="fa fa-check"></i><b>11.2.2</b> An alternative representation of the model.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-a-discrete-time-hazard-model-to-data"><i class="fa fa-check"></i><b>11.3</b> Fitting a discrete-time hazard model to data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#adding-predictors-to-the-person-period-data-set."><i class="fa fa-check"></i><b>11.3.1</b> Adding predictors to the person-period data set.</a></li>
<li class="chapter" data-level="11.3.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#maximum-likelihood-estimates-and-bayesian-posteriors-for-the-discrete-time-hazard-model."><i class="fa fa-check"></i><b>11.3.2</b> Maximum likelihood estimates [and Bayesian posteriors] for the discrete-time hazard model.</a></li>
<li class="chapter" data-level="11.3.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-the-discrete-time-hazard-model-to-data."><i class="fa fa-check"></i><b>11.3.3</b> Fitting the discrete-time hazard model to data.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#interpreting-parameter-estimates"><i class="fa fa-check"></i><b>11.4</b> Interpreting parameter estimates</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-time-indicators."><i class="fa fa-check"></i><b>11.4.1</b> The time indicators.</a></li>
<li class="chapter" data-level="11.4.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#dichotomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.2</b> Dichotomous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#continuous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.3</b> Continuous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#polytomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.4</b> Polytomous substantive predictors.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#displaying-fitted-hazard-and-survivor-functions"><i class="fa fa-check"></i><b>11.5</b> Displaying fitted hazard and survivor functions</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#a-strategy-for-a-single-categorical-substantive-predictor."><i class="fa fa-check"></i><b>11.5.1</b> A strategy for a single categorical substantive predictor.</a></li>
<li class="chapter" data-level="11.5.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#extending-this-strategy-to-multiple-predictors-some-of-which-are-continuous."><i class="fa fa-check"></i><b>11.5.2</b> Extending this strategy to multiple predictors (some of which are continuous).</a></li>
<li class="chapter" data-level="11.5.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#two-cautions-when-interpreting-fitted-hazard-and-survivor-functions."><i class="fa fa-check"></i><b>11.5.3</b> Two cautions when interpreting fitted hazard and survivor functions.</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-models-using-deviance-statistics-and-information-criteria"><i class="fa fa-check"></i><b>11.6</b> Comparing models using <del>deviance statistics and</del> information criteria</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-deviance-statistic.-1"><i class="fa fa-check"></i><b>11.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="11.6.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-individual-predictors."><i class="fa fa-check"></i><b>11.6.2</b> Deviance-based hypothesis tests for individual predictors.</a></li>
<li class="chapter" data-level="11.6.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-groups-of-predictors."><i class="fa fa-check"></i><b>11.6.3</b> Deviance-based hypothesis tests for groups of predictors.</a></li>
<li class="chapter" data-level="11.6.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-nonnested-models-using-waic-and-loo."><i class="fa fa-check"></i><b>11.6.4</b> Comparing nonnested models using [WAIC and LOO].</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#statistical-inference-using-uncertainty-in-the-bayesian-posterior"><i class="fa fa-check"></i><b>11.7</b> Statistical inference using [uncertainty in the Bayesian posterior]</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-wald-chi-square-statistic."><i class="fa fa-check"></i><b>11.7.1</b> The <del>Wald chi-square statistic</del>.</a></li>
<li class="chapter" data-level="11.7.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#asymmetric-credible-intervals-for-parameters-and-odds-ratios."><i class="fa fa-check"></i><b>11.7.2</b> [Asymmetric credible intervals] for parameters and odds ratios.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html"><i class="fa fa-check"></i><b>12</b> Extending the Discrete-Time Hazard Model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#alternative-specification-for-the-main-effect-of-time"><i class="fa fa-check"></i><b>12.1</b> Alternative specification for the “main effect” of <em>TIME</em></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#an-ordered-series-of-polynomial-specifications-for-time."><i class="fa fa-check"></i><b>12.1.1</b> An ordered series of polynomial specifications for <em>TIME</em>.</a></li>
<li class="chapter" data-level="12.1.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#criteria-for-comparing-alternative-specification."><i class="fa fa-check"></i><b>12.1.2</b> Criteria for comparing alternative specification.</a></li>
<li class="chapter" data-level="12.1.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-parameters-from-linear-quadratic-and-cubic-specifications."><i class="fa fa-check"></i><b>12.1.3</b> Interpreting parameters from linear, quadratic, and cubic specifications.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#using-the-complementary-log-log-link-to-specify-a-discrete-time-hazard-model"><i class="fa fa-check"></i><b>12.2</b> Using the complementary log-log link to specify a discrete-time hazard model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-clog-log-transformation-when-and-why-it-is-useful."><i class="fa fa-check"></i><b>12.2.1</b> The clog-log transformation: When and why it is useful.</a></li>
<li class="chapter" data-level="12.2.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#a-discrete-time-hazard-model-using-the-complementary-log-log-link."><i class="fa fa-check"></i><b>12.2.2</b> A discrete-time hazard model using the complementary log-log link.</a></li>
<li class="chapter" data-level="12.2.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#choosing-between-logit-and-clog-log-links-for-discrete-time-hazard-models."><i class="fa fa-check"></i><b>12.2.3</b> Choosing between logit and clog-log links for discrete-time hazard models.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#time-varying-predictors-1"><i class="fa fa-check"></i><b>12.3</b> Time-varying predictors</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#assumptions-underlying-a-model-with-time-varying-predictors."><i class="fa fa-check"></i><b>12.3.1</b> Assumptions underlying a model with time-varying predictors.</a></li>
<li class="chapter" data-level="12.3.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-and-displaying-time-varying-predictors-effects."><i class="fa fa-check"></i><b>12.3.2</b> Interpreting and displaying time-varying predictors’ effects.</a></li>
<li class="chapter" data-level="12.3.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#two-caveats-the-problems-of-state-and-rate-dependence."><i class="fa fa-check"></i><b>12.3.3</b> Two caveats: The problems of state and rate dependence.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-linear-additivity-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.4</b> The linear additivity assumption: Uncovering violations and simple solutions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interactions-between-substantive-predictors."><i class="fa fa-check"></i><b>12.4.1</b> Interactions between substantive predictors.</a></li>
<li class="chapter" data-level="12.4.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#nonlinear-effects."><i class="fa fa-check"></i><b>12.4.2</b> Nonlinear effects.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-proportionality-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.5</b> The proportionality assumption: Uncovering violations and simple solutions</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#discrete-time-hazard-models-that-do-not-invoke-a-proportionality-assumption."><i class="fa fa-check"></i><b>12.5.1</b> Discrete-time hazard models that do not invoke a proportionality assumption.</a></li>
<li class="chapter" data-level="12.5.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#investigating-the-proportionality-assumption-in-practice."><i class="fa fa-check"></i><b>12.5.2</b> Investigating the proportionality assumption in practice.</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-no-unobserved-heterogeneity-assumption-no-simple-solution"><i class="fa fa-check"></i><b>12.6</b> The no unobserved heterogeneity assumption: No simple solution</a></li>
<li class="chapter" data-level="12.7" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#residual-analysis"><i class="fa fa-check"></i><b>12.7</b> Residual analysis</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html"><i class="fa fa-check"></i><b>13</b> Describing Continuous-Time Event Occurrence Data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#a-framework-for-characterizing-the-distribution-of-continuous-time-event-data"><i class="fa fa-check"></i><b>13.1</b> A framework for characterizing the distribution of continuous-time event data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#salient-features-of-continuous-time-event-occurrence-data."><i class="fa fa-check"></i><b>13.1.1</b> Salient features of continuous-time event occurrence data.</a></li>
<li class="chapter" data-level="13.1.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-survivor-function."><i class="fa fa-check"></i><b>13.1.2</b> The survivor function.</a></li>
<li class="chapter" data-level="13.1.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-hazard-function."><i class="fa fa-check"></i><b>13.1.3</b> The hazard function.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#grouped-methods-for-estimating-continuous-time-survivor-and-hazard-functions"><i class="fa fa-check"></i><b>13.2</b> Grouped methods for estimating continuous-time survivor and hazard functions</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#constructing-a-grouped-life-table."><i class="fa fa-check"></i><b>13.2.1</b> Constructing a grouped life table.</a></li>
<li class="chapter" data-level="13.2.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-discrete-time-method."><i class="fa fa-check"></i><b>13.2.2</b> The discrete-time method.</a></li>
<li class="chapter" data-level="13.2.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-actuarial-method."><i class="fa fa-check"></i><b>13.2.3</b> The actuarial method.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-kaplan-meier-method-of-estimating-the-continuous-time-survivor-function"><i class="fa fa-check"></i><b>13.3</b> The Kaplan-Meier method of estimating the continuous-time survivor function</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#fitting-a-bayesian-kaplan-meier-model"><i class="fa fa-check"></i><b>13.3.1</b> Fitting a Bayesian Kaplan-Meier model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-cumulative-hazard-function"><i class="fa fa-check"></i><b>13.4</b> The cumulative hazard function</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#understanding-the-meaning-of-cumulative-hazard."><i class="fa fa-check"></i><b>13.4.1</b> Understanding the meaning of cumulative hazard.</a></li>
<li class="chapter" data-level="13.4.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#estimating-the-cumulative-hazard-function."><i class="fa fa-check"></i><b>13.4.2</b> Estimating the cumulative hazard function.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#kernel-smoothed-estimates-of-the-hazard-function"><i class="fa fa-check"></i><b>13.5</b> Kernel-smoothed estimates of the hazard function</a></li>
<li class="chapter" data-level="13.6" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#developing-an-intuition-about-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions"><i class="fa fa-check"></i><b>13.6</b> Developing an intuition about continuous-time survivor, cumulative hazard, and kernel-smoothed hazard functions</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#bonus-bayesians-can-compare-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions-too."><i class="fa fa-check"></i><b>13.6.1</b> Bonus: Bayesians can compare continuous-time survivor, cumulative hazard, and kernel-smoothed hazard functions, too.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Applied longitudinal data analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-discontinuous-and-nonlinear-change" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Modeling Discontinuous and Nonlinear Change</h1>
<blockquote>
<p>All the multilevel models for change presented so far assume that individual growth is smooth and linear. Yet individual change can also be discontinuous or nonlinear…</p>
<p>In this chapter, we introduce strategies for fitting models in which individual change is explicitly discontinuous or nonlinear. Rather than view these patterns as inconveniences, we treat them as substantively compelling opportunities. In doing so, we broaden our questions about the nature of change beyond the basic concepts of initial status and rate of change to a consideration of acceleration, deceleration, turning points, shifts, and asymptotes. The strategies that we use fall into two broad classes. <em>Empirical</em> strategies that let the “data speak for themselves.” Under this approach, you inspect observed growth records systematically and identify a transformation of the outcome, or of <em>TIME</em>, that linearizes the individual change trajectory. Unfortunately, this approach can lead to interpretive difficulties, especially if it involves esoteric transformations or higher order polynomials. Under <em>rational</em> strategies, on the other hand, you use theory to hypothesize a substantively meaningful functional form for the individual change trajectory. Although rational strategies generally yield clearer interpretations, their dependence on good theory makes them somewhat more difficult to develop and apply. <span class="citation">(<a href="references.html#ref-singerAppliedLongitudinalData2003" role="doc-biblioref">Singer &amp; Willett, 2003, pp. 189–190</a>, <em>emphasis</em> in the original)</span></p>
</blockquote>
<div id="discontinuous-individual-change" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Discontinuous individual change</h2>
<blockquote>
<p>Not all individual change trajectories are continuous functions of time…</p>
<p>If you have reason to believe that individual change trajectories might shift in elevation and/or slope, your level-1 model should reflect this hypothesis. Doing so allows you to test ideas about how the trajectory’s shape might change over time…</p>
<p>To postulate a discontinuous individual change trajectory, you need to know not just <em>why</em> the shift might occur but also <em>when</em>. This is because your level-1 individual growth model must include one (or more) time-varying predictor(s) that specify whether and if so, when each person experiences the hypothesized shift. (pp. 190–191, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="alternative-discontinuous-level-1-models-for-change." class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Alternative discontinuous level-1 models for change.</h3>
<blockquote>
<p>To postulate a discontinuous level-1 individual growth model, you must first decide on its functional form. Although you can begin empirically, we prefer to focus on substance and the longitudinal process that gave rise to the data. What kind of discontinuity might the precipitating event create? What would a plausible level-1 trajectory look like? Before parameterizing models and constructing variables, we suggest that you: (1) take a pen and paper and sketch some options; and (2) articulate–in words, not equations–the rationale for each. We recommend these steps because, as we demonstrate, the easiest models to specify may not display the type of discontinuity you expect to find. (pp. 191–192)</p>
</blockquote>
<p>I’ll leave the pen and paper scribbling to you. Here we load the <code>wages_pp.csv</code> data.</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb737-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb737-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb737-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb737-3" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/wages_pp.csv&quot;</span>)</span>
<span id="cb737-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb737-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb737-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb737-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(wages_pp)</span></code></pre></div>
<pre><code>## Rows: 6,402
## Columns: 15
## $ id            &lt;dbl&gt; 31, 31, 31, 31, 31, 31, 31, 31, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 53, 53, 53, 53…
## $ lnw           &lt;dbl&gt; 1.491, 1.433, 1.469, 1.749, 1.931, 1.709, 2.086, 2.129, 1.982, 1.798, 2.256, 2.573, 1.…
## $ exper         &lt;dbl&gt; 0.015, 0.715, 1.734, 2.773, 3.927, 4.946, 5.965, 6.984, 0.315, 0.983, 2.040, 3.021, 4.…
## $ ged           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0,…
## $ postexp       &lt;dbl&gt; 0.015, 0.715, 1.734, 2.773, 3.927, 4.946, 5.965, 6.984, 0.315, 0.983, 2.040, 3.021, 4.…
## $ black         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ hispanic      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,…
## $ hgc           &lt;dbl&gt; 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 7, 7, 7, 7, 7, 7, 7, 7, 12, 12, …
## $ hgc.9         &lt;dbl&gt; -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2, …
## $ uerate        &lt;dbl&gt; 3.215, 3.215, 3.215, 3.295, 2.895, 2.495, 2.595, 4.795, 4.895, 7.400, 7.400, 5.295, 4.…
## $ ue.7          &lt;dbl&gt; -3.785, -3.785, -3.785, -3.705, -4.105, -4.505, -4.405, -2.205, -2.105, 0.400, 0.400, …
## $ ue.centert1   &lt;dbl&gt; 0.000, 0.000, 0.000, 0.080, -0.320, -0.720, -0.620, 1.580, 0.000, 2.505, 2.505, 0.400,…
## $ ue.mean       &lt;dbl&gt; 3.2150, 3.2150, 3.2150, 3.2150, 3.2150, 3.2150, 3.2150, 3.2150, 5.0965, 5.0965, 5.0965…
## $ ue.person.cen &lt;dbl&gt; 0.0000, 0.0000, 0.0000, 0.0800, -0.3200, -0.7200, -0.6200, 1.5800, -0.2015, 2.3035, 2.…
## $ ue1           &lt;dbl&gt; 3.215, 3.215, 3.215, 3.215, 3.215, 3.215, 3.215, 3.215, 4.895, 4.895, 4.895, 4.895, 4.…</code></pre>
<p>Here’s a more focused look along the lines of Table 6.1.</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb739-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb739-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb739-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, lnw, exper, ged, postexp) <span class="sc">%&gt;%</span> </span>
<span id="cb739-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb739-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">ged by exper</span><span class="st">`</span> <span class="ot">=</span> ged <span class="sc">*</span> exper) <span class="sc">%&gt;%</span> </span>
<span id="cb739-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb739-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">206</span>, <span class="dv">2365</span>, <span class="dv">4384</span>))</span></code></pre></div>
<pre><code>## # A tibble: 22 x 6
##       id   lnw exper   ged postexp `ged by exper`
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;
##  1   206  2.03  1.87     0    0              0   
##  2   206  2.30  2.81     0    0              0   
##  3   206  2.48  4.31     0    0              0   
##  4  2365  1.78  0.66     0    0              0   
##  5  2365  1.76  1.68     0    0              0   
##  6  2365  1.71  2.74     0    0              0   
##  7  2365  1.74  3.68     0    0              0   
##  8  2365  2.19  4.68     1    0              4.68
##  9  2365  2.04  5.72     1    1.04           5.72
## 10  2365  2.32  6.72     1    2.04           6.72
## # … with 12 more rows</code></pre>
<p>Similar to what we did in Section 5.2.1, here is a visualization of the two primary variables, <code>exper</code> and <code>lnw</code>, for those three participants.</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb741-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">206</span>, <span class="dv">2365</span>, <span class="dv">4384</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb741-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">factor</span>(id)) <span class="sc">%&gt;%</span> </span>
<span id="cb741-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb741-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw)) <span class="sc">+</span></span>
<span id="cb741-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> id),</span>
<span id="cb741-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb741-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id)) <span class="sc">+</span></span>
<span id="cb741-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ged),</span>
<span id="cb741-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb741-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb741-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>, <span class="at">begin =</span> .<span class="dv">6</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb741-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Note&quot;</span>)<span class="sc">*</span><span class="st">&#39;. GED status is coded 0 = &quot;not yet&quot;, 1 = &quot;yes.&quot;&#39;</span>)) <span class="sc">+</span></span>
<span id="cb741-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb741-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb741-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Note how the time-varying predictor <code>ged</code> is depicted as either an <code>0</code> or a <code>1</code> in the center of the dots. Maybe we might describe that change as linear with the simple model <span class="math inline">\(\text{lnw}_{ij} = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \epsilon_{ij}\)</span>. Maybe a different model that included <code>ged</code> would be helpful.</p>
<p>In the data, <span class="math inline">\(n = 581\)</span> never got their GED’s, while <span class="math inline">\(n = 307\)</span> did.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb742-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb742-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb742-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb742-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb742-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">got_ged =</span> <span class="fu">sum</span>(ged) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb742-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb742-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(got_ged)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   got_ged     n
##   &lt;lgl&gt;   &lt;int&gt;
## 1 FALSE     581
## 2 TRUE      307</code></pre>
<p>However, those who did get their GED’s did so at different times. Here’s their distribution.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb744-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ged <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb744-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb744-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb744-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb744-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper)) <span class="sc">+</span></span>
<span id="cb744-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb744-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(The<span class="sc">~</span><span class="fu">italic</span>(timing)<span class="sc">~</span>of<span class="sc">~</span>the<span class="sc">~</span>GED<span class="sc">~</span>attainment<span class="sc">~</span>varies)) <span class="sc">+</span></span>
<span id="cb744-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb744-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-6-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Here’s another, more focused, look at the GED status for our three focal participants, over <code>exper</code>.</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb745-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, lnw, exper, ged, postexp) <span class="sc">%&gt;%</span> </span>
<span id="cb745-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">206</span>, <span class="dv">2365</span>, <span class="dv">4384</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb745-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">factor</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb745-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb745-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> ged)) <span class="sc">+</span></span>
<span id="cb745-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> id),</span>
<span id="cb745-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb745-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb745-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>)) <span class="sc">+</span></span>
<span id="cb745-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>, <span class="at">begin =</span> .<span class="dv">6</span>, <span class="at">end =</span> .<span class="dv">9</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb745-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb745-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb745-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb745-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>One might wonder: “How might GED receipt affect individual <span class="math inline">\(i\)</span>’s wage trajectory?” (p. 193). Here we reproduce Figure 6.1, which entertains four possibilities.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb746-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">ged   =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb746-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb746-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">nesting</span>(exper, ged)) <span class="sc">%&gt;%</span> </span>
<span id="cb746-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exper2 =</span> <span class="fu">if_else</span>(ged <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, exper <span class="sc">-</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb746-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnw =</span> <span class="fu">case_when</span>(</span>
<span id="cb746-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-7" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;a&quot;</span> <span class="sc">~</span> <span class="fl">1.60</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper,</span>
<span id="cb746-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-8" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;b&quot;</span> <span class="sc">~</span> <span class="fl">1.65</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> ged,</span>
<span id="cb746-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-9" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;c&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> exper2 <span class="sc">*</span> ged,</span>
<span id="cb746-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-10" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;d&quot;</span> <span class="sc">~</span> <span class="fl">1.85</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> ged <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> exper <span class="sc">*</span> ged</span>
<span id="cb746-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb746-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">fct_rev</span>(model)) <span class="sc">%&gt;%</span> </span>
<span id="cb746-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb746-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw)) <span class="sc">+</span></span>
<span id="cb746-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> model),</span>
<span id="cb746-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb746-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>, <span class="at">begin =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">end =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb746-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb746-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb746-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-8-1.png" width="384" style="display: block; margin: auto;" /></p>
<div id="including-a-discontinuity-in-elevation-not-slope." class="section level4" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Including a discontinuity in elevation, not slope.</h4>
<p>We can write the level-1 formula for when there is a change in elevation, but not slope, as</p>
<p><span class="math display">\[
\text{lnw}_{ij} = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} \text{ged}_{ij} + \epsilon_{ij}.
\]</span></p>
<p>Because we are equating <code>ged</code> values as relating to the intercept, but not the slope, it might be helpful to rewrite that formula as</p>
<p><span class="math display">\[
\text{lnw}_{ij} = (\pi_{0i} + \pi_{2i} \text{ged}_{ij}) + \pi_{1i} \text{exper}_{ij} + \epsilon_{ij},
\]</span></p>
<p>where the portion inside of the parentheses concerns initial status and discontinuity in elevation, but not slope. Because the <code>ged</code> values only come in 0’s and 1’s, we can express the two versions of this equation as</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = [\pi_{0i} + \pi_{2i} (0)] + \pi_{1i} \text{exper}_{ij} + \epsilon_{ij} \;\;\; \text{and} \\
                &amp; = [\pi_{0i} + \pi_{2i} (1)] + \pi_{1i} \text{exper}_{ij} + \epsilon_{ij}.
\end{align*}
\]</span></p>
<p>In other words, whereas the pre-GED intercept is <span class="math inline">\(\pi_{0i}\)</span>, the post-GED intercept is <span class="math inline">\(\pi_{0i} + \pi_{2i}\)</span>. To get a better sense of this, we might make a version of the upper left panel of Figure 6.2. Since we’ll be making four of these over the next few sections, we might reduce the redundancies in the code by makign a custom plotting function. We’ll call it <code>plot_figure_6.2()</code>.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-1" aria-hidden="true" tabindex="-1"></a>plot_figure_6<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping, </span>
<span id="cb747-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sizes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), </span>
<span id="cb747-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">linetypes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb747-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-4" aria-hidden="true" tabindex="-1"></a>                            ...) {</span>
<span id="cb747-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb747-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, mapping) <span class="sc">+</span></span>
<span id="cb747-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size =</span> model, <span class="at">linetype =</span> model)) <span class="sc">+</span></span>
<span id="cb747-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb747-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">hjust =</span> hjust),</span>
<span id="cb747-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb747-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> arrow,</span>
<span id="cb747-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-12" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xend =</span> xend, <span class="at">yend =</span> yend),</span>
<span id="cb747-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.075</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb747-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb747-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values =</span> sizes) <span class="sc">+</span></span>
<span id="cb747-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> linetypes) <span class="sc">+</span></span>
<span id="cb747-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb747-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="fl">1.6</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb747-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">2.4</span>)) <span class="sc">+</span></span>
<span id="cb747-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb747-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb747-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb747-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb747-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we have our custom plotting function, let’s take it for a spin.</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb748-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="fl">7.5</span>, <span class="fl">7.5</span>, <span class="dv">1</span>),</span>
<span id="cb748-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.24</span>, <span class="fl">2.2</span>, <span class="fl">1.82</span>, <span class="fl">1.78</span>, <span class="fl">1.62</span>),</span>
<span id="cb748-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Common~rate~of~change&quot;</span>,</span>
<span id="cb748-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Pre-Post~GED~(pi[1][italic(i)])&quot;</span>,</span>
<span id="cb748-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Elevation~differential&quot;</span>,</span>
<span id="cb748-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;on~GED~receipt~(pi[2][italic(i)])&quot;</span>,</span>
<span id="cb748-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;italic(LNW)~at~labor~force~entry~(pi[0][italic(i)])&quot;</span>),</span>
<span id="cb748-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>))</span>
<span id="cb748-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb748-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-11" aria-hidden="true" tabindex="-1"></a>arrow <span class="ot">&lt;-</span></span>
<span id="cb748-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">2.85</span>, <span class="fl">5.2</span>, <span class="fl">5.5</span>, <span class="fl">1.7</span>),</span>
<span id="cb748-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">6.8</span>, <span class="fl">3.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb748-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.18</span>, <span class="fl">2.18</span>, <span class="fl">1.8</span>, <span class="fl">1.64</span>),</span>
<span id="cb748-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend  =</span> <span class="fu">c</span>(<span class="fl">1.84</span>, <span class="fl">2.08</span>, <span class="fl">1.9</span>, <span class="fl">1.74</span>))</span>
<span id="cb748-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb748-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb748-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb748-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">ged   =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb748-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb748-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-21" aria-hidden="true" tabindex="-1"></a>         <span class="fu">nesting</span>(exper, ged)) <span class="sc">%&gt;%</span> </span>
<span id="cb748-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exper2 =</span> <span class="fu">if_else</span>(ged <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, exper <span class="sc">-</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb748-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnw =</span> <span class="fu">case_when</span>(</span>
<span id="cb748-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-24" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;a&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper,</span>
<span id="cb748-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-25" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;b&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> ged),</span>
<span id="cb748-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">fct_rev</span>(model)) <span class="sc">%&gt;%</span></span>
<span id="cb748-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb748-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_figure_6.2</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw))</span>
<span id="cb748-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb748-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb748-30" aria-hidden="true" tabindex="-1"></a>p1  </span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-10-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Worked like a dream!</p>
</div>
<div id="including-a-discontinuity-in-slope-not-elevation." class="section level4" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Including a discontinuity in slope, not elevation.</h4>
<blockquote>
<p>To specify a level-1 individual growth model that includes a discontinuity in slope, not elevation, you need a different time-varying predictor. Unlike GED, this predictor must clock the passage of time (like <em>EXPER</em>). But unlike <em>EXPER</em>, it must do so within only one of the two epochs (pre- or post-GED receipt). Adding a second temporal predictor allows each individual change trajectory to have two distinct slopes: one before the hypothesized discontinuity an another after. (p. 195, <em>emphasis</em> in the original)</p>
</blockquote>
<p>In the <code>wages_pp</code> data, <code>postexp</code> is this second variable. Here is how it compares to the other relevant variables.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb749-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb749-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb749-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, ged, exper, postexp) <span class="sc">%&gt;%</span> </span>
<span id="cb749-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb749-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">&gt;=</span> <span class="dv">53</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6,384 x 4
##       id   ged exper postexp
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1    53     0 0.781   0    
##  2    53     0 0.943   0    
##  3    53     1 0.957   0    
##  4    53     1 1.04    0.08 
##  5    53     1 1.06    0.1  
##  6    53     1 1.11    0.152
##  7    53     1 1.18    0.227
##  8    53     1 1.78    0.82 
##  9   122     0 2.04    0    
## 10   122     0 2.64    0    
## # … with 6,374 more rows</code></pre>
<p>Singer and Willett then went on to report “construction of a suitable time-varying predictor to register the desired discontinuity is often the hardest part of the model specification” (p. 195). They weren’t kidding.</p>
<p>This concept caused me a good bit of frustration when learning about these models. Let’s walk through this slowly. In the last code block, we looked at four relevant variables. You may wonder why we executed <code>filter(id &gt;= 53)</code>. This is because the first two participants always had <code>ged == 1</code>. They’re valid cases and all, but those data won’t be immediately helpful for understanding what’s going on with <code>postexp</code>. Happily, the next case, <code>id == 53</code>, is perfect for our goal. First, notice how that person’s <code>postexp</code> values are always 0 when <code>ged == 0</code>. Second, notice how the first time where <code>ged == 1</code>, <code>postexp</code> is still a 0. Third, notice that after that first initial row, <code>postexp</code> increases. If you caught all that, go you!</p>
<p>To make the next point, it’ll come in handy to subset the data. Because we’re trying to understand the relationship between <code>exper</code> and <code>postesp</code> conditional on <code>ged</code>, cases for which <code>ged</code> is always the same will be of little use. Let’s drop them.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-1" aria-hidden="true" tabindex="-1"></a>wages_pp_subset <span class="ot">&lt;-</span></span>
<span id="cb751-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-2" aria-hidden="true" tabindex="-1"></a>  wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb751-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb751-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">mean</span>(ged) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb751-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">mean</span>(ged) <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb751-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb751-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, ged, exper, postexp)</span>
<span id="cb751-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb751-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb751-9" aria-hidden="true" tabindex="-1"></a>wages_pp_subset</span></code></pre></div>
<pre><code>## # A tibble: 819 x 4
##       id   ged exper postexp
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1    53     0 0.781   0    
##  2    53     0 0.943   0    
##  3    53     1 0.957   0    
##  4    53     1 1.04    0.08 
##  5    53     1 1.06    0.1  
##  6    53     1 1.11    0.152
##  7    53     1 1.18    0.227
##  8    53     1 1.78    0.82 
##  9   134     0 0.192   0    
## 10   134     0 0.972   0    
## # … with 809 more rows</code></pre>
<p>What might not be obvious yet is <code>exper</code> and <code>postexp</code> scale together. To show how this works, we’ll make two new columns. First, we’ll mark the minimum <code>exper</code> value for each level of <code>id</code>. Then we’ll make a <code>exper - postexp</code> which is exactly what the name implies. Here’s what that looks like.</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb753-1" aria-hidden="true" tabindex="-1"></a>wages_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb753-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb753-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ged <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb753-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb753-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb753-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb753-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">min_exper         =</span> <span class="fu">min</span>(exper),</span>
<span id="cb753-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb753-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">exper - postexp</span><span class="st">`</span> <span class="ot">=</span> exper <span class="sc">-</span> postexp)</span></code></pre></div>
<pre><code>## # A tibble: 525 x 6
## # Groups:   id [107]
##       id   ged exper postexp min_exper `exper - postexp`
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt;
##  1    53     1 0.957   0         0.957             0.957
##  2    53     1 1.04    0.08      0.957             0.957
##  3    53     1 1.06    0.1       0.957             0.957
##  4    53     1 1.11    0.152     0.957             0.958
##  5    53     1 1.18    0.227     0.957             0.958
##  6    53     1 1.78    0.82      0.957             0.957
##  7   134     1 3.92    0         3.92              3.92 
##  8   134     1 4.64    0.72      3.92              3.92 
##  9   134     1 5.64    1.72      3.92              3.92 
## 10   134     1 6.75    2.84      3.92              3.92 
## # … with 515 more rows</code></pre>
<p>Huh. For each case, the <code>min_exper</code> value is (near)identical with <code>exper - postexp</code>. The reason they’re not always identical is simply rounding error. Had we computed them by hand without rounding, they would always be the same. This relationship is the consequence of our having coded <code>postexp == 0</code> the very first time <code>ged == 1</code>, but allowed it to linearly increase afterward. Within each level of <code>id</code>–and conditional on <code>ged == 1</code>–, the way it increases is simply <code>exper – min(exper)</code>. Here’s that value.</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb755-1" aria-hidden="true" tabindex="-1"></a>wages_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb755-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb755-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ged <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb755-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb755-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb755-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb755-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">min_exper         =</span> <span class="fu">min</span>(exper),</span>
<span id="cb755-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb755-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">exper - postexp</span><span class="st">`</span> <span class="ot">=</span> exper <span class="sc">-</span> postexp) <span class="sc">%&gt;%</span> </span>
<span id="cb755-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb755-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">exper - min_exper</span><span class="st">`</span> <span class="ot">=</span> exper <span class="sc">-</span> min_exper)</span></code></pre></div>
<pre><code>## # A tibble: 525 x 7
## # Groups:   id [107]
##       id   ged exper postexp min_exper `exper - postexp` `exper - min_exper`
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt;               &lt;dbl&gt;
##  1    53     1 0.957   0         0.957             0.957              0     
##  2    53     1 1.04    0.08      0.957             0.957              0.0800
##  3    53     1 1.06    0.1       0.957             0.957              0.100 
##  4    53     1 1.11    0.152     0.957             0.958              0.153 
##  5    53     1 1.18    0.227     0.957             0.958              0.228 
##  6    53     1 1.78    0.82      0.957             0.957              0.82  
##  7   134     1 3.92    0         3.92              3.92               0     
##  8   134     1 4.64    0.72      3.92              3.92               0.720 
##  9   134     1 5.64    1.72      3.92              3.92               1.72  
## 10   134     1 6.75    2.84      3.92              3.92               2.84  
## # … with 515 more rows</code></pre>
<p>See? Our new <code>exper - min_exper</code> column is the same, within rounding error, as <code>postexp</code>.</p>
<blockquote>
<p>A fundamental feature of <em>POSTEXP</em>–indeed, any temporal predictor designed to register a shift in slope–is that the difference between each non-zero pair of consecutive values must be numerically identical to the difference between the corresponding pair of values for the basic predictor (here, <em>EXPER</em>). (p. 197, <em>emphasis</em> in the original)</p>
</blockquote>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb757-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb757-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">mean</span>(ged) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">mean</span>(ged) <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb757-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb757-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(exper, postexp),</span>
<span id="cb757-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;temporal predictor&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb757-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">&lt;</span> <span class="dv">250</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb757-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb757-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> lnw)) <span class="sc">+</span></span>
<span id="cb757-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">`</span><span class="at">temporal predictor</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">`</span><span class="at">temporal predictor</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb757-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">begin =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">end =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb757-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>, .<span class="dv">25</span>),</span>
<span id="cb757-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb757-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb757-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>id, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>See how those two scale together within each level of <code>id</code>?</p>
<p>All of this work is a setup for the level-1 equation</p>
<p><span class="math display">\[
\text{lnw}_{ij} = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{3i} \text{postexp}_{ij} + \epsilon_{ij},
\]</span></p>
<p>where <span class="math inline">\(\pi_{0i}\)</span> is the only intercept parameter and <span class="math inline">\(\pi_{1i}\)</span> and <span class="math inline">\(\pi_{3i}\)</span> are two slope parameters. Singer and Willett explained</p>
<blockquote>
<p>each slope assesses the effect of work experience, but it does so from a different origin: (1) <span class="math inline">\(\pi_{1i}\)</span> captures the effects of <em>total</em> work experience (measured from labor force entry); and (2) <span class="math inline">\(\pi_{3i}\)</span> captures the <em>added</em> effect of post-GED work experience (measured from GED receipt). (p. 197, <em>emphasis</em> in the original)</p>
</blockquote>
<p>To get a sense of what this looks like, here’s our version of the upper right panel of Figure 6.2.</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb758-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb758-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.24</span>, <span class="fl">2.2</span>, <span class="dv">2</span>, <span class="fl">1.96</span>, <span class="fl">1.62</span>),</span>
<span id="cb758-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Slope~differential&quot;</span>,</span>
<span id="cb758-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Pre-Post~GED~(pi[3][italic(i)])&quot;</span>,</span>
<span id="cb758-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Rate~of~change&quot;</span>,</span>
<span id="cb758-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Pre~GED~(pi[1][italic(i)])&quot;</span>,</span>
<span id="cb758-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;italic(LNW)~at~labor~force~entry~(pi[0][italic(i)])&quot;</span>),</span>
<span id="cb758-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb758-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb758-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-11" aria-hidden="true" tabindex="-1"></a>arrow <span class="ot">&lt;-</span></span>
<span id="cb758-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">1.7</span>, <span class="fl">1.7</span>),</span>
<span id="cb758-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend  =</span> <span class="fu">c</span>(<span class="fl">9.1</span>, <span class="fl">1.7</span>, <span class="fl">0.05</span>),</span>
<span id="cb758-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.18</span>, <span class="fl">1.93</span>, <span class="fl">1.64</span>),</span>
<span id="cb758-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend  =</span> <span class="fu">c</span>(<span class="fl">2.15</span>, <span class="fl">1.84</span>, <span class="fl">1.74</span>))</span>
<span id="cb758-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb758-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb758-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb758-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">ged   =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb758-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb758-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-21" aria-hidden="true" tabindex="-1"></a>         <span class="fu">nesting</span>(exper, ged)) <span class="sc">%&gt;%</span> </span>
<span id="cb758-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">postexp =</span> <span class="fu">ifelse</span>(exper <span class="sc">==</span> <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb758-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnw =</span> <span class="fu">case_when</span>(</span>
<span id="cb758-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-24" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;a&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper,</span>
<span id="cb758-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-25" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;b&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.15</span> <span class="sc">*</span> postexp),</span>
<span id="cb758-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">fct_rev</span>(model)) <span class="sc">%&gt;%</span></span>
<span id="cb758-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb758-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_figure_6.2</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw)) <span class="sc">+</span></span>
<span id="cb758-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;curve&quot;</span>,</span>
<span id="cb758-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">8.5</span>, <span class="at">xend =</span> <span class="fl">8.8</span>,</span>
<span id="cb758-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">2.195</span>, <span class="at">yend =</span> <span class="fl">2.109</span>,</span>
<span id="cb758-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">ends =</span> <span class="st">&quot;both&quot;</span>),</span>
<span id="cb758-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.85</span>)</span>
<span id="cb758-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb758-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb758-35" aria-hidden="true" tabindex="-1"></a>p2  </span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-16-1.png" width="336" style="display: block; margin: auto;" /></p>
</div>
<div id="including-discontinuities-in-both-elevation-and-slope." class="section level4" number="6.1.1.3">
<h4><span class="header-section-number">6.1.1.3</span> Including discontinuities in both elevation and slope.</h4>
<p>There are (at least) two ways to do this. They are similar, but not identical. The first is an extension of the model from the last subsection where we retain <code>postexp</code> from our second slope parameter. We can express this as the equation</p>
<p><span class="math display">\[
\text{lnw}_{ij} = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} \text{ged}_{ij} + \pi_{3i} \text{postexp}_{ij} + \epsilon_{ij}.
\]</span></p>
<p>For those without a GED, the equation reduces to</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} (0) + \pi_{3i} (0) + \epsilon_{ij} \\
                &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \epsilon_{ij}.
\end{align*}
\]</span></p>
<p>Once people secure their GED, <span class="math inline">\(\pi_{2i}\)</span> is always multiplied by 1 (i.e., $_{2i} (1) $) and the values by which we multiply <span class="math inline">\(\pi_{3i}\)</span> scale linearly with <code>exper</code>, but with the offset the way we discussed in the previous subsection. To emphasize that, we might rewrite the equation as</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} (1) + \pi_{3i} \text{postexp} + \epsilon_{ij} \\
                &amp; = (\pi_{0i} + \pi_{2i}) + \pi_{1i} \text{exper}_{ij} + \pi_{3i} \text{postexp} + \epsilon_{ij}.
\end{align*}
\]</span></p>
<p>To get a sense of what this looks like, here’s our version of the lower left panel of Figure 6.2.</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb759-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">7</span>),</span>
<span id="cb759-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.24</span>, <span class="fl">2.2</span>, <span class="dv">2</span>, <span class="fl">1.96</span>, <span class="fl">1.62</span>, <span class="fl">1.78</span>, <span class="fl">1.74</span>),</span>
<span id="cb759-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Slope~differential&quot;</span>,</span>
<span id="cb759-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Pre-Post~GED~(pi[3][italic(i)])&quot;</span>,</span>
<span id="cb759-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Rate~of~change&quot;</span>,</span>
<span id="cb759-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Pre~GED~(pi[1][italic(i)])&quot;</span>,</span>
<span id="cb759-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;italic(LNW)~at~labor~force~entry~(pi[0][italic(i)])&quot;</span>,</span>
<span id="cb759-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Constant~elevation~differential&quot;</span>,</span>
<span id="cb759-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;on~GED~receipt~(pi[2][italic(i)])&quot;</span>),</span>
<span id="cb759-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>))</span>
<span id="cb759-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb759-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-13" aria-hidden="true" tabindex="-1"></a>arrow <span class="ot">&lt;-</span></span>
<span id="cb759-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">1.7</span>, <span class="fl">1.7</span>, <span class="dv">6</span>),</span>
<span id="cb759-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend  =</span> <span class="fu">c</span>(<span class="fl">9.1</span>, <span class="fl">1.7</span>, <span class="fl">0.05</span>, <span class="fl">3.1</span>),</span>
<span id="cb759-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.18</span>, <span class="fl">1.93</span>, <span class="fl">1.64</span>, <span class="fl">1.8</span>),</span>
<span id="cb759-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend  =</span> <span class="fu">c</span>(<span class="fl">2.15</span>, <span class="fl">1.84</span>, <span class="fl">1.74</span>, <span class="fl">1.885</span>))</span>
<span id="cb759-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb759-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-19" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb759-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb759-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">ged   =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb759-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb759-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-23" aria-hidden="true" tabindex="-1"></a>         <span class="fu">nesting</span>(exper, ged)) <span class="sc">%&gt;%</span> </span>
<span id="cb759-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">postexp =</span> <span class="fu">ifelse</span>(exper <span class="sc">==</span> <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb759-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnw =</span> <span class="fu">case_when</span>(</span>
<span id="cb759-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-26" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;a&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper,</span>
<span id="cb759-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-27" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;b&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> ged,</span>
<span id="cb759-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-28" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;c&quot;</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> ged <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> postexp),</span>
<span id="cb759-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">fct_rev</span>(model)) <span class="sc">%&gt;%</span></span>
<span id="cb759-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb759-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_figure_6.2</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw),</span>
<span id="cb759-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sizes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb759-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linetypes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb759-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;curve&quot;</span>,</span>
<span id="cb759-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">8.5</span>, <span class="at">xend =</span> <span class="fl">8.8</span>,</span>
<span id="cb759-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">2.185</span>, <span class="at">yend =</span> <span class="fl">2.125</span>,</span>
<span id="cb759-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">ends =</span> <span class="st">&quot;both&quot;</span>),</span>
<span id="cb759-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.85</span>)</span>
<span id="cb759-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb759-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb759-40" aria-hidden="true" tabindex="-1"></a>p3  </span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-17-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>The second way to include discontinuities in both elevation and slope replaces the <code>postexp</code> variable with an interaction between <code>exper</code> and <code>ged</code>. Here’s the equation:</p>
<p><span class="math display">\[
\text{lnw}_{ij} = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} \text{ged}_{ij} + \pi_{3i} (\text{exper}_{ij} \times \text{ged}_{ij}) + \epsilon_{ij}.
\]</span></p>
<p>For those without a GED, the equation simplifies to</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} (0) + \pi_{3i} (\text{exper}_{ij} \times 0) + \epsilon_{ij} \\
                &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \epsilon_{ij}.
\end{align*}
\]</span></p>
<p>Once a participant secures their GED, the equation changes to</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} (1) + \pi_{3i} (\text{exper}_{ij} \times 1) + \epsilon_{ij} \\
               &amp; = (\pi_{0i} + \pi_{2i}) + (\pi_{1i} + \pi_{3i}) \text{exper}_{ij} + \epsilon_{ij}.
\end{align*}
\]</span></p>
<p>So again, the two ways we might include discontinuities in both elevation and slope are</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} \text{ged}_{ij} + \pi_{3i} \text{postexp}_{ij} + \epsilon_{ij} &amp; \text{and} \\
\text{lnw}_{ij} &amp; = \pi_{0i} + \pi_{1i} \text{exper}_{ij} + \pi_{2i} \text{ged}_{ij} + \pi_{3i} (\text{exper}_{ij} \times \text{ged}_{ij}) + \epsilon_{ij}.
\end{align*}
\]</span></p>
<p>The <span class="math inline">\(\pi_{0i}\)</span> and <span class="math inline">\(\pi_{1i}\)</span> terms have the same meaning in both. Even though <span class="math inline">\(\pi_{3i}\)</span> is multiplied by different values in the two equations, it has the same interpretation: “it represents the increment (or decrement) of the slope in the post-GED epoch” (p. 200). However, the big difference is the behavior and interpretation for <span class="math inline">\(\pi_{2i}\)</span>. In the equation for the first approach, it “assesses the magnitude of the instantaneous increment (or decrement) associated with GED attainment” (p. 200). But in the equation for the second approach, “<span class="math inline">\(\pi_{2i}\)</span> assesses the magnitude of the increment (or decrement) associated with GED attainment at a particular–and not particularly meaningful–moment: the day of labor force entry” (p. 220, <em>emphasis</em> added). That is, whereas <span class="math inline">\(\pi_{2i}\)</span> has a fixed value for the first approach, its magnitude changes with time in the second.</p>
<p>To get a sense of what this looks like, here’s our version of the lower right panel of Figure 6.2.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb760-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb760-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.28</span>, <span class="fl">2.24</span>, <span class="fl">2.1</span>, <span class="fl">2.06</span>, <span class="fl">1.62</span>, <span class="fl">1.76</span>, <span class="fl">1.72</span>, <span class="fl">1.94</span>, <span class="fl">1.9</span>, <span class="fl">1.86</span>),</span>
<span id="cb760-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Slope~differential&quot;</span>,</span>
<span id="cb760-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Pre-Post~GED~(pi[3][italic(i)])&quot;</span>,</span>
<span id="cb760-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Rate~of~change&quot;</span>,</span>
<span id="cb760-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Pre~GED~(pi[1][italic(i)])&quot;</span>,</span>
<span id="cb760-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;italic(LNW)~at~labor~force~entry~(pi[0][italic(i)])&quot;</span>,</span>
<span id="cb760-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;GED~differential~at&quot;</span>,</span>
<span id="cb760-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;labor~force~entry~(pi[2][italic(i)])&quot;</span>,</span>
<span id="cb760-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Elevation~differential&quot;</span>,</span>
<span id="cb760-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-12" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;on~GED~receipt&quot;</span>,</span>
<span id="cb760-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;(pi[2][italic(i)]+pi[3][italic(i)]*italic(EXPER))&quot;</span>),</span>
<span id="cb760-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>))</span>
<span id="cb760-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb760-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-16" aria-hidden="true" tabindex="-1"></a>arrow <span class="ot">&lt;-</span></span>
<span id="cb760-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">1.7</span>, <span class="fl">1.7</span>, <span class="fl">4.9</span>, <span class="fl">6.2</span>),</span>
<span id="cb760-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend  =</span> <span class="fu">c</span>(<span class="fl">8.8</span>, <span class="fl">1.7</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">3.1</span>),</span>
<span id="cb760-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.22</span>, <span class="fl">2.03</span>, <span class="fl">1.64</span>, <span class="fl">1.745</span>, <span class="fl">1.9</span>),</span>
<span id="cb760-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend  =</span> <span class="fu">c</span>(<span class="fl">2.18</span>, <span class="fl">1.825</span>, <span class="fl">1.74</span>, <span class="fl">1.775</span>, <span class="fl">1.9</span>))</span>
<span id="cb760-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb760-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-22" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb760-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb760-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">point =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb760-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exper =</span> <span class="fu">ifelse</span>(point <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb760-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(point <span class="sc">==</span> <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">3</span>)),</span>
<span id="cb760-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">ged   =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb760-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnw =</span> <span class="fu">case_when</span>(</span>
<span id="cb760-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-29" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">%in%</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> ged <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> exper <span class="sc">*</span> ged,</span>
<span id="cb760-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-30" aria-hidden="true" tabindex="-1"></a>    model <span class="sc">==</span> <span class="st">&quot;d&quot;</span>            <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> ged)) <span class="sc">%&gt;%</span> </span>
<span id="cb760-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb760-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_figure_6.2</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw),</span>
<span id="cb760-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sizes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb760-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linetypes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))  <span class="sc">+</span></span>
<span id="cb760-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;curve&quot;</span>,</span>
<span id="cb760-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">8.5</span>, <span class="at">xend =</span> <span class="fl">8.8</span>,</span>
<span id="cb760-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fl">2.205</span>, <span class="at">yend =</span> <span class="fl">2.145</span>,</span>
<span id="cb760-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">ends =</span> <span class="st">&quot;both&quot;</span>),</span>
<span id="cb760-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.85</span>)</span>
<span id="cb760-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb760-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb760-41" aria-hidden="true" tabindex="-1"></a>p4</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-18-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>You may have noticed we’ve been saving the various subplot panels as objects. Here we combine them to make the full version of Figure 6.2.</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb761-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb761-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb761-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb761-3" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Glorious.</p>
</div>
</div>
<div id="selecting-among-the-alternative-discontinuous-models." class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Selecting among the alternative discontinuous models.</h3>
<p>Our first model in this section will be a call back from the last chapter, <code>fit5.16</code>.</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb762-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb762-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-3" aria-hidden="true" tabindex="-1"></a><span class="co"># model a</span></span>
<span id="cb762-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-4" aria-hidden="true" tabindex="-1"></a>fit5<span class="fl">.16</span> <span class="ot">&lt;-</span></span>
<span id="cb762-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb762-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb762-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-7" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">|</span> id),</span>
<span id="cb762-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb762-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb762-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb762-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb762-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb762-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb762-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">5</span>,</span>
<span id="cb762-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb762-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit05.16&quot;</span>)</span></code></pre></div>
<p>Review the summary.</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb763-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit5<span class="fl">.16</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: lnw ~ 0 + Intercept + exper + hgc_9 + black:exper + uerate_7 + (1 + exper | id) 
##    Data: wages_pp (Number of observations: 6402) 
## Samples: 3 chains, each with iter = 2500; warmup = 1000; thin = 1;
##          total post-warmup samples = 4500
## 
## Group-Level Effects: 
## ~id (Number of levels: 888) 
##                      Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sd(Intercept)           0.224     0.011    0.203    0.245 1.001     1768     2591
## sd(exper)               0.040     0.003    0.035    0.045 1.005      574     1338
## cor(Intercept,exper)   -0.299     0.068   -0.425   -0.156 1.003      736     1710
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept      1.749     0.011    1.727    1.772 1.000     3293     3660
## exper          0.044     0.003    0.039    0.049 1.000     2947     3578
## hgc_9          0.040     0.006    0.028    0.053 1.001     2423     2782
## uerate_7      -0.012     0.002   -0.015   -0.008 1.000     5544     4052
## exper:black   -0.018     0.004   -0.027   -0.010 1.001     2889     3524
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma    0.308     0.003    0.302    0.315 1.001     3162     2941
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Before we move forward with the next models, we’ll need to wrangle the data a bit. First, we rename <code>hgc.9</code> to the more <strong>tidyverse</strong>-centric <code>hgc_9</code>. Then we compute <code>uerate_7</code>, which is <code>uerate</code> centered on <code>7</code>.</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb765-1" aria-hidden="true" tabindex="-1"></a>wages_pp <span class="ot">&lt;-</span></span>
<span id="cb765-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb765-2" aria-hidden="true" tabindex="-1"></a>  wages_pp <span class="sc">%&gt;%</span> </span>
<span id="cb765-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb765-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">hgc_9 =</span> hgc<span class="fl">.9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb765-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb765-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">uerate_7 =</span> uerate <span class="sc">-</span> <span class="dv">7</span>)</span></code></pre></div>
<p>Our model A (<code>fit5.16</code>) and the rest of the models B through J (<code>fit6.1</code> through <code>fit6.9</code>) can all be thought of as variants of two parent models. The first parent model is model F (<code>fit6.5</code>), which follows the form</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = \gamma_{00} + \gamma_{01} (\text{hgc}_i - 9) \\
                &amp; \;\;\; + \gamma_{10} \text{exper}_{ij} + \gamma_{12} \text{black}_i \times \text{exper}_{ij} \\
                &amp; \;\;\; + \gamma_{20} (\text{uerate}_{ij} - 7) \\
                &amp; \;\;\; + \gamma_{30} \text{ged}_{ij} \\
                &amp; \;\;\; + \gamma_{40} \text{postexp}_{ij}\\
                &amp; \;\;\; + \zeta_{0i} + \zeta_{1i} \text{exper}_{ij} + \zeta_{3i} \text{ged}_{ij} + \zeta_{4i} \text{postexp}_{ij} + \epsilon_{ij}, \;\;\; \text{where} \\
\epsilon_{ij} &amp; \sim \operatorname{Normal}(0, \sigma_\epsilon) \\
\begin{bmatrix} 
\zeta_{0i} \\ \zeta_{1i} \\ \zeta_{3i} \\ \zeta_{4i}
\end{bmatrix} &amp; \sim \operatorname{Normal} 
\begin{pmatrix}
\begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \end{bmatrix},
\mathbf D \mathbf \Omega \mathbf D&#39;
\end{pmatrix} \\
\mathbf D &amp; = \begin{bmatrix} \sigma_0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma_1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; \sigma_3 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; \sigma_4 \end{bmatrix} \\ 
\mathbf\Omega &amp; = \begin{bmatrix} 1 &amp; \rho_{01} &amp; \rho_{03} &amp; \rho_{04} \\ 
\rho_{10} &amp; 1 &amp; \rho_{13} &amp; \rho_{14} \\ 
\rho_{30} &amp; \rho_{31} &amp; 1 &amp; \rho_{34} \\ 
\rho_{40} &amp; \rho_{41} &amp; \rho_{43} &amp;1 \end{bmatrix} \\
\gamma_{00} &amp; \sim \operatorname{Normal}(1.335, 1) \\
\gamma_{01}, \dots, \gamma_{40} &amp; \sim \operatorname{Normal}(0, 0.5) \\
\sigma_0, \dots, \sigma_4 &amp; \sim \operatorname{Student-t}(3, 0, 1) \\
\sigma_\epsilon &amp; \sim \operatorname{Student-t}(3, 0, 1) \\
\mathbf\Omega   &amp; \sim \operatorname{LKJ}(4),
\end{align*}
\]</span></p>
<p>which uses the <code>postexp</code>-based approach for discontinuity in slopes. Notice how we’re using the same basic prior specification as with <code>fit5.16</code>. The second parent model is model I (<code>fit6.8</code>), which follows the form</p>
<p><span class="math display">\[
\begin{align*}
\text{lnw}_{ij} &amp; = \gamma_{00} + \gamma_{01} (\text{hgc}_i - 9) \\
                &amp; \;\;\; + \gamma_{10} \text{exper}_{ij} + \gamma_{12} \text{black}_i \times \text{exper}_{ij} \\
                &amp; \;\;\; + \gamma_{20} (\text{uerate}_{ij} - 7) \\
                &amp; \;\;\; + \gamma_{30} \text{ged}_{ij} \\
                &amp; \;\;\; + \gamma_{50} \text{ged}_{ij} \times \text{exper}_{ij} \\
                &amp; \;\;\; + \zeta_{0i} + \zeta_{1i} \text{exper}_{ij} + \zeta_{3i} \text{ged}_{ij} + \zeta_{5i} \text{ged}_{ij} \times \text{exper}_{ij} + \epsilon_{ij}, \;\;\; \text{where} \\
\epsilon_{ij} &amp; \sim \operatorname{Normal}(0, \sigma_\epsilon) \\
\begin{bmatrix} 
\zeta_{0i} \\ \zeta_{1i} \\ \zeta_{3i} \\ \zeta_{5i}
\end{bmatrix} &amp; \sim \operatorname{Normal} 
\begin{pmatrix}
\begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \end{bmatrix},
\mathbf D \mathbf \Omega \mathbf D&#39;
\end{pmatrix} \\
\mathbf D &amp; = \begin{bmatrix} \sigma_0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma_1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; \sigma_3 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; \sigma_5 \end{bmatrix} \\ 
\mathbf\Omega &amp; = \begin{bmatrix} 1 &amp; \rho_{01} &amp; \rho_{03} &amp; \rho_{05} \\ 
\rho_{10} &amp; 1 &amp; \rho_{13} &amp; \rho_{15} \\ 
\rho_{30} &amp; \rho_{31} &amp; 1 &amp; \rho_{35} \\ 
\rho_{50} &amp; \rho_{51} &amp; \rho_{53} &amp;1 \end{bmatrix} \\
\gamma_{00} &amp; \sim \operatorname{Normal}(1.335, 1) \\
\gamma_{01}, \dots, \gamma_{50} &amp; \sim \operatorname{Normal}(0, 0.5) \\
\sigma_0, \dots, \sigma_5 &amp; \sim \operatorname{Student-t}(3, 0, 1) \\
\sigma_\epsilon &amp; \sim \operatorname{Student-t}(3, 0, 1) \\
\mathbf\Omega   &amp; \sim \operatorname{LKJ}(4).
\end{align*}
\]</span></p>
<p>which uses the <code>ged:exper</code>-based approach for discontinuity in slopes. Here we fit the models in bulk.</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model b</span></span>
<span id="cb766-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-2" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb766-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-5" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> ged <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">+</span> ged <span class="sc">|</span> id),</span>
<span id="cb766-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.01&quot;</span>)</span>
<span id="cb766-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-15" aria-hidden="true" tabindex="-1"></a><span class="co"># model c</span></span>
<span id="cb766-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-16" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb766-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-19" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> ged <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">|</span> id),</span>
<span id="cb766-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.02&quot;</span>)</span>
<span id="cb766-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-29" aria-hidden="true" tabindex="-1"></a><span class="co"># model d</span></span>
<span id="cb766-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-30" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb766-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-33" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> postexp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">+</span> postexp <span class="sc">|</span> id),</span>
<span id="cb766-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-35" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-36" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-37" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>),</span>
<span id="cb766-42"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.03&quot;</span>)</span>
<span id="cb766-43"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-44"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-44" aria-hidden="true" tabindex="-1"></a><span class="co"># model e</span></span>
<span id="cb766-45"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-45" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb766-46"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-47"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-48"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-48" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> postexp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">|</span> id),</span>
<span id="cb766-49"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-50"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-50" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-51"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-51" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-52"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-52" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-53"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-53" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-54"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-55"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-56"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.04&quot;</span>)</span>
<span id="cb766-57"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-58"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-58" aria-hidden="true" tabindex="-1"></a><span class="co"># model f</span></span>
<span id="cb766-59"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-59" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.5</span> <span class="ot">&lt;-</span></span>
<span id="cb766-60"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-61"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-62"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-62" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> ged <span class="sc">+</span> postexp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">+</span> ged <span class="sc">+</span> postexp <span class="sc">|</span> id),</span>
<span id="cb766-63"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-64"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-64" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-65"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-65" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-66"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-66" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-67"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-67" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-68"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-69"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-70"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.05&quot;</span>)</span>
<span id="cb766-71"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-72"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-72" aria-hidden="true" tabindex="-1"></a><span class="co"># model g</span></span>
<span id="cb766-73"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-73" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.6</span> <span class="ot">&lt;-</span></span>
<span id="cb766-74"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-75"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-76"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-76" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> ged <span class="sc">+</span> postexp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">+</span> ged <span class="sc">|</span> id),</span>
<span id="cb766-77"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-78"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-78" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-79"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-79" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-80"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-80" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-81"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-81" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-82"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-83"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-84"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.06&quot;</span>)</span>
<span id="cb766-85"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-86"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-86" aria-hidden="true" tabindex="-1"></a><span class="co"># model h</span></span>
<span id="cb766-87"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-87" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.7</span> <span class="ot">&lt;-</span></span>
<span id="cb766-88"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-89"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-90"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-90" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> ged <span class="sc">+</span> postexp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">+</span> postexp <span class="sc">|</span> id),</span>
<span id="cb766-91"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-92"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-92" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-93"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-93" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-94"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-94" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-95"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-95" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-96"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-97"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-98"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>),</span>
<span id="cb766-99"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.07&quot;</span>)</span>
<span id="cb766-100"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-101"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-101" aria-hidden="true" tabindex="-1"></a><span class="co"># model i</span></span>
<span id="cb766-102"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-102" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.8</span> <span class="ot">&lt;-</span></span>
<span id="cb766-103"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-104"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-105"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-105" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> ged <span class="sc">+</span> ged<span class="sc">:</span>exper <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">+</span> ged <span class="sc">+</span> ged<span class="sc">:</span>exper <span class="sc">|</span> id),</span>
<span id="cb766-106"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-107"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-107" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-108"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-108" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-109"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-109" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-110"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-110" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-111"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-112"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-113"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>),</span>
<span id="cb766-114"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.08&quot;</span>)</span>
<span id="cb766-115"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb766-116"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-116" aria-hidden="true" tabindex="-1"></a><span class="co"># model j</span></span>
<span id="cb766-117"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-117" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.9</span> <span class="ot">&lt;-</span></span>
<span id="cb766-118"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> wages_pp, </span>
<span id="cb766-119"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb766-120"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-120" aria-hidden="true" tabindex="-1"></a>      lnw <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> exper <span class="sc">+</span> hgc_9 <span class="sc">+</span> black<span class="sc">:</span>exper <span class="sc">+</span> uerate_7 <span class="sc">+</span> ged <span class="sc">+</span> ged<span class="sc">:</span>exper <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> exper <span class="sc">+</span> ged <span class="sc">|</span> id),</span>
<span id="cb766-121"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.335</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb766-122"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-122" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb766-123"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-123" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb766-124"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-124" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb766-125"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-125" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb766-126"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb766-127"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb766-128"><a href="modeling-discontinuous-and-nonlinear-change.html#cb766-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.09&quot;</span>)</span></code></pre></div>
<p>To keep from cluttering up this ebook, I’m not going to show the summary <code>print()</code> output for <code>fit6.1</code> through <code>fit6.7</code>. If you go through that output yourself, you’ll see that several of them had low effective sample size estimates for one or a few of the <span class="math inline">\(\sigma\)</span> parameters. For our pedagogical purposes, I’m okay with moving forward with these. But do note that when fitting a model for your scientific or other real-world projects, make sure you attend to your effective sample size issues (i.e., extract more posterior draws, as needed, by adjusting the <code>warmup</code>, <code>iter</code>, and <code>chains</code> arguments).</p>
<p>Though we’re avoiding <code>print()</code> output, we might take a birds-eye perspective and summarize the parameters for our competing models with a faceted coefficient plot. First we extract and save the relevant information as an object, <code>post</code>, and then we wrangle and plot.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute</span></span>
<span id="cb767-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-2" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span></span>
<span id="cb767-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb767-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fit   =</span> <span class="fu">c</span>(<span class="st">&quot;fit5.16&quot;</span>, <span class="fu">str_c</span>(<span class="st">&quot;fit6.&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb767-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">map</span>(fit, <span class="sc">~</span><span class="fu">get</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb767-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">posterior_summary</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb767-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb767-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rownames_to_column</span>(<span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb767-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-9" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(parameter, <span class="st">&quot;r_id</span><span class="sc">\\</span><span class="st">[&quot;</span>) <span class="sc">&amp;</span> parameter <span class="sc">!=</span> <span class="st">&quot;lp__&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb767-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(p) </span>
<span id="cb767-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb767-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-12" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb767-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-13" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span> </span>
<span id="cb767-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">greek =</span> <span class="fu">case_when</span>(</span>
<span id="cb767-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-15" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_Intercept&quot;</span>   <span class="sc">~</span> <span class="st">&quot;gamma[0][0]&quot;</span>,</span>
<span id="cb767-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-16" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_hgc_9&quot;</span>       <span class="sc">~</span> <span class="st">&quot;gamma[0][1]&quot;</span>,</span>
<span id="cb767-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-17" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_exper&quot;</span>       <span class="sc">~</span> <span class="st">&quot;gamma[1][0]&quot;</span>,</span>
<span id="cb767-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-18" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_exper:black&quot;</span> <span class="sc">~</span> <span class="st">&quot;gamma[1][2]&quot;</span>,</span>
<span id="cb767-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-19" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_uerate_7&quot;</span>    <span class="sc">~</span> <span class="st">&quot;gamma[2][0]&quot;</span>,</span>
<span id="cb767-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-20" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_ged&quot;</span>         <span class="sc">~</span> <span class="st">&quot;gamma[3][0]&quot;</span>,</span>
<span id="cb767-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-21" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_postexp&quot;</span>     <span class="sc">~</span> <span class="st">&quot;gamma[4][0]&quot;</span>,</span>
<span id="cb767-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-22" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_exper:ged&quot;</span>   <span class="sc">~</span> <span class="st">&quot;gamma[5][0]&quot;</span>,</span>
<span id="cb767-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-23" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__Intercept&quot;</span> <span class="sc">~</span> <span class="st">&quot;sigma[0]&quot;</span>,</span>
<span id="cb767-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-24" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__exper&quot;</span>     <span class="sc">~</span> <span class="st">&quot;sigma[1]&quot;</span>,</span>
<span id="cb767-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-25" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__ged&quot;</span>       <span class="sc">~</span> <span class="st">&quot;sigma[3]&quot;</span>,</span>
<span id="cb767-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-26" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__postexp&quot;</span>   <span class="sc">~</span> <span class="st">&quot;sigma[4]&quot;</span>,</span>
<span id="cb767-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-27" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__exper:ged&quot;</span> <span class="sc">~</span> <span class="st">&quot;sigma[5]&quot;</span>,</span>
<span id="cb767-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-28" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sigma&quot;</span>            <span class="sc">~</span> <span class="st">&quot;sigma[epsilon]&quot;</span>,</span>
<span id="cb767-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-29" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__Intercept__exper&quot;</span>     <span class="sc">~</span> <span class="st">&quot;rho[0][1]&quot;</span>,</span>
<span id="cb767-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-30" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__Intercept__ged&quot;</span>       <span class="sc">~</span> <span class="st">&quot;rho[0][3]&quot;</span>,</span>
<span id="cb767-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-31" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__exper__ged&quot;</span>           <span class="sc">~</span> <span class="st">&quot;rho[1][3]&quot;</span>,</span>
<span id="cb767-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-32" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__Intercept__postexp&quot;</span>   <span class="sc">~</span> <span class="st">&quot;rho[0][4]&quot;</span>,</span>
<span id="cb767-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-33" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__Intercept__exper:ged&quot;</span> <span class="sc">~</span> <span class="st">&quot;rho[0][5]&quot;</span>,</span>
<span id="cb767-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-34" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__exper__postexp&quot;</span>       <span class="sc">~</span> <span class="st">&quot;rho[1][4]&quot;</span>,</span>
<span id="cb767-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-35" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__exper__exper:ged&quot;</span>     <span class="sc">~</span> <span class="st">&quot;rho[1][5]&quot;</span>,</span>
<span id="cb767-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-36" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__ged__postexp&quot;</span>         <span class="sc">~</span> <span class="st">&quot;rho[3][4]&quot;</span>,</span>
<span id="cb767-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-37" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__ged__exper:ged&quot;</span>       <span class="sc">~</span> <span class="st">&quot;rho[3][5]&quot;</span></span>
<span id="cb767-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-38" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb767-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">fct_rev</span>(model)) <span class="sc">%&gt;%</span> </span>
<span id="cb767-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb767-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb767-42"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb767-43"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb767-44"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Marginal posteriors for models a thorugh j&quot;</span>,</span>
<span id="cb767-45"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb767-46"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb767-47"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb767-48"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb767-49"><a href="modeling-discontinuous-and-nonlinear-change.html#cb767-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> greek, <span class="at">labeller =</span> label_parsed, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-22-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>For our model comparisons, let’s compute the WAIC estimates for each.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-1" aria-hidden="true" tabindex="-1"></a>fit5<span class="fl">.16</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit5<span class="fl">.16</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-2" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.1</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-3" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-4" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.3</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-5" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.4</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-6" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.5</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-7" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.6</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-8" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.7</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-9" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.8</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb768-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb768-10" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.9</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span></code></pre></div>
<p>On pages 202 through 204, Singer and Willett performed a number of model comparisons with deviance tests and the frequentist AIC and BIC. Here we do the analogous comparisons with WAIC difference estimates.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb769-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a vs b</span></span>
<span id="cb769-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb769-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit5<span class="fl">.16</span>, fit6<span class="fl">.1</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.1      0.0       0.0 -2030.4     103.9        881.9    27.7    4060.8   207.8
## fit5.16    -6.6       6.2 -2037.0     104.2        862.0    26.9    4073.9   208.3</code></pre>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b vs c</span></span>
<span id="cb771-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb771-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.1</span>, fit6<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.1     0.0       0.0 -2030.4     103.9        881.9    27.7    4060.8   207.8
## fit6.2    -2.9       4.9 -2033.3     103.8        863.4    26.8    4066.5   207.5</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb773-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a vs d</span></span>
<span id="cb773-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb773-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit5<span class="fl">.16</span>, fit6<span class="fl">.3</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.3      0.0       0.0 -2036.4     104.2        866.3    27.2    4072.8   208.3
## fit5.16    -0.5       2.6 -2037.0     104.2        862.0    26.9    4073.9   208.3</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="co"># d vs e</span></span>
<span id="cb775-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb775-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.3</span>, fit6<span class="fl">.4</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.4     0.0       0.0 -2036.4     104.1        862.5    27.0    4072.8   208.3
## fit6.3     0.0       1.7 -2036.4     104.2        866.3    27.2    4072.8   208.3</code></pre>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f vs b</span></span>
<span id="cb777-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb777-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.5</span>, fit6<span class="fl">.1</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.5     0.0       0.0 -2021.3     103.9        886.2    28.0    4042.5   207.8
## fit6.1    -9.1       3.7 -2030.4     103.9        881.9    27.7    4060.8   207.8</code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f vs d</span></span>
<span id="cb779-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb779-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.5</span>, fit6<span class="fl">.3</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.5     0.0       0.0 -2021.3     103.9        886.2    28.0    4042.5   207.8
## fit6.3   -15.1       7.2 -2036.4     104.2        866.3    27.2    4072.8   208.3</code></pre>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f vs g</span></span>
<span id="cb781-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb781-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.5</span>, fit6<span class="fl">.6</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.5     0.0       0.0 -2021.3     103.9        886.2    28.0    4042.5   207.8
## fit6.6    -9.0       3.6 -2030.3     104.0        882.1    27.8    4060.5   208.0</code></pre>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb783-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f vs h</span></span>
<span id="cb783-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb783-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.5</span>, fit6<span class="fl">.7</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.5     0.0       0.0 -2021.3     103.9        886.2    28.0    4042.5   207.8
## fit6.7   -10.6       6.2 -2031.9     104.0        866.1    27.1    4063.7   207.9</code></pre>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="co"># i vs b</span></span>
<span id="cb785-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb785-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.8</span>, fit6<span class="fl">.1</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.8     0.0       0.0 -2025.6     103.9        888.8    27.9    4051.1   207.7
## fit6.1    -4.8       2.6 -2030.4     103.9        881.9    27.7    4060.8   207.8</code></pre>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="co"># j vs i</span></span>
<span id="cb787-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb787-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.9</span>, fit6<span class="fl">.8</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.8     0.0       0.0 -2025.6     103.9        888.8    27.9    4051.1   207.7
## fit6.9    -2.2       2.6 -2027.8     103.7        879.6    27.6    4055.5   207.5</code></pre>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="co"># i vs f</span></span>
<span id="cb789-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb789-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.8</span>, fit6<span class="fl">.5</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.5     0.0       0.0 -2021.3     103.9        886.2    28.0    4042.5   207.8
## fit6.8    -4.3       2.6 -2025.6     103.9        888.8    27.9    4051.1   207.7</code></pre>
<p>We might also just look at all of the WAIC estimates, plus and minus their standard errors, in a coefficient plot.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit5<span class="fl">.16</span>, fit6<span class="fl">.1</span>, fit6<span class="fl">.2</span>, fit6<span class="fl">.3</span>, fit6<span class="fl">.4</span>, fit6<span class="fl">.5</span>, fit6<span class="fl">.6</span>, fit6<span class="fl">.7</span>, fit6<span class="fl">.8</span>, fit6<span class="fl">.9</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb791-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb791-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;fit&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb791-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb791-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()]) <span class="sc">%&gt;%</span> </span>
<span id="cb791-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb791-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> waic, <span class="at">xmin =</span> waic <span class="sc">-</span> se_waic, <span class="at">xmax =</span> waic <span class="sc">+</span> se_waic, <span class="at">y =</span> <span class="fu">reorder</span>(model, waic))) <span class="sc">+</span></span>
<span id="cb791-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb791-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(WAIC<span class="sc">%+-%</span>s.e.),</span>
<span id="cb791-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;model&quot;</span>) <span class="sc">+</span></span>
<span id="cb791-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb791-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb791-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-25-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In the text, model I had the lowest (best) deviance and information criteria values, with model F coming in a close second. Our WAIC results are the reverse. However, look at the widths of the standard error intervals, for each, relative to their point estimates. I wouldn’t get too upset about differences in our results versus those in the text. Our Bayesian models reveal there’s massive uncertainty in each estimate, an insight missing from the frequent analyses reported in the text.</p>
<p>Here’s a focused look at the parameter summary for model F.</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit6<span class="fl">.5</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: lnw ~ 0 + Intercept + exper + hgc_9 + black:exper + uerate_7 + ged + postexp + (1 + exper + ged + postexp | id) 
##    Data: wages_pp (Number of observations: 6402) 
## Samples: 3 chains, each with iter = 2500; warmup = 1000; thin = 1;
##          total post-warmup samples = 4500
## 
## Group-Level Effects: 
## ~id (Number of levels: 888) 
##                        Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sd(Intercept)             0.205     0.012    0.183    0.229 1.007      878     1046
## sd(exper)                 0.037     0.003    0.032    0.043 1.012      518     1218
## sd(ged)                   0.162     0.043    0.078    0.243 1.024      286      212
## sd(postexp)               0.039     0.013    0.012    0.063 1.044      139      233
## cor(Intercept,exper)     -0.227     0.089   -0.392   -0.041 1.015      538     1167
## cor(Intercept,ged)        0.186     0.206   -0.203    0.603 1.004      558     1039
## cor(exper,ged)           -0.045     0.247   -0.486    0.460 1.004      481      952
## cor(Intercept,postexp)   -0.410     0.192   -0.741   -0.002 1.005      717     1346
## cor(exper,postexp)       -0.093     0.243   -0.518    0.423 1.015      266      638
## cor(ged,postexp)         -0.301     0.231   -0.703    0.191 1.003      454      931
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept      1.739     0.012    1.715    1.763 1.000     3047     3597
## exper          0.041     0.003    0.036    0.047 1.001     2872     3443
## hgc_9          0.038     0.006    0.026    0.051 1.002     2573     3275
## uerate_7      -0.012     0.002   -0.015   -0.008 1.001     4814     3712
## ged            0.042     0.022   -0.001    0.086 1.000     3844     2855
## postexp        0.009     0.006   -0.002    0.020 1.001     4072     3805
## exper:black   -0.019     0.005   -0.029   -0.011 1.000     3234     3260
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma    0.307     0.003    0.301    0.313 1.001     3336     3118
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Before we dive into the <span class="math inline">\(\gamma\)</span>-based counterfactual trajectories of Figure 6.3, we might use a plot to get at sense of the <span class="math inline">\(\zeta\)</span>’s, as summarized by the <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\rho\)</span> parameters. Here we extract the <span class="math inline">\(\zeta\)</span>’s. Since there’s such a large number, we’ll focus on their posterior means.</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb794-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span></span>
<span id="cb794-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb794-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="st">`</span><span class="at">zeta[0]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ranef</span>(fit6<span class="fl">.5</span>)<span class="sc">$</span>id[, <span class="dv">1</span>, <span class="st">&quot;Intercept&quot;</span>],</span>
<span id="cb794-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb794-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">zeta[1]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ranef</span>(fit6<span class="fl">.5</span>)<span class="sc">$</span>id[, <span class="dv">1</span>, <span class="st">&quot;exper&quot;</span>],</span>
<span id="cb794-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb794-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">zeta[3]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ranef</span>(fit6<span class="fl">.5</span>)<span class="sc">$</span>id[, <span class="dv">1</span>, <span class="st">&quot;ged&quot;</span>],</span>
<span id="cb794-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb794-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">zeta[4]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ranef</span>(fit6<span class="fl">.5</span>)<span class="sc">$</span>id[, <span class="dv">1</span>, <span class="st">&quot;postexp&quot;</span>])</span>
<span id="cb794-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb794-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb794-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(r)</span></code></pre></div>
<pre><code>## Rows: 888
## Columns: 4
## $ `zeta[0]` &lt;dbl&gt; -0.148963272, 0.102569002, 0.056118132, 0.031371592, 0.161765504, -0.117642666, 0.01801627…
## $ `zeta[1]` &lt;dbl&gt; 0.0083486454, 0.0097289703, -0.0051474998, -0.0018623506, 0.0290523311, -0.0088984076, 0.0…
## $ `zeta[3]` &lt;dbl&gt; -1.051174e-01, 8.664920e-02, 8.728911e-02, 5.092634e-03, 3.416938e-02, -7.712996e-02, 2.15…
## $ `zeta[4]` &lt;dbl&gt; 0.0171956964, 0.0010991633, -0.0122369950, -0.0026658896, -0.0049689291, 0.0013584553, -0.…</code></pre>
<p>We’ll be plotting with help from the <a href="https://CRAN.R-project.org/package=GGally"><strong>GGally</strong> package</a> <span class="citation">(<a href="references.html#ref-R-GGally" role="doc-biblioref">Schloerke et al., 2020</a>)</span>, which does a nice job displaying a grid of bivariate plots via the <code>ggpairs()</code>. We’re going to get fancy with our <code>ggpairs()</code> plot by using a handful of custom settings. Here we save them as two functions.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-1" aria-hidden="true" tabindex="-1"></a>my_diag <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping, ...) {</span>
<span id="cb796-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="at">mapping =</span> mapping) <span class="sc">+</span> </span>
<span id="cb796-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb796-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb796-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span>
<span id="cb796-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb796-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-8" aria-hidden="true" tabindex="-1"></a>my_upper <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping, ...) {</span>
<span id="cb796-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="at">mapping =</span> mapping) <span class="sc">+</span> </span>
<span id="cb796-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb796-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb796-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span>
<span id="cb796-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb796-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now visualize the model F <span class="math inline">\(\zeta\)</span>’s with <code>GGally::ggpairs()</code>.</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb797-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb797-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb797-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb797-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb797-3" aria-hidden="true" tabindex="-1"></a>r <span class="sc">%&gt;%</span> </span>
<span id="cb797-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb797-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> my_upper),</span>
<span id="cb797-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb797-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> my_diag),</span>
<span id="cb797-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb797-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb797-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb797-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-30-1.png" width="456" style="display: block; margin: auto;" /></p>
<p>Now we’re ready to make our version of Figure 6.3. Since we will be expressing the uncertainty of our counterfactual trajectories with 95% interval bands, we’ll be faceting the plot by the two levels of <code>hgc_9</code>. Otherwise, the overplotting would become too much.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the new data</span></span>
<span id="cb798-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb798-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">black =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb798-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">hgc_9 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb798-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(black, hgc_9),</span>
<span id="cb798-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">exper =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">11</span>, <span class="at">by =</span> <span class="fl">0.02</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb798-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ged      =</span> <span class="fu">ifelse</span>(exper <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb798-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">postexp  =</span> <span class="fu">ifelse</span>(ged <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, exper <span class="sc">-</span> <span class="dv">3</span>),</span>
<span id="cb798-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">uerate_7 =</span> <span class="dv">0</span>)</span>
<span id="cb798-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb798-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the fitted draws</span></span>
<span id="cb798-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-12" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit6<span class="fl">.5</span>, </span>
<span id="cb798-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">re_formula =</span> <span class="cn">NA</span>,</span>
<span id="cb798-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb798-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb798-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb798-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb798-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race  =</span> <span class="fu">ifelse</span>(black <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;White/Latino&quot;</span>, <span class="st">&quot;Black&quot;</span>),</span>
<span id="cb798-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">hgc_9 =</span> <span class="fu">ifelse</span>(hgc_9 <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;9th grade dropouts&quot;</span>, <span class="st">&quot;12th grade dropouts&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb798-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race  =</span> <span class="fu">fct_rev</span>(race),</span>
<span id="cb798-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">hgc_9 =</span> <span class="fu">fct_rev</span>(hgc_9)) <span class="sc">%&gt;%</span> </span>
<span id="cb798-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb798-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb798-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb798-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> race, <span class="at">color =</span> race)) <span class="sc">+</span></span>
<span id="cb798-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb798-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb798-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb798-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb798-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb798-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;lnw&quot;</span>, <span class="at">breaks =</span> <span class="fl">1.6</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="fl">0.2</span>, </span>
<span id="cb798-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb798-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">2.4</span>)) <span class="sc">+</span></span>
<span id="cb798-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb798-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb798-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> hgc_9)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-31-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="further-extensions-of-the-discontinuous-growth-model." class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Further extensions of the discontinuous growth model.</h3>
<p>“It is easy to generalize these strategies to models with other discontinuities” (p. 206).</p>
<div id="dividing-time-into-multiple-phases." class="section level4" number="6.1.3.1">
<h4><span class="header-section-number">6.1.3.1</span> Dividing TIME into multiple phases.</h4>
<p>“You can divide <em>TIME</em> into <em>multiple</em> epochs, allowing the trajectories to differ in elevation (and perhaps slope) during each” (p. 206, <em>emphasis</em> in the original). With our examples, above, we divided time into two epochs: before and (possibly) after receipt of one’s GED. More possible epochs might after completing college or graduate school. All such epochs might influence intercepts and/or slopes (by either of the slope methods, above).</p>
</div>
<div id="discontinuities-at-common-points-in-time." class="section level4" number="6.1.3.2">
<h4><span class="header-section-number">6.1.3.2</span> Discontinuities at common points in time.</h4>
<blockquote>
<p>In some data sets, the timing of the discontinuity will not be person-specific; instead, everyone will experience the hypothesized transition at a common point in time. You can hypothesize a similar discontinuous change trajectory for such data sets by applying the strategies outlined above. (p. 207)</p>
</blockquote>
<p>Examples might include months, seasons, and academic quarters or semesters.</p>
</div>
</div>
</div>
<div id="using-transformations-to-model-nonlinear-individual-change" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Using transformations to model nonlinear individual change</h2>
<blockquote>
<p>When confronted by obviously nonlinear trajectories, we usually begin with the transformation approach for two reasons. First, a straight line–even on a transformed scale–is a simple mathematical form whose two parameters have clear interpretations. Second, because the metrics of many variables are ad hoc to begin with, transformation to another ad hoc scale may sacrifice little. (p. 208)</p>
</blockquote>
<p>As an example, consider <code>fit4.6</code> from back in Chapter 4.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-1" aria-hidden="true" tabindex="-1"></a>fit4<span class="fl">.6</span> <span class="ot">&lt;-</span></span>
<span id="cb799-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> alcohol1_pp, </span>
<span id="cb799-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb799-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-4" aria-hidden="true" tabindex="-1"></a>      alcuse <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> age_14 <span class="sc">+</span> coa <span class="sc">+</span> peer <span class="sc">+</span> age_14<span class="sc">:</span>peer <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> age_14 <span class="sc">|</span> id),</span>
<span id="cb799-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">class =</span> sd),</span>
<span id="cb799-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">class =</span> sigma),</span>
<span id="cb799-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">1</span>), <span class="at">class =</span> cor)),</span>
<span id="cb799-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb799-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb799-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb799-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit04.06&quot;</span>)</span></code></pre></div>
<p>In the <code>alcohol1_pp</code> data, the criterion <code>alcuse</code> was transformed by taking its square root. Since we fit a linear model on that transformed variable, our model is actually non-linear on the original metric of <code>alcuse</code>. To see, we’ll square the <code>fitted()</code>-based counterfactual trajectories and their intervals to make our version of Figure 6.4.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the new data</span></span>
<span id="cb800-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb800-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">coa  =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb800-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">peer =</span> <span class="fu">c</span>(.<span class="dv">655</span>, <span class="fl">1.381</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb800-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(coa, peer),</span>
<span id="cb800-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">age_14 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">30</span>))</span>
<span id="cb800-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb800-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the counterfactual trajectories</span></span>
<span id="cb800-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit4<span class="fl">.6</span>, </span>
<span id="cb800-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb800-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span></span>
<span id="cb800-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb800-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span></span>
<span id="cb800-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># transform the predictions by squaring them</span></span>
<span id="cb800-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Estimate =</span> Estimate<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb800-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">Q2.5     =</span> Q2<span class="fl">.5</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb800-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">Q97.5    =</span> Q97<span class="fl">.5</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb800-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a little wrangling will make plotting much easier</span></span>
<span id="cb800-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age  =</span> age_14 <span class="sc">+</span> <span class="dv">14</span>,</span>
<span id="cb800-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">coa  =</span> <span class="fu">ifelse</span>(coa <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;coa = 0&quot;</span>, <span class="st">&quot;coa = 1&quot;</span>),</span>
<span id="cb800-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">peer =</span> <span class="fu">factor</span>(peer)) <span class="sc">%&gt;%</span></span>
<span id="cb800-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb800-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb800-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">color =</span> peer, <span class="at">fill =</span> peer)) <span class="sc">+</span></span>
<span id="cb800-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb800-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb800-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">size =</span> peer)) <span class="sc">+</span></span>
<span id="cb800-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb800-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;red3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb800-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;red3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb800-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;alcuse&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb800-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;High peer values are in red; low ones are in blue.&quot;</span>) <span class="sc">+</span></span>
<span id="cb800-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">17</span>),</span>
<span id="cb800-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb800-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb800-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb800-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb800-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>coa)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-32-1.png" width="441.6" style="display: block; margin: auto;" /></p>
<p>Compare these to the linear trajectories depicted back in Figure 4.3c.</p>
<div id="the-ladder-of-transformations-and-the-rule-of-the-bulge." class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> The ladder of transformations and the rule of the bulge.</h3>
<p>I just not a fan of the “ladder of powers” idea and I’m not interested in reproducing Figure 6.5. However, we will make the next one, real quick. Load the <code>berkeley_pp</code> data.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb801-1" aria-hidden="true" tabindex="-1"></a>berkeley_pp <span class="ot">&lt;-</span> </span>
<span id="cb801-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb801-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&quot;data/berkeley_pp.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb801-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb801-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> age)</span>
<span id="cb801-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb801-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb801-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb801-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(berkeley_pp)</span></code></pre></div>
<pre><code>## Rows: 18
## Columns: 3
## $ age  &lt;dbl&gt; 5, 7, 9, 10, 11, 12, 13, 14, 15, 18, 21, 24, 27, 36, 42, 48, 54, 60
## $ iq   &lt;dbl&gt; 37, 65, 85, 88, 95, 101, 103, 107, 113, 121, 148, 161, 165, 187, 205, 218, 218, 228
## $ time &lt;dbl&gt; 5, 7, 9, 10, 11, 12, 13, 14, 15, 18, 21, 24, 27, 36, 42, 48, 54, 60</code></pre>
<p>Here’s how we might make Figure 6.6.</p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb803-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb803-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-3" aria-hidden="true" tabindex="-1"></a>  berkeley_pp <span class="sc">%&gt;%</span> </span>
<span id="cb803-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iq)) <span class="sc">+</span></span>
<span id="cb803-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb803-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">250</span>))</span>
<span id="cb803-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb803-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-8" aria-hidden="true" tabindex="-1"></a><span class="co"># middle</span></span>
<span id="cb803-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb803-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-10" aria-hidden="true" tabindex="-1"></a>  berkeley_pp <span class="sc">%&gt;%</span> </span>
<span id="cb803-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iq<span class="sc">^</span><span class="fl">2.3</span>)) <span class="sc">+</span></span>
<span id="cb803-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb803-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(iq<span class="sc">^</span>(<span class="fl">2.3</span>)), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">*</span> <span class="fl">5e4</span>, </span>
<span id="cb803-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3e5</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb803-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb803-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-16" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb803-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-17" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb803-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-18" aria-hidden="true" tabindex="-1"></a>  berkeley_pp <span class="sc">%&gt;%</span> </span>
<span id="cb803-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">2.3</span>), <span class="at">y =</span> iq)) <span class="sc">+</span></span>
<span id="cb803-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb803-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb803-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(time<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">2.3</span>)))</span>
<span id="cb803-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb803-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-24" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb803-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-25" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3) <span class="sc">&amp;</span></span>
<span id="cb803-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">&amp;</span></span>
<span id="cb803-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb803-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-34-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="representing-individual-change-using-a-polynomial-function-of-time" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Representing individual change using a polynomial function of TIME</h2>
<blockquote>
<p>We can also model curvilinear change by including several level-1 predictors that <em>collectively</em> represent a polynomial function of time. Although the resulting <em>polynomial growth model</em> can be cumbersome, it can capture an even wider array of complex patterns of change over time. (p. 213, <em>emphasis</em> in the original)</p>
</blockquote>
<p>To my eye, it will be easiest to make Table by dividing it up into columns, making each column individually, and then combining them on the back end. For our first step, here’s our first column, the “Shape” column.</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb804-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="dv">1</span>,</span>
<span id="cb804-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fl">9.5</span>,</span>
<span id="cb804-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;No</span><span class="sc">\n</span><span class="st">change&quot;</span>, <span class="st">&quot;Linear</span><span class="sc">\n</span><span class="st">change&quot;</span>, <span class="st">&quot;Quadratic</span><span class="sc">\n</span><span class="st">change&quot;</span>, <span class="st">&quot;Cubic</span><span class="sc">\n</span><span class="st">change&quot;</span>),</span>
<span id="cb804-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">row   =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb804-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">col   =</span> <span class="st">&quot;Shape&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb804-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb804-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb804-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.25</span>) <span class="sc">+</span></span>
<span id="cb804-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb804-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb804-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb804-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb804-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb804-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb804-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb804-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(row <span class="sc">~</span> col)</span></code></pre></div>
<p>For our second step, here’s the “Level-1 model” column.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb805-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb805-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">9.5</span>, <span class="fl">9.5</span>, <span class="fl">9.5</span>, <span class="fl">8.5</span>, <span class="fl">9.5</span>, <span class="fl">8.5</span>, <span class="fl">7.25</span>),</span>
<span id="cb805-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(Y[i][j])==pi[0][italic(i)]+epsilon[italic(ij)]&quot;</span>,</span>
<span id="cb805-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;italic(Y[i][j])==pi[0][italic(i)]+pi[1][italic(i)]*italic(TIME[ij])+epsilon[italic(ij)]&quot;</span>,</span>
<span id="cb805-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;italic(Y[i][j])==pi[0][italic(i)]+pi[1][italic(i)]*italic(TIME[ij])&quot;</span>,</span>
<span id="cb805-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;+pi[2][italic(i)]*italic(TIME[ij])^2+epsilon[italic(ij)]&quot;</span>,</span>
<span id="cb805-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;italic(Y[i][j])==pi[0][italic(i)]+pi[1][italic(i)]*italic(TIME[ij])&quot;</span>,</span>
<span id="cb805-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;+pi[2][italic(i)]*italic(TIME[ij])^2+pi[3][italic(i)]*italic(TIME[ij])^3&quot;</span>,</span>
<span id="cb805-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;+epsilon[italic(ij)]&quot;</span>),</span>
<span id="cb805-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">row   =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb805-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">col   =</span> <span class="st">&quot;Level-1 model&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb805-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb805-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb805-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.25</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb805-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb805-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb805-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb805-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb805-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb805-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb805-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb805-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(row <span class="sc">~</span> col)</span></code></pre></div>
<p>For our third step, here’s the “Parameter values” column.</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb806-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="dv">1</span>,</span>
<span id="cb806-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">9.5</span>, <span class="fl">9.5</span>, <span class="fl">8.5</span>, <span class="fl">9.5</span>, <span class="fl">8.5</span>, <span class="fl">7.5</span>, <span class="fl">9.5</span>, <span class="fl">8.5</span>, <span class="fl">7.5</span>, <span class="fl">6.5</span>),</span>
<span id="cb806-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;pi[0][italic(i)]==71&quot;</span>,</span>
<span id="cb806-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[0][italic(i)]==71&quot;</span>,</span>
<span id="cb806-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1][italic(i)]==1.2&quot;</span>,</span>
<span id="cb806-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[0][italic(i)]==50&quot;</span>,</span>
<span id="cb806-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1][italic(i)]==3.8&quot;</span>,</span>
<span id="cb806-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[2][italic(i)]==-0.03&quot;</span>,</span>
<span id="cb806-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[0][italic(i)]==30&quot;</span>,</span>
<span id="cb806-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1][italic(i)]==10&quot;</span>,</span>
<span id="cb806-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-12" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[2][italic(i)]==-0.2&quot;</span>,</span>
<span id="cb806-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[3][italic(i)]==0.0012&quot;</span>),</span>
<span id="cb806-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">row   =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">times =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb806-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">col   =</span> <span class="st">&quot;Parameter</span><span class="sc">\n</span><span class="st">values&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb806-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb806-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb806-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.25</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb806-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb806-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb806-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb806-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb806-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb806-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb806-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb806-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(row <span class="sc">~</span> col)</span></code></pre></div>
<p>We’ll do our fourth step in three stages. First, we’ll make and save four data sets, one for each of the plot panels. Second, we’ll combine those into a single data set, which we’ll wrangle a bit. Third, we’ll make the plots in the final column.</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the four small data sets</span></span>
<span id="cb807-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-2" aria-hidden="true" tabindex="-1"></a>pi0 <span class="ot">&lt;-</span> <span class="dv">71</span></span>
<span id="cb807-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-4" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb807-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> pi0)</span>
<span id="cb807-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-7" aria-hidden="true" tabindex="-1"></a>pi0 <span class="ot">&lt;-</span> <span class="dv">71</span></span>
<span id="cb807-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-8" aria-hidden="true" tabindex="-1"></a>pi1 <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb807-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-10" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb807-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> pi0 <span class="sc">+</span> pi1 <span class="sc">*</span> time) </span>
<span id="cb807-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-13" aria-hidden="true" tabindex="-1"></a>pi0 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb807-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-14" aria-hidden="true" tabindex="-1"></a>pi1 <span class="ot">&lt;-</span> <span class="fl">3.8</span></span>
<span id="cb807-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-15" aria-hidden="true" tabindex="-1"></a>pi2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.03</span></span>
<span id="cb807-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-17" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb807-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> pi0 <span class="sc">+</span> pi1 <span class="sc">*</span> time <span class="sc">+</span> pi2 <span class="sc">*</span> time<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb807-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-20" aria-hidden="true" tabindex="-1"></a>pi0 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb807-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-21" aria-hidden="true" tabindex="-1"></a>pi1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb807-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-22" aria-hidden="true" tabindex="-1"></a>pi2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.2</span></span>
<span id="cb807-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-23" aria-hidden="true" tabindex="-1"></a>pi3 <span class="ot">&lt;-</span> <span class="fl">0.0012</span></span>
<span id="cb807-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-25" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb807-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> pi0 <span class="sc">+</span> pi1 <span class="sc">*</span> time <span class="sc">+</span> pi2 <span class="sc">*</span> time<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> pi3 <span class="sc">*</span> time<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb807-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb807-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-28" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the data sets</span></span>
<span id="cb807-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-29" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb807-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(d1, d2, d3, d4) <span class="sc">%&gt;%</span> </span>
<span id="cb807-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb807-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">4</span>),</span>
<span id="cb807-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">&quot;Plot of the true change trajectory&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb807-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb807-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb807-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb807-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb807-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(TIME)), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb807-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">50</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb807-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(Y)), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb807-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">100</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">205</span>)) <span class="sc">+</span></span>
<span id="cb807-42"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb807-43"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb807-44"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb807-45"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb807-46"><a href="modeling-discontinuous-and-nonlinear-change.html#cb807-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(row <span class="sc">~</span> col)</span></code></pre></div>
<p>Now we’re finally ready to combine all the elements to make Table 6.4.</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb808-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3 <span class="sc">|</span> p4) <span class="sc">+</span></span>
<span id="cb808-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb808-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;A taxonomy of polynomial individual change trajectories&quot;</span>) <span class="sc">+</span></span>
<span id="cb808-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb808-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-39-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="the-shapes-of-polynomial-individual-change-trajectories." class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> The shapes of polynomial individual change trajectories.</h3>
<p>“The ‘no change’ and ‘linear change’ models are familiar; the remaining models, which contain quadratic and cubic functions of <em>TIME</em>, are new” (p. 213, <em>emphasis</em> in the original).</p>
<div id="no-change-trajectory." class="section level4" number="6.3.1.1">
<h4><span class="header-section-number">6.3.1.1</span> “No change” trajectory.</h4>
<blockquote>
<p>The “no change” trajectory is known as a polynomial function of “zero order” because <em>TIME</em> raised to the 0<sup>th</sup> power is 1 (i.e., <span class="math inline">\(TIME^0 = 1\)</span>). This model is tantamount to including a constant predictor, 1, in the level-1 model, as a multiplier of the sole individual growth parameter, the intercept, <span class="math inline">\(\pi_{0i}\)</span>… Even though each trajectory is flat, different individuals can have different intercepts and so a collection of true “no change” trajectories is a set of vertically scattered horizontal lines. (p. 215, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="linear-change-trajectory." class="section level4" number="6.3.1.2">
<h4><span class="header-section-number">6.3.1.2</span> “Linear change” trajectory.</h4>
<blockquote>
<p>The “linear change” trajectory is known as a “first order” polynomial in time because <em>TIME</em> raised to the 1<sup>st</sup> power equals <em>TIME</em> itself (i.e., <span class="math inline">\(TIME^1 = TIME\)</span>). Linear <em>TIME</em> is the sole predictor and the two individual growth parameters have the usual interpretations. (p. 215, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="quadratic-change-trajectory." class="section level4" number="6.3.1.3">
<h4><span class="header-section-number">6.3.1.3</span> “Quadratic change” trajectory.</h4>
<blockquote>
<p>Adding <span class="math inline">\(TIME^2\)</span> to a level-1 individual growth model that already includes linear <em>TIME</em> yields a second order polynomial for quadratic change. Unlike a level-1 model that includes only <span class="math inline">\(TIME^2\)</span>, a second order polynomial change trajectory includes two <em>TIME</em> predictors and three growth parameters (<span class="math inline">\(\pi_{0i}\)</span>, <span class="math inline">\(\pi_{1i}\)</span> and <span class="math inline">\(\pi_{2i}\)</span>). The first two parameters have interpretations that are <em>similar</em>, but not identical, to those in the linear change trajectory; the third is new. (p. 215, <em>emphasis</em> in the original)</p>
</blockquote>
<p>In this model, <span class="math inline">\(\pi_{0i}\)</span> is still the intercept. The <span class="math inline">\(\pi_{1i}\)</span> parameter is now the <em>instantaneous rate of change</em> when <span class="math inline">\(TIME = 0\)</span>. The new <span class="math inline">\(\pi_{2i}\)</span> parameter, sometimes called the <em>curvature</em> parameter, describes the change in the rate of change.</p>
</div>
<div id="higher-order-change-trajectories." class="section level4" number="6.3.1.4">
<h4><span class="header-section-number">6.3.1.4</span> Higher order change trajectories.</h4>
<p>“Adding higher powers of TIME increases the complexity of the polynomial trajectory” (p. 216).</p>
</div>
</div>
<div id="selecting-a-suitable-level-1-polynomial-trajectory-for-change." class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Selecting a suitable level-1 polynomial trajectory for change.</h3>
<p>It appears that both the <code>external_pp.csv</code> and <code>external_pp.txt</code> files within the <code>data</code> folder (<a href="https://github.com/ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse/tree/master/data">here</a>) are missing a few occasions. Happily, you can download a more complete version of the data from the good people at <a href="stats.idre.ucla.edu">stats.idre.ucla.edu</a>.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb809-1" aria-hidden="true" tabindex="-1"></a>external_pp <span class="ot">&lt;-</span> </span>
<span id="cb809-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb809-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="st">&quot;https://stats.idre.ucla.edu/wp-content/uploads/2020/01/external_pp.txt&quot;</span>, </span>
<span id="cb809-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb809-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb809-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb809-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb809-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb809-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(external_pp)</span></code></pre></div>
<pre><code>## Rows: 270
## Columns: 5
## $ id       &lt;int&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6…
## $ external &lt;int&gt; 50, 57, 51, 48, 43, 19, 4, 6, 3, 3, 5, 12, 0, 1, 9, 26, 10, 24, 14, 5, 18, 31, 31, 23, 26, …
## $ female   &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0…
## $ time     &lt;int&gt; 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0…
## $ grade    &lt;int&gt; 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1…</code></pre>
<p>There are data from 45 children.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb811-1" aria-hidden="true" tabindex="-1"></a>external_pp <span class="sc">%&gt;%</span> </span>
<span id="cb811-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb811-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb811-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb811-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 45</code></pre>
<p>The 45 kids were composed of 28 boys and 17 girls.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb813-1" aria-hidden="true" tabindex="-1"></a>external_pp <span class="sc">%&gt;%</span> </span>
<span id="cb813-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb813-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, female) <span class="sc">%&gt;%</span> </span>
<span id="cb813-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb813-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(female) <span class="sc">%&gt;%</span> </span>
<span id="cb813-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb813-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>##   female  n  percent
## 1      0 28 62.22222
## 2      1 17 37.77778</code></pre>
<p>The data were collected over the children’s first through sixth grades.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb815-1" aria-hidden="true" tabindex="-1"></a>external_pp <span class="sc">%&gt;%</span> </span>
<span id="cb815-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb815-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(grade)</span></code></pre></div>
<pre><code>##   grade
## 1     1
## 2     2
## 3     3
## 4     4
## 5     5
## 6     6</code></pre>
<p>Our criterion, <code>external</code>, is the sum of the 34 items in the Externalizing subscale of the Child Behavior Checklist. Each item is rated on a 3-point Likert-type scale, ranging from 0 (<em>rarely/never</em>) to 2 (<em>often</em>). The possible range for the sum score of the Externalizing subscale is 0 to 68. Here’s the overall distribution.</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb817-1" aria-hidden="true" tabindex="-1"></a>external_pp <span class="sc">%&gt;%</span> </span>
<span id="cb817-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb817-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> external)) <span class="sc">+</span></span>
<span id="cb817-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb817-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">boundary =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb817-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb817-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">68</span>) <span class="sc">+</span></span>
<span id="cb817-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb817-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-44-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The data are strongly bound to the left, which is a good thing in this case. We generally like it when our children exhibit fewer externalizing behaviors.</p>
<p>Figure 6.7 is based on a subset of the cases in the data. It might make our job easier if we just make a subset of the data, called <code>external_pp_subset</code>.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-1" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">34</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">26</span>)</span>
<span id="cb818-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-3" aria-hidden="true" tabindex="-1"></a>external_pp_subset <span class="ot">&lt;-</span></span>
<span id="cb818-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-4" aria-hidden="true" tabindex="-1"></a>  external_pp <span class="sc">%&gt;%</span> </span>
<span id="cb818-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> subset) <span class="sc">%&gt;%</span> </span>
<span id="cb818-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this is for the facets in the plot</span></span>
<span id="cb818-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">case =</span> <span class="fu">factor</span>(id,</span>
<span id="cb818-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> subset,</span>
<span id="cb818-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]))</span>
<span id="cb818-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb818-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb818-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(external_pp_subset)</span></code></pre></div>
<pre><code>## Rows: 48
## Columns: 6
## $ id       &lt;int&gt; 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 11, 11, 11, 11, 11, 11, 25, 25, 25, 25, 25, 25, 26, 26,…
## $ external &lt;int&gt; 50, 57, 51, 48, 43, 19, 9, 10, 9, 29, 21, 50, 11, 8, 4, 1, 0, 0, 11, 9, 9, 13, 10, 10, 19, …
## $ female   &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ time     &lt;int&gt; 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5, 0…
## $ grade    &lt;int&gt; 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1…
## $ case     &lt;fct&gt; A, A, A, A, A, A, B, B, B, B, B, B, C, C, C, C, C, C, D, D, D, D, D, D, H, H, H, H, H, H, E…</code></pre>
<p>Since the order of the polynomials in Figure 6.7 is tailored to each case, we’ll have to first build the subplots in pieces, and then combine then at the end. Make the pieces.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a and e</span></span>
<span id="cb820-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb820-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-3" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span>       <span class="co"># quartic</span></span>
<span id="cb820-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>),  <span class="co"># quadratic</span></span>
<span id="cb820-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb820-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, </span>
<span id="cb820-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span>
<span id="cb820-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-17" aria-hidden="true" tabindex="-1"></a><span class="co"># e</span></span>
<span id="cb820-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb820-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-19" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;E&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span>                <span class="co"># quartic</span></span>
<span id="cb820-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>),  <span class="co"># cubic</span></span>
<span id="cb820-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb820-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, </span>
<span id="cb820-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span>
<span id="cb820-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-33" aria-hidden="true" tabindex="-1"></a><span class="co"># b</span></span>
<span id="cb820-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-34" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb820-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-35" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span>       <span class="co"># quartic</span></span>
<span id="cb820-42"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>),  <span class="co"># quadratic</span></span>
<span id="cb820-43"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb820-44"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, </span>
<span id="cb820-45"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-46"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-47"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span>
<span id="cb820-48"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-49"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-49" aria-hidden="true" tabindex="-1"></a><span class="co"># f</span></span>
<span id="cb820-50"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-50" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb820-51"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-51" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-52"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-53"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-54"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-55"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-56"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-57"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># quartic</span></span>
<span id="cb820-58"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-59"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-60"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span>
<span id="cb820-61"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-62"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-62" aria-hidden="true" tabindex="-1"></a><span class="co"># c</span></span>
<span id="cb820-63"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-63" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb820-64"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-64" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-65"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-66"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-67"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-68"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-69"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-70"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-70" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># quartic</span></span>
<span id="cb820-71"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,      <span class="co"># linear</span></span>
<span id="cb820-72"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-72" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb820-73"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, </span>
<span id="cb820-74"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-74" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-75"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-76"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span>
<span id="cb820-77"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-78"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-78" aria-hidden="true" tabindex="-1"></a><span class="co"># g</span></span>
<span id="cb820-79"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-79" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb820-80"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-80" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-81"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;G&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-82"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-83"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-84"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-85"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-86"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-86" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span>       <span class="co"># quartic</span></span>
<span id="cb820-87"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>),  <span class="co"># quadratic</span></span>
<span id="cb820-88"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-88" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb820-89"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-90"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-91"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span>
<span id="cb820-92"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-93"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-93" aria-hidden="true" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb820-94"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-94" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb820-95"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-95" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-96"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-97"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-98"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-99"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-100"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-101"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-101" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># quartic</span></span>
<span id="cb820-102"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,      <span class="co"># linear</span></span>
<span id="cb820-103"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-103" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb820-104"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, </span>
<span id="cb820-105"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-105" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-106"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-107"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span>
<span id="cb820-108"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-109"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-109" aria-hidden="true" tabindex="-1"></a><span class="co"># h</span></span>
<span id="cb820-110"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-110" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb820-111"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-111" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb820-112"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(case <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;H&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb820-113"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb820-114"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb820-115"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-116"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb820-117"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-117" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># quartic</span></span>
<span id="cb820-118"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb820-119"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb820-120"><a href="modeling-discontinuous-and-nonlinear-change.html#cb820-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case)</span></code></pre></div>
<p>Now combine the subplots to make the full Figure 6.7.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb821-1" aria-hidden="true" tabindex="-1"></a>((p1 <span class="sc">/</span> p2) <span class="sc">|</span> (p3 <span class="sc">/</span> p4) <span class="sc">|</span> (p5 <span class="sc">/</span> p6) <span class="sc">|</span> (p7 <span class="sc">/</span> p8)) <span class="sc">&amp;</span></span>
<span id="cb821-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb821-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="sc">&amp;</span></span>
<span id="cb821-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb821-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-47-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="testing-higher-order-terms-in-a-polynomial-level-1-model." class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Testing higher order terms in a polynomial level-1 model.</h3>
<p>Let’s talk about priors, first focusing on the overall intercept <span class="math inline">\(\pi_{01}\)</span>. At the time of the original article by <span class="citation"><a href="references.html#ref-keiley2000cross" role="doc-biblioref">Margaret Kraatz Keiley et al.</a> (<a href="references.html#ref-keiley2000cross" role="doc-biblioref">2000</a>)</span>, it was known that boys tended to show more externalizing behaviors than girls, and that boys tend to either increase or remain fairly stable during primary school. Less was known about typical trajectories for girls. However, <span class="citation"><a href="references.html#ref-sandberg1991child" role="doc-biblioref">Sandberg et al.</a> (<a href="references.html#ref-sandberg1991child" role="doc-biblioref">1991</a>)</span> can give us a sense of what values are reasonable to center on. I their paper, they compared externalizing in two groups if children, broken down between boys and girls. From their second and third tables, we get the following descriptive statistics:</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-1" aria-hidden="true" tabindex="-1"></a>sample_statistics <span class="ot">&lt;-</span></span>
<span id="cb822-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">gender =</span> <span class="fu">c</span>(<span class="st">&quot;boys&quot;</span>, <span class="st">&quot;girls&quot;</span>),</span>
<span id="cb822-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">&quot;School&quot;</span>, <span class="st">&quot;CBCL Nonclinical&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb822-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n    =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">261</span>, <span class="dv">300</span>, <span class="dv">267</span>),</span>
<span id="cb822-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">c</span>(<span class="fl">10.8</span>, <span class="fl">14.5</span>, <span class="fl">10.7</span>, <span class="fl">16.6</span>),</span>
<span id="cb822-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd   =</span> <span class="fu">c</span>(<span class="fl">8.4</span>, <span class="fl">10.4</span>, <span class="fl">8.6</span>, <span class="fl">12.1</span>))</span>
<span id="cb822-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb822-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-8" aria-hidden="true" tabindex="-1"></a>sample_statistics <span class="sc">%&gt;%</span> </span>
<span id="cb822-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb822-9" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>()</span></code></pre></div>
<template id="dc0d8dc0-ecdc-40f2-b33e-cb320f1ffc06"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-6ee4f4a8{border-collapse:collapse;}.cl-6ede7f56{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6ede9900{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6ede991e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6edececa{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6edecee8{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6edecef2{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6edecefc{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6edecf06{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6edecf10{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-6ee4f4a8'><thead><tr style="overflow-wrap:break-word;"><td class="cl-6edecf06"><p class="cl-6ede9900"><span class="cl-6ede7f56">gender</span></p></td><td class="cl-6edecf06"><p class="cl-6ede9900"><span class="cl-6ede7f56">sample</span></p></td><td class="cl-6edecf10"><p class="cl-6ede991e"><span class="cl-6ede7f56">n</span></p></td><td class="cl-6edecf10"><p class="cl-6ede991e"><span class="cl-6ede7f56">mean</span></p></td><td class="cl-6edecf10"><p class="cl-6ede991e"><span class="cl-6ede7f56">sd</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-6edececa"><p class="cl-6ede9900"><span class="cl-6ede7f56">boys</span></p></td><td class="cl-6edececa"><p class="cl-6ede9900"><span class="cl-6ede7f56">CBCL Nonclinical</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">300</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">10.8</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">8.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6edececa"><p class="cl-6ede9900"><span class="cl-6ede7f56">boys</span></p></td><td class="cl-6edececa"><p class="cl-6ede9900"><span class="cl-6ede7f56">School</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">261</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">14.5</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">10.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6edececa"><p class="cl-6ede9900"><span class="cl-6ede7f56">girls</span></p></td><td class="cl-6edececa"><p class="cl-6ede9900"><span class="cl-6ede7f56">CBCL Nonclinical</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">300</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">10.7</span></p></td><td class="cl-6edecee8"><p class="cl-6ede991e"><span class="cl-6ede7f56">8.6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6edecef2"><p class="cl-6ede9900"><span class="cl-6ede7f56">girls</span></p></td><td class="cl-6edecef2"><p class="cl-6ede9900"><span class="cl-6ede7f56">School</span></p></td><td class="cl-6edecefc"><p class="cl-6ede991e"><span class="cl-6ede7f56">267</span></p></td><td class="cl-6edecefc"><p class="cl-6ede991e"><span class="cl-6ede7f56">16.6</span></p></td><td class="cl-6edecefc"><p class="cl-6ede991e"><span class="cl-6ede7f56">12.1</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="7ac824a6-a5e9-4792-8d71-f01a4e20bba7"></div>
<script>
var dest = document.getElementById("7ac824a6-a5e9-4792-8d71-f01a4e20bba7");
var template = document.getElementById("dc0d8dc0-ecdc-40f2-b33e-cb320f1ffc06");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>Here’s the weighted mean of the externalizing scores.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb823-1" aria-hidden="true" tabindex="-1"></a>sample_statistics <span class="sc">%&gt;%</span> </span>
<span id="cb823-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb823-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weighted_average =</span> <span class="fu">sum</span>(n <span class="sc">*</span> mean) <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   weighted_average
##              &lt;dbl&gt;
## 1             13.0</code></pre>
<p>Here’s the pooled standard deviation.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb825-1" aria-hidden="true" tabindex="-1"></a>sample_statistics <span class="sc">%&gt;%</span> </span>
<span id="cb825-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb825-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pooled_sd =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sum</span>(n) <span class="sc">-</span> <span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   pooled_sd
##       &lt;dbl&gt;
## 1      9.91</code></pre>
<p>Thus, I propose a good place to start with is with a <span class="math inline">\(\operatorname{Normal}(13, 9.9)\)</span> prior on the overall intercept, <span class="math inline">\(\gamma_{00}\)</span>. So far, we’ve been using the Student-<span class="math inline">\(t\)</span> distribution for the priors on our variance parameters. Another option favored by McElreath in the second edition of his text is the exponential distribution. The exponential distribution has a single parameter, <span class="math inline">\(\lambda\)</span>, which is often called the rate. The mean of the exponential distribution is the inverse of the rate, <span class="math inline">\(1 / \lambda\)</span>. When you’re working with standardized data, a nice weakly-regularizing priors on the variance parameters is <span class="math inline">\(\operatorname{Exponential}(1)\)</span>, which has a mean of 1. Since our data are not standardized, we might use the prior <span class="math inline">\(\operatorname{Exponential}(1 / s_p)\)</span>, where <span class="math inline">\(s_p\)</span> is the pooled standard deviation. In our case, that would be <span class="math inline">\(\operatorname{Exponential}(1 / 9.9)\)</span>. Here’s what those priors would look like.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb827-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb827-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">30</span>, <span class="at">to =</span> <span class="dv">50</span>, <span class="at">length.out =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb827-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">13</span>, <span class="at">sd =</span> <span class="fl">9.9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb827-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb827-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb827-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb827-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="st">&quot;prior for &quot;</span><span class="sc">*</span>gamma[<span class="dv">0</span>][<span class="dv">0</span>]),</span>
<span id="cb827-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> (<span class="fu">expression</span>(<span class="fu">Normal</span>(<span class="dv">13</span><span class="sc">*</span><span class="st">&#39;, &#39;</span><span class="sc">*</span><span class="fl">9.9</span>)))) <span class="sc">+</span></span>
<span id="cb827-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb827-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb827-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-12" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb827-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb827-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">length.out =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb827-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">dexp</span>(x, <span class="at">rate =</span> <span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb827-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb827-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb827-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb827-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="st">&quot;priors for &quot;</span><span class="sc">*</span>sigma[<span class="dv">0</span>]<span class="sc">~</span>and<span class="sc">~</span>sigma[epsilon]),</span>
<span id="cb827-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> (<span class="fu">expression</span>(<span class="fu">Exponential</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">9.9</span>)))) <span class="sc">+</span></span>
<span id="cb827-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb827-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb827-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-23" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb827-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb827-24" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-51-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>Now using those priors, here’s how to fit the model.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.10</span> <span class="ot">&lt;-</span></span>
<span id="cb828-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> external_pp, </span>
<span id="cb828-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb828-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-4" aria-hidden="true" tabindex="-1"></a>      external <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb828-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">13</span>, <span class="fl">9.9</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb828-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sd),</span>
<span id="cb828-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb828-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb828-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb828-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb828-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.10&quot;</span>)</span></code></pre></div>
<p>For the next three models, we’ll keep those priors for <span class="math inline">\(\gamma_{00}\)</span> and the <span class="math inline">\(\sigma\)</span> parameters. Yet now we have to consider the new <span class="math inline">\(\gamma_{00}\)</span> parameters which will account for the population-level effects if time, from a linear, quadratic, and cubic perspective. Given that <code>time</code> takes on integer values <code>0</code> through <code>5</code>, the simple linear slope <span class="math inline">\(\gamma_{10}\)</span> is the expected change from one grade to the next. Since we know from the previous literature that boys tend to have either stable or slightly-increasing trajectories for their externalizing behaviors (recall we’re uncertain about girls), a mildly conservative prior might be centered on zero with, say, half of the pooled standard deviation on the scale, <span class="math inline">\(\operatorname{Normal}(0, 4.95)\)</span>. This is the rough analogue to a <span class="math inline">\(\operatorname{Normal}(0, 0.5)\)</span> prior on standardized data. Without better information, we’ll extend that same <span class="math inline">\(\operatorname{Normal}(0, 4.95)\)</span> prior on <span class="math inline">\(\gamma_{20}\)</span> and <span class="math inline">\(\gamma_{30}\)</span>. As to the new <span class="math inline">\(\rho\)</span> parameters, we’ll use our typical weakly-regularizing <span class="math inline">\(\operatorname{LKJ}(4)\)</span> prior on the level-2 correlation matrices.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear</span></span>
<span id="cb829-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-2" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.11</span> <span class="ot">&lt;-</span></span>
<span id="cb829-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> external_pp, </span>
<span id="cb829-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb829-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-5" aria-hidden="true" tabindex="-1"></a>      external <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> id),</span>
<span id="cb829-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">4.95</span>), <span class="at">class =</span> b),</span>
<span id="cb829-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">13</span>, <span class="fl">9.9</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb829-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sd),</span>
<span id="cb829-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sigma),</span>
<span id="cb829-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb829-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb829-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb829-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.11&quot;</span>)</span>
<span id="cb829-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb829-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-15" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic</span></span>
<span id="cb829-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-16" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.12</span> <span class="ot">&lt;-</span></span>
<span id="cb829-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> external_pp, </span>
<span id="cb829-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb829-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-19" aria-hidden="true" tabindex="-1"></a>      external <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|</span> id),</span>
<span id="cb829-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">4.95</span>), <span class="at">class =</span> b),</span>
<span id="cb829-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">13</span>, <span class="fl">9.9</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb829-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sd),</span>
<span id="cb829-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sigma),</span>
<span id="cb829-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb829-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb829-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb829-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>),</span>
<span id="cb829-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.12&quot;</span>)</span>
<span id="cb829-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb829-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-30" aria-hidden="true" tabindex="-1"></a><span class="co"># cubic</span></span>
<span id="cb829-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-31" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.13</span> <span class="ot">&lt;-</span></span>
<span id="cb829-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> external_pp, </span>
<span id="cb829-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb829-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-34" aria-hidden="true" tabindex="-1"></a>      external <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">3</span>) <span class="sc">|</span> id),</span>
<span id="cb829-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">4.95</span>), <span class="at">class =</span> b),</span>
<span id="cb829-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-36" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">13</span>, <span class="fl">9.9</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb829-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-37" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sd),</span>
<span id="cb829-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sigma),</span>
<span id="cb829-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-39" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb829-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb829-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb829-42"><a href="modeling-discontinuous-and-nonlinear-change.html#cb829-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.13&quot;</span>)</span></code></pre></div>
<p>Compute and save the WAIC estimates.</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb830-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.10</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb830-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb830-2" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.11</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.11</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb830-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb830-3" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.12</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.12</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb830-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb830-4" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.13</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.13</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span></code></pre></div>
<p>Here we’ll make a simplified versionof the WAIC output, saving the results as <code>waic_summary</code>.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-1" aria-hidden="true" tabindex="-1"></a><span class="co"># order the parameters, which will come in handy in the next block</span></span>
<span id="cb831-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-2" aria-hidden="true" tabindex="-1"></a>order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gamma[0][0]&quot;</span>, <span class="st">&quot;gamma[1][0]&quot;</span>, <span class="st">&quot;gamma[2][0]&quot;</span>, <span class="st">&quot;gamma[3][0]&quot;</span>, <span class="st">&quot;sigma[epsilon]&quot;</span>, <span class="st">&quot;sigma[0]&quot;</span>, <span class="st">&quot;sigma[1]&quot;</span>, <span class="st">&quot;sigma[2]&quot;</span>, <span class="st">&quot;sigma[3]&quot;</span>, <span class="st">&quot;rho[0][1]&quot;</span>, <span class="st">&quot;rho[0][2]&quot;</span>, <span class="st">&quot;rho[0][3]&quot;</span>, <span class="st">&quot;rho[1][2]&quot;</span>, <span class="st">&quot;rho[1][3]&quot;</span>, <span class="st">&quot;rho[2][3]&quot;</span>, <span class="st">&quot;WAIC&quot;</span>)</span>
<span id="cb831-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-4" aria-hidden="true" tabindex="-1"></a>waic_summary <span class="ot">&lt;-</span></span>
<span id="cb831-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">loo_compare</span>(fit6<span class="fl">.10</span>, fit6<span class="fl">.11</span>, fit6<span class="fl">.12</span>, fit6<span class="fl">.13</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb831-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb831-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;fit&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb831-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb831-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">model   =</span> <span class="fu">str_c</span>(<span class="st">&quot;model &quot;</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()]),</span>
<span id="cb831-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">summary =</span> <span class="fu">str_c</span>(<span class="fu">formatC</span>(waic, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">format =</span> <span class="st">&quot;f&quot;</span>), <span class="st">&quot; (&quot;</span>, <span class="fu">formatC</span>(se_waic, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">format =</span> <span class="st">&quot;f&quot;</span>), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb831-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">parameter =</span> <span class="fu">factor</span>(<span class="st">&quot;WAIC&quot;</span>, <span class="at">levels =</span> order)) </span>
<span id="cb831-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb831-13" aria-hidden="true" tabindex="-1"></a>waic_summary</span></code></pre></div>
<pre><code>##     model         summary parameter
## 1 model a 1958.60 (29.63)      WAIC
## 2 model b 1923.65 (28.28)      WAIC
## 3 model c 1905.80 (26.38)      WAIC
## 4 model d 1902.01 (26.16)      WAIC</code></pre>
<p>Here we’ll use a little summarizing, wrangling, and creative plotting, we’ll make a streamlined version of Table 6.5 with <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract and wrangle the posterior summaries</span></span>
<span id="cb833-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">model =</span> <span class="fu">str_c</span>(<span class="st">&quot;model &quot;</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]),</span>
<span id="cb833-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fit   =</span> <span class="fu">str_c</span>(<span class="st">&quot;fit6.1&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb833-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">map</span>(fit, <span class="sc">~</span><span class="fu">get</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb833-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">posterior_summary</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb833-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb833-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rownames_to_column</span>(<span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb833-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(parameter, <span class="st">&quot;r_id</span><span class="sc">\\</span><span class="st">[&quot;</span>) <span class="sc">&amp;</span> parameter <span class="sc">!=</span> <span class="st">&quot;lp__&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb833-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(p) <span class="sc">%&gt;%</span> </span>
<span id="cb833-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">greek =</span> <span class="fu">case_when</span>(</span>
<span id="cb833-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-11" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_Intercept&quot;</span> <span class="sc">~</span> <span class="st">&quot;gamma[0][0]&quot;</span>,</span>
<span id="cb833-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-12" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_time&quot;</span>      <span class="sc">~</span> <span class="st">&quot;gamma[1][0]&quot;</span>,</span>
<span id="cb833-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-13" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_ItimeE2&quot;</span>   <span class="sc">~</span> <span class="st">&quot;gamma[2][0]&quot;</span>,</span>
<span id="cb833-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-14" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;b_ItimeE3&quot;</span>   <span class="sc">~</span> <span class="st">&quot;gamma[3][0]&quot;</span>,</span>
<span id="cb833-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-15" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__Intercept&quot;</span> <span class="sc">~</span> <span class="st">&quot;sigma[0]&quot;</span>,</span>
<span id="cb833-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-16" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__time&quot;</span>      <span class="sc">~</span> <span class="st">&quot;sigma[1]&quot;</span>,</span>
<span id="cb833-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-17" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__ItimeE2&quot;</span>   <span class="sc">~</span> <span class="st">&quot;sigma[2]&quot;</span>,</span>
<span id="cb833-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-18" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sd_id__ItimeE3&quot;</span>   <span class="sc">~</span> <span class="st">&quot;sigma[3]&quot;</span>,</span>
<span id="cb833-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-19" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;sigma&quot;</span>            <span class="sc">~</span> <span class="st">&quot;sigma[epsilon]&quot;</span>,</span>
<span id="cb833-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-20" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__Intercept__time&quot;</span>    <span class="sc">~</span> <span class="st">&quot;rho[0][1]&quot;</span>,</span>
<span id="cb833-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-21" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__Intercept__ItimeE2&quot;</span> <span class="sc">~</span> <span class="st">&quot;rho[0][2]&quot;</span>,</span>
<span id="cb833-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-22" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__Intercept__ItimeE3&quot;</span> <span class="sc">~</span> <span class="st">&quot;rho[0][3]&quot;</span>,</span>
<span id="cb833-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-23" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__time__ItimeE2&quot;</span>      <span class="sc">~</span> <span class="st">&quot;rho[1][2]&quot;</span>,</span>
<span id="cb833-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-24" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__time__ItimeE3&quot;</span>      <span class="sc">~</span> <span class="st">&quot;rho[1][3]&quot;</span>,</span>
<span id="cb833-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-25" aria-hidden="true" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;cor_id__ItimeE2__ItimeE3&quot;</span>   <span class="sc">~</span> <span class="st">&quot;rho[2][3]&quot;</span></span>
<span id="cb833-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-26" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb833-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">summary =</span> <span class="fu">str_c</span>(<span class="fu">formatC</span>(Estimate, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">format =</span> <span class="st">&quot;f&quot;</span>), <span class="st">&quot; (&quot;</span>, <span class="fu">formatC</span>(Est.Error, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">format =</span> <span class="st">&quot;f&quot;</span>), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb833-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">parameter =</span> <span class="fu">factor</span>(greek, <span class="at">levels =</span> order)) <span class="sc">%&gt;%</span> </span>
<span id="cb833-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model, summary, parameter) <span class="sc">%&gt;%</span> </span>
<span id="cb833-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add in the WAIC summary information</span></span>
<span id="cb833-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(waic_summary) <span class="sc">%&gt;%</span> </span>
<span id="cb833-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> <span class="fu">fct_rev</span>(parameter)) <span class="sc">%&gt;%</span> </span>
<span id="cb833-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb833-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb833-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> parameter, <span class="at">label =</span> summary)) <span class="sc">+</span></span>
<span id="cb833-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb833-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb833-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe) <span class="sc">+</span></span>
<span id="cb833-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb833-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb833-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb833-42"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb833-43"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb833-44"><a href="modeling-discontinuous-and-nonlinear-change.html#cb833-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-54-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>Here are the formal WAIC difference estimates.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb834-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.10</span>, fit6<span class="fl">.11</span>, fit6<span class="fl">.12</span>, fit6<span class="fl">.13</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb834-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb834-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic   se_waic
## fit6.13    0.0       0.0  -951.0      13.1         68.1    5.7    1902.0   26.2 
## fit6.12   -1.9       1.3  -952.9      13.2         66.4    5.8    1905.8   26.4 
## fit6.11  -10.8       5.1  -961.8      14.1         62.3    6.2    1923.6   28.3 
## fit6.10  -28.3       9.2  -979.3      14.8         38.4    4.0    1958.6   29.6</code></pre>
<p>The WAIC difference estimates suggest the cubic and quadratic models are about the same, but both are notably better than the intercepts-only and linear models.</p>
<p>In the text, Singer and Willett preferred the quadratic model (<code>fit6.12</code>). Now we’ve fit our Bayesian version of the model, why not use the posterior distribution to make a high-quality model-based version of Figure 6.7?</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the new data</span></span>
<span id="cb836-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb836-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-3" aria-hidden="true" tabindex="-1"></a>  external_pp_subset <span class="sc">%&gt;%</span> </span>
<span id="cb836-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, case) <span class="sc">%&gt;%</span> </span>
<span id="cb836-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(id, case),</span>
<span id="cb836-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb836-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grade =</span> time <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb836-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb836-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-9" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the fitted trajectories and wrangle</span></span>
<span id="cb836-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit6<span class="fl">.12</span>, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb836-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb836-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb836-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb836-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb836-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb836-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb836-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb836-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb836-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> external_pp_subset,</span>
<span id="cb836-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> external)) <span class="sc">+</span></span>
<span id="cb836-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">labels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb836-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb836-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;external&quot;</span>) <span class="sc">+</span></span>
<span id="cb836-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="sc">+</span></span>
<span id="cb836-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb836-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb836-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> case, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-56-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>At the end of this section in the text, Singer and Willett briefly discussed fitting an expansion of the quadratic model which included the variable <code>female</code> as time-invariant predictor for the individual differences in initial status (<span class="math inline">\(\pi_{0i}\)</span>), the instantaneous rate of change (<span class="math inline">\(\pi_{1i}\)</span>), and curvature (<span class="math inline">\(\pi_{2i}\)</span>). We might express the model in formal notation as</p>
<p><span class="math display">\[
\begin{align*}
\text{external}_{ij} &amp; = \gamma_{00} + \gamma_{01} \text{female}_i \\
 &amp; \;\;\; + \gamma_{10} \text{time}_{ij} + \gamma_{11} ( \text{female}_i \times \text{time}_{ij} ) \\
 &amp; \;\;\; + \gamma_{20} \text{time}_{ij}^2 + \gamma_{21} ( \text{female}_i \times \text{time}_{ij}^2 ) \\
 &amp; \;\;\; + [\zeta_{0i} + \zeta_{1i} \text{time}_{ij} + \zeta_{2i} \text{time}_{ij}^2 + \epsilon_{ij}] \\
\epsilon_{ij} &amp; \sim \operatorname{Normal}(0, \sigma_\epsilon) \\
\begin{bmatrix} 
\zeta_{0i} \\ \zeta_{1i} \\ \zeta_{2i}
\end{bmatrix} &amp; \sim \operatorname{Normal}(\mathbf 0, \mathbf D \mathbf \Omega \mathbf D&#39;) \\
\mathbf D &amp; = \begin{bmatrix} \sigma_0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma_1 &amp; 0 \\ 0 &amp; 0 &amp; \sigma_2 \end{bmatrix} \\ 
\mathbf\Omega &amp; = \begin{bmatrix} 1 &amp; \rho_{01} &amp; \rho_{02} \\ 
 \rho_{10} &amp; 1 &amp; \rho_{12} \\ 
 \rho_{20} &amp; \rho_{21} &amp; 1 \end{bmatrix} \\
\gamma_{00}                     &amp; \sim \operatorname{Normal}(13, 9.9) \\
\gamma_{01}, \dots, \gamma_{21} &amp; \sim \operatorname{Normal}(0, 4.95) \\
\sigma_0, \dots, \sigma_2 &amp; \sim \operatorname{Exponential}(1 / 9.9) \\
\sigma_\epsilon           &amp; \sim \operatorname{Exponential}(1 / 9.9) \\
\mathbf\Omega   &amp; \sim \operatorname{LKJ}(4).
\end{align*}
\]</span></p>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.14</span> <span class="ot">&lt;-</span></span>
<span id="cb837-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> external_pp, </span>
<span id="cb837-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb837-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-4" aria-hidden="true" tabindex="-1"></a>      external <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> female <span class="sc">+</span> time<span class="sc">:</span>female <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>female <span class="sc">+</span></span>
<span id="cb837-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-5" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|</span> id),</span>
<span id="cb837-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">4.95</span>), <span class="at">class =</span> b),</span>
<span id="cb837-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">13</span>, <span class="fl">9.9</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb837-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sd),</span>
<span id="cb837-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">1.0</span> <span class="sc">/</span> <span class="fl">9.9</span>), <span class="at">class =</span> sigma),</span>
<span id="cb837-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb837-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">3</span>, <span class="at">cores =</span> <span class="dv">3</span>,</span>
<span id="cb837-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb837-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>),</span>
<span id="cb837-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb837-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.14&quot;</span>)</span></code></pre></div>
<p>Singer and Willett reported the new parameters <span class="math inline">\(\gamma_{01}\)</span>, <span class="math inline">\(\gamma_{02}\)</span> and <span class="math inline">\(\gamma_{03}\)</span>, were unimpressive. Let’s check their posteriors with a coefficient plot.</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit6<span class="fl">.14</span>)[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, ] <span class="sc">%&gt;%</span> </span>
<span id="cb838-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb838-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> <span class="fu">str_c</span>(<span class="st">&quot;gamma[&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;][1]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb838-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb838-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> parameter)) <span class="sc">+</span></span>
<span id="cb838-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb838-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb838-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe) <span class="sc">+</span></span>
<span id="cb838-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;How well did &#39;female&#39; do?&quot;</span>,</span>
<span id="cb838-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>) <span class="sc">+</span></span>
<span id="cb838-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb838-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-57-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Yeah, they were wither small or highly uncertain. Let’s go all the way with a WAIC comparison with <code>fit6.12</code>.</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb839-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.14</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.14</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb839-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb839-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb839-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb839-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.12</span>, fit6<span class="fl">.14</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic   se_waic
## fit6.12    0.0       0.0  -952.9      13.2         66.4    5.8    1905.8   26.4 
## fit6.14   -0.5       1.0  -953.4      13.3         67.7    6.0    1906.8   26.6</code></pre>
<p>Yep, there’s no compelling reason to prefer <code>fit6.14</code> over <code>fit6.12</code>. The predictor <code>female</code> looks like a dud, which suggests the externalizing behavior trajectories are about the same for the boys and the girls.</p>
</div>
</div>
<div id="truly-nonlinear-trajectories" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Truly nonlinear trajectories</h2>
<blockquote>
<p>All the individual growth models described so far—including the curvilinear ones presented in this chapter–share an important mathematical property: they are <em>linear in the individual growth parameters</em>. Why do we use the label “linear” to describe trajectories that are blatantly nonlinear? The explanation for this apparent paradox is that this mathematical property depends not on the <em>shape</em> of the underlying growth trajectory but rather <em>where</em>–in which portion of the model–the nonlinearity arises. In all previous model, nonlinearity (or discontinuity) stems from the representation of the <em>predictors</em>. To allow the hypothesized trajectory to deviate from a straight line, <em>TIME</em> is either transformed or expressed using higher order polynomial terms. In the truly nonlinear models we now discuss, nonlinearity arises in a different way–through the <em>parameters</em>. (pp. 223–224, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="what-do-we-mean-by-truly-nonlinear-models" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> What do we mean by truly nonlinear models?</h3>
<p>Linear models are <em>linear</em> in the sense that the expected value for the criterion (<span class="math inline">\(\operatorname E(y)\)</span>) is the sum of the <span class="math inline">\(\gamma\)</span>’s multiplies by either a constant (in the case of <span class="math inline">\(\gamma_{00}\)</span>) or b the regression weight (the point estimate for frequentists or the measure of central tendency in the posterior, often the mean or median, for Bayesians). In other words, <span class="math inline">\(\operatorname E(y)\)</span> is a <em>weighted linear composite</em> of the <span class="math inline">\(\gamma\)</span>’s multiplied by a given set of predictor values. Truly nonlinear models do not have this property.</p>
</div>
<div id="the-logistic-individual-growth-curve." class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> The logistic individual growth curve.</h3>
<p>Load the data from Tivan’s (1980) unpublished dissertation.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb841-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb841-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb841-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb841-3" aria-hidden="true" tabindex="-1"></a>foxngeese_pp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/foxngeese_pp.csv&quot;</span>)</span>
<span id="cb841-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb841-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb841-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(foxngeese_pp)</span></code></pre></div>
<pre><code>## Rows: 445
## Columns: 4
## $ id     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, …
## $ game   &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26…
## $ nmoves &lt;dbl&gt; 4, 7, 8, 3, 3, 3, 7, 6, 3, 7, 5, 3, 8, 3, 3, 3, 3, 3, 6, 3, 3, 3, 3, 3, 3, 5, 3, 3, 6, 3, 3, …
## $ read   &lt;dbl&gt; 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4…</code></pre>
<p>There are responses from 17 participants in these data.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb843-1" aria-hidden="true" tabindex="-1"></a>foxngeese_pp <span class="sc">%&gt;%</span> </span>
<span id="cb843-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb843-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id)</span></code></pre></div>
<pre><code>## # A tibble: 17 x 1
##       id
##    &lt;dbl&gt;
##  1     1
##  2     2
##  3     3
##  4     4
##  5     5
##  6     6
##  7     7
##  8     8
##  9     9
## 10    10
## 11    11
## 12    12
## 13    13
## 14    14
## 15    15
## 16    16
## 17    17</code></pre>
<p>In this experiment, each child played up to 27 games, with some variation among the children.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb845-1" aria-hidden="true" tabindex="-1"></a>foxngeese_pp <span class="sc">%&gt;%</span> </span>
<span id="cb845-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb845-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(id, <span class="at">name =</span> <span class="st">&quot;# games, per kid&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb845-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb845-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="st">`</span><span class="at"># games, per kid</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   `# games, per kid`     n
##                &lt;int&gt; &lt;int&gt;
## 1                 14     1
## 2                 26     1
## 3                 27    15</code></pre>
<p>Our criterion is <code>nmoves</code>, the number of a child made within a game “before making a catastrophic error” (p. 226). Here’s the overall distribution of <code>nmoves</code>.</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb847-1" aria-hidden="true" tabindex="-1"></a>foxngeese_pp <span class="sc">%&gt;%</span> </span>
<span id="cb847-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb847-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nmoves)) <span class="sc">+</span></span>
<span id="cb847-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb847-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb847-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb847-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-62-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>We can get a sense of the child-level data with our version of Figure 6.8.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-1" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;15&quot;</span>)</span>
<span id="cb848-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb848-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-3" aria-hidden="true" tabindex="-1"></a>foxngeese_pp <span class="sc">%&gt;%</span> </span>
<span id="cb848-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> subset) <span class="sc">%&gt;%</span> </span>
<span id="cb848-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">if_else</span>(id <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="fu">str_c</span>(<span class="st">&quot;0&quot;</span>, id), <span class="fu">as.character</span>(id))) <span class="sc">%&gt;%</span> </span>
<span id="cb848-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb848-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game, <span class="at">y =</span> nmoves)) <span class="sc">+</span></span>
<span id="cb848-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb848-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb848-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb848-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb848-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-63-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In these data, <code>nmoves</code> always lies between 1 and 20. Based on what we know about the structure of these data and the experiment which produced them, Singer and Willett proposed our statistical model should include:</p>
<ul>
<li>a <em>lower asymptote</em>, which captures how each child had to make at least one move;</li>
<li>an <em>upper asymptote</em>, which captures the maximum number of moves allowed, which seems to be 20; and</li>
<li>a <em>smooth curve</em> showing growth from the lower asymptote to the upper, which involves a period of accelerated learning somewhere in the middle.</li>
</ul>
<p>They then point out these features are captured in a logistic trajectory. Their proposed logistic model of change follows the form</p>
<p><span class="math display">\[
\begin{align*}
\text{nmoves}_{ij} &amp; = 1 + \frac{19}{1 + \pi_{0i} e^{-(\pi_{1i} \text{game}_{ij})}} + \epsilon_{ij} \\
\epsilon_{ij}      &amp; \sim \operatorname{Normal}(0, \sigma_\epsilon^2).
\end{align*}
\]</span></p>
<p>This equation is set up so that as the value for <span class="math inline">\(\text{game}_{ij} \rightarrow \infty\)</span>, the denominator in the equation shrinks to 1, which leave <span class="math inline">\(1 + 19/1 = 20\)</span>, the <em>upper asymptote</em>. Yet as <span class="math inline">\(\text{game}_{ij} \rightarrow -\infty\)</span>, the denominator inflates to <span class="math inline">\(\infty\)</span>, leaving <span class="math inline">\(1 + 0 = 1\)</span>, the <em>lower asymptote</em>. The <span class="math inline">\(\pi_{0i}\)</span> and <span class="math inline">\(\pi_{1i}\)</span> terms are no longer simply the intercepts and time slopes, as in earlier models. To get a sense, we’ll make Figure 6.9. To help, we might make a custom function that follows the equation, above.</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb849-1" aria-hidden="true" tabindex="-1"></a>sw_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">pi0 =</span> <span class="dv">15</span>, <span class="at">pi1 =</span> <span class="fl">0.3</span>, <span class="at">game =</span> <span class="dv">10</span>) {</span>
<span id="cb849-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb849-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb849-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb849-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">19</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pi0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>pi1 <span class="sc">*</span> game)))</span>
<span id="cb849-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb849-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now use our <code>sw_logistic()</code> function<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> to make Figure 6.9.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">pi0 =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">15</span>, <span class="dv">150</span>),</span>
<span id="cb850-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">pi1 =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb850-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(pi0, pi1),</span>
<span id="cb850-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">game =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb850-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y     =</span> <span class="fu">sw_logistic</span>(pi0, pi1, game),</span>
<span id="cb850-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pi0_f =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;pi[0]==&quot;</span>, pi0), </span>
<span id="cb850-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pi[0]==150&quot;</span>, <span class="st">&quot;pi[0]==15&quot;</span>, <span class="st">&quot;pi[0]==1.5&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb850-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb850-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game, <span class="at">y =</span> y, <span class="at">group =</span> pi1)) <span class="sc">+</span></span>
<span id="cb850-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size =</span> pi1)) <span class="sc">+</span> </span>
<span id="cb850-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="fu">expression</span>(pi[<span class="dv">1</span>]), <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb850-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;nmoves&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb850-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb850-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb850-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pi0_f, <span class="at">labeller =</span> label_parsed) </span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-65-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>Though <span class="math inline">\(\pi_{0i}\)</span> has clear implications for the intercept, it’s not quite the same thing as the intercept. Similarly, though <span class="math inline">\(\pi_{1i}\)</span> has an influence on how rapidly the trajectories approach the upper asymptote, it’s not the same thing as the slope. Once you go nonlinear, it can become tricky to interpret the parameters directly.</p>
<p>Since we’ll be fitting this model as Bayesians, let’s talk about priors. Based on the plots in Figure 6.9, it seems like we should center the <span class="math inline">\(\gamma_{00}\)</span> prior on a relatively large value. If you compare the three panels of the plot, it seems like there’s a diminishing returns effect as the value for <span class="math inline">\(\pi_0\)</span> went from 1.5 to 15 to 150. I propose something like <span class="math inline">\(\operatorname N(15, 3)\)</span>.</p>
<p>Now let’s talk about the prior for <span class="math inline">\(\gamma_{10}\)</span>. In each of the three panels of Figure 6.9, it looks like the values of 0.1 to 0.5 cover a good range of plausible values. If we were conservative about how quickly the children might learn the game, perhaps we’d settle for a prior like <span class="math inline">\(\operatorname N(0.2, 0.1)\)</span>.</p>
<p>A nonlinear model like this can be hard to understand even with the benefit of Figure 6.9. To get a clear sense of our priors, we might do a graphical prior predictive check. Here we simulate 100 draws from the prior predictive distribution of</p>
<p><span class="math display">\[
\begin{align*}
y_j &amp; = 1 + \frac{19}{1 + \gamma_{00} e^{-(\gamma_{10} \text{game}_j)}} \\
\gamma_{00} &amp; \sim \operatorname N(15, 3) \\
\gamma_{10} &amp; \sim \operatorname N(0.2, 0.1).
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many do you want?</span></span>
<span id="cb851-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb851-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb851-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate</span></span>
<span id="cb851-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb851-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb851-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">n   =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb851-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">gamma00 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb851-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">gamma10 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">0.2</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb851-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(n, gamma00, gamma10),</span>
<span id="cb851-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">game =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb851-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">sw_logistic</span>(gamma00, gamma10, game)) <span class="sc">%&gt;%</span></span>
<span id="cb851-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb851-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb851-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game, <span class="at">y =</span> y, <span class="at">group =</span> n)) <span class="sc">+</span></span>
<span id="cb851-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb851-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb851-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb851-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb851-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-66-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>To my eye, this looks like a respectable starting point. As for our variance parameters, I’d be comfortable just setting <span class="math inline">\(\sigma_0 \sim \operatorname{Exponential}(1)\)</span> and <span class="math inline">\(\sigma_\epsilon \sim \operatorname{Exponential}(1)\)</span>. Since the range for our <span class="math inline">\(\gamma_{10}\)</span> prior is about an order of magnitude smaller, I’d argue <span class="math inline">\(\operatorname{Exponential}(10)\)</span> would be a decent starting point for our <span class="math inline">\(\sigma_1\)</span> prior. As is typical, I recommend the weakly regularizing <span class="math inline">\(\operatorname{LKJ}(4)\)</span> for the level-2 correlation matrix.</p>
<p>Here’s how to fit the model with <strong>brms</strong>.</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.15</span> <span class="ot">&lt;-</span></span>
<span id="cb852-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> foxngeese_pp, </span>
<span id="cb852-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb852-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(nmoves <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="fl">19.0</span> <span class="sc">/</span> (<span class="fl">1.0</span> <span class="sc">+</span> g0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>g1 <span class="sc">*</span> game))),</span>
<span id="cb852-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-5" aria-hidden="true" tabindex="-1"></a>         g0 <span class="sc">+</span> g1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>i<span class="sc">|</span> id), </span>
<span id="cb852-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb852-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">15</span>, <span class="dv">3</span>), <span class="at">nlpar =</span> g0),</span>
<span id="cb852-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>), <span class="at">nlpar =</span> g1),</span>
<span id="cb852-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">nlpar =</span> g0),</span>
<span id="cb852-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">10</span>), <span class="at">class =</span> sd, <span class="at">nlpar =</span> g1),</span>
<span id="cb852-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb852-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb852-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">3</span>, <span class="at">chains =</span> <span class="dv">3</span>,</span>
<span id="cb852-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">inits =</span> <span class="dv">0</span>, </span>
<span id="cb852-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">999</span>),</span>
<span id="cb852-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb852-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.15&quot;</span>)</span></code></pre></div>
<p>Before we explore the results, you might have noticed a few odd things about our syntax. For example, notice how we wrapped our model formula within a <code>bf()</code> statement, that the actual formula is composed of both variable names (e.g., <code>game</code>) AND parameter names (e.g., <code>g0</code>, which is an abbreviation for <span class="math inline">\(\gamma_{00}\)</span>), and that we set <code>nl = TRUE</code>. Further, did you notice how we used the <code>nlpar</code> argument in several of our <code>prior()</code> lines? Taken as a whole, these indicate we used the <strong>brms</strong> non-linear syntax. Since so few of the models in this book require the <strong>brms</strong> non-linear syntax, I’m not going to explain it in detail, here. However, you can learn all about it in Bürkner’s <span class="citation">(<a href="references.html#ref-Bürkner2021Non_linear" role="doc-biblioref">2021a</a>)</span> vignette, <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_nonlinear.html"><em>Estimating non-linear models with brms</em></a>. I also use the non-linear syntax quite a bit in my <span class="citation">(<a href="references.html#ref-kurzStatisticalRethinkingSecondEd2021" role="doc-biblioref">2021</a>)</span> translation of the second edition of McElreath’s text.</p>
<p>But as to the task at hand, let’s look at the summary for our model.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit6<span class="fl">.15</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: nmoves ~ 1 + (19/(1 + g0 * exp(-g1 * game))) 
##          g0 ~ 1 + (1 | i | id)
##          g1 ~ 1 + (1 | i | id)
##    Data: foxngeese_pp (Number of observations: 445) 
## Samples: 3 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 3000
## 
## Group-Level Effects: 
## ~id (Number of levels: 17) 
##                                Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sd(g0_Intercept)                  1.362     1.320    0.027    4.690 1.001     1475     1420
## sd(g1_Intercept)                  0.059     0.012    0.041    0.088 1.002     1054     1661
## cor(g0_Intercept,g1_Intercept)    0.123     0.329   -0.558    0.703 1.013      216      599
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## g0_Intercept   13.528     1.896   10.081   17.520 1.002     3448     2269
## g1_Intercept    0.124     0.016    0.092    0.157 1.002     1107     1719
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma    3.748     0.132    3.503    4.014 1.001     4134     2081
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Our posterior summaries are similar to the results Singer and Willett reported in their Table 6.6. To further explore the model, let’s use the <code>fitted()</code> approach to make our version of Figure 6.10a.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">game =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb855-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb855-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb855-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit6<span class="fl">.15</span>,</span>
<span id="cb855-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb855-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb855-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb855-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb855-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb855-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>)) <span class="sc">+</span></span>
<span id="cb855-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb855-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb855-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb855-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;nmoves&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb855-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Model A&quot;</span>) <span class="sc">+</span></span>
<span id="cb855-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb855-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb855-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb855-18" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-68-1.png" width="216" style="display: block; margin: auto;" /></p>
<p>For the next model, Singer and Willett proposed we use a mean-centered version of <code>read</code> as predictor of the level-2 intercepts and slopes. Here we make a version of that variable, which we’ll call <code>read_c</code>.</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb856-1" aria-hidden="true" tabindex="-1"></a>foxngeese_pp <span class="ot">&lt;-</span></span>
<span id="cb856-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb856-2" aria-hidden="true" tabindex="-1"></a>  foxngeese_pp <span class="sc">%&gt;%</span> </span>
<span id="cb856-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb856-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">read_c =</span> read <span class="sc">-</span> <span class="fu">mean</span>(read))</span></code></pre></div>
<p>For our new coefficients, I propose we continue to take a weakly-regularizing approach. Since the level-2 variables they’re predicting are on different scales, it seems like these priors should be on different scales, too. I suggest we specify <span class="math inline">\(\gamma_{01} \sim \operatorname{Normal}(0, 1)\)</span> and <span class="math inline">\(\gamma_{11} \sim \operatorname{Normal}(0, 0.1)\)</span>. If you follow along, we might express our statistical model in formal notation as</p>
<p><span class="math display">\[
\begin{align*}
\text{nmoves}_{ij} &amp; = 1 + \frac{19}{1 + \pi_{0i} e^{-(\pi_{1i} \text{game}_{ij})}} + \epsilon_{ij} \\
\pi_{0i} &amp; = \gamma_{00} + \gamma_{01} \left (\text{read}_i - \overline{\text{read}} \right ) + \zeta_{0i} \\
\pi_{1i} &amp; = \gamma_{10} + \gamma_{11} \left (\text{read}_i - \overline{\text{read}} \right ) + \zeta_{1i} \\
\epsilon_{ij}      &amp; \sim \operatorname{Normal}(0, \sigma_\epsilon) \\
\begin{bmatrix} \zeta_{0i} \\ \zeta_{1i} \end{bmatrix} &amp; 
 \sim \operatorname{Normal}  \begin{pmatrix} \begin{bmatrix} 
   0 \\ 0  \end{bmatrix}, \mathbf D \mathbf \Omega 
   \mathbf D&#39; \end{pmatrix} \\
\mathbf D &amp; = \begin{bmatrix} \sigma_0 &amp; 0 \\ 0 &amp; \sigma_1\end{bmatrix} \\ 
\mathbf\Omega &amp; = \begin{bmatrix} 1 &amp; \rho_{01} \\ 
 \rho_{10} &amp; 1 \end{bmatrix}, \\
\gamma_{00} &amp; \sim \operatorname{Normal}(15, 3) \\ 
\gamma_{10} &amp; \sim \operatorname{Normal}(0.2, 0.1) \\
\gamma_{01} &amp; \sim \operatorname{Normal}(0, 1) \\ 
\gamma_{11} &amp; \sim \operatorname{Normal}(0, 0.1) \\ 
\sigma_0 &amp; \sim \operatorname{Exponential}(1) \\ 
\sigma_1 &amp; \sim \operatorname{Exponential}(10) \\ 
\sigma_\epsilon &amp; \sim \operatorname{Exponential}(1) \\ 
\mathbf \Omega &amp; \sim \operatorname{LKJ}(4).
\end{align*}
\]</span></p>
<p>Fit the model.</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.16</span> <span class="ot">&lt;-</span></span>
<span id="cb857-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> foxngeese_pp, </span>
<span id="cb857-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb857-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(nmoves <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="fl">19.0</span> <span class="sc">/</span> (<span class="fl">1.0</span> <span class="sc">+</span> g0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>g1 <span class="sc">*</span> game))),</span>
<span id="cb857-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-5" aria-hidden="true" tabindex="-1"></a>         g0 <span class="sc">+</span> g1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> read_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>i<span class="sc">|</span> id), </span>
<span id="cb857-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb857-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">15</span>, <span class="dv">3</span>), <span class="at">nlpar =</span> g0, <span class="at">coef =</span> Intercept),</span>
<span id="cb857-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nlpar =</span> g0, <span class="at">coef =</span> read_c),</span>
<span id="cb857-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>), <span class="at">nlpar =</span> g1, <span class="at">coef =</span> Intercept),</span>
<span id="cb857-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">nlpar =</span> g1, <span class="at">coef =</span> read_c),</span>
<span id="cb857-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">nlpar =</span> g0),</span>
<span id="cb857-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">10</span>), <span class="at">class =</span> sd, <span class="at">nlpar =</span> g1),</span>
<span id="cb857-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb857-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb857-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">3</span>, <span class="at">chains =</span> <span class="dv">3</span>,</span>
<span id="cb857-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">inits =</span> <span class="dv">0</span>, </span>
<span id="cb857-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">999</span>),</span>
<span id="cb857-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb857-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.16&quot;</span>)</span></code></pre></div>
<p>Check the results.</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb858-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit6<span class="fl">.16</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: nmoves ~ 1 + (19/(1 + g0 * exp(-g1 * game))) 
##          g0 ~ 1 + read_c + (1 | i | id)
##          g1 ~ 1 + read_c + (1 | i | id)
##    Data: foxngeese_pp (Number of observations: 445) 
## Samples: 3 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 3000
## 
## Group-Level Effects: 
## ~id (Number of levels: 17) 
##                                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(g0_Intercept)                   1.37      1.31     0.04     4.77 1.00     2088     2095
## sd(g1_Intercept)                   0.06      0.01     0.04     0.09 1.00     1109     1508
## cor(g0_Intercept,g1_Intercept)     0.10      0.33    -0.54     0.69 1.01      379      837
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## g0_Intercept    13.57      1.94    10.11    17.91 1.00     3362     2057
## g0_read_c        0.48      0.98    -1.42     2.46 1.00     4670     1947
## g1_Intercept     0.12      0.02     0.09     0.16 1.00     1194     1463
## g1_read_c        0.02      0.02    -0.02     0.06 1.00     1352     1828
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     3.75      0.13     3.50     4.02 1.00     4471     2223
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Before you get worried about how our posterior mean for <span class="math inline">\(\gamma_{01}\)</span> has the opposite sign as the point estimate Singer and Willett reported in the text, take a look at the whole posterior.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb860-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-3" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_samples</span>(fit6<span class="fl">.16</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb860-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_g0_read_c, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb860-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb860-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span><span class="fl">0.3745</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb860-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb860-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3745</span>, <span class="at">y =</span> <span class="fl">0.03</span>,</span>
<span id="cb860-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Singer and Willett&#39;s</span><span class="sc">\n</span><span class="st">point estimate&quot;</span>,</span>
<span id="cb860-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb860-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb860-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(gamma[<span class="dv">0</span>][<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb860-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb860-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-71-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The posterior is wide and the point estimate in the text fits comfortably within our inner 80% interval. Okay, let’s explore this model further by making the rest of Figure 6.10.</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb861-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">game   =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb861-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">read_c =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.58</span>, <span class="fl">1.58</span>))</span>
<span id="cb861-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb861-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit6<span class="fl">.16</span>,</span>
<span id="cb861-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb861-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb861-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb861-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb861-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">read_c =</span> <span class="fu">ifelse</span>(read_c <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;low (-1.58)&quot;</span>, <span class="st">&quot;high (1.58)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb861-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb861-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>, </span>
<span id="cb861-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> read_c, <span class="at">color =</span> read_c)) <span class="sc">+</span></span>
<span id="cb861-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb861-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb861-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb861-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb861-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb861-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb861-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Model B&quot;</span>) <span class="sc">+</span></span>
<span id="cb861-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb861-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-24" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb861-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb861-25" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-72-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>Notice how unimpressive the expected trajectories between the two levels of <code>read_c</code> are when you include the 95% interval bands. Beware plots of fitted lines that do not include the 95% intervals!</p>
<p>We might compare our two nonlinear models with their WAIC estimates.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb862-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.15</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.15</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb862-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb862-2" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.16</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.16</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb862-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb862-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb862-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb862-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.15</span>, fit6<span class="fl">.16</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.16     0.0       0.0 -1235.7      18.3         28.6     3.2    2471.5    36.7
## fit6.15     0.0       0.5 -1235.7      18.3         28.4     3.2    2471.5    36.6</code></pre>
<p>They’re nearly the same, suggesting <code>fit6.16</code> was overfit. However, now that we have it, we might use our overfit model <code>fit6.16</code> to an updated version of Figure 6.8.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the new data</span></span>
<span id="cb864-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb864-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-3" aria-hidden="true" tabindex="-1"></a>  foxngeese_pp <span class="sc">%&gt;%</span> </span>
<span id="cb864-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, read_c) <span class="sc">%&gt;%</span> </span>
<span id="cb864-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> subset) <span class="sc">%&gt;%</span> </span>
<span id="cb864-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(id, read_c),</span>
<span id="cb864-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">game =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb864-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb864-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb864-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-10" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the fitted trajectories</span></span>
<span id="cb864-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-11" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit6<span class="fl">.16</span>, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb864-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb864-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb864-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb864-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb864-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb864-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game)) <span class="sc">+</span></span>
<span id="cb864-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb864-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>, <span class="at">fill =</span> read_c),</span>
<span id="cb864-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb864-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">color =</span> read_c)) <span class="sc">+</span> </span>
<span id="cb864-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> foxngeese_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(id <span class="sc">%in%</span> subset),</span>
<span id="cb864-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> nmoves),</span>
<span id="cb864-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb864-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">begin =</span> .<span class="dv">15</span>, <span class="at">end =</span> .<span class="dv">85</span>, </span>
<span id="cb864-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">range</span>(foxngeese_pp<span class="sc">$</span>read_c)) <span class="sc">+</span></span>
<span id="cb864-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">begin =</span> .<span class="dv">15</span>, <span class="at">end =</span> .<span class="dv">85</span>, </span>
<span id="cb864-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">limits =</span> <span class="fu">range</span>(foxngeese_pp<span class="sc">$</span>read_c)) <span class="sc">+</span></span>
<span id="cb864-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb864-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb864-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb864-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-74-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="a-survey-of-truly-nonlinear-change-trajectories." class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> A survey of truly nonlinear change trajectories.</h3>
<blockquote>
<p>By now you should realize that you can represent individual change using a virtually limitless number of mathematical functions….</p>
<p>How then can you possibly specify a suitable model for your data and purposes? Clearly, you need more than empirical evidence. Among a group of well-fitting growth models, blind numeric comparison of descriptive statistics, goodness-of-fit, and regression diagnostics will rarely pick out the best one. As you might expect, we recommend that you blend theory and empirical evidence, articulating a rationale that you can translate into a statistical model. This recommendation underscores an important point that can often be overlooked in the heat of data analysis: <em>substance is paramount</em>. The best way to select an appropriate individual growth model is to work within an explicit theoretical framework. We suggest that you ask not “What is the best model for the job?” but, rather, “What model is most theoretically sound?” (pp. 232–233, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Based on the work of Mead and Pike <span class="citation">(<a href="references.html#ref-head1975review" role="doc-biblioref">1975</a>)</span>, Singer and Willett suggested we might divide up the range of nonlinear models into four bins:</p>
<ul>
<li>polynomial,</li>
<li>hyperbolic,</li>
<li>inverse polynomial, and</li>
<li>exponential.</li>
</ul>
<div id="hyperbolic-growth." class="section level4" number="6.4.3.1">
<h4><span class="header-section-number">6.4.3.1</span> Hyperbolic growth.</h4>
<blockquote>
<p>The <em>rectangular hyperbola</em> is one of the simplest nonlinear models for individual change. <em>TIME</em> enters as a <em>reciprocal</em> in the denominator of the model’s right side. This model possesses an important property for modeling biological and agricultural growth: over time, its outcome smoothly approaches–but never reaches–an asymptote. (p. 234, <em>emphasis</em> in the original)</p>
</blockquote>
<p>The example of a hyperbolic growth from Table 6.7 (p. 234) followed the form</p>
<p><span class="math display">\[Y_{ij} = \alpha_i - \frac{1}{\pi_{1i} TIME_{ij}} + \epsilon_{ij},\]</span></p>
<p>where <span class="math inline">\(\pi_{1i}\)</span> is kinda like a growth slope and there is no <span class="math inline">\(\pi_{0i}\)</span> because <span class="math inline">\(\pi_{0i}\)</span> parameters are for losers. To get a sense of what this model provides, here’s our version of the upper-left panel of Figure 6.11.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb865-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">time  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>, <span class="fl">4.6</span>, <span class="dv">8</span>),</span>
<span id="cb865-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">102.5</span>, <span class="dv">90</span>, <span class="dv">87</span>, <span class="dv">85</span>),</span>
<span id="cb865-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;alpha==100&quot;</span>,</span>
<span id="cb865-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.01&quot;</span>,</span>
<span id="cb865-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.02&quot;</span>,</span>
<span id="cb865-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.1&quot;</span>))</span>
<span id="cb865-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb865-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">alpha =</span> <span class="dv">100</span>,</span>
<span id="cb865-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">pi1   =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb865-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(alpha, pi1),</span>
<span id="cb865-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb865-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> alpha <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">/</span> (pi1 <span class="sc">*</span> time))) <span class="sc">%&gt;%</span> </span>
<span id="cb865-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb865-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> y, <span class="at">group =</span> pi1)) <span class="sc">+</span></span>
<span id="cb865-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb865-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb865-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb865-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb865-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb865-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Hyperbola&quot;</span>,</span>
<span id="cb865-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">E</span>(<span class="fu">italic</span>(Y)))) <span class="sc">+</span></span>
<span id="cb865-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb865-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb865-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb865-27" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-75-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Note how, in this plot, <span class="math inline">\(\alpha\)</span> is the upper asymptote.</p>
</div>
<div id="inverse-polynomial-growth." class="section level4" number="6.4.3.2">
<h4><span class="header-section-number">6.4.3.2</span> Inverse polynomial growth.</h4>
<p>“The family of <em>inverse polynomials</em> extends the rectangular hyperbola by adding higher powers of <em>TIME</em> to the denominator of the quotient on the model’s right side” (p. 236, <em>emphasis</em> in the original). The example of a hyperbolic growth from Table 6.7 followed the form</p>
<p><span class="math display">\[Y_{ij} = \alpha_i - \frac{1}{\pi_{1i} TIME_{ij} + \pi_{2i} TIME_{ij}^2} + \epsilon_{ij}.\]</span></p>
<p>To get a sense of what this model provides, here’s our version of the upper-right panel of Figure 6.11.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb866-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">time  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.5</span>, <span class="fl">7.5</span>, <span class="dv">10</span>, <span class="fl">1.5</span>),</span>
<span id="cb866-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">102.5</span>, <span class="dv">94</span>, <span class="dv">91</span>, <span class="dv">77</span>, <span class="dv">8</span>),</span>
<span id="cb866-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;alpha==100&quot;</span>,</span>
<span id="cb866-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[2]==0.015&quot;</span>,</span>
<span id="cb866-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[2]==0&quot;</span>,</span>
<span id="cb866-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[2]==-0.0015&quot;</span>,</span>
<span id="cb866-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.02~(&#39;for all curves&#39;)&quot;</span>),</span>
<span id="cb866-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb866-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb866-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb866-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">alpha =</span> <span class="dv">100</span>,</span>
<span id="cb866-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">pi1   =</span>  <span class="fl">0.02</span>,</span>
<span id="cb866-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">pi2   =</span> <span class="fu">c</span>(<span class="fl">0.015</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.0015</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb866-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(alpha, pi1, pi2),</span>
<span id="cb866-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb866-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> alpha <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">/</span> (pi1 <span class="sc">*</span> time <span class="sc">+</span> pi2 <span class="sc">*</span> time<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb866-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb866-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> y, <span class="at">group =</span> pi2)) <span class="sc">+</span></span>
<span id="cb866-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb866-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb866-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb866-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">hjust =</span> hjust),</span>
<span id="cb866-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb866-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Inverse polynomial&quot;</span>,</span>
<span id="cb866-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">E</span>(<span class="fu">italic</span>(Y)))) <span class="sc">+</span></span>
<span id="cb866-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb866-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb866-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb866-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb866-30" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-76-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="exponential-growth." class="section level4" number="6.4.3.3">
<h4><span class="header-section-number">6.4.3.3</span> Exponential growth.</h4>
<blockquote>
<p>Exponential growth is probably the most widely used class of truly nonlinear models. This theoretically compelling group has been used for centuries to model biological, agricultural, and physical growth. This class includes a wide range of different functional forms, but all contain an <em>exponent of</em> <span class="math inline">\(e\)</span>, the base of the natural logarithm. (p. 237, <em>emphasis</em> in the original)</p>
</blockquote>
<p>The example of simple exponential growth from Table 6.7 followed the form</p>
<p><span class="math display">\[Y_{ij} = \pi_{0i} e^{\pi_{1i} TIME_{ij}} + \epsilon_{ij},\]</span></p>
<p>where now we have the triumphant return of <span class="math inline">\(\pi_{0i}\)</span>, which still isn’t quite an intercept but is close to one. The of negative exponential growth from Table 6.7 followed the form</p>
<p><span class="math display">\[Y_{ij} = \alpha_i -(\alpha_i - \pi_{0i}) e^{\pi_{1i} TIME_{ij}} + \epsilon_{ij}.\]</span></p>
<p>Let’s make the panels of the lower row of Figure 6.11.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb867-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-2" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb867-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">time  =</span> <span class="dv">10</span>,</span>
<span id="cb867-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">100.5</span>, <span class="dv">39</span>, <span class="dv">16</span>, <span class="dv">1</span>),</span>
<span id="cb867-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;pi[1]==0.3&quot;</span>,</span>
<span id="cb867-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.2&quot;</span>,</span>
<span id="cb867-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.1&quot;</span>,</span>
<span id="cb867-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[0]==5~(&#39;for all curves&#39;)&quot;</span>),</span>
<span id="cb867-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">vjust =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>))</span>
<span id="cb867-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-11" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb867-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">pi0 =</span> <span class="dv">5</span>,</span>
<span id="cb867-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">pi1 =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb867-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(pi0, pi1),</span>
<span id="cb867-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb867-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> pi0 <span class="sc">*</span> <span class="fu">exp</span>(pi1 <span class="sc">*</span> time)) <span class="sc">%&gt;%</span> </span>
<span id="cb867-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb867-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> y, <span class="at">group =</span> pi1)) <span class="sc">+</span></span>
<span id="cb867-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb867-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb867-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb867-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">vjust =</span> vjust),</span>
<span id="cb867-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb867-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Exponential (simple)&quot;</span>,</span>
<span id="cb867-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">E</span>(<span class="fu">italic</span>(Y)))) <span class="sc">+</span></span>
<span id="cb867-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb867-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb867-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-29" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb867-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-30" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb867-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">time  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">7</span>),</span>
<span id="cb867-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">102.5</span>, <span class="dv">98</span>, <span class="dv">83</span>, <span class="dv">63</span>, <span class="dv">20</span>),</span>
<span id="cb867-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;alpha==100&quot;</span>,</span>
<span id="cb867-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-34" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.3&quot;</span>,</span>
<span id="cb867-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-35" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.2&quot;</span>,</span>
<span id="cb867-36"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-36" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==0.1&quot;</span>,</span>
<span id="cb867-37"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-37" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[0]==20~(&#39;for all curves&#39;)&quot;</span>),</span>
<span id="cb867-38"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb867-39"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb867-40"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-40" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb867-41"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">alpha =</span> <span class="dv">100</span>,</span>
<span id="cb867-42"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">pi0   =</span> <span class="dv">20</span>,</span>
<span id="cb867-43"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">pi1   =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb867-44"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(alpha, pi0, pi1),</span>
<span id="cb867-45"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb867-46"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> alpha <span class="sc">-</span> (alpha <span class="sc">-</span> pi0) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>pi1 <span class="sc">*</span> time)) <span class="sc">%&gt;%</span> </span>
<span id="cb867-47"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb867-48"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> y, <span class="at">group =</span> pi1)) <span class="sc">+</span></span>
<span id="cb867-49"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb867-50"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb867-51"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb867-52"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">hjust =</span> hjust),</span>
<span id="cb867-53"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb867-54"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Negative exponential&quot;</span>,</span>
<span id="cb867-55"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">E</span>(<span class="fu">italic</span>(Y)))) <span class="sc">+</span></span>
<span id="cb867-56"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb867-57"><a href="modeling-discontinuous-and-nonlinear-change.html#cb867-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Now combine the ggplots to make the full version of Figure 6.11.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb868-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-78-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>As covered, above, the logistic trajectory is great when you have need of both lower and upper asymptotic. I might note that the logistic models we fit were not what you’d expect when thinking of what is typically called <em>logistic regression</em>. Conventional logistic regression models don’t add a normally-distributed error term. Rather, error is simply a function of the expected value. It’s something of a shame Singer and Willett didn’t cover logistic multilevel growth models. Is such a shame, in fact, that we’ll go rogue and cover them in a <a href="modeling-discontinuous-and-nonlinear-change.html#bonus-the-logistic-growth-model">bonus section</a> a the end of this chapter.</p>
</div>
</div>
<div id="from-substantive-theory-to-mathematical-representations-of-individual-growth." class="section level3" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> From substantive theory to mathematical representations of individual growth.</h3>
<p>Here’s how to make Figure 6.12.</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb869-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">time  =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">9.8</span>, <span class="fl">9.8</span>, <span class="fl">9.8</span>, <span class="dv">1</span>),</span>
<span id="cb869-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">102.5</span>, <span class="dv">87</span>, <span class="dv">63</span>, <span class="dv">46</span>, <span class="dv">10</span>),</span>
<span id="cb869-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;alpha==100&quot;</span>,</span>
<span id="cb869-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==1&quot;</span>,</span>
<span id="cb869-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==5&quot;</span>,</span>
<span id="cb869-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[1]==10&quot;</span>,</span>
<span id="cb869-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;pi[0]==10~(&#39;for all curves&#39;)&quot;</span>),</span>
<span id="cb869-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb869-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb869-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-11" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">alpha =</span> <span class="dv">100</span>,</span>
<span id="cb869-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pi0   =</span> <span class="dv">10</span>,</span>
<span id="cb869-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pi1   =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb869-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(alpha, pi0, pi1),</span>
<span id="cb869-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb869-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> pi0 <span class="sc">+</span> ((alpha <span class="sc">-</span> pi0) <span class="sc">*</span> time) <span class="sc">/</span> (pi1 <span class="sc">+</span> time)) <span class="sc">%&gt;%</span> </span>
<span id="cb869-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb869-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> y, <span class="at">group =</span> pi1)) <span class="sc">+</span></span>
<span id="cb869-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb869-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb869-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb869-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">hjust =</span> hjust),</span>
<span id="cb869-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb869-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb869-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">E</span>(<span class="fu">italic</span>(Y))), </span>
<span id="cb869-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb869-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Thurstone&#39;s learning equation&quot;</span>) <span class="sc">+</span></span>
<span id="cb869-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb869-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-79-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Just to get in a little more practice with non-linear models and the <strong>brms</strong> non-liner syntax, we might practice applying Thurstone’s learning equation to our children’s behavioral data from the last section. As before, our preliminary task to to pick our prior. Based on what we already know about the data and also based on the curves we see in the plot, above, I recommend we select something like <span class="math inline">\(\gamma_{00} \sim \operatorname{Normal}(2, 1)\)</span> and <span class="math inline">\(\gamma_{10} \sim \operatorname{Normal}(5, 2)\)</span>. To get a sense of what that’d mean, here’s a prior predictive check.</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many do you want?</span></span>
<span id="cb870-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb870-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate</span></span>
<span id="cb870-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb870-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb870-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">n   =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb870-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">pi0 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb870-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">pi1 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb870-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(n, pi0, pi1),</span>
<span id="cb870-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">game =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb870-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> pi0 <span class="sc">+</span> (((alpha <span class="sc">-</span> pi0) <span class="sc">*</span> game) <span class="sc">/</span> (pi1 <span class="sc">+</span> game))) <span class="sc">%&gt;%</span></span>
<span id="cb870-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb870-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb870-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game, <span class="at">y =</span> y, <span class="at">group =</span> n)) <span class="sc">+</span></span>
<span id="cb870-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb870-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb870-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb870-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-80-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Play around with different priors on your own. Here’s how to fit the model to the <code>foxngeese_pp</code> data.</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.17</span> <span class="ot">&lt;-</span></span>
<span id="cb871-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> foxngeese_pp, </span>
<span id="cb871-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb871-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(nmoves <span class="sc">~</span> g0 <span class="sc">+</span> (((<span class="dv">20</span> <span class="sc">-</span> g0) <span class="sc">*</span> game) <span class="sc">/</span> (g1 <span class="sc">+</span> game)),</span>
<span id="cb871-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-5" aria-hidden="true" tabindex="-1"></a>         g0 <span class="sc">+</span> g1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>i<span class="sc">|</span> id), </span>
<span id="cb871-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb871-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nlpar =</span> g0),</span>
<span id="cb871-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">5</span>, <span class="dv">2</span>), <span class="at">nlpar =</span> g1),</span>
<span id="cb871-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">nlpar =</span> g0),</span>
<span id="cb871-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">nlpar =</span> g1),</span>
<span id="cb871-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb871-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb871-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">3</span>, <span class="at">chains =</span> <span class="dv">3</span>,</span>
<span id="cb871-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">inits =</span> <span class="dv">0</span>, </span>
<span id="cb871-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>),</span>
<span id="cb871-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb871-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.17&quot;</span>)</span></code></pre></div>
<p>Check the parameter summary.</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb872-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit6<span class="fl">.17</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: nmoves ~ g0 + (((20 - g0) * game)/(g1 + game)) 
##          g0 ~ 1 + (1 | i | id)
##          g1 ~ 1 + (1 | i | id)
##    Data: foxngeese_pp (Number of observations: 445) 
## Samples: 3 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 3000
## 
## Group-Level Effects: 
## ~id (Number of levels: 17) 
##                                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(g0_Intercept)                   0.40      0.35     0.01     1.32 1.00     1824     1577
## sd(g1_Intercept)                  17.12      3.03    11.82    23.62 1.00     2004     2275
## cor(g0_Intercept,g1_Intercept)    -0.03      0.31    -0.62     0.55 1.03      234      570
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## g0_Intercept     0.54      0.51    -0.44     1.56 1.00     1827     2106
## g1_Intercept     9.26      2.03     5.28    13.10 1.00     2282     2053
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     4.30      0.15     4.03     4.61 1.00     4692     2190
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We might use our Thurstone model to an updated version of Figure 6.8.</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the new data</span></span>
<span id="cb874-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb874-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-3" aria-hidden="true" tabindex="-1"></a>  foxngeese_pp <span class="sc">%&gt;%</span> </span>
<span id="cb874-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb874-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> subset) <span class="sc">%&gt;%</span> </span>
<span id="cb874-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(id, <span class="at">game =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">30</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb874-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb874-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-8" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the fitted trajectories</span></span>
<span id="cb874-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit6<span class="fl">.17</span>, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb874-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb874-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb874-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb874-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb874-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb874-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game)) <span class="sc">+</span></span>
<span id="cb874-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb874-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb874-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb874-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span> </span>
<span id="cb874-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> foxngeese_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(id <span class="sc">%in%</span> subset),</span>
<span id="cb874-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> nmoves),</span>
<span id="cb874-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb874-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb874-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb874-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb874-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb874-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> id, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-82-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Doesn’t look great. Notice how the parameters in this model did not restrict the fitted trajectories to respect the lower asymptote. Thurstone’s model has no lower asymptote. Let’s see how this model compares with the unconditional logistic model, <code>fit6.15</code>, by way of the WAIC.</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb875-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.17</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit6<span class="fl">.17</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb875-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb875-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb875-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit6<span class="fl">.15</span>, fit6<span class="fl">.17</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit6.15     0.0       0.0 -1235.7      18.3         28.4     3.2    2471.5    36.6
## fit6.17   -55.5      10.4 -1291.2      14.0         17.4     1.2    2582.5    27.9</code></pre>
<p>Yep, the logistic model captured the patterns in these data better than Thurstone’s learning model.</p>
</div>
</div>
<div id="bonus-the-logistic-growth-model" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Bonus: The logistic growth model</h2>
<p>In the social sciences, binary data are a widely-collected data type which are often best analyzed with a nonlinear model. In this section, we’ll practice fitting a multilevel growth model on binary data using logistic regression. This will differ from the logistic curve models, above, in that we will not be presuming normally distributed errors, <span class="math inline">\(\epsilon_{ij} \sim \operatorname N(0, \sigma_\epsilon)\)</span>. Rather, we’ll be using a different likelihood altogether.</p>
<div id="we-need-data." class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> We need data.</h3>
<p>In this section, we’ll be borrowing a data file from the <a href="https://stat.columbia.edu/~gelman/arm/software/">supplemental material</a> from <span class="citation"><a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">Gelman &amp; Hill</a> (<a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">2006</a>)</span>, <em>Data analysis using regression and multilevel/hierarchical models</em>.</p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-1" aria-hidden="true" tabindex="-1"></a>dogs <span class="ot">&lt;-</span> </span>
<span id="cb877-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_delim</span>(<span class="st">&quot;extra_data/dogs.txt&quot;</span>, </span>
<span id="cb877-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, </span>
<span id="cb877-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">escape_double =</span> <span class="cn">FALSE</span>, </span>
<span id="cb877-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">trim_ws =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb877-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dog =</span> Dog)</span>
<span id="cb877-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb877-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb877-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dogs)</span></code></pre></div>
<pre><code>## Rows: 30
## Columns: 26
## $ dog  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, …
## $ T.0  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
## $ T.1  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0
## $ T.2  &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0
## $ T.3  &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0
## $ T.4  &lt;dbl&gt; 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0
## $ T.5  &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1
## $ T.6  &lt;dbl&gt; 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0
## $ T.7  &lt;dbl&gt; 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1
## $ T.8  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0
## $ T.9  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1
## $ T.10 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1
## $ T.11 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0
## $ T.12 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1
## $ T.13 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0
## $ T.14 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0
## $ T.15 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0
## $ T.16 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1
## $ T.17 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1
## $ T.18 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1
## $ T.19 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
## $ T.20 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
## $ T.21 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0
## $ T.22 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
## $ T.23 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
## $ T.24 &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0</code></pre>
<p>The data are initially in the wide format. Here we make the <code>dogs</code> data long.</p>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb879-1" aria-hidden="true" tabindex="-1"></a>dogs <span class="ot">&lt;-</span></span>
<span id="cb879-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb879-2" aria-hidden="true" tabindex="-1"></a>  dogs <span class="sc">%&gt;%</span> </span>
<span id="cb879-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb879-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>dog, <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb879-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb879-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial =</span> <span class="fu">str_remove</span>(name, <span class="st">&quot;T.&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.double</span>())</span>
<span id="cb879-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb879-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb879-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb879-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dogs)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##     dog name      y trial
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 T.0       0     0
## 2     1 T.1       0     1
## 3     1 T.2       1     2
## 4     1 T.3       0     3
## 5     1 T.4       1     4
## 6     1 T.5       0     5</code></pre>
<p>As Gelman and Hill described (p. 515), these data were taken from a behavioral experiment in the 1950’s. Thirty dogs learned a new trick. Each of the 30 dogs was given 25 trials to learn the trick. In these data, <em>time</em> is captured by the <code>tial</code> column, which ranges from <code>0</code> (the first trial) to <code>24</code> (the final 25<sup>th</sup> trial). The criterion variable is <code>y</code>, which is coded <code>0</code> = fail, <code>1</code> = success. To give a sense of the data, here’s a descriptive plot of a randomly-chosen subset of eight of the dogs.</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the dog subset</span></span>
<span id="cb881-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb881-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb881-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-4" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb881-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb881-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-6" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the data</span></span>
<span id="cb881-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-7" aria-hidden="true" tabindex="-1"></a>dogs <span class="sc">%&gt;%</span> </span>
<span id="cb881-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dog <span class="sc">%in%</span> subset) <span class="sc">%&gt;%</span> </span>
<span id="cb881-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb881-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb881-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb881-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb881-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb881-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb881-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb881-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> dog, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-86-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>At the beginning of the experiment (<code>trial == 0</code>), none of the dogs new how to do the trick (i.e., for each one, <code>y == 0</code>). However, the dogs tended to learn the trick (i.e., get <code>y == 1</code>) by around the fifth or tenth trial. When modeling data of this kind, the conventional <span class="math inline">\(\epsilon_{ij} \sim \operatorname N(0, \sigma_\epsilon)\)</span> assumption has no hope of working. It’s just inappropriate. To get a sense of why, we’ll need to get technical.</p>
</div>
<div id="have-you-heard-of-the-generalized-linear-mixed-model" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Have you heard of the generalized linear [mixed] model?</h3>
<p>This wasn’t really addressed in Singer and Willett, but not all data kinds produce nicely Gaussian residuals. Though multilevel models can help with this, they won’t always do the job, particularly with binary data. Happily, the family of approaches described as the <em>generalized linear mixed model</em> (GLMM) will allow you to handle all kinds of wacky time-series data types. I’m not really going to offer a thorough introduction to the GLMM, here. For that, see <span class="citation"><a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">Gelman &amp; Hill</a> (<a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">2006</a>)</span> or <span class="citation"><a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">McElreath</a> (<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">2020a</a>)</span>. However, we will explore one strategy from the GLMM framework, which replaces the Gaussian likelihood with the Bernoulli.</p>
<div id="sometimes-data-come-in-0s-and-1s." class="section level4" number="6.5.2.1">
<h4><span class="header-section-number">6.5.2.1</span> Sometimes data come in 0’s and 1’s.</h4>
<p>Say you have a set of binary data <span class="math inline">\(y_i\)</span>. You can summarize those data as <span class="math inline">\(N\)</span> trials, for which <span class="math inline">\(z\)</span> were <span class="math inline">\(1\)</span>’s. So if we had five coin flips, for which we assigned <em>heads</em> as 1 and <em>tails</em> as 0, we might describe those data as <span class="math inline">\(N = 5\)</span> Bernoulli trials with <span class="math inline">\(z = 4\)</span> successes. In ‘Bernoulli trials talk,’ <em>success</em> is often a synonym for <span class="math inline">\(y_i = 1\)</span>. Further, you can use the Bernoulli likelihood to describe the probability <span class="math inline">\(y_i = 1\)</span>, given an underlying probability <span class="math inline">\(p\)</span>, as</p>
<p><span class="math display">\[\operatorname{Pr}(y_i = 1 | p) = p^z (1 - p)^{N - z}.\]</span></p>
<p>Let’s see how this plays out. First, we’ll make a custom <code>bernoulli_likelihood()</code> function.</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-1" aria-hidden="true" tabindex="-1"></a>bernoulli_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(p, data) {</span>
<span id="cb882-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb882-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb882-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-4" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">sum</span>(data)</span>
<span id="cb882-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb882-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-6" aria-hidden="true" tabindex="-1"></a>  p<span class="sc">^</span>z <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>(n <span class="sc">-</span> <span class="fu">sum</span>(data))</span>
<span id="cb882-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb882-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb882-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we’ll apply this function to a range of possible <span class="math inline">\(p\)</span> values and data of the kind we just discussed, <span class="math inline">\(N = 5\)</span> trials, for which <span class="math inline">\(z = 4\)</span>.</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb883-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">p =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb883-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">bernoulli_likelihood</span>(p, data)) <span class="sc">%&gt;%</span> </span>
<span id="cb883-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb883-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb883-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb883-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">8</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb883-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(p)), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb883-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;likelihood&quot;</span>) <span class="sc">+</span></span>
<span id="cb883-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb883-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-88-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Note how the maximum value for this likelihood, given our data, is at <span class="math inline">\(p = .8\)</span>. It’s also the case that the sample mean of a set of Bernoulli trials is the same as the sample estimate of <span class="math inline">\(p\)</span>. Let’s confirm.</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb884-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data)</span></code></pre></div>
<pre><code>## [1] 0.8</code></pre>
<p>Although the sample mean gave us a point estimate for <span class="math inline">\(p\)</span>, it was our use of the Bernoulli likelihood function that gave us a sense of the relative likelihoods of all possible values of <span class="math inline">\(p\)</span>. It also gave us a sense of the certainty for our sample estimate of <span class="math inline">\(p\)</span>. As is usually the case, our certainty will increase when <span class="math inline">\(N\)</span> increases. For example, consider the case of <span class="math inline">\(N = 100\)</span> and <span class="math inline">\(z = 80\)</span>.</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb886-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb886-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb886-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(z, n <span class="sc">-</span> z))</span>
<span id="cb886-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb886-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">p =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>,  <span class="at">length.out =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb886-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">bernoulli_likelihood</span>(p, data)) <span class="sc">%&gt;%</span> </span>
<span id="cb886-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb886-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb886-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb886-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> z <span class="sc">/</span> n, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb886-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(p)), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb886-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;likelihood&quot;</span>) <span class="sc">+</span></span>
<span id="cb886-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb886-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-90-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The same ratio of <span class="math inline">\(z/N\)</span> produced the same point estimate of <span class="math inline">\(p\)</span>, but the overall shape of the likelihood was more concentrated around that point estimate (the mode) than in our first example.</p>
</div>
<div id="recall-how-we-can-express-models-in-terms-of-the-gaussian-likelihood." class="section level4" number="6.5.2.2">
<h4><span class="header-section-number">6.5.2.2</span> Recall how we can express models in terms of the Gaussian likelihood.</h4>
<p>Throughout the text, Singer and Willett express their models in terms true scores and stochastic elements. For a simple single-level model of one predictor <span class="math inline">\(x_i\)</span> for a criterion <span class="math inline">\(y_i\)</span>, Singer and Willett might express that model as</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp; = [b_0 + b_1 x_i] + \epsilon_i \\
\epsilon_i &amp; \sim \operatorname{N}(0, \sigma_\epsilon^2),
\end{align*}
\]</span></p>
<p>where the <span class="math inline">\(y_i = [b_0 + b_1 x_i]\)</span> portion describes the deterministic part of the model (the true score) and the <span class="math inline">\(\epsilon_i\)</span> portion describes the stochastic part of the model (the residual variance). As we briefly covered in <a href="introducing-the-multilevel-model-for-change.html#the-stochastic-part-of-the-level-1-submodel.">Section 3.2.2</a>, it turns out that another way to express this model is</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp; \sim \operatorname{N}(\mu_i, \sigma_\epsilon^2)\\
\mu_i &amp; = b_0 + b_1 x_i,
\end{align*}
\]</span></p>
<p>where we more explicitly declare that the criterion <span class="math inline">\(y_i\)</span> follows a conditional Normal distribution for which we model the mean with the equation <span class="math inline">\(\mu_i = b_0 + b_1 x_i\)</span> and we express the variation around the conditional mean as <span class="math inline">\(\sigma_\epsilon^2\)</span>. The advantage of adopting this style of model notation is it generalizes well to data of other kinds for which we might want to use other likelihoods, such as the Bernoulli.</p>
</div>
<div id="the-simple-logistic-regression-model-using-the-bernoulli-likelihood." class="section level4" number="6.5.2.3">
<h4><span class="header-section-number">6.5.2.3</span> The simple logistic regression model using the Bernoulli likelihood.</h4>
<p>Now consider our example of <span class="math inline">\(N = 100\)</span> Bernoulli trials data, <span class="math inline">\(y_i\)</span>, for which <span class="math inline">\(z = 80\)</span>. We can use the likelihood-based notation to express that as</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp; \sim \operatorname{Bernoulli}(p_i)\\
\operatorname{logit}(p_i) &amp; = b_0,
\end{align*}
\]</span></p>
<p>where, since we don’t have a predictor variable, the intercept <span class="math inline">\(b_0\)</span> is the log-odds probability. <em>Why ‘log-odds?’</em> you say. Well, the problem of fitting regression models for probabilities (<span class="math inline">\(p_i\)</span>) is that probabilities are logically bounded between 0 and 1. Yet there’s nothing inherent in the machinery of the conventional linear regression model to prevent predictions outside of those bound. Happily, our friends the statisticians can help us get around that with the aid of link functions. If we model the logit of <span class="math inline">\(p\)</span>, <span class="math inline">\(\operatorname{logit}(p_i)\)</span>, instead of modeling <span class="math inline">\(p\)</span> directly, we end up with an inherently nonlinear model that will always produce estimates within the bounds of 0 and 1. Another way of expressing this model is by nesting the right-hand part of the equation within the inverse logit function,</p>
<p><span class="math display">\[
\begin{align*}
y_i &amp; \sim \operatorname{Bernoulli}(p_i) \\
p_i &amp; = \operatorname{logit}^{-1}(b_0),
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\operatorname{logit}^{-1}\)</span> is called the inverse logit. This use of the logit/inverse-logit function is where <em>logistic regression</em> get’s its name. Getting to the functions themselves, the logistic function is</p>
<p><span class="math display">\[\operatorname{logit}(x) = \log \left ( \frac{x}{1 - x} \right ).\]</span></p>
<p>You may recall that the odds of a probability is defined as <span class="math inline">\(\left ( \frac{p}{1 - p}\right )\)</span>. Therefore, we can describe <span class="math inline">\(\operatorname{logit}(p)\)</span> as the log odds of the probability, or <span class="math inline">\(p\)</span> in a log-odds metric. Anyway, the inverse of the logistic function is</p>
<p><span class="math display">\[\operatorname{logit}^{-1}(x) = \frac{e^x}{1 + e^x}.\]</span></p>
<p>To bring this all down to earth, here’s what happens when we apply the logistic function to a series of values ranging between 0 and 1.</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">p =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">001</span>, <span class="at">to =</span> .<span class="dv">999</span>, <span class="at">by =</span> .<span class="dv">001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb887-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">odds =</span> p <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p)) <span class="sc">%&gt;%</span> </span>
<span id="cb887-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_odds =</span> <span class="fu">log</span>(odds)) <span class="sc">%&gt;%</span> </span>
<span id="cb887-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb887-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> log_odds)) <span class="sc">+</span></span>
<span id="cb887-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb887-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb887-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb887-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(p)), </span>
<span id="cb887-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.25&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;.75&quot;</span>, <span class="st">&quot;1&quot;</span>),</span>
<span id="cb887-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb887-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(p)<span class="sc">~</span>(log<span class="sc">~</span>odds)), <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb887-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb887-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb887-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-91-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>The consequence of the logistic function is it can take the probability values, which are necessarily bounded within 0 and 1, and transform then to the unbounded log-odds space. Thus, if you fit a linear regression model on <span class="math inline">\(\operatorname{logit}(p)\)</span>, you will avoid making predictions that <span class="math inline">\(p\)</span> is less than 0 or greater than 1.</p>
<p>Hopefully this is all just review. Now let’s consider the longitudinal multilevel model version of this model type for our <code>dogs</code> data.</p>
</div>
</div>
<div id="define-the-simple-logistic-multilevel-growth-model." class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Define the simple logistic multilevel growth model.</h3>
<p>If we have <span class="math inline">\(j\)</span> Bernoulli trials nested within <span class="math inline">\(i\)</span> participants over time, we can express the generic logistic multilevel growth model as</p>
<p><span class="math display">\[\begin{align*}
y_{ij} &amp; \sim \operatorname{Bernoulli}(p_{ij}) \\
\operatorname{logit}(p_{ij}) &amp; = \pi_{0i} + \pi_{1i} \text{time}_{ij} \\
\pi_{0i} &amp; = \gamma_{00} + \zeta_{0i} \\
\pi_{1i} &amp; = \gamma_{10} + \zeta_{1i} \\
\begin{bmatrix} \zeta_{0i} \\ \zeta_{1i} \end{bmatrix} &amp; 
 \sim \operatorname{Normal}  \begin{pmatrix} \begin{bmatrix} 
   0 \\ 0  \end{bmatrix}, \mathbf D \mathbf \Omega 
   \mathbf D&#39; \end{pmatrix} \\
   
\mathbf D &amp; = \begin{bmatrix} \sigma_0 &amp; 0 \\ 0 &amp; \sigma_1\end{bmatrix} \\ 
\mathbf\Omega &amp; = \begin{bmatrix} 1 &amp; \rho_{01} \\ 
 \rho_{10} &amp; 1 \end{bmatrix},   
\end{align*}\]</span></p>
<p>where we make the usual multivariate-normal assumptions about <span class="math inline">\(\zeta_{0i}\)</span> and <span class="math inline">\(\zeta_{1i}\)</span>. Yet because we are modeling the <span class="math inline">\(y_{ij}\)</span> with the Bernoulli likelihood, we end up setting the linear model to <span class="math inline">\(\operatorname{logit}(p_{ij})\)</span>. And also, because the Bernoulli distribution doesn’t itself have a <span class="math inline">\(\sigma\)</span> parameter, we have no <span class="math inline">\(\sigma_\epsilon\)</span> term. That is, though the <span class="math inline">\(\zeta\)</span> parameters get a multivariate normal distribution, the <span class="math inline">\(y_{ij}\)</span> data is considered Bernoulli. We have multiple distributional assumptions within a single model and this is totally okay.</p>
<p>Now let’s see how this will work with our <code>dogs</code> data.</p>
</div>
<div id="ease-into-the-model-with-a-prior-predictive-check." class="section level3" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Ease into the model with a prior predictive check.</h3>
<p>If we focus just on the top parts of the model, we can express the logistic multilevel growth model for our <code>dogs</code> data as</p>
<p><span class="math display">\[
\begin{align*}
y_{ij} &amp; \sim \operatorname{Bernoulli}(p_{ij}) \\
\operatorname{logit}(p_{ij}) &amp; = \gamma_{00} + \gamma_{10} \text{trial}_{ij} + [\zeta_{0i} + \zeta_{1i} \text{trial}_{ij}],  
\end{align*}
\]</span></p>
<p>where the Bernoulli trials <span class="math inline">\(y\)</span> are nested within <span class="math inline">\(i\)</span> dogs across <span class="math inline">\(j\)</span> trials. As with all Bayesian models, we have to place priors on all model parameters. Before we get all technical with the model, let’s review what we know about the data:</p>
<ul>
<li>there were 25 trials;</li>
<li>the <code>trial</code> variable is coded such that the first of the trials is <code>trial == 0</code> and the 25<sup>th</sup> is <code>trial == 24</code>;</li>
<li>the dogs didn’t know how to do the trick, at first; and</li>
<li>the dogs all tended to learn the trick after several trials.</li>
</ul>
<p>Now if we were the actual scientists who collected these data and wanted to model them for a scientific publication, we wouldn’t have known that last bullet point before collecting the data. But perhaps we could have hypothesized that the dogs would tend to learn after a handful of trials. Anyway, this information tells us that because of the scaling of the predictor variable <code>trial</code>, the <span class="math inline">\(\gamma_{00}\)</span> parameter will be the expected value at the first trial. Since we know the dogs didn’t know how to do the trick at this point in the experiment, the probability value should be close to zero. Also, since we know the trials are scaled from <code>0</code> to <code>24</code>, we also know that the coefficient increases in time, <span class="math inline">\(\gamma_{10}\)</span>, should be positive since we expect improvement, but it shouldn’t be overly large since we don’t expect a lot of learning from one trial to the next. Rather, we expect to see learning unfold across several trials.</p>
<p>The difficulty is how to encode these insights into parameters that will make good predictions in the log-odds probability space. If you look up at our last plot, you’ll see that <span class="math inline">\(p = .5\)</span> is the same as <span class="math inline">\(\operatorname{logit}(p) = 0\)</span>. You’ll also notice that as <span class="math inline">\(p \rightarrow 0\)</span>, <span class="math inline">\(\operatorname{logit}(p) \rightarrow -\infty\)</span>. Further, <span class="math inline">\(p = .25 \approx \operatorname{logit}(p) = -1.1\)</span> and <span class="math inline">\(p = .1 \approx \operatorname{logit}(p) = -2.2\)</span>. Thus, we might express our expectation that the initial probability of success will be low with a prior centered somewhere around -2. I propose we consider <span class="math inline">\(\gamma_{00} \sim \operatorname N(-2, 1)\)</span>.</p>
<p>Now we consider our effect size from trial to trial, <span class="math inline">\(\gamma_{10}\)</span>. This should be modest on the log-odds space. Somewhere between 0 and 1 would be weakly regularizing. I propose we consider <span class="math inline">\(\gamma_{10} \sim \operatorname N(0.25, 0.25)\)</span>.</p>
<p>To get a sense of what these priors would predict, let’s do a prior predictive check. McElreath covered this strategy extensively in his <span class="citation">(<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">2020a</a>)</span> text. Here we’ll simulate 1,000 draws using these two priors, given 25 trials.</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many simulations?</span></span>
<span id="cb888-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb888-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb888-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb888-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb888-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb888-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-7" aria-hidden="true" tabindex="-1"></a>       <span class="co"># notice we set the parameters on the log-odds scale</span></span>
<span id="cb888-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">b0   =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb888-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">b1   =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">0.25</span>, <span class="at">sd =</span> <span class="fl">0.25</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb888-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(iter, b0, b1),</span>
<span id="cb888-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">trial =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">24</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb888-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we use the inverse logit function to convert the liner model to the probability metric</span></span>
<span id="cb888-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">inv_logit_scaled</span>(b0 <span class="sc">+</span> b1 <span class="sc">*</span> trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb888-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb888-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb888-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> y, <span class="at">group =</span> iter)) <span class="sc">+</span></span>
<span id="cb888-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb888-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb888-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(p[i][j])), </span>
<span id="cb888-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.25&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;.75&quot;</span>, <span class="st">&quot;1&quot;</span>),</span>
<span id="cb888-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb888-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;prior predictive check&quot;</span>) <span class="sc">+</span></span>
<span id="cb888-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb888-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-92-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>To my eye, this is about what we want. Our <span class="math inline">\(\gamma_{00} \sim \operatorname N(-2, 1)\)</span> prior concentrated the probability values close to zero at the start, but it was permissive enough to allow for the possibility that the success probability could be nearly as high as .5, or so. Also, our <span class="math inline">\(\gamma_{10} \sim \operatorname N(0.25, 0.25)\)</span> prior was largely consistent with moderate growth across trials, but it was not so heavy-handed that it prevented the possibility of no growth or even getting worse, over time.`</p>
<p>Especially if you’re new to this, see what happens if you fool with the priors, a little.</p>
<p>Next, we’ll need to think about the priors for our <span class="math inline">\(\sigma\)</span>’s. Since we generally like those to be only weakly regularizing, I suggest we continue on with <span class="math inline">\(\operatorname{Exponential}(1)\)</span>, which puts an expected value at 1, easily allows for values as low as zero, and gently discourages very large values. As to the <span class="math inline">\(\mathbf \Omega\)</span> matrix, we’ll stick with the good old <span class="math inline">\(\operatorname{LKJ}(4)\)</span>.</p>
<p>Thus, we can express the full model as</p>
<p><span class="math display">\[
\begin{align*}
y_{ij} &amp; \sim \operatorname{Bernoulli}(p_{ij}) \\
\operatorname{logit}(p_{ij}) &amp; = \gamma_{00} + \gamma_{10} \text{time}_{ij} + \zeta_{0i} + \zeta_{1i} \text{time}_{ij} \\
\begin{bmatrix} \zeta_{0i} \\ \zeta_{1i} \end{bmatrix} &amp; 
 \sim \operatorname{Normal}(\mathbf 0, \mathbf D \mathbf \Omega \mathbf D&#39;) \\
\mathbf D &amp; = \begin{bmatrix} \sigma_0 &amp; 0 \\ 0 &amp; \sigma_1 \end{bmatrix} \\ 
\mathbf\Omega &amp; = \begin{bmatrix} 1 &amp; \rho_{01} \\ 
 \rho_{10} &amp; 1 \end{bmatrix} \\
\gamma_{00} &amp; \sim \operatorname{Normal}(-2, 1) \\ 
\gamma_{10} &amp; \sim \operatorname{Normal}(0.25, 0.25) \\
\sigma_0\ \&amp;\ \sigma_1 &amp; \sim \operatorname{Exponential}(1) \\ 
\mathbf \Omega &amp; \sim \operatorname{LKJ}(4).
\end{align*}
\]</span></p>
<p>To fit this model with <strong>brms</strong>, the big new trick is setting <code>family = bernoulli</code>. By default, <code>brm()</code> will use the logit link.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-1" aria-hidden="true" tabindex="-1"></a>fit6<span class="fl">.18</span> <span class="ot">&lt;-</span> </span>
<span id="cb889-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dogs,</span>
<span id="cb889-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> bernoulli,</span>
<span id="cb889-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-4" aria-hidden="true" tabindex="-1"></a>      y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> trial <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> trial <span class="sc">|</span> dog),</span>
<span id="cb889-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb889-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b),</span>
<span id="cb889-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb889-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb889-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">3</span>, <span class="at">chains =</span> <span class="dv">3</span>,</span>
<span id="cb889-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb889-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb889-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit06.18&quot;</span>)</span></code></pre></div>
<p>Check the parameter summary.</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit6<span class="fl">.18</span>)</span></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: y ~ 0 + Intercept + trial + (1 + trial | dog) 
##    Data: dogs (Number of observations: 750) 
## Samples: 3 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 3000
## 
## Group-Level Effects: 
## ~dog (Number of levels: 30) 
##                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)            0.35      0.24     0.01     0.89 1.00      796     1293
## sd(trial)                0.09      0.03     0.04     0.14 1.00      647      914
## cor(Intercept,trial)    -0.06      0.33    -0.66     0.59 1.00      519     1254
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -2.33      0.24    -2.81    -1.87 1.00     2113     1758
## trial         0.35      0.03     0.29     0.42 1.00     1430     1922
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>It can take a while to make sense of the output of a logistic regression model, multilevel or otherwise. Perhaps for now, you might compare the sizes of our posterior means with the priors we used. To me, it’s helpful to see what this model predicts. For that, we’ll want to extract the posterior draws.</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb892-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(fit6<span class="fl">.18</span>)</span></code></pre></div>
<p>If we focus on the <span class="math inline">\(\gamma\)</span>’s, here’s the population trajectory in <span class="math inline">\(p\)</span>, across the trials.</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-1" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span> </span>
<span id="cb893-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(b_Intercept, b_trial),</span>
<span id="cb893-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">trial =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb893-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the magic happens here</span></span>
<span id="cb893-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">inv_logit_scaled</span>(b_Intercept <span class="sc">+</span> b_trial <span class="sc">*</span> trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb893-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb893-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> prob)) <span class="sc">+</span></span>
<span id="cb893-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb893-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">&quot;grey67&quot;</span>, .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb893-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;probability of success&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb893-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;The population-level learning curve&quot;</span>,</span>
<span id="cb893-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">expression</span>(We<span class="sc">~</span>get<span class="sc">~</span>the<span class="sc">~</span>overall<span class="sc">~</span>success<span class="sc">~</span>probability<span class="sc">~</span>over<span class="sc">~</span>time<span class="sc">~</span>with<span class="sc">~</span>logit<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}<span class="sc">*</span>(gamma[<span class="dv">0</span>][<span class="dv">0</span>]<span class="sc">+</span>gamma[<span class="dv">1</span>][<span class="dv">0</span>]<span class="sc">*</span><span class="fu">italic</span>(trial[j]))<span class="sc">*</span><span class="st">&#39;.&#39;</span>)) <span class="sc">+</span></span>
<span id="cb893-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb893-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-95-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>In the <code>mutate()</code> line, note our use of the <code>brms::inv_logit_scaled()</code> function (i.e., the <span class="math inline">\(\operatorname{logit}^{-1}\)</span> function). That line was the equivalent of <span class="math inline">\(p_j = \operatorname{logit}^{-1}(\gamma_{00} + \gamma_{10} \text{time}_j)\)</span>. Another thing to keep in mind: The conventional Gaussian regression paradigm, particularly when using the Singer and Willet style <span class="math inline">\(\epsilon_i \sim \operatorname{N}(0, \sigma_\epsilon^2)\)</span> notation, can give you a sense that the regression models are supposed to be in the metric of the criterion. That is, we expect to see <span class="math inline">\(y_{ij}\)</span> on the <span class="math inline">\(y\)</span>-axis of our trajectory plots. That isn’t the case when we switch to logistic regression. Now, we’re predicting <span class="math inline">\(p(y_{ij} = 1)\)</span>, not <span class="math inline">\(y_{ij}\)</span> itself. This is why our trajectory can take on all values between 0 and 1, whereas our criterion <span class="math inline">\(y_{ij}\)</span> can only take on 0’s and 1’s.</p>
<p>Another question we might ask of our model is at what point across the <code>trial</code> axis do we cross the threshold of a <span class="math inline">\(p = .5\)</span> success rate? For a simple model, like ours, the formula for that threshold is <span class="math inline">\(-\gamma_{00}/ \gamma_{10}\)</span>. Here’s how to compute and summarize the threshold with our posterior draws.</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb894-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span></span>
<span id="cb894-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb894-2" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span></span>
<span id="cb894-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb894-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">threshold =</span> <span class="sc">-</span>b_Intercept <span class="sc">/</span> b_trial) <span class="sc">%&gt;%</span> </span>
<span id="cb894-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb894-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>()</span>
<span id="cb894-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb894-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb894-6" aria-hidden="true" tabindex="-1"></a>threshold</span></code></pre></div>
<pre><code>##   threshold   .lower   .upper .width .point .interval
## 1  6.715498 5.752162 7.771128   0.95   mean        qi</code></pre>
<p>The population threshold is about 6.7 trials, give or take one. Here’s what that looks like in a plot.</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust for plotting</span></span>
<span id="cb896-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-2" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> </span>
<span id="cb896-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-3" aria-hidden="true" tabindex="-1"></a>  threshold <span class="sc">%&gt;%</span> </span>
<span id="cb896-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(threshold, .lower, .upper),</span>
<span id="cb896-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb896-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb896-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-7" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb896-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-8" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span> </span>
<span id="cb896-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(b_Intercept, b_trial),</span>
<span id="cb896-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">trial =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb896-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">inv_logit_scaled</span>(b_Intercept <span class="sc">+</span> b_trial <span class="sc">*</span> trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb896-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb896-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb896-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> prob)) <span class="sc">+</span></span>
<span id="cb896-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb896-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb896-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">&quot;grey67&quot;</span>, .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb896-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> threshold,</span>
<span id="cb896-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> threshold, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper),</span>
<span id="cb896-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb896-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb896-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;probability of success&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb896-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;The population-level threshold&quot;</span>,</span>
<span id="cb896-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="sc">-</span>gamma[<span class="dv">0</span>][<span class="dv">0</span>]<span class="sc">/</span>gamma[<span class="dv">1</span>][<span class="dv">0</span>]<span class="sc">*</span><span class="st">&quot; marks the typical half-way point for learning.&quot;</span>),</span>
<span id="cb896-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;trial&quot;</span>) <span class="sc">+</span></span>
<span id="cb896-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb896-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-97-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>The plot is a little cumbersome, but hopefully it clarifies the idea.</p>
<p>Next, we might want to better understand our model at the level of the dogs. As a first step, we might make a plot of the 30 dog-level <span class="math inline">\(\pi\)</span> parameters.</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb897-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-2" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span></span>
<span id="cb897-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb897-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pi0</span></span>
<span id="cb897-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-5" aria-hidden="true" tabindex="-1"></a>    post <span class="sc">%&gt;%</span> </span>
<span id="cb897-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;Intercept]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb897-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate_all</span>(<span class="sc">~</span> . <span class="sc">+</span> post<span class="sc">$</span>b_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb897-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>),</span>
<span id="cb897-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pi1</span></span>
<span id="cb897-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-10" aria-hidden="true" tabindex="-1"></a>    post <span class="sc">%&gt;%</span> </span>
<span id="cb897-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;trial]&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb897-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate_all</span>(<span class="sc">~</span> . <span class="sc">+</span> post<span class="sc">$</span>b_trial) <span class="sc">%&gt;%</span> </span>
<span id="cb897-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb897-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb897-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3000</span>, <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb897-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">pi   =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;p0&quot;</span>, <span class="st">&quot;p1&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb897-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(iter, pi)) <span class="sc">%&gt;%</span> </span>
<span id="cb897-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> pi, <span class="at">values_from =</span> value) </span>
<span id="cb897-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb897-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb897-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-21" aria-hidden="true" tabindex="-1"></a>pi <span class="sc">%&gt;%</span> </span>
<span id="cb897-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p0, <span class="at">y =</span> p1, <span class="at">group =</span> name)) <span class="sc">+</span></span>
<span id="cb897-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">&quot;polygon&quot;</span>, <span class="at">level =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb897-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dog-level intercepts and slopes&quot;</span>,</span>
<span id="cb897-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Each ellipse marks off the 10% posterior interval.&quot;</span>,</span>
<span id="cb897-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(pi[<span class="dv">0</span>][<span class="fu">italic</span>(i)]<span class="sc">~</span>(log<span class="sc">~</span>odds)),</span>
<span id="cb897-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(pi[<span class="dv">1</span>][<span class="fu">italic</span>(i)]<span class="sc">~</span>(log<span class="sc">~</span>odds))) <span class="sc">+</span></span>
<span id="cb897-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb897-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-98-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The full bivariate posterior for each dog’s <span class="math inline">\(\pi\)</span>’s is wider than we’ve depicted with our little 10% ellipses. But even those ellipses give you a sense of their distributions better than simple posterior mean points. It can be hard to interpret these, directly, since both the axes are on the log-odds scale. But hopefully you can at least get a sense of two things: There’s more variability <em>across</em> the <span class="math inline">\(\pi_{0i}\)</span> parameters than across the <span class="math inline">\(\pi_{1i}\)</span> parameters (look at the ranges in the axes). Also, there is more variability <em>within</em> the <span class="math inline">\(\pi_{0i}\)</span> parameters than within the <span class="math inline">\(\pi_{1i}\)</span> parameters (look at the shapes of the ellipses, themselves). This is the essence of the posterior means and standard deviations of the level-2 <span class="math inline">\(\sigma\)</span> parameters.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb898-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit6<span class="fl">.18</span>)[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##                    Estimate Est.Error
## sd_dog__Intercept 0.3477971 0.2411927
## sd_dog__trial     0.0850827 0.0261195</code></pre>
<p>All this is still quite abstract. It might be helpful if we plotted a handful of the dog-specific trajectories.</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb900-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">dog   =</span> subset,</span>
<span id="cb900-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">trial =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb900-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb900-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit6<span class="fl">.18</span>, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb900-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb900-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb900-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb900-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb900-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb900-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb900-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb900-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb900-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dogs <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dog <span class="sc">%in%</span> subset),</span>
<span id="cb900-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb900-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;y&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb900-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb900-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb900-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> dog, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-100-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Keep in mind that whereas the <span class="math inline">\(y\)</span>-axis is on the scale of the data, the trajectories themselves are actually of <span class="math inline">\(p_{ij}\)</span>. To my eye, the dog-level trajectories all look very similar. It might be easier to detect the variation across the dogs by way of their thresholds. To compute the dog-level thresholds, we use the formula <span class="math inline">\(-\pi_{0i} / \pi_{1i}\)</span>.</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-1" aria-hidden="true" tabindex="-1"></a>pi <span class="sc">%&gt;%</span> </span>
<span id="cb901-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">threshold =</span> <span class="sc">-</span>p0 <span class="sc">/</span> p1) <span class="sc">%&gt;%</span> </span>
<span id="cb901-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb901-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-4" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">mean_qi</span>(threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb901-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb901-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> threshold, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> <span class="fu">reorder</span>(name, threshold))) <span class="sc">+</span></span>
<span id="cb901-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb901-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="st">&quot;dogs, ranked by threshold&quot;</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb901-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb901-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">expression</span>(<span class="dv">50</span><span class="sc">*</span><span class="st">&#39;%&#39;</span><span class="sc">~</span>threshold),</span>
<span id="cb901-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="sc">-</span>pi[<span class="dv">0</span>][<span class="fu">italic</span>(i)]<span class="sc">/</span>pi[<span class="dv">1</span>][<span class="fu">italic</span>(i)]<span class="sc">*</span><span class="st">&quot; marks the point where the &quot;</span><span class="sc">*</span><span class="fu">italic</span>(i)<span class="sc">*</span><span class="st">&quot;th dog has acquired the skill half way.&quot;</span>),</span>
<span id="cb901-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;trial&quot;</span>) <span class="sc">+</span></span>
<span id="cb901-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb901-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-101-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>The dog-specific thresholds range from <span class="math inline">\(5 \pm 2\)</span> to <span class="math inline">\(12 \pm 3.5\)</span>. Here’s what it looks like if we adjust our trajectory plots to include the threshold information.</p>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the dog-level thresholds</span></span>
<span id="cb902-2"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-2" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span></span>
<span id="cb902-3"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-3" aria-hidden="true" tabindex="-1"></a>  pi <span class="sc">%&gt;%</span> </span>
<span id="cb902-4"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">threshold =</span> <span class="sc">-</span>p0 <span class="sc">/</span> p1) <span class="sc">%&gt;%</span> </span>
<span id="cb902-5"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb902-6"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-6" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">mean_qi</span>(threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb902-7"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dog =</span> name <span class="sc">%&gt;%</span> <span class="fu">as.double</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb902-8"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dog, threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb902-9"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dog <span class="sc">%in%</span> subset) <span class="sc">%&gt;%</span> </span>
<span id="cb902-10"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(dog, threshold),</span>
<span id="cb902-11"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">point =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb902-12"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial =</span> <span class="fu">ifelse</span>(point <span class="sc">==</span> <span class="dv">1</span>, <span class="sc">-</span><span class="cn">Inf</span>, threshold),</span>
<span id="cb902-13"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob  =</span> <span class="fu">ifelse</span>(point <span class="sc">==</span> <span class="dv">3</span>, <span class="sc">-</span><span class="cn">Inf</span>, .<span class="dv">5</span>))</span>
<span id="cb902-14"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb902-15"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-15" aria-hidden="true" tabindex="-1"></a><span class="co"># go through the usual fitted() steps</span></span>
<span id="cb902-16"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-16" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb902-17"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">dog   =</span> subset,</span>
<span id="cb902-18"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">trial =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb902-19"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb902-20"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-20" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit6<span class="fl">.18</span>, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb902-21"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb902-22"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb902-23"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb902-24"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb902-25"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial)) <span class="sc">+</span></span>
<span id="cb902-26"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb902-27"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb902-28"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb902-29"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb902-30"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> threshold,</span>
<span id="cb902-31"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> prob),</span>
<span id="cb902-32"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb902-33"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;success probability&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb902-34"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb902-35"><a href="modeling-discontinuous-and-nonlinear-change.html#cb902-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> dog, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-102-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To keep things simple, we only focused on threshold posterior means.</p>
</div>
<div id="you-may-want-more." class="section level3" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> You may want more.</h3>
<p>If you’d like more practice with logistic regression, with other aspects of the generalized linear model, Here are a few resources to consider:</p>
<ul>
<li><span class="citation"><a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">Gelman &amp; Hill</a> (<a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">2006</a>)</span> covered the generalized linear model, including logistic regression, in both single-level and multilevel contexts. You can find their supplemental materials at <a href="https://www.stat.columbia.edu/~gelman/arm/software/">https://www.stat.columbia.edu/~gelman/arm/software/</a>. Heads up: some of their Bayesian model code is getting a dated.</li>
<li><span class="citation"><a href="references.html#ref-gelmanRegressionOtherStories2020" role="doc-biblioref">Gelman et al.</a> (<a href="references.html#ref-gelmanRegressionOtherStories2020" role="doc-biblioref">2020</a>)</span> is something of a second edition of the first half of <span class="citation"><a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">Gelman &amp; Hill</a> (<a href="references.html#ref-gelmanDataAnalysisUsing2006" role="doc-biblioref">2006</a>)</span>. This text covered the generalized linear model, but only from a single-level context. You can find supporting materials at <a href="https://avehtari.github.io/ROS-Examples/">https://avehtari.github.io/ROS-Examples/</a>.</li>
<li>Both editions of McElreath’s text <span class="citation">(<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">2020a</a>, <a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2015" role="doc-biblioref">2015</a>)</span> cover the generalized linear model, including logistic regression, from both single-level and multilevel contexts. You can find all kinds of supporting material at <a href="https://xcelab.net/rm/statistical-rethinking/">https://xcelab.net/rm/statistical-rethinking/</a>.</li>
<li>I have <strong>tidyverse</strong> + <strong>brms</strong> ebook translations of both of McElreath’s texts <span class="citation">(<a href="references.html#ref-kurzStatisticalRethinkingBrms2020" role="doc-biblioref">Kurz, 2020</a>, <a href="references.html#ref-kurzStatisticalRethinkingSecondEd2021" role="doc-biblioref">2021</a>)</span>. I’m also slowly working through <span class="citation"><a href="references.html#ref-gelmanRegressionOtherStories2020" role="doc-biblioref">Gelman et al.</a> (<a href="references.html#ref-gelmanRegressionOtherStories2020" role="doc-biblioref">2020</a>)</span>, which you can find on GitHub at <a href="https://github.com/ASKurz/Working-through-Regression-and-other-stories">https://github.com/ASKurz/Working-through-Regression-and-other-stories</a>.</li>
</ul>
</div>
</div>
<div id="session-info-5" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="modeling-discontinuous-and-nonlinear-change.html#cb903-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.0.4 (2021-02-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidybayes_2.3.1 GGally_2.1.1    brms_2.15.0     Rcpp_1.0.6      patchwork_1.1.1 forcats_0.5.1  
##  [7] stringr_1.4.0   dplyr_1.0.5     purrr_0.3.4     readr_1.4.0     tidyr_1.1.3     tibble_3.1.0   
## [13] ggplot2_3.3.3   tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##   [1] uuid_0.1-4           readxl_1.3.1         backports_1.2.1      systemfonts_1.0.1    plyr_1.8.6          
##   [6] igraph_1.2.6         svUnit_1.0.3         splines_4.0.4        crosstalk_1.1.0.1    TH.data_1.0-10      
##  [11] rstantools_2.1.1     inline_0.3.17        digest_0.6.27        htmltools_0.5.1.1    rsconnect_0.8.16    
##  [16] fansi_0.4.2          magrittr_2.0.1       modelr_0.1.8         RcppParallel_5.0.2   matrixStats_0.57.0  
##  [21] officer_0.3.17       xts_0.12.1           sandwich_3.0-0       prettyunits_1.1.1    colorspace_2.0-0    
##  [26] rvest_0.3.6          ggdist_2.4.0.9000    haven_2.3.1          xfun_0.22            callr_3.5.1         
##  [31] crayon_1.4.1         jsonlite_1.7.2       lme4_1.1-25          survival_3.2-10      zoo_1.8-8           
##  [36] glue_1.4.2           gtable_0.3.0         emmeans_1.5.2-1      V8_3.4.0             distributional_0.2.2
##  [41] pkgbuild_1.2.0       rstan_2.21.2         abind_1.4-5          scales_1.1.1         mvtnorm_1.1-1       
##  [46] DBI_1.1.0            miniUI_0.1.1.1       viridisLite_0.3.0    xtable_1.8-4         stats4_4.0.4        
##  [51] StanHeaders_2.21.0-7 DT_0.16              htmlwidgets_1.5.2    httr_1.4.2           threejs_0.3.3       
##  [56] arrayhelpers_1.1-0   RColorBrewer_1.1-2   ellipsis_0.3.1       reshape_0.8.8        pkgconfig_2.0.3     
##  [61] loo_2.4.1            farver_2.0.3         dbplyr_2.0.0         utf8_1.1.4           tidyselect_1.1.0    
##  [66] labeling_0.4.2       rlang_0.4.10         reshape2_1.4.4       later_1.1.0.1        munsell_0.5.0       
##  [71] cellranger_1.1.0     tools_4.0.4          cli_2.3.1            generics_0.1.0       broom_0.7.5         
##  [76] ggridges_0.5.2       evaluate_0.14        fastmap_1.0.1        processx_3.4.5       knitr_1.31          
##  [81] fs_1.5.0             zip_2.1.1            nlme_3.1-152         mime_0.10            projpred_2.0.2      
##  [86] xml2_1.3.2           compiler_4.0.4       bayesplot_1.8.0      shinythemes_1.1.2    rstudioapi_0.13     
##  [91] gamm4_0.2-6          curl_4.3             reprex_0.3.0         statmod_1.4.35       stringi_1.5.3       
##  [96] highr_0.8            ps_1.6.0             Brobdingnag_1.2-6    gdtools_0.2.2        lattice_0.20-41     
## [101] Matrix_1.3-2         nloptr_1.2.2.2       markdown_1.1         shinyjs_2.0.0        vctrs_0.3.6         
## [106] pillar_1.5.1         lifecycle_1.0.0      bridgesampling_1.0-0 estimability_1.3     data.table_1.14.0   
## [111] flextable_0.6.4      httpuv_1.5.4         R6_2.5.0             bookdown_0.21        promises_1.1.1      
## [116] gridExtra_2.3        codetools_0.2-18     boot_1.3-26          colourpicker_1.1.0   MASS_7.3-53         
## [121] gtools_3.8.2         assertthat_0.2.1     withr_2.4.1          shinystan_2.5.0      multcomp_1.4-16     
## [126] mgcv_1.8-33          parallel_4.0.4       hms_0.5.3            grid_4.0.4           coda_0.19-4         
## [131] minqa_1.2.4          rmarkdown_2.7        shiny_1.5.0          lubridate_1.7.9.2    base64enc_0.1-3     
## [136] dygraphs_1.1.1.6</code></pre>
</div>
<div id="footnote" class="section level2 unnumbered">
<h2>Footnote</h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>You might also use our <code>sw_logistic()</code> to investigate the claims on what happens when <span class="math inline">\(\text{game}_{ij} \rightarrow \infty\)</span> or <span class="math inline">\(\text{game}_{ij} \rightarrow -\infty\)</span>.<a href="modeling-discontinuous-and-nonlinear-change.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="treating-time-more-flexibly.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="examining-the-multilevel-models-error-covariance-structure.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
