<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Extending the Discrete-Time Hazard Model | Applied longitudinal data analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Extending the Discrete-Time Hazard Model | Applied longitudinal data analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="github-repo" content="ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Extending the Discrete-Time Hazard Model | Applied longitudinal data analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2023-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fitting-basic-discrete-time-hazard-models.html"/>
<link rel="next" href="describing-continuous-time-event-occurrence-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html"><i class="fa fa-check"></i><b>1</b> A Framework for Investigating Change over Time</a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#when-might-you-study-change-over-time"><i class="fa fa-check"></i><b>1.1</b> When might you study change over time?</a></li>
<li class="chapter" data-level="1.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#distinguishing-between-two-types-of-questions-about-change"><i class="fa fa-check"></i><b>1.2</b> Distinguishing between two types of questions about change</a></li>
<li class="chapter" data-level="1.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#three-important-features-of-a-study-of-change"><i class="fa fa-check"></i><b>1.3</b> Three important features of a study of change</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#multiple-waves-of-data."><i class="fa fa-check"></i><b>1.3.1</b> Multiple waves of data.</a></li>
<li class="chapter" data-level="1.3.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-sensible-metric-for-time."><i class="fa fa-check"></i><b>1.3.2</b> A sensible metric for time.</a></li>
<li class="chapter" data-level="1.3.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-continuous-outcome-that-changes-systematically-over-time."><i class="fa fa-check"></i><b>1.3.3</b> A continuous outcome that changes systematically over time.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html"><i class="fa fa-check"></i><b>2</b> Exploring Longitudinal Data on Change</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#creating-a-longitudinal-data-set"><i class="fa fa-check"></i><b>2.1</b> Creating a longitudinal data set</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-level-data-set."><i class="fa fa-check"></i><b>2.1.1</b> The person-level data set.</a></li>
<li class="chapter" data-level="2.1.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-period-data-set."><i class="fa fa-check"></i><b>2.1.2</b> The person-period data set.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#descriptive-analysis-of-individual-change-over-time"><i class="fa fa-check"></i><b>2.2</b> Descriptive analysis of individual change over time</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#empirical-growth-plots."><i class="fa fa-check"></i><b>2.2.1</b> Empirical growth plots.</a></li>
<li class="chapter" data-level="2.2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-a-trajectory-to-summarize-each-persons-empirical-growth-record."><i class="fa fa-check"></i><b>2.2.2</b> Using a trajectory to summarize each person’s empirical growth record.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-differences-in-change-across-people"><i class="fa fa-check"></i><b>2.3</b> Exploring differences in change across people</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#examining-the-entire-set-of-smooth-trajectories."><i class="fa fa-check"></i><b>2.3.1</b> Examining the entire set of smooth trajectories.</a></li>
<li class="chapter" data-level="2.3.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-the-results-of-model-fitting-to-frame-questions-about-change."><i class="fa fa-check"></i><b>2.3.2</b> Using the results of model fitting to frame questions about change.</a></li>
<li class="chapter" data-level="2.3.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-the-relationship-between-change-and-time-invariant-predictors."><i class="fa fa-check"></i><b>2.3.3</b> Exploring the relationship between change and time-invariant predictors.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design"><i class="fa fa-check"></i><b>2.4</b> Improving the precision and reliability of <del>OLS</del> single-level-Bayesian-estimated rates of change: Lessons for research design</a></li>
<li class="chapter" data-level="" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>3</b> Introducing the Multilevel Model for Change</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#what-is-the-purpose-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>3.1</b> What is the purpose of the multilevel model for change?</a></li>
<li class="chapter" data-level="3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-1-submodel-for-individual-change"><i class="fa fa-check"></i><b>3.2</b> The level-1 submodel for individual change</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-structural-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.1</b> The structural part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-stochastic-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.2</b> The stochastic part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#relating-the-level-1-submodel-to-the-ols-exploratory-methods-of-chapter-2."><i class="fa fa-check"></i><b>3.2.3</b> Relating the level-1 submodel to the OLS exploratory methods of chapter 2.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-2-submodel-for-systematic-interindividual-differences-in-change"><i class="fa fa-check"></i><b>3.3</b> The level-2 submodel for systematic interindividual differences in change</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#structural-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.1</b> Structural components of the level-2 submodel.</a></li>
<li class="chapter" data-level="3.3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#stochastic-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.2</b> Stochastic components of the level-2 submodel.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#fitting-the-multilevel-model-for-change-to-data"><i class="fa fa-check"></i><b>3.4</b> Fitting the multilevel model for change to data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-advantages-of-maximum-likelihood-bayesian-estimation."><i class="fa fa-check"></i><b>3.4.1</b> The advantages of <del>maximum likelihood</del> Bayesian estimation.</a></li>
<li class="chapter" data-level="3.4.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#using-maximum-likelihood-modern-bayesian-methods-to-fit-a-multilevel-model."><i class="fa fa-check"></i><b>3.4.2</b> Using <del>maximum likelihood</del> modern Bayesian methods to fit a multilevel model.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-fixed-effects"><i class="fa fa-check"></i><b>3.5</b> Examining estimated fixed effects</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-estimated-fixed-effects."><i class="fa fa-check"></i><b>3.5.1</b> Interpreting estimated fixed effects.</a></li>
<li class="chapter" data-level="3.5.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-fixed-effects."><i class="fa fa-check"></i><b>3.5.2</b> Single parameter tests for the fixed effects.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-variance-components"><i class="fa fa-check"></i><b>3.6</b> Examining estimated variance components</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-the-estimated-variance-components."><i class="fa fa-check"></i><b>3.6.1</b> Interpreting the estimated variance components.</a></li>
<li class="chapter" data-level="3.6.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-variance-components."><i class="fa fa-check"></i><b>3.6.2</b> Single parameter tests for the variance components.</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#bonus-how-did-you-simulate-that-data"><i class="fa fa-check"></i><b>3.7</b> Bonus: How did you simulate that data?</a></li>
<li class="chapter" data-level="" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>4</b> Doing Data Analysis with the Multilevel Model for Change</a>
<ul>
<li class="chapter" data-level="4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#example-changes-in-adolescent-alcohol-use"><i class="fa fa-check"></i><b>4.1</b> Example: Changes in adolescent alcohol use</a></li>
<li class="chapter" data-level="4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-composite-specification-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>4.2</b> The composite specification of the multilevel model for change</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-structural-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.1</b> The structural component of the composite model.</a></li>
<li class="chapter" data-level="4.2.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-stochastic-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.2</b> The stochastic component of the composite model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#methods-of-estimation-revisited"><i class="fa fa-check"></i><b>4.3</b> Methods of estimation, revisited</a></li>
<li class="chapter" data-level="4.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#first-steps-fitting-two-unconditional-multilevel-models-for-change"><i class="fa fa-check"></i><b>4.4</b> First steps: Fitting two unconditional multilevel models for change</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-means-model."><i class="fa fa-check"></i><b>4.4.1</b> The unconditional means model.</a></li>
<li class="chapter" data-level="4.4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-growth-model."><i class="fa fa-check"></i><b>4.4.2</b> The unconditional growth model.</a></li>
<li class="chapter" data-level="4.4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#quantifying-the-proportion-of-outcome-variation-explained."><i class="fa fa-check"></i><b>4.4.3</b> Quantifying the proportion of outcome variation “explained.”</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#practical-data-analytic-strategies-for-model-building"><i class="fa fa-check"></i><b>4.5</b> Practical data analytic strategies for model building</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#a-taxonomy-of-statistical-models."><i class="fa fa-check"></i><b>4.5.1</b> A taxonomy of statistical models.</a></li>
<li class="chapter" data-level="4.5.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#interpreting-fitted-models."><i class="fa fa-check"></i><b>4.5.2</b> Interpreting fitted models.</a></li>
<li class="chapter" data-level="4.5.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#displaying-prototypical-change-trajectories."><i class="fa fa-check"></i><b>4.5.3</b> Displaying prototypical change trajectories.</a></li>
<li class="chapter" data-level="4.5.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#recentering-predictors-to-improve-interpretation."><i class="fa fa-check"></i><b>4.5.4</b> Recentering predictors to improve interpretation.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#comparing-models-using-deviance-statistics"><i class="fa fa-check"></i><b>4.6</b> Comparing models using deviance statistics</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-deviance-statistic."><i class="fa fa-check"></i><b>4.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="4.6.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#when-and-how-can-you-compare-deviance-statistics"><i class="fa fa-check"></i><b>4.6.2</b> When and how can you compare deviance statistics?</a></li>
<li class="chapter" data-level="4.6.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#implementing-deviance-based-hypothesis-tests."><i class="fa fa-check"></i><b>4.6.3</b> Implementing deviance-based hypothesis tests.</a></li>
<li class="chapter" data-level="4.6.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#aic-and-bic-waic-and-loo-statistics-comparing-nonnested-models-using-information-criteria-and-cross-validation."><i class="fa fa-check"></i><b>4.6.4</b> <del>AIC and BIC</del> WAIC and LOO statistics: Comparing nonnested models using information criteria [and cross validation].</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#using-wald-statistics-to-test-composite-hypotheses-about-fixed-effects"><i class="fa fa-check"></i><b>4.7</b> Using Wald statistics to test composite hypotheses about fixed effects</a></li>
<li class="chapter" data-level="4.8" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#evaluating-the-tenability-of-a-models-assumptions"><i class="fa fa-check"></i><b>4.8</b> Evaluating the tenability of a model’s assumptions</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-functional-form."><i class="fa fa-check"></i><b>4.8.1</b> Checking functional form.</a></li>
<li class="chapter" data-level="4.8.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-normality."><i class="fa fa-check"></i><b>4.8.2</b> Checking normality.</a></li>
<li class="chapter" data-level="4.8.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-homoscedasticity."><i class="fa fa-check"></i><b>4.8.3</b> Checking homoscedasticity.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#model-based-empirical-bayes-estimates-of-the-individual-growth-parameters"><i class="fa fa-check"></i><b>4.9</b> Model-based (Empirical Bayes) estimates of the individual growth parameters</a></li>
<li class="chapter" data-level="" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html"><i class="fa fa-check"></i><b>5</b> Treating Time More Flexibly</a>
<ul>
<li class="chapter" data-level="5.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#variably-spaced-measurement-occasions"><i class="fa fa-check"></i><b>5.1</b> Variably spaced measurement occasions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#the-structure-of-variably-spaced-data-sets."><i class="fa fa-check"></i><b>5.1.1</b> The structure of variably spaced data sets.</a></li>
<li class="chapter" data-level="5.1.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#postulating-and-fitting-multilevel-models-with-variably-spaced-waves-of-data."><i class="fa fa-check"></i><b>5.1.2</b> Postulating and fitting multilevel models with variably spaced waves of data.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#varying-numbers-of-measurement-occasions"><i class="fa fa-check"></i><b>5.2</b> Varying numbers of measurement occasions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#analyzing-data-sets-in-which-the-number-of-waves-per-person-varies."><i class="fa fa-check"></i><b>5.2.1</b> Analyzing data sets in which the number of waves per person varies.</a></li>
<li class="chapter" data-level="5.2.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#practical-problems-that-may-arise-when-analyzing-unbalanced-data-sets."><i class="fa fa-check"></i><b>5.2.2</b> Practical problems that may arise when analyzing unbalanced data sets.</a></li>
<li class="chapter" data-level="5.2.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#distinguishing-among-different-types-of-missingness."><i class="fa fa-check"></i><b>5.2.3</b> Distinguishing among different types of missingness.</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#time-varying-predictors"><i class="fa fa-check"></i><b>5.3</b> Time-varying predictors</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#including-the-main-effect-of-a-time-varying-predictor."><i class="fa fa-check"></i><b>5.3.1</b> Including the main effect of a time-varying predictor.</a></li>
<li class="chapter" data-level="5.3.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#allowing-the-effect-of-a-time-varying-predictor-to-vary-over-time."><i class="fa fa-check"></i><b>5.3.2</b> Allowing the effect of a time-varying predictor to vary over time.</a></li>
<li class="chapter" data-level="5.3.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-time-varying-predictors."><i class="fa fa-check"></i><b>5.3.3</b> Recentering time-varying predictors.</a></li>
<li class="chapter" data-level="5.3.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#an-important-caveat-the-problem-of-reciprocal-causation."><i class="fa fa-check"></i><b>5.3.4</b> An important caveat: The problem of reciprocal causation.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-the-effect-of-time"><i class="fa fa-check"></i><b>5.4</b> Recentering the effect of <em>TIME</em></a></li>
<li class="chapter" data-level="" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html"><i class="fa fa-check"></i><b>6</b> Modeling Discontinuous and Nonlinear Change</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#discontinuous-individual-change"><i class="fa fa-check"></i><b>6.1</b> Discontinuous individual change</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#alternative-discontinuous-level-1-models-for-change."><i class="fa fa-check"></i><b>6.1.1</b> Alternative discontinuous level-1 models for change.</a></li>
<li class="chapter" data-level="6.1.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#selecting-among-the-alternative-discontinuous-models."><i class="fa fa-check"></i><b>6.1.2</b> Selecting among the alternative discontinuous models.</a></li>
<li class="chapter" data-level="6.1.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#further-extensions-of-the-discontinuous-growth-model."><i class="fa fa-check"></i><b>6.1.3</b> Further extensions of the discontinuous growth model.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#using-transformations-to-model-nonlinear-individual-change"><i class="fa fa-check"></i><b>6.2</b> Using transformations to model nonlinear individual change</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-ladder-of-transformations-and-the-rule-of-the-bulge."><i class="fa fa-check"></i><b>6.2.1</b> The ladder of transformations and the rule of the bulge.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#representing-individual-change-using-a-polynomial-function-of-time"><i class="fa fa-check"></i><b>6.3</b> Representing individual change using a polynomial function of TIME</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-shapes-of-polynomial-individual-change-trajectories."><i class="fa fa-check"></i><b>6.3.1</b> The shapes of polynomial individual change trajectories.</a></li>
<li class="chapter" data-level="6.3.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#selecting-a-suitable-level-1-polynomial-trajectory-for-change."><i class="fa fa-check"></i><b>6.3.2</b> Selecting a suitable level-1 polynomial trajectory for change.</a></li>
<li class="chapter" data-level="6.3.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#testing-higher-order-terms-in-a-polynomial-level-1-model."><i class="fa fa-check"></i><b>6.3.3</b> Testing higher order terms in a polynomial level-1 model.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#truly-nonlinear-trajectories"><i class="fa fa-check"></i><b>6.4</b> Truly nonlinear trajectories</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#what-do-we-mean-by-truly-nonlinear-models"><i class="fa fa-check"></i><b>6.4.1</b> What do we mean by truly nonlinear models?</a></li>
<li class="chapter" data-level="6.4.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-logistic-individual-growth-curve."><i class="fa fa-check"></i><b>6.4.2</b> The logistic individual growth curve.</a></li>
<li class="chapter" data-level="6.4.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#a-survey-of-truly-nonlinear-change-trajectories."><i class="fa fa-check"></i><b>6.4.3</b> A survey of truly nonlinear change trajectories.</a></li>
<li class="chapter" data-level="6.4.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#from-substantive-theory-to-mathematical-representations-of-individual-growth."><i class="fa fa-check"></i><b>6.4.4</b> From substantive theory to mathematical representations of individual growth.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#bonus-the-logistic-growth-model"><i class="fa fa-check"></i><b>6.5</b> Bonus: The logistic growth model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#we-need-data."><i class="fa fa-check"></i><b>6.5.1</b> We need data.</a></li>
<li class="chapter" data-level="6.5.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#have-you-heard-of-the-generalized-linear-mixed-model"><i class="fa fa-check"></i><b>6.5.2</b> Have you heard of the generalized linear [mixed] model?</a></li>
<li class="chapter" data-level="6.5.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#define-the-simple-logistic-multilevel-growth-model."><i class="fa fa-check"></i><b>6.5.3</b> Define the simple logistic multilevel growth model.</a></li>
<li class="chapter" data-level="6.5.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#ease-into-the-model-with-a-prior-predictive-check."><i class="fa fa-check"></i><b>6.5.4</b> Ease into the model with a prior predictive check.</a></li>
<li class="chapter" data-level="6.5.5" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#you-may-want-more."><i class="fa fa-check"></i><b>6.5.5</b> You may want more.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html"><i class="fa fa-check"></i><b>7</b> Examining the Multilevel Model’s Error Covariance Structure</a>
<ul>
<li class="chapter" data-level="7.1" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#the-standard-specification-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>7.1</b> The “standard” specification of the multilevel model for change</a></li>
<li class="chapter" data-level="7.2" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#using-the-composite-model-to-understand-assumptions-about-the-error-covariance-matrix"><i class="fa fa-check"></i><b>7.2</b> Using the composite model to understand assumptions about the error covariance matrix</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#variance-of-the-composite-residual."><i class="fa fa-check"></i><b>7.2.1</b> Variance of the composite residual.</a></li>
<li class="chapter" data-level="7.2.2" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#covariance-of-the-composite-residuals."><i class="fa fa-check"></i><b>7.2.2</b> Covariance of the composite residuals.</a></li>
<li class="chapter" data-level="7.2.3" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#autocorrelation-of-the-composite-residuals."><i class="fa fa-check"></i><b>7.2.3</b> Autocorrelation of the composite residuals.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#postulating-an-alternative-error-covariance-structure"><i class="fa fa-check"></i><b>7.3</b> Postulating an alternative error covariance structure</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#unstructured-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.1</b> Unstructured error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.2" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#compound-symmetric-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.2</b> Compound symmetric error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.3" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#heterogeneous-compound-symmetric-error-covariance-matrix-."><i class="fa fa-check"></i><b>7.3.3</b> Heterogeneous compound symmetric error covariance matrix .</a></li>
<li class="chapter" data-level="7.3.4" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#autoregressive-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.4</b> Autoregressive error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.5" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#heterogeneous-autoregressive-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.5</b> Heterogeneous autoregressive error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.6" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#toeplitz-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.6</b> Toeplitz error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.7" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#does-choosing-the-correct-error-covariance-structure-really-matter"><i class="fa fa-check"></i><b>7.3.7</b> Does choosing the “correct” error covariance structure really matter?</a></li>
<li class="chapter" data-level="7.3.8" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#bonus-did-we-trade-multilevel-for-multivariate"><i class="fa fa-check"></i><b>7.3.8</b> Bonus: Did we trade multilevel for multivariate?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html"><i class="fa fa-check"></i><b>8</b> Modeling Change Using Covariance Structure Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html"><i class="fa fa-check"></i><b>9</b> A Framework for Investigating Event Occurrence</a>
<ul>
<li class="chapter" data-level="9.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#should-you-conduct-a-survival-analysis-the-whether-and-when-test"><i class="fa fa-check"></i><b>9.1</b> Should you conduct a survival analysis? The “whether” and “when” test</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#time-to-relapse-among-recently-treated-alcoholics."><i class="fa fa-check"></i><b>9.1.1</b> Time to relapse among recently treated alcoholics.</a></li>
<li class="chapter" data-level="9.1.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#length-of-stay-in-teaching."><i class="fa fa-check"></i><b>9.1.2</b> Length of stay in teaching.</a></li>
<li class="chapter" data-level="9.1.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#age-at-first-suicide-ideation."><i class="fa fa-check"></i><b>9.1.3</b> Age at first suicide ideation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#framing-a-research-question-about-event-occurrence"><i class="fa fa-check"></i><b>9.2</b> Framing a research question about event occurrence</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#defining-event-occurrence."><i class="fa fa-check"></i><b>9.2.1</b> Defining event occurrence.</a></li>
<li class="chapter" data-level="9.2.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#identifying-the-beginning-of-time."><i class="fa fa-check"></i><b>9.2.2</b> Identifying the “beginning of time.”</a></li>
<li class="chapter" data-level="9.2.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#specifying-a-metric-for-time."><i class="fa fa-check"></i><b>9.2.3</b> Specifying a metric for time.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#censoring-how-complete-are-the-data-on-event-occurrence"><i class="fa fa-check"></i><b>9.3</b> Censoring: How complete are the data on event occurrence?</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-and-why-does-censoring-arise"><i class="fa fa-check"></i><b>9.3.1</b> How and why does censoring arise?</a></li>
<li class="chapter" data-level="9.3.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#different-types-of-censoring."><i class="fa fa-check"></i><b>9.3.2</b> Different types of censoring.</a></li>
<li class="chapter" data-level="9.3.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-does-censoring-affect-statistical-analysis"><i class="fa fa-check"></i><b>9.3.3</b> How does censoring affect statistical analysis?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html"><i class="fa fa-check"></i><b>10</b> Describing Discrete-Time Event Occurrence Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-life-table"><i class="fa fa-check"></i><b>10.1</b> The life table</a></li>
<li class="chapter" data-level="10.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-framework-for-characterizing-the-distribution-of-discrete-time-event-occurrence-data"><i class="fa fa-check"></i><b>10.2</b> A framework for characterizing the distribution of discrete-time event occurrence data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-function."><i class="fa fa-check"></i><b>10.2.1</b> Survivor function.</a></li>
<li class="chapter" data-level="10.2.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#median-lifetime."><i class="fa fa-check"></i><b>10.2.2</b> Median lifetime.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#developing-intuition-about-hazard-functions-survivor-functions-and-median-lifetimes"><i class="fa fa-check"></i><b>10.3</b> Developing intuition about hazard functions, survivor functions, and median lifetimes</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#identifying-periods-of-high-and-low-risk-using-hazard-functions."><i class="fa fa-check"></i><b>10.3.1</b> Identifying periods of high and low risk using hazard functions.</a></li>
<li class="chapter" data-level="10.3.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-functions-as-a-context-for-evaluating-the-magnitude-of-hazard."><i class="fa fa-check"></i><b>10.3.2</b> Survivor functions as a context for evaluating the magnitude of hazard.</a></li>
<li class="chapter" data-level="10.3.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#strengths-and-limitations-of-estimated-median-lifetimes."><i class="fa fa-check"></i><b>10.3.3</b> Strengths and limitations of estimated median lifetimes.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#quantifying-the-effects-of-sampling-variation"><i class="fa fa-check"></i><b>10.4</b> Quantifying the effects of sampling variation</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-standard-error-of-the-estimated-hazard-probabilities."><i class="fa fa-check"></i><b>10.4.1</b> The standard error of the estimated hazard probabilities.</a></li>
<li class="chapter" data-level="10.4.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#standard-error-of-the-estimated-survival-probabilities."><i class="fa fa-check"></i><b>10.4.2</b> Standard error of the estimated survival probabilities.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-simple-and-useful-strategy-for-constructing-the-life-table"><i class="fa fa-check"></i><b>10.5</b> A simple and useful strategy for constructing the life table</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-person-period-data-set.-1"><i class="fa fa-check"></i><b>10.5.1</b> The person-period data set.</a></li>
<li class="chapter" data-level="10.5.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#using-the-person-period-data-set-to-construct-the-life-table."><i class="fa fa-check"></i><b>10.5.2</b> Using the person-period data set to construct the life table.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#bonus-fit-the-discrete-time-hazard-models-with-brms"><i class="fa fa-check"></i><b>10.6</b> Bonus: Fit the discrete-time hazard models with <strong>brms</strong></a></li>
<li class="chapter" data-level="" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html"><i class="fa fa-check"></i><b>11</b> Fitting Basic Discrete-Time Hazard Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#toward-a-statistical-model-for-discrete-time-hazard"><i class="fa fa-check"></i><b>11.1</b> Toward a statistical model for discrete-time hazard</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#plots-of-within-group-hazard-functions-and-survivor-functions."><i class="fa fa-check"></i><b>11.1.1</b> Plots of within-group hazard functions and survivor functions.</a></li>
<li class="chapter" data-level="11.1.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-kind-of-statistical-model-do-these-graphs-suggest"><i class="fa fa-check"></i><b>11.1.2</b> What kind of statistical model do these graphs suggest?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#formal-representation-of-the-population-discrete-time-hazard-model"><i class="fa fa-check"></i><b>11.2</b> Formal representation of the population discrete-time hazard model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-do-the-parameters-represent"><i class="fa fa-check"></i><b>11.2.1</b> What do the parameters represent?</a></li>
<li class="chapter" data-level="11.2.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#an-alternative-representation-of-the-model."><i class="fa fa-check"></i><b>11.2.2</b> An alternative representation of the model.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-a-discrete-time-hazard-model-to-data"><i class="fa fa-check"></i><b>11.3</b> Fitting a discrete-time hazard model to data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#adding-predictors-to-the-person-period-data-set."><i class="fa fa-check"></i><b>11.3.1</b> Adding predictors to the person-period data set.</a></li>
<li class="chapter" data-level="11.3.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#maximum-likelihood-estimates-and-bayesian-posteriors-for-the-discrete-time-hazard-model."><i class="fa fa-check"></i><b>11.3.2</b> Maximum likelihood estimates [and Bayesian posteriors] for the discrete-time hazard model.</a></li>
<li class="chapter" data-level="11.3.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-the-discrete-time-hazard-model-to-data."><i class="fa fa-check"></i><b>11.3.3</b> Fitting the discrete-time hazard model to data.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#interpreting-parameter-estimates"><i class="fa fa-check"></i><b>11.4</b> Interpreting parameter estimates</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-time-indicators."><i class="fa fa-check"></i><b>11.4.1</b> The time indicators.</a></li>
<li class="chapter" data-level="11.4.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#dichotomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.2</b> Dichotomous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#continuous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.3</b> Continuous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#polytomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.4</b> Polytomous substantive predictors.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#displaying-fitted-hazard-and-survivor-functions"><i class="fa fa-check"></i><b>11.5</b> Displaying fitted hazard and survivor functions</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#a-strategy-for-a-single-categorical-substantive-predictor."><i class="fa fa-check"></i><b>11.5.1</b> A strategy for a single categorical substantive predictor.</a></li>
<li class="chapter" data-level="11.5.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#extending-this-strategy-to-multiple-predictors-some-of-which-are-continuous."><i class="fa fa-check"></i><b>11.5.2</b> Extending this strategy to multiple predictors (some of which are continuous).</a></li>
<li class="chapter" data-level="11.5.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#two-cautions-when-interpreting-fitted-hazard-and-survivor-functions."><i class="fa fa-check"></i><b>11.5.3</b> Two cautions when interpreting fitted hazard and survivor functions.</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-models-using-deviance-statistics-and-information-criteria"><i class="fa fa-check"></i><b>11.6</b> Comparing models using <del>deviance statistics and</del> information criteria</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-deviance-statistic.-1"><i class="fa fa-check"></i><b>11.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="11.6.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-individual-predictors."><i class="fa fa-check"></i><b>11.6.2</b> Deviance-based hypothesis tests for individual predictors.</a></li>
<li class="chapter" data-level="11.6.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-groups-of-predictors."><i class="fa fa-check"></i><b>11.6.3</b> Deviance-based hypothesis tests for groups of predictors.</a></li>
<li class="chapter" data-level="11.6.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-nonnested-models-using-waic-and-loo."><i class="fa fa-check"></i><b>11.6.4</b> Comparing nonnested models using [WAIC and LOO].</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#statistical-inference-using-uncertainty-in-the-bayesian-posterior"><i class="fa fa-check"></i><b>11.7</b> Statistical inference using [uncertainty in the Bayesian posterior]</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-wald-chi-square-statistic."><i class="fa fa-check"></i><b>11.7.1</b> The <del>Wald chi-square statistic</del>.</a></li>
<li class="chapter" data-level="11.7.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#asymmetric-credible-intervals-for-parameters-and-odds-ratios."><i class="fa fa-check"></i><b>11.7.2</b> [Asymmetric credible intervals] for parameters and odds ratios.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html"><i class="fa fa-check"></i><b>12</b> Extending the Discrete-Time Hazard Model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#alternative-specification-for-the-main-effect-of-time"><i class="fa fa-check"></i><b>12.1</b> Alternative specification for the “main effect” of <em>TIME</em></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#an-ordered-series-of-polynomial-specifications-for-time."><i class="fa fa-check"></i><b>12.1.1</b> An ordered series of polynomial specifications for <em>TIME</em>.</a></li>
<li class="chapter" data-level="12.1.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#criteria-for-comparing-alternative-specification."><i class="fa fa-check"></i><b>12.1.2</b> Criteria for comparing alternative specification.</a></li>
<li class="chapter" data-level="12.1.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-parameters-from-linear-quadratic-and-cubic-specifications."><i class="fa fa-check"></i><b>12.1.3</b> Interpreting parameters from linear, quadratic, and cubic specifications.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#using-the-complementary-log-log-link-to-specify-a-discrete-time-hazard-model"><i class="fa fa-check"></i><b>12.2</b> Using the complementary log-log link to specify a discrete-time hazard model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-clog-log-transformation-when-and-why-it-is-useful."><i class="fa fa-check"></i><b>12.2.1</b> The clog-log transformation: When and why it is useful.</a></li>
<li class="chapter" data-level="12.2.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#a-discrete-time-hazard-model-using-the-complementary-log-log-link."><i class="fa fa-check"></i><b>12.2.2</b> A discrete-time hazard model using the complementary log-log link.</a></li>
<li class="chapter" data-level="12.2.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#choosing-between-logit-and-clog-log-links-for-discrete-time-hazard-models."><i class="fa fa-check"></i><b>12.2.3</b> Choosing between logit and clog-log links for discrete-time hazard models.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#time-varying-predictors-1"><i class="fa fa-check"></i><b>12.3</b> Time-varying predictors</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#assumptions-underlying-a-model-with-time-varying-predictors."><i class="fa fa-check"></i><b>12.3.1</b> Assumptions underlying a model with time-varying predictors.</a></li>
<li class="chapter" data-level="12.3.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-and-displaying-time-varying-predictors-effects."><i class="fa fa-check"></i><b>12.3.2</b> Interpreting and displaying time-varying predictors’ effects.</a></li>
<li class="chapter" data-level="12.3.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#two-caveats-the-problems-of-state-and-rate-dependence."><i class="fa fa-check"></i><b>12.3.3</b> Two caveats: The problems of state and rate dependence.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-linear-additivity-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.4</b> The linear additivity assumption: Uncovering violations and simple solutions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interactions-between-substantive-predictors."><i class="fa fa-check"></i><b>12.4.1</b> Interactions between substantive predictors.</a></li>
<li class="chapter" data-level="12.4.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#nonlinear-effects."><i class="fa fa-check"></i><b>12.4.2</b> Nonlinear effects.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-proportionality-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.5</b> The proportionality assumption: Uncovering violations and simple solutions</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#discrete-time-hazard-models-that-do-not-invoke-a-proportionality-assumption."><i class="fa fa-check"></i><b>12.5.1</b> Discrete-time hazard models that do not invoke a proportionality assumption.</a></li>
<li class="chapter" data-level="12.5.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#investigating-the-proportionality-assumption-in-practice."><i class="fa fa-check"></i><b>12.5.2</b> Investigating the proportionality assumption in practice.</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-no-unobserved-heterogeneity-assumption-no-simple-solution"><i class="fa fa-check"></i><b>12.6</b> The no unobserved heterogeneity assumption: No simple solution</a></li>
<li class="chapter" data-level="12.7" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#residual-analysis"><i class="fa fa-check"></i><b>12.7</b> Residual analysis</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html"><i class="fa fa-check"></i><b>13</b> Describing Continuous-Time Event Occurrence Data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#a-framework-for-characterizing-the-distribution-of-continuous-time-event-data"><i class="fa fa-check"></i><b>13.1</b> A framework for characterizing the distribution of continuous-time event data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#salient-features-of-continuous-time-event-occurrence-data."><i class="fa fa-check"></i><b>13.1.1</b> Salient features of continuous-time event occurrence data.</a></li>
<li class="chapter" data-level="13.1.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-survivor-function."><i class="fa fa-check"></i><b>13.1.2</b> The survivor function.</a></li>
<li class="chapter" data-level="13.1.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-hazard-function."><i class="fa fa-check"></i><b>13.1.3</b> The hazard function.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#grouped-methods-for-estimating-continuous-time-survivor-and-hazard-functions"><i class="fa fa-check"></i><b>13.2</b> Grouped methods for estimating continuous-time survivor and hazard functions</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#constructing-a-grouped-life-table."><i class="fa fa-check"></i><b>13.2.1</b> Constructing a grouped life table.</a></li>
<li class="chapter" data-level="13.2.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-discrete-time-method."><i class="fa fa-check"></i><b>13.2.2</b> The discrete-time method.</a></li>
<li class="chapter" data-level="13.2.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-actuarial-method."><i class="fa fa-check"></i><b>13.2.3</b> The actuarial method.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-kaplan-meier-method-of-estimating-the-continuous-time-survivor-function"><i class="fa fa-check"></i><b>13.3</b> The Kaplan-Meier method of estimating the continuous-time survivor function</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#fitting-a-bayesian-kaplan-meier-model"><i class="fa fa-check"></i><b>13.3.1</b> Fitting a Bayesian Kaplan-Meier model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-cumulative-hazard-function"><i class="fa fa-check"></i><b>13.4</b> The cumulative hazard function</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#understanding-the-meaning-of-cumulative-hazard."><i class="fa fa-check"></i><b>13.4.1</b> Understanding the meaning of cumulative hazard.</a></li>
<li class="chapter" data-level="13.4.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#estimating-the-cumulative-hazard-function."><i class="fa fa-check"></i><b>13.4.2</b> Estimating the cumulative hazard function.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#kernel-smoothed-estimates-of-the-hazard-function"><i class="fa fa-check"></i><b>13.5</b> Kernel-smoothed estimates of the hazard function</a></li>
<li class="chapter" data-level="13.6" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#developing-an-intuition-about-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions"><i class="fa fa-check"></i><b>13.6</b> Developing an intuition about continuous-time survivor, cumulative hazard, and kernel-smoothed hazard functions</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#bonus-bayesians-can-compare-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions-too."><i class="fa fa-check"></i><b>13.6.1</b> Bonus: Bayesians can compare continuous-time survivor, cumulative hazard, and kernel-smoothed hazard functions, too.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Applied longitudinal data analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extending-the-discrete-time-hazard-model" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Extending the Discrete-Time Hazard Model<a href="extending-the-discrete-time-hazard-model.html#extending-the-discrete-time-hazard-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>Like all statistical models, the basic discrete-time hazard model invokes assumptions about the population that may, or may not, hold in practice. Because no model should be adopted without scrutiny, we devote this chapter to examining its assumptions, demonstrating how to evaluate their tenability and relax their constraints when appropriate. In doing so, we illustrate practical principles of data analysis and offer theoretical insights into the model’s behavior and interpretation. <span class="citation">(<a href="#ref-singerAppliedLongitudinalData2003" role="doc-biblioref">Singer &amp; Willett, 2003, p. 407</a>)</span></p>
</blockquote>
<div id="alternative-specification-for-the-main-effect-of-time" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Alternative specification for the “main effect” of <em>TIME</em><a href="extending-the-discrete-time-hazard-model.html#alternative-specification-for-the-main-effect-of-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Use of a completely general specification for <em>TIME</em> [as explored in the last chapter] is an analytic decision, not an integral feature of the model. Nothing about the model or its estimation <em>requires</em> adoption of this, or any other, particular specification for <em>TIME</em> (p. 409, <em>emphasis</em> in the original)</p>
</blockquote>
<p>In the next page, Singer and Willett listed three circumstances under which we might consider alternatives to the completely general approach to time. They were</p>
<ul>
<li>in studies with many discrete time periods,</li>
<li>when hazard is expected to be near zero in some time periods, and</li>
<li>when some time periods have small risk sets.</li>
</ul>
<p>In the subsections to follow, we will explore each in turn.</p>
<div id="an-ordered-series-of-polynomial-specifications-for-time." class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> An ordered series of polynomial specifications for <em>TIME</em>.<a href="extending-the-discrete-time-hazard-model.html#an-ordered-series-of-polynomial-specifications-for-time." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the Gamse and Conger’s <span class="citation">(<a href="#ref-gamseEvaluationSpencerPostdoctoral1997" role="doc-biblioref">1997</a>)</span> <code>tenure_pp.csv</code> data.</p>
<div class="sourceCode" id="cb1291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1291-1"><a href="extending-the-discrete-time-hazard-model.html#cb1291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1291-2"><a href="extending-the-discrete-time-hazard-model.html#cb1291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1291-3"><a href="extending-the-discrete-time-hazard-model.html#cb1291-3" aria-hidden="true" tabindex="-1"></a>tenure_pp <span class="ot">&lt;-</span> </span>
<span id="cb1291-4"><a href="extending-the-discrete-time-hazard-model.html#cb1291-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&quot;data/tenure_pp.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1291-5"><a href="extending-the-discrete-time-hazard-model.html#cb1291-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert the column names to lower case</span></span>
<span id="cb1291-6"><a href="extending-the-discrete-time-hazard-model.html#cb1291-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(tolower)</span>
<span id="cb1291-7"><a href="extending-the-discrete-time-hazard-model.html#cb1291-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1291-8"><a href="extending-the-discrete-time-hazard-model.html#cb1291-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tenure_pp)</span></code></pre></div>
<pre><code>## Rows: 1,474
## Columns: 12
## $ id     &lt;dbl&gt; 111, 111, 111, 111, 111, 211, 211, 211, 211, 211, 211, 311, 311, 311, 311, 311, 311, 311, 311…
## $ period &lt;dbl&gt; 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, …
## $ event  &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, …
## $ d1     &lt;dbl&gt; 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, …
## $ d2     &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, …
## $ d3     &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, …
## $ d4     &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ d5     &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, …
## $ d6     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …
## $ d7     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, …
## $ d8     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, …
## $ d9     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, …</code></pre>
<p>Let’s confirm these data are composed of the records of <span class="math inline">\(n = 260\)</span> early-career academics.</p>
<div class="sourceCode" id="cb1293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1293-1"><a href="extending-the-discrete-time-hazard-model.html#cb1293-1" aria-hidden="true" tabindex="-1"></a>tenure_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1293-2"><a href="extending-the-discrete-time-hazard-model.html#cb1293-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1293-3"><a href="extending-the-discrete-time-hazard-model.html#cb1293-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1   260</code></pre>
<p>Here’s a way to count how many cases were censored.</p>
<div class="sourceCode" id="cb1295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1295-1"><a href="extending-the-discrete-time-hazard-model.html#cb1295-1" aria-hidden="true" tabindex="-1"></a>tenure_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1295-2"><a href="extending-the-discrete-time-hazard-model.html#cb1295-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1295-3"><a href="extending-the-discrete-time-hazard-model.html#cb1295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(period)) <span class="sc">%&gt;%</span> </span>
<span id="cb1295-4"><a href="extending-the-discrete-time-hazard-model.html#cb1295-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1295-5"><a href="extending-the-discrete-time-hazard-model.html#cb1295-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1295-6"><a href="extending-the-discrete-time-hazard-model.html#cb1295-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(event) <span class="sc">%&gt;%</span> </span>
<span id="cb1295-7"><a href="extending-the-discrete-time-hazard-model.html#cb1295-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   event     n percent
##   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1     0    94    36.2
## 2     1   166    63.8</code></pre>
<p>Let’s fire up <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1297-1"><a href="extending-the-discrete-time-hazard-model.html#cb1297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<p>As discussed in the prose and displayed in Tables 12.1 and 12.2, we will fit seven models, ranging from a constant (i.e., intercept only) model to a general (i.e., discrete factor) model. In the last chapter, we discussed how one can fit a general model with a series of <span class="math inline">\(J\)</span> dummies or equivalently with the time variable, <code>period</code> in these data, set as a factor. Here we’ll do both. In preparation, we’ll make a <code>period_f</code> version of <code>period</code>.</p>
<div class="sourceCode" id="cb1298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1298-1"><a href="extending-the-discrete-time-hazard-model.html#cb1298-1" aria-hidden="true" tabindex="-1"></a>tenure_pp <span class="ot">&lt;-</span></span>
<span id="cb1298-2"><a href="extending-the-discrete-time-hazard-model.html#cb1298-2" aria-hidden="true" tabindex="-1"></a>  tenure_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1298-3"><a href="extending-the-discrete-time-hazard-model.html#cb1298-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period_f =</span> <span class="fu">factor</span>(period))</span></code></pre></div>
<p>Now fit the models.</p>
<div class="sourceCode" id="cb1299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1299-1"><a href="extending-the-discrete-time-hazard-model.html#cb1299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># constant</span></span>
<span id="cb1299-2"><a href="extending-the-discrete-time-hazard-model.html#cb1299-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-3"><a href="extending-the-discrete-time-hazard-model.html#cb1299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-4"><a href="extending-the-discrete-time-hazard-model.html#cb1299-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-5"><a href="extending-the-discrete-time-hazard-model.html#cb1299-5" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1299-6"><a href="extending-the-discrete-time-hazard-model.html#cb1299-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1299-7"><a href="extending-the-discrete-time-hazard-model.html#cb1299-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-8"><a href="extending-the-discrete-time-hazard-model.html#cb1299-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-9"><a href="extending-the-discrete-time-hazard-model.html#cb1299-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.01&quot;</span>)</span>
<span id="cb1299-10"><a href="extending-the-discrete-time-hazard-model.html#cb1299-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1299-11"><a href="extending-the-discrete-time-hazard-model.html#cb1299-11" aria-hidden="true" tabindex="-1"></a><span class="co"># linear</span></span>
<span id="cb1299-12"><a href="extending-the-discrete-time-hazard-model.html#cb1299-12" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-13"><a href="extending-the-discrete-time-hazard-model.html#cb1299-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-14"><a href="extending-the-discrete-time-hazard-model.html#cb1299-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-15"><a href="extending-the-discrete-time-hazard-model.html#cb1299-15" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> period,</span>
<span id="cb1299-16"><a href="extending-the-discrete-time-hazard-model.html#cb1299-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1299-17"><a href="extending-the-discrete-time-hazard-model.html#cb1299-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-18"><a href="extending-the-discrete-time-hazard-model.html#cb1299-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-19"><a href="extending-the-discrete-time-hazard-model.html#cb1299-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.02&quot;</span>)</span>
<span id="cb1299-20"><a href="extending-the-discrete-time-hazard-model.html#cb1299-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1299-21"><a href="extending-the-discrete-time-hazard-model.html#cb1299-21" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic</span></span>
<span id="cb1299-22"><a href="extending-the-discrete-time-hazard-model.html#cb1299-22" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-23"><a href="extending-the-discrete-time-hazard-model.html#cb1299-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-24"><a href="extending-the-discrete-time-hazard-model.html#cb1299-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-25"><a href="extending-the-discrete-time-hazard-model.html#cb1299-25" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> period <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb1299-26"><a href="extending-the-discrete-time-hazard-model.html#cb1299-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1299-27"><a href="extending-the-discrete-time-hazard-model.html#cb1299-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-28"><a href="extending-the-discrete-time-hazard-model.html#cb1299-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-29"><a href="extending-the-discrete-time-hazard-model.html#cb1299-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.03&quot;</span>)</span>
<span id="cb1299-30"><a href="extending-the-discrete-time-hazard-model.html#cb1299-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1299-31"><a href="extending-the-discrete-time-hazard-model.html#cb1299-31" aria-hidden="true" tabindex="-1"></a><span class="co"># cubic</span></span>
<span id="cb1299-32"><a href="extending-the-discrete-time-hazard-model.html#cb1299-32" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-33"><a href="extending-the-discrete-time-hazard-model.html#cb1299-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-34"><a href="extending-the-discrete-time-hazard-model.html#cb1299-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-35"><a href="extending-the-discrete-time-hazard-model.html#cb1299-35" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> period <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb1299-36"><a href="extending-the-discrete-time-hazard-model.html#cb1299-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1299-37"><a href="extending-the-discrete-time-hazard-model.html#cb1299-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-38"><a href="extending-the-discrete-time-hazard-model.html#cb1299-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-39"><a href="extending-the-discrete-time-hazard-model.html#cb1299-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.04&quot;</span>)</span>
<span id="cb1299-40"><a href="extending-the-discrete-time-hazard-model.html#cb1299-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1299-41"><a href="extending-the-discrete-time-hazard-model.html#cb1299-41" aria-hidden="true" tabindex="-1"></a><span class="co"># fourth order</span></span>
<span id="cb1299-42"><a href="extending-the-discrete-time-hazard-model.html#cb1299-42" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.5</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-43"><a href="extending-the-discrete-time-hazard-model.html#cb1299-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-44"><a href="extending-the-discrete-time-hazard-model.html#cb1299-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-45"><a href="extending-the-discrete-time-hazard-model.html#cb1299-45" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> period <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">4</span>),</span>
<span id="cb1299-46"><a href="extending-the-discrete-time-hazard-model.html#cb1299-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1299-47"><a href="extending-the-discrete-time-hazard-model.html#cb1299-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-48"><a href="extending-the-discrete-time-hazard-model.html#cb1299-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">max_treedepth =</span> <span class="dv">12</span>),</span>
<span id="cb1299-49"><a href="extending-the-discrete-time-hazard-model.html#cb1299-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-50"><a href="extending-the-discrete-time-hazard-model.html#cb1299-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.05&quot;</span>)</span>
<span id="cb1299-51"><a href="extending-the-discrete-time-hazard-model.html#cb1299-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1299-52"><a href="extending-the-discrete-time-hazard-model.html#cb1299-52" aria-hidden="true" tabindex="-1"></a><span class="co"># fifth order</span></span>
<span id="cb1299-53"><a href="extending-the-discrete-time-hazard-model.html#cb1299-53" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.6</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-54"><a href="extending-the-discrete-time-hazard-model.html#cb1299-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-55"><a href="extending-the-discrete-time-hazard-model.html#cb1299-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-56"><a href="extending-the-discrete-time-hazard-model.html#cb1299-56" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> period <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(period<span class="sc">^</span><span class="dv">5</span>),</span>
<span id="cb1299-57"><a href="extending-the-discrete-time-hazard-model.html#cb1299-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1299-58"><a href="extending-the-discrete-time-hazard-model.html#cb1299-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-59"><a href="extending-the-discrete-time-hazard-model.html#cb1299-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">max_treedepth =</span> <span class="dv">14</span>),</span>
<span id="cb1299-60"><a href="extending-the-discrete-time-hazard-model.html#cb1299-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-61"><a href="extending-the-discrete-time-hazard-model.html#cb1299-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">init =</span> <span class="dv">0</span>,</span>
<span id="cb1299-62"><a href="extending-the-discrete-time-hazard-model.html#cb1299-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.06&quot;</span>)</span>
<span id="cb1299-63"><a href="extending-the-discrete-time-hazard-model.html#cb1299-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1299-64"><a href="extending-the-discrete-time-hazard-model.html#cb1299-64" aria-hidden="true" tabindex="-1"></a><span class="co"># general</span></span>
<span id="cb1299-65"><a href="extending-the-discrete-time-hazard-model.html#cb1299-65" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.7</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-66"><a href="extending-the-discrete-time-hazard-model.html#cb1299-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-67"><a href="extending-the-discrete-time-hazard-model.html#cb1299-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-68"><a href="extending-the-discrete-time-hazard-model.html#cb1299-68" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d1 <span class="sc">+</span> d2 <span class="sc">+</span> d3 <span class="sc">+</span> d4 <span class="sc">+</span> d5 <span class="sc">+</span> d6 <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9,</span>
<span id="cb1299-69"><a href="extending-the-discrete-time-hazard-model.html#cb1299-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1299-70"><a href="extending-the-discrete-time-hazard-model.html#cb1299-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-71"><a href="extending-the-discrete-time-hazard-model.html#cb1299-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-72"><a href="extending-the-discrete-time-hazard-model.html#cb1299-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.07&quot;</span>)</span>
<span id="cb1299-73"><a href="extending-the-discrete-time-hazard-model.html#cb1299-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1299-74"><a href="extending-the-discrete-time-hazard-model.html#cb1299-74" aria-hidden="true" tabindex="-1"></a><span class="co"># general with `factor(period)`</span></span>
<span id="cb1299-75"><a href="extending-the-discrete-time-hazard-model.html#cb1299-75" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.8</span> <span class="ot">&lt;-</span></span>
<span id="cb1299-76"><a href="extending-the-discrete-time-hazard-model.html#cb1299-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> tenure_pp,</span>
<span id="cb1299-77"><a href="extending-the-discrete-time-hazard-model.html#cb1299-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1299-78"><a href="extending-the-discrete-time-hazard-model.html#cb1299-78" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> period_f,</span>
<span id="cb1299-79"><a href="extending-the-discrete-time-hazard-model.html#cb1299-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1299-80"><a href="extending-the-discrete-time-hazard-model.html#cb1299-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1299-81"><a href="extending-the-discrete-time-hazard-model.html#cb1299-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1299-82"><a href="extending-the-discrete-time-hazard-model.html#cb1299-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.08&quot;</span>)</span></code></pre></div>
<p>Before we compare the models with information criteria, it might be handy to look at the hazard functions for each. A relatively quick way is with the <code>conditional_effects()</code> function.</p>
<div class="sourceCode" id="cb1300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1300-1"><a href="extending-the-discrete-time-hazard-model.html#cb1300-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">conditional_effects</span>(fit12<span class="fl">.2</span>), <span class="at">plot =</span> F)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;linear&quot;</span>)</span>
<span id="cb1300-2"><a href="extending-the-discrete-time-hazard-model.html#cb1300-2" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">conditional_effects</span>(fit12<span class="fl">.3</span>), <span class="at">plot =</span> F)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;quadratic&quot;</span>)</span>
<span id="cb1300-3"><a href="extending-the-discrete-time-hazard-model.html#cb1300-3" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">conditional_effects</span>(fit12<span class="fl">.4</span>), <span class="at">plot =</span> F)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;cubic&quot;</span>)</span>
<span id="cb1300-4"><a href="extending-the-discrete-time-hazard-model.html#cb1300-4" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">conditional_effects</span>(fit12<span class="fl">.5</span>), <span class="at">plot =</span> F)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;fourth order&quot;</span>)</span>
<span id="cb1300-5"><a href="extending-the-discrete-time-hazard-model.html#cb1300-5" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">conditional_effects</span>(fit12<span class="fl">.6</span>), <span class="at">plot =</span> F)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;fifth order&quot;</span>)</span>
<span id="cb1300-6"><a href="extending-the-discrete-time-hazard-model.html#cb1300-6" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">conditional_effects</span>(fit12<span class="fl">.8</span>), </span>
<span id="cb1300-7"><a href="extending-the-discrete-time-hazard-model.html#cb1300-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">cat_args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>), </span>
<span id="cb1300-8"><a href="extending-the-discrete-time-hazard-model.html#cb1300-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">plot =</span> F)[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;general&quot;</span>)</span></code></pre></div>
<p>Because it contains no predictors, we cannot use <code>conditional_effects()</code> to make a plot for the constant model (i.e., <code>fit12.1</code>). We’ll have to do that by hand.</p>
<div class="sourceCode" id="cb1301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1301-1"><a href="extending-the-discrete-time-hazard-model.html#cb1301-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1301-2"><a href="extending-the-discrete-time-hazard-model.html#cb1301-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">period =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1301-3"><a href="extending-the-discrete-time-hazard-model.html#cb1301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period)) <span class="sc">+</span></span>
<span id="cb1301-4"><a href="extending-the-discrete-time-hazard-model.html#cb1301-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">fixef</span>(fit12<span class="fl">.1</span>)[, <span class="dv">3</span>] <span class="sc">%&gt;%</span> <span class="fu">inv_logit_scaled</span>(),</span>
<span id="cb1301-5"><a href="extending-the-discrete-time-hazard-model.html#cb1301-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fu">fixef</span>(fit12<span class="fl">.1</span>)[, <span class="dv">4</span>] <span class="sc">%&gt;%</span> <span class="fu">inv_logit_scaled</span>()),</span>
<span id="cb1301-6"><a href="extending-the-discrete-time-hazard-model.html#cb1301-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1301-7"><a href="extending-the-discrete-time-hazard-model.html#cb1301-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fixef</span>(fit12<span class="fl">.1</span>)[, <span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">inv_logit_scaled</span>()),</span>
<span id="cb1301-8"><a href="extending-the-discrete-time-hazard-model.html#cb1301-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;blue1&quot;</span>) <span class="sc">+</span></span>
<span id="cb1301-9"><a href="extending-the-discrete-time-hazard-model.html#cb1301-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;constant&quot;</span>) <span class="sc">+</span></span>
<span id="cb1301-10"><a href="extending-the-discrete-time-hazard-model.html#cb1301-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;event | trials(1)&quot;</span>)</span></code></pre></div>
<p>Now combine and format the subplots with <strong>patchwork</strong>.</p>
<div class="sourceCode" id="cb1302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1302-1"><a href="extending-the-discrete-time-hazard-model.html#cb1302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1302-2"><a href="extending-the-discrete-time-hazard-model.html#cb1302-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1302-3"><a href="extending-the-discrete-time-hazard-model.html#cb1302-3" aria-hidden="true" tabindex="-1"></a>(((p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6) <span class="sc">&amp;</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)) <span class="sc">+</span> p7) <span class="sc">&amp;</span></span>
<span id="cb1302-4"><a href="extending-the-discrete-time-hazard-model.html#cb1302-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>)) <span class="sc">&amp;</span></span>
<span id="cb1302-5"><a href="extending-the-discrete-time-hazard-model.html#cb1302-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>We are going to depart from Singer and Willett and no longer entertain using deviance for Bayesian model comparison. But we will compare then using the WAIC and the LOO.</p>
<div class="sourceCode" id="cb1303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1303-1"><a href="extending-the-discrete-time-hazard-model.html#cb1303-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.1</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1303-2"><a href="extending-the-discrete-time-hazard-model.html#cb1303-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1303-3"><a href="extending-the-discrete-time-hazard-model.html#cb1303-3" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.3</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1303-4"><a href="extending-the-discrete-time-hazard-model.html#cb1303-4" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.4</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1303-5"><a href="extending-the-discrete-time-hazard-model.html#cb1303-5" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.5</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1303-6"><a href="extending-the-discrete-time-hazard-model.html#cb1303-6" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.6</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1303-7"><a href="extending-the-discrete-time-hazard-model.html#cb1303-7" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.7</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1303-8"><a href="extending-the-discrete-time-hazard-model.html#cb1303-8" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.8</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span></code></pre></div>
<p>Before comparing the models in bulk, as in Table 12.2, let’s confirm that whether we use the dummy variable method (<code>fit12.7</code>) or the factor variable method (<code>fit12.8</code>), the results for the general model are the same.</p>
<div class="sourceCode" id="cb1304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1304-1"><a href="extending-the-discrete-time-hazard-model.html#cb1304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.7</span>, fit12<span class="fl">.8</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit12.7    0.0       0.0  -425.1     22.5         9.4    1.1    850.1   45.0  
## fit12.8    0.0       0.0  -425.1     22.5         9.4    1.1    850.1   45.0</code></pre>
<div class="sourceCode" id="cb1306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1306-1"><a href="extending-the-discrete-time-hazard-model.html#cb1306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.7</span>, fit12<span class="fl">.8</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic   se_waic
## fit12.7    0.0       0.0  -425.0      22.5          9.3    1.1     850.0   45.0 
## fit12.8    0.0       0.0  -425.0      22.5          9.3    1.1     850.0   45.0</code></pre>
<p>Yep, both WAIC and LOO confirm both methods are equivalent. One of the main reasons we used the factor method, here, was because it made it easier to plot the results with <code>conditional_effects()</code>. But with the following model comparisons, we’ll focus on <code>fit12.1</code> through <code>fit12.7</code>.</p>
<div class="sourceCode" id="cb1308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1308-1"><a href="extending-the-discrete-time-hazard-model.html#cb1308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.1</span>, fit12<span class="fl">.2</span>, fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, fit12<span class="fl">.5</span>, fit12<span class="fl">.6</span>, fit12<span class="fl">.7</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1308-2"><a href="extending-the-discrete-time-hazard-model.html#cb1308-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit12.4    0.0       0.0  -420.7     22.0         4.1    0.5    841.4   44.1  
## fit12.3   -0.5       2.2  -421.2     22.0         3.1    0.4    842.3   44.1  
## fit12.5   -0.6       0.8  -421.3     22.2         4.8    0.6    842.5   44.4  
## fit12.6   -0.9       0.8  -421.6     22.2         5.2    0.6    843.3   44.4  
## fit12.7   -4.4       1.5  -425.1     22.5         9.4    1.1    850.1   45.0  
## fit12.2  -14.9       5.9  -435.6     22.0         1.8    0.1    871.2   44.1  
## fit12.1  -99.1      13.2  -519.8     25.1         1.0    0.1   1039.5   50.2</code></pre>
<div class="sourceCode" id="cb1310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1310-1"><a href="extending-the-discrete-time-hazard-model.html#cb1310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.1</span>, fit12<span class="fl">.2</span>, fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, fit12<span class="fl">.5</span>, fit12<span class="fl">.6</span>, fit12<span class="fl">.7</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1310-2"><a href="extending-the-discrete-time-hazard-model.html#cb1310-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic   se_waic
## fit12.4    0.0       0.0  -420.7      22.0          4.1    0.5     841.4   44.1 
## fit12.3   -0.5       2.2  -421.2      22.0          3.1    0.4     842.3   44.1 
## fit12.5   -0.6       0.8  -421.2      22.2          4.8    0.6     842.5   44.4 
## fit12.6   -0.9       0.8  -421.6      22.2          5.2    0.6     843.2   44.4 
## fit12.7   -4.3       1.5  -425.0      22.5          9.3    1.1     850.0   45.0 
## fit12.2  -14.9       5.9  -435.6      22.0          1.8    0.1     871.2   44.1 
## fit12.1  -99.1      13.2  -519.8      25.1          1.0    0.1    1039.5   50.2</code></pre>
<p>Our results are very similar to those in the AIC column in Table 12.2. Just for kicks and giggles, here are the model weights based on the LOO, WAIC, and stacking method.</p>
<div class="sourceCode" id="cb1312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1312-1"><a href="extending-the-discrete-time-hazard-model.html#cb1312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.1</span>, fit12<span class="fl">.2</span>, fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, fit12<span class="fl">.5</span>, fit12<span class="fl">.6</span>, fit12<span class="fl">.7</span>, <span class="at">weights =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1312-2"><a href="extending-the-discrete-time-hazard-model.html#cb1312-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.1 fit12.2 fit12.3 fit12.4 fit12.5 fit12.6 fit12.7 
##   0.000   0.000   0.240   0.385   0.219   0.150   0.005</code></pre>
<div class="sourceCode" id="cb1314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1314-1"><a href="extending-the-discrete-time-hazard-model.html#cb1314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.1</span>, fit12<span class="fl">.2</span>, fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, fit12<span class="fl">.5</span>, fit12<span class="fl">.6</span>, fit12<span class="fl">.7</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1314-2"><a href="extending-the-discrete-time-hazard-model.html#cb1314-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.1 fit12.2 fit12.3 fit12.4 fit12.5 fit12.6 fit12.7 
##   0.000   0.000   0.238   0.384   0.221   0.151   0.005</code></pre>
<div class="sourceCode" id="cb1316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1316-1"><a href="extending-the-discrete-time-hazard-model.html#cb1316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.1</span>, fit12<span class="fl">.2</span>, fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, fit12<span class="fl">.5</span>, fit12<span class="fl">.6</span>, fit12<span class="fl">.7</span>, <span class="at">weights =</span> <span class="st">&quot;stacking&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1316-2"><a href="extending-the-discrete-time-hazard-model.html#cb1316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.1 fit12.2 fit12.3 fit12.4 fit12.5 fit12.6 fit12.7 
##   0.019   0.000   0.487   0.494   0.000   0.000   0.000</code></pre>
<p>Across the comparison methods, the overall pattern is the cubic model (<code>fit12.4</code>) is marginally better than the rest, but that both the quadratic and fourth-order models were quite close. Unlike when you use model deviance, the parsimony corrections used in the information-criteria-based methods all suggest the general model is overfit.</p>
<blockquote>
<p>Before considering whether these differences in [information criteria] are sufficient to warrant use of an alternative specification for <em>TIME</em>, let us examine the corresponding fitted logit hazard functions. Doing so not only highlights the behavior of logit hazard, it also offers a graphical means of comparing the fit of competing specifications. (p. 413, <em>emphasis</em> in the original)</p>
</blockquote>
<p>In preparation for our Figure 12.1, we’ll make a custom function called <code>make_fitted()</code>, which will streamline some of the data wrangling code.</p>
<div class="sourceCode" id="cb1318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1318-1"><a href="extending-the-discrete-time-hazard-model.html#cb1318-1" aria-hidden="true" tabindex="-1"></a>make_fitted <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, scale, ...) {</span>
<span id="cb1318-2"><a href="extending-the-discrete-time-hazard-model.html#cb1318-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1318-3"><a href="extending-the-discrete-time-hazard-model.html#cb1318-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit,</span>
<span id="cb1318-4"><a href="extending-the-discrete-time-hazard-model.html#cb1318-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb1318-5"><a href="extending-the-discrete-time-hazard-model.html#cb1318-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> scale,</span>
<span id="cb1318-6"><a href="extending-the-discrete-time-hazard-model.html#cb1318-6" aria-hidden="true" tabindex="-1"></a>         ...) <span class="sc">%&gt;%</span> </span>
<span id="cb1318-7"><a href="extending-the-discrete-time-hazard-model.html#cb1318-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1318-8"><a href="extending-the-discrete-time-hazard-model.html#cb1318-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(nd)</span>
<span id="cb1318-9"><a href="extending-the-discrete-time-hazard-model.html#cb1318-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1318-10"><a href="extending-the-discrete-time-hazard-model.html#cb1318-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In addition to taking different <strong>brms</strong> fit objects as input, <code>make_fitted()</code> will allow us to adjust the <code>scale</code> of the output. As you’ll see, we will need to work with to settings in the coming plots. For our first batch of code, we’ll use <code>scale = "linear"</code>. Because the <code>newdata</code> for our version of the general model (i.e., <code>fit12.8</code>) requires the predictor to be called <code>period_f</code> and the rest of the models require the predictor to be named <code>period</code>, we’ll make and save the results for the former first, redefine our <code>newdata</code>, apply <code>make_fitted()</code> to the rest of the models, and then combine them all. Here it is in one fell swoop.</p>
<div class="sourceCode" id="cb1319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1319-1"><a href="extending-the-discrete-time-hazard-model.html#cb1319-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">period_f =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb1319-2"><a href="extending-the-discrete-time-hazard-model.html#cb1319-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1319-3"><a href="extending-the-discrete-time-hazard-model.html#cb1319-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">make_fitted</span>(fit12<span class="fl">.8</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">period =</span> period_f)</span>
<span id="cb1319-4"><a href="extending-the-discrete-time-hazard-model.html#cb1319-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1319-5"><a href="extending-the-discrete-time-hazard-model.html#cb1319-5" aria-hidden="true" tabindex="-1"></a><span class="co"># this will simplify the `mutate()` code below</span></span>
<span id="cb1319-6"><a href="extending-the-discrete-time-hazard-model.html#cb1319-6" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;constant&quot;</span>, <span class="st">&quot;linear&quot;</span>, <span class="st">&quot;quadratic&quot;</span>, <span class="st">&quot;cubic&quot;</span>, <span class="st">&quot;general&quot;</span>)</span>
<span id="cb1319-7"><a href="extending-the-discrete-time-hazard-model.html#cb1319-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1319-8"><a href="extending-the-discrete-time-hazard-model.html#cb1319-8" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">period =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb1319-9"><a href="extending-the-discrete-time-hazard-model.html#cb1319-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1319-10"><a href="extending-the-discrete-time-hazard-model.html#cb1319-10" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1319-11"><a href="extending-the-discrete-time-hazard-model.html#cb1319-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">make_fitted</span>(fit12<span class="fl">.1</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),  <span class="co"># constant</span></span>
<span id="cb1319-12"><a href="extending-the-discrete-time-hazard-model.html#cb1319-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.2</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),  <span class="co"># linear</span></span>
<span id="cb1319-13"><a href="extending-the-discrete-time-hazard-model.html#cb1319-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.3</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),  <span class="co"># quadratic</span></span>
<span id="cb1319-14"><a href="extending-the-discrete-time-hazard-model.html#cb1319-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.4</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),  <span class="co"># cubic</span></span>
<span id="cb1319-15"><a href="extending-the-discrete-time-hazard-model.html#cb1319-15" aria-hidden="true" tabindex="-1"></a>            f) <span class="sc">%&gt;%</span>                                   <span class="co"># general</span></span>
<span id="cb1319-16"><a href="extending-the-discrete-time-hazard-model.html#cb1319-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(models, <span class="at">each =</span> <span class="dv">9</span>),</span>
<span id="cb1319-17"><a href="extending-the-discrete-time-hazard-model.html#cb1319-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> models))</span>
<span id="cb1319-18"><a href="extending-the-discrete-time-hazard-model.html#cb1319-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1319-19"><a href="extending-the-discrete-time-hazard-model.html#cb1319-19" aria-hidden="true" tabindex="-1"></a><span class="co"># what have we done?</span></span>
<span id="cb1319-20"><a href="extending-the-discrete-time-hazard-model.html#cb1319-20" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(f)</span></code></pre></div>
<pre><code>## Rows: 45
## Columns: 6
## $ Estimate  &lt;dbl&gt; -2.0652119, -2.0652119, -2.0652119, -2.0652119, -2.0652119, -2.0652119, -2.0652119, -2.065…
## $ Est.Error &lt;dbl&gt; 0.08186425, 0.08186425, 0.08186425, 0.08186425, 0.08186425, 0.08186425, 0.08186425, 0.0818…
## $ Q2.5      &lt;dbl&gt; -2.22771603, -2.22771603, -2.22771603, -2.22771603, -2.22771603, -2.22771603, -2.22771603,…
## $ Q97.5     &lt;dbl&gt; -1.90606492, -1.90606492, -1.90606492, -1.90606492, -1.90606492, -1.90606492, -1.90606492,…
## $ period    &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, …
## $ model     &lt;fct&gt; constant, constant, constant, constant, constant, constant, constant, constant, constant, …</code></pre>
<p>Now we’re in good shape to make and save our version of the top panel of Figure 12.1.</p>
<div class="sourceCode" id="cb1321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1321-1"><a href="extending-the-discrete-time-hazard-model.html#cb1321-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1321-2"><a href="extending-the-discrete-time-hazard-model.html#cb1321-2" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">%&gt;%</span> </span>
<span id="cb1321-3"><a href="extending-the-discrete-time-hazard-model.html#cb1321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> Estimate, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb1321-4"><a href="extending-the-discrete-time-hazard-model.html#cb1321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1321-5"><a href="extending-the-discrete-time-hazard-model.html#cb1321-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1321-6"><a href="extending-the-discrete-time-hazard-model.html#cb1321-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Fitted logit(hazard)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1321-7"><a href="extending-the-discrete-time-hazard-model.html#cb1321-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1321-8"><a href="extending-the-discrete-time-hazard-model.html#cb1321-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>The bottom two panels require we redo our <code>make_fitted()</code> code from above, this time setting <code>scale = "response"</code>.</p>
<div class="sourceCode" id="cb1322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1322-1"><a href="extending-the-discrete-time-hazard-model.html#cb1322-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">period_f =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb1322-2"><a href="extending-the-discrete-time-hazard-model.html#cb1322-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1322-3"><a href="extending-the-discrete-time-hazard-model.html#cb1322-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">make_fitted</span>(fit12<span class="fl">.8</span>, <span class="at">scale =</span> <span class="st">&quot;response&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">period =</span> period_f)</span>
<span id="cb1322-4"><a href="extending-the-discrete-time-hazard-model.html#cb1322-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1322-5"><a href="extending-the-discrete-time-hazard-model.html#cb1322-5" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">period =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb1322-6"><a href="extending-the-discrete-time-hazard-model.html#cb1322-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1322-7"><a href="extending-the-discrete-time-hazard-model.html#cb1322-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1322-8"><a href="extending-the-discrete-time-hazard-model.html#cb1322-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">make_fitted</span>(fit12<span class="fl">.1</span>, <span class="at">scale =</span> <span class="st">&quot;response&quot;</span>),  <span class="co"># constant</span></span>
<span id="cb1322-9"><a href="extending-the-discrete-time-hazard-model.html#cb1322-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.2</span>, <span class="at">scale =</span> <span class="st">&quot;response&quot;</span>),  <span class="co"># linear</span></span>
<span id="cb1322-10"><a href="extending-the-discrete-time-hazard-model.html#cb1322-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.3</span>, <span class="at">scale =</span> <span class="st">&quot;response&quot;</span>),  <span class="co"># quadratic</span></span>
<span id="cb1322-11"><a href="extending-the-discrete-time-hazard-model.html#cb1322-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.4</span>, <span class="at">scale =</span> <span class="st">&quot;response&quot;</span>),  <span class="co"># cubic</span></span>
<span id="cb1322-12"><a href="extending-the-discrete-time-hazard-model.html#cb1322-12" aria-hidden="true" tabindex="-1"></a>            f) <span class="sc">%&gt;%</span>                                     <span class="co"># general</span></span>
<span id="cb1322-13"><a href="extending-the-discrete-time-hazard-model.html#cb1322-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(models, <span class="at">each =</span> <span class="dv">9</span>),</span>
<span id="cb1322-14"><a href="extending-the-discrete-time-hazard-model.html#cb1322-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> models))</span></code></pre></div>
<p>Now make and save the bottom left panel for Figure 12.1.</p>
<div class="sourceCode" id="cb1323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1323-1"><a href="extending-the-discrete-time-hazard-model.html#cb1323-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1323-2"><a href="extending-the-discrete-time-hazard-model.html#cb1323-2" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">%&gt;%</span> </span>
<span id="cb1323-3"><a href="extending-the-discrete-time-hazard-model.html#cb1323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;quadratic&quot;</span>, <span class="st">&quot;general&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1323-4"><a href="extending-the-discrete-time-hazard-model.html#cb1323-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1323-5"><a href="extending-the-discrete-time-hazard-model.html#cb1323-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> Estimate, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb1323-6"><a href="extending-the-discrete-time-hazard-model.html#cb1323-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1323-7"><a href="extending-the-discrete-time-hazard-model.html#cb1323-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">5</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1323-8"><a href="extending-the-discrete-time-hazard-model.html#cb1323-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Fitted hazard&quot;</span>) <span class="sc">+</span></span>
<span id="cb1323-9"><a href="extending-the-discrete-time-hazard-model.html#cb1323-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb1323-10"><a href="extending-the-discrete-time-hazard-model.html#cb1323-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb1323-11"><a href="extending-the-discrete-time-hazard-model.html#cb1323-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Our <code>f</code> data will also work to make the final bottom right panel for the figure, but we’ll need to convert the <code>Estimate</code> values from the hazard metric to the survival-probability metric. In addition, we will need to add in values for when <code>period = 0</code>. Here we wrangle, plot, and save in one block.</p>
<div class="sourceCode" id="cb1324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1324-1"><a href="extending-the-discrete-time-hazard-model.html#cb1324-1" aria-hidden="true" tabindex="-1"></a>new_rows <span class="ot">&lt;-</span></span>
<span id="cb1324-2"><a href="extending-the-discrete-time-hazard-model.html#cb1324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Estimate =</span> <span class="dv">0</span>,</span>
<span id="cb1324-3"><a href="extending-the-discrete-time-hazard-model.html#cb1324-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">period   =</span> <span class="dv">0</span>,</span>
<span id="cb1324-4"><a href="extending-the-discrete-time-hazard-model.html#cb1324-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">model    =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;quadratic&quot;</span>, <span class="st">&quot;general&quot;</span>),</span>
<span id="cb1324-5"><a href="extending-the-discrete-time-hazard-model.html#cb1324-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> models))</span>
<span id="cb1324-6"><a href="extending-the-discrete-time-hazard-model.html#cb1324-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1324-7"><a href="extending-the-discrete-time-hazard-model.html#cb1324-7" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1324-8"><a href="extending-the-discrete-time-hazard-model.html#cb1324-8" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">%&gt;%</span> </span>
<span id="cb1324-9"><a href="extending-the-discrete-time-hazard-model.html#cb1324-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(model <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;quadratic&quot;</span>, <span class="st">&quot;general&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1324-10"><a href="extending-the-discrete-time-hazard-model.html#cb1324-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Estimate, period, model) <span class="sc">%&gt;%</span> </span>
<span id="cb1324-11"><a href="extending-the-discrete-time-hazard-model.html#cb1324-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the `new_rows` data</span></span>
<span id="cb1324-12"><a href="extending-the-discrete-time-hazard-model.html#cb1324-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(new_rows) <span class="sc">%&gt;%</span></span>
<span id="cb1324-13"><a href="extending-the-discrete-time-hazard-model.html#cb1324-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(model, period) <span class="sc">%&gt;%</span></span>
<span id="cb1324-14"><a href="extending-the-discrete-time-hazard-model.html#cb1324-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb1324-15"><a href="extending-the-discrete-time-hazard-model.html#cb1324-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert hazards to survival probabilities</span></span>
<span id="cb1324-16"><a href="extending-the-discrete-time-hazard-model.html#cb1324-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Estimate =</span> <span class="fu">cumprod</span>(<span class="dv">1</span> <span class="sc">-</span> Estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb1324-17"><a href="extending-the-discrete-time-hazard-model.html#cb1324-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1324-18"><a href="extending-the-discrete-time-hazard-model.html#cb1324-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1324-19"><a href="extending-the-discrete-time-hazard-model.html#cb1324-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> Estimate, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb1324-20"><a href="extending-the-discrete-time-hazard-model.html#cb1324-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1324-21"><a href="extending-the-discrete-time-hazard-model.html#cb1324-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1324-22"><a href="extending-the-discrete-time-hazard-model.html#cb1324-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">5</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1324-23"><a href="extending-the-discrete-time-hazard-model.html#cb1324-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Fitted survival probability&quot;</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1324-24"><a href="extending-the-discrete-time-hazard-model.html#cb1324-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1324-25"><a href="extending-the-discrete-time-hazard-model.html#cb1324-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb1324-26"><a href="extending-the-discrete-time-hazard-model.html#cb1324-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Now combine the subplots and format a little with <strong>patchwork</strong> to make our version of Figure 12.1.</p>
<div class="sourceCode" id="cb1325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1325-1"><a href="extending-the-discrete-time-hazard-model.html#cb1325-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> </span>
<span id="cb1325-2"><a href="extending-the-discrete-time-hazard-model.html#cb1325-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb1325-3"><a href="extending-the-discrete-time-hazard-model.html#cb1325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Years after hire&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>))</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-19-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Instead of the two-row layout in the text, it seemed simpler to arrange the panels all in one row. This way we can let the full version of the line-color legend serve for all three panels.</p>
</div>
<div id="criteria-for-comparing-alternative-specification." class="section level3 hasAnchor" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Criteria for comparing alternative specification.<a href="extending-the-discrete-time-hazard-model.html#criteria-for-comparing-alternative-specification." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The decline in the deviance statistic across models indicates that fit improves with increasing complexity of the temporal specification. To evaluate the magnitude of this decline, we must also account for the increased number of parameters in the model. You should not adopt a more complex specification if it fits no better than a simpler one. But if an alternative specification is (nearly) as good as the most general one, it may be “good enough.” At the same time, we would not want an alternative that performs measurably worse than we know we can do. (p. 415)</p>
</blockquote>
<p>We won’t be comparing deviances with <span class="math inline">\(\chi^2\)</span> tests, here. As to information criteria, we got ahead of the authors a bit and presented those comparisons in the last section. Although our use of the WAIC and the LOO is similar to Singer and Willett’s use of the AIC and BIC in that they yield no formal hypothesis test in the form of a <span class="math inline">\(p\)</span>-value, their estimates and difference scores do come with standard errors.</p>
<p>In the middle of page 416, the authors focused on comparing the constant and linear models, the linear and quadratic models, and the quadratic and general models. The LOO and WAIC estimates for each were near identical. For the sake of simplicity, here are those three focused comparisons using the LOO.</p>
<div class="sourceCode" id="cb1326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1326-1"><a href="extending-the-discrete-time-hazard-model.html#cb1326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the constant and linear models</span></span>
<span id="cb1326-2"><a href="extending-the-discrete-time-hazard-model.html#cb1326-2" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(fit12<span class="fl">.1</span>, fit12<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb1326-3"><a href="extending-the-discrete-time-hazard-model.html#cb1326-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1326-4"><a href="extending-the-discrete-time-hazard-model.html#cb1326-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the linear and quadratic models</span></span>
<span id="cb1326-5"><a href="extending-the-discrete-time-hazard-model.html#cb1326-5" aria-hidden="true" tabindex="-1"></a>l2 <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(fit12<span class="fl">.2</span>, fit12<span class="fl">.3</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb1326-6"><a href="extending-the-discrete-time-hazard-model.html#cb1326-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1326-7"><a href="extending-the-discrete-time-hazard-model.html#cb1326-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the quadratic and general models</span></span>
<span id="cb1326-8"><a href="extending-the-discrete-time-hazard-model.html#cb1326-8" aria-hidden="true" tabindex="-1"></a>l3 <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(fit12<span class="fl">.3</span>, fit12<span class="fl">.7</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb1326-9"><a href="extending-the-discrete-time-hazard-model.html#cb1326-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1326-10"><a href="extending-the-discrete-time-hazard-model.html#cb1326-10" aria-hidden="true" tabindex="-1"></a>l1 <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit12.2    0.0       0.0  -435.6     22.0         1.8    0.1    871.2   44.1  
## fit12.1  -84.2      11.7  -519.8     25.1         1.0    0.1   1039.5   50.2</code></pre>
<div class="sourceCode" id="cb1328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1328-1"><a href="extending-the-discrete-time-hazard-model.html#cb1328-1" aria-hidden="true" tabindex="-1"></a>l2 <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit12.3    0.0       0.0  -421.2     22.0         3.1    0.4    842.3   44.1  
## fit12.2  -14.4       5.5  -435.6     22.0         1.8    0.1    871.2   44.1</code></pre>
<div class="sourceCode" id="cb1330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1330-1"><a href="extending-the-discrete-time-hazard-model.html#cb1330-1" aria-hidden="true" tabindex="-1"></a>l3 <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit12.3    0.0       0.0  -421.2     22.0         3.1    0.4    842.3   44.1  
## fit12.7   -3.9       2.3  -425.1     22.5         9.4    1.1    850.1   45.0</code></pre>
<p>If we presume the LOO differences follow a normal distribution, we can use their point estimates and standard errors to plot those distributions using simulated data from good old <code>rnorm()</code>.</p>
<div class="sourceCode" id="cb1332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1332-1"><a href="extending-the-discrete-time-hazard-model.html#cb1332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1332-2"><a href="extending-the-discrete-time-hazard-model.html#cb1332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1332-3"><a href="extending-the-discrete-time-hazard-model.html#cb1332-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb1332-4"><a href="extending-the-discrete-time-hazard-model.html#cb1332-4" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;linear - constant&quot;</span>, <span class="st">&quot;quadratic - linear&quot;</span>, <span class="st">&quot;quadratic - general&quot;</span>)</span>
<span id="cb1332-5"><a href="extending-the-discrete-time-hazard-model.html#cb1332-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb1332-6"><a href="extending-the-discrete-time-hazard-model.html#cb1332-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1332-7"><a href="extending-the-discrete-time-hazard-model.html#cb1332-7" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb1332-8"><a href="extending-the-discrete-time-hazard-model.html#cb1332-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">loo_difference =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n, <span class="at">mean =</span> l1[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sd =</span> l1[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">*</span> <span class="dv">2</span>),</span>
<span id="cb1332-9"><a href="extending-the-discrete-time-hazard-model.html#cb1332-9" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">rnorm</span>(n, <span class="at">mean =</span> l2[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sd =</span> l2[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">*</span> <span class="dv">2</span>),</span>
<span id="cb1332-10"><a href="extending-the-discrete-time-hazard-model.html#cb1332-10" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">rnorm</span>(n, <span class="at">mean =</span> l3[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sd =</span> l3[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">*</span> <span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1332-11"><a href="extending-the-discrete-time-hazard-model.html#cb1332-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">models =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(models, <span class="at">each =</span> n),</span>
<span id="cb1332-12"><a href="extending-the-discrete-time-hazard-model.html#cb1332-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> models)) <span class="sc">%&gt;%</span> </span>
<span id="cb1332-13"><a href="extending-the-discrete-time-hazard-model.html#cb1332-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1332-14"><a href="extending-the-discrete-time-hazard-model.html#cb1332-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1332-15"><a href="extending-the-discrete-time-hazard-model.html#cb1332-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> loo_difference, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1332-16"><a href="extending-the-discrete-time-hazard-model.html#cb1332-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>), <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1332-17"><a href="extending-the-discrete-time-hazard-model.html#cb1332-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1332-18"><a href="extending-the-discrete-time-hazard-model.html#cb1332-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;LOO-difference simulations based on 1,000,000 draws&quot;</span>,</span>
<span id="cb1332-19"><a href="extending-the-discrete-time-hazard-model.html#cb1332-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;difference distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb1332-20"><a href="extending-the-discrete-time-hazard-model.html#cb1332-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1332-21"><a href="extending-the-discrete-time-hazard-model.html#cb1332-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> models, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-21-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The LOO difference for the linear and constant models is decisive. The difference for the quadratic and linear models is fairly large on the information-criteria scale, but the uncertainty in that distribution is fairly large relative to its location (i.e., its mean), which might temper overly-strong conclusions about how much better the quadratic was compared to the linear. The comparison between the quadratic and the general produced a simulation with a modest location and rather large uncertainty relative to the magnitude of that location. All in all, “all signs point to the superiority of the quadratic specification, which fits nearly as well as the general mode, but with fewer parameters” (p. 416).</p>
<p>In the next page, Singer and Willett briefly focused on comparing the cubic and quadratic models. Here are their LOO and WAIC caparisons.</p>
<div class="sourceCode" id="cb1333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1333-1"><a href="extending-the-discrete-time-hazard-model.html#cb1333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit12.4    0.0       0.0  -420.7     22.0         4.1    0.5    841.4   44.1  
## fit12.3   -0.5       2.2  -421.2     22.0         3.1    0.4    842.3   44.1</code></pre>
<div class="sourceCode" id="cb1335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1335-1"><a href="extending-the-discrete-time-hazard-model.html#cb1335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic   se_waic
## fit12.4    0.0       0.0  -420.7      22.0          4.1    0.5     841.4   44.1 
## fit12.3   -0.5       2.2  -421.2      22.0          3.1    0.4     842.3   44.1</code></pre>
<p>In the text, the results for the AIC and BIC differed. Our LOO and WAIC results both agree with the AIC: the cubic model has a slightly lower LOO and WAIC estimate compared to the quadratic. However, the standard errors for the formal difference score are about twice the size of that difference and the absolute magnitude of the difference is rather small to begin with. Here’s what it looks like if we compare them using LOO weights, WAIC weights, and stacking weights.</p>
<div class="sourceCode" id="cb1337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1337-1"><a href="extending-the-discrete-time-hazard-model.html#cb1337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, <span class="at">weights =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.3 fit12.4 
##   0.384   0.616</code></pre>
<div class="sourceCode" id="cb1339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1339-1"><a href="extending-the-discrete-time-hazard-model.html#cb1339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.3 fit12.4 
##   0.383   0.617</code></pre>
<div class="sourceCode" id="cb1341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1341-1"><a href="extending-the-discrete-time-hazard-model.html#cb1341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>, <span class="at">weights =</span> <span class="st">&quot;stacking&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.3 fit12.4 
##   0.404   0.596</code></pre>
<p>Across all three weight comparisons, there was a modest edge for the quadratic model. But back to Singer and Willett:</p>
<blockquote>
<p>Although decision rules cannot substitute for judgment, intuition, and common sense, we nevertheless conclude by offering two guidelines for selecting among alternative specifications:</p>
<ul>
<li><em>If a smooth specification works nearly as well as the completely general one, appreciably better than all simpler ones, and no worse than all more complex ones, consider adopting it.</em></li>
<li><em>If no smooth specifications meet these criteria, retain the completely general specification.</em></li>
</ul>
<p>If this decision process leads you to a polynomial specification, then you can interpret the model’s parameters easily, as we [will discuss in a bit]. (p. 417, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Before moving on, we might point out that our Bayesian <strong>brms</strong>-based framework offers a different option: model averaging. We plot the hazard and survival curves based on weighted averages of multiple models. The weights can be based on various criteria. One approach would be to use the model weights from the LOO or the WAIC. As an example, here we use the LOO weights for the quadratic and cubic models.</p>
<div class="sourceCode" id="cb1343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1343-1"><a href="extending-the-discrete-time-hazard-model.html#cb1343-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">period =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb1343-2"><a href="extending-the-discrete-time-hazard-model.html#cb1343-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1343-3"><a href="extending-the-discrete-time-hazard-model.html#cb1343-3" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span></span>
<span id="cb1343-4"><a href="extending-the-discrete-time-hazard-model.html#cb1343-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_average</span>(fit12<span class="fl">.3</span>, fit12<span class="fl">.4</span>,</span>
<span id="cb1343-5"><a href="extending-the-discrete-time-hazard-model.html#cb1343-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">weights =</span> <span class="st">&quot;loo&quot;</span>,</span>
<span id="cb1343-6"><a href="extending-the-discrete-time-hazard-model.html#cb1343-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">newdata =</span> nd,</span>
<span id="cb1343-7"><a href="extending-the-discrete-time-hazard-model.html#cb1343-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">&quot;pp_expect&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1343-8"><a href="extending-the-discrete-time-hazard-model.html#cb1343-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1343-9"><a href="extending-the-discrete-time-hazard-model.html#cb1343-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd)</span></code></pre></div>
<p>The <code>pp_average()</code> function works much like <code>fitted()</code> or <code>predict()</code>. If you input models and perhaps <code>newdata</code>, it will return estimates that are the weighted averages of the specified models. With the <code>weights = "loo"</code> argument, we indicated our desired weights were those from the LOO, just as we computed earlier with the <code>model_weights()</code> function. With the <code>method = "pp_expect"</code> argument, we indicated we wanted fitted values like we would get from <code>fitted()</code>.</p>
<p>Here we plot the results in terms of hazard and survival.</p>
<div class="sourceCode" id="cb1344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1344-1"><a href="extending-the-discrete-time-hazard-model.html#cb1344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hazard</span></span>
<span id="cb1344-2"><a href="extending-the-discrete-time-hazard-model.html#cb1344-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1344-3"><a href="extending-the-discrete-time-hazard-model.html#cb1344-3" aria-hidden="true" tabindex="-1"></a>  pp <span class="sc">%&gt;%</span> </span>
<span id="cb1344-4"><a href="extending-the-discrete-time-hazard-model.html#cb1344-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period)) <span class="sc">+</span></span>
<span id="cb1344-5"><a href="extending-the-discrete-time-hazard-model.html#cb1344-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1344-6"><a href="extending-the-discrete-time-hazard-model.html#cb1344-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1344-7"><a href="extending-the-discrete-time-hazard-model.html#cb1344-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb1344-8"><a href="extending-the-discrete-time-hazard-model.html#cb1344-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Years after hire&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb1344-9"><a href="extending-the-discrete-time-hazard-model.html#cb1344-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;hazard&quot;</span>) <span class="sc">+</span></span>
<span id="cb1344-10"><a href="extending-the-discrete-time-hazard-model.html#cb1344-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1344-11"><a href="extending-the-discrete-time-hazard-model.html#cb1344-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1344-12"><a href="extending-the-discrete-time-hazard-model.html#cb1344-12" aria-hidden="true" tabindex="-1"></a><span class="co"># survival</span></span>
<span id="cb1344-13"><a href="extending-the-discrete-time-hazard-model.html#cb1344-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1344-14"><a href="extending-the-discrete-time-hazard-model.html#cb1344-14" aria-hidden="true" tabindex="-1"></a>  pp <span class="sc">%&gt;%</span> </span>
<span id="cb1344-15"><a href="extending-the-discrete-time-hazard-model.html#cb1344-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Est.Error) <span class="sc">%&gt;%</span> </span>
<span id="cb1344-16"><a href="extending-the-discrete-time-hazard-model.html#cb1344-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">Estimate =</span> <span class="dv">0</span>, <span class="at">Q2.5 =</span> <span class="dv">0</span>, <span class="at">Q97.5 =</span> <span class="dv">0</span>, <span class="at">period =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1344-17"><a href="extending-the-discrete-time-hazard-model.html#cb1344-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(period) <span class="sc">%&gt;%</span> </span>
<span id="cb1344-18"><a href="extending-the-discrete-time-hazard-model.html#cb1344-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(Estimate<span class="sc">:</span>Q97<span class="fl">.5</span>), <span class="at">.funs =</span> <span class="sc">~</span> <span class="fu">cumprod</span>(<span class="dv">1</span> <span class="sc">-</span> .)) <span class="sc">%&gt;%</span> </span>
<span id="cb1344-19"><a href="extending-the-discrete-time-hazard-model.html#cb1344-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1344-20"><a href="extending-the-discrete-time-hazard-model.html#cb1344-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period)) <span class="sc">+</span></span>
<span id="cb1344-21"><a href="extending-the-discrete-time-hazard-model.html#cb1344-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1344-22"><a href="extending-the-discrete-time-hazard-model.html#cb1344-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1344-23"><a href="extending-the-discrete-time-hazard-model.html#cb1344-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1344-24"><a href="extending-the-discrete-time-hazard-model.html#cb1344-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb1344-25"><a href="extending-the-discrete-time-hazard-model.html#cb1344-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Years after hire&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb1344-26"><a href="extending-the-discrete-time-hazard-model.html#cb1344-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;survival&quot;</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1344-27"><a href="extending-the-discrete-time-hazard-model.html#cb1344-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1344-28"><a href="extending-the-discrete-time-hazard-model.html#cb1344-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1344-29"><a href="extending-the-discrete-time-hazard-model.html#cb1344-29" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb1344-30"><a href="extending-the-discrete-time-hazard-model.html#cb1344-30" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">+</span> </span>
<span id="cb1344-31"><a href="extending-the-discrete-time-hazard-model.html#cb1344-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Behold the fitted hazard and survival curves based on a weighted</span><span class="sc">\n</span><span class="st">average of the quadratic and linear models!&quot;</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-24-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="interpreting-parameters-from-linear-quadratic-and-cubic-specifications." class="section level3 hasAnchor" number="12.1.3">
<h3><span class="header-section-number">12.1.3</span> Interpreting parameters from linear, quadratic, and cubic specifications.<a href="extending-the-discrete-time-hazard-model.html#interpreting-parameters-from-linear-quadratic-and-cubic-specifications." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>“One advantage of a polynomial specification is that you can often interpret its parameters directly” (p. 417). For the polynomial models in this section, Singer and Willett used the <span class="math inline">\(TIME - c\)</span> specification for <code>period</code> where <span class="math inline">\(c\)</span> is a centering constant. They used <span class="math inline">\(c = 5\)</span>. Before we can refit our polynomial models with this parameterization, we’ll want to make a new <code>period</code> variable with this centering. We’ll call it <code>period_5</code>.</p>
<div class="sourceCode" id="cb1345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1345-1"><a href="extending-the-discrete-time-hazard-model.html#cb1345-1" aria-hidden="true" tabindex="-1"></a>tenure_pp <span class="ot">&lt;-</span></span>
<span id="cb1345-2"><a href="extending-the-discrete-time-hazard-model.html#cb1345-2" aria-hidden="true" tabindex="-1"></a>  tenure_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1345-3"><a href="extending-the-discrete-time-hazard-model.html#cb1345-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period_5 =</span> period <span class="sc">-</span> <span class="dv">5</span>)</span>
<span id="cb1345-4"><a href="extending-the-discrete-time-hazard-model.html#cb1345-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1345-5"><a href="extending-the-discrete-time-hazard-model.html#cb1345-5" aria-hidden="true" tabindex="-1"></a><span class="co"># how do the two `period` variables compare?</span></span>
<span id="cb1345-6"><a href="extending-the-discrete-time-hazard-model.html#cb1345-6" aria-hidden="true" tabindex="-1"></a>tenure_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1345-7"><a href="extending-the-discrete-time-hazard-model.html#cb1345-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(period, period_5)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 2
##   period period_5
##    &lt;dbl&gt;    &lt;dbl&gt;
## 1      1       -4
## 2      2       -3
## 3      3       -2
## 4      4       -1
## 5      5        0
## 6      6        1
## 7      7        2
## 8      8        3
## 9      9        4</code></pre>
<p>Now refit the quadratic model using <code>period_5</code>.</p>
<div class="sourceCode" id="cb1347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1347-1"><a href="extending-the-discrete-time-hazard-model.html#cb1347-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.9</span> <span class="ot">&lt;-</span></span>
<span id="cb1347-2"><a href="extending-the-discrete-time-hazard-model.html#cb1347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit12<span class="fl">.3</span>,</span>
<span id="cb1347-3"><a href="extending-the-discrete-time-hazard-model.html#cb1347-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> tenure_pp,</span>
<span id="cb1347-4"><a href="extending-the-discrete-time-hazard-model.html#cb1347-4" aria-hidden="true" tabindex="-1"></a>         event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> period_5 <span class="sc">+</span> <span class="fu">I</span>(period_5<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb1347-5"><a href="extending-the-discrete-time-hazard-model.html#cb1347-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1347-6"><a href="extending-the-discrete-time-hazard-model.html#cb1347-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1347-7"><a href="extending-the-discrete-time-hazard-model.html#cb1347-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit12.09&quot;</span>)</span></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb1348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1348-1"><a href="extending-the-discrete-time-hazard-model.html#cb1348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.9</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ Intercept + period_5 + I(period_5^2) - 1 
##    Data: tenure_pp (Number of observations: 1474) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept      -1.41      0.11    -1.64    -1.19 1.00     2318     2182
## period_5        0.61      0.06     0.50     0.73 1.00     2379     2147
## Iperiod_5E2    -0.13      0.03    -0.18    -0.08 1.00     2158     2633
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Focusing just on the posterior means, this yields the following formula for the quadratic discrete-time hazard model: <span class="math inline">\(\operatorname{logit} \hat h (t_j) = \;\)</span> -1.4122 <span class="math inline">\(\text{one } +\)</span> 0.6150<span class="math inline">\((\text{time}_j - 5)\)</span> -0.1282<span class="math inline">\((\text{time}_j - 5)^2\)</span>.</p>
<p>Singer and Willett used the term “flipover point” for the point at which the quadratic function reaches its peak or trough. If we let <span class="math inline">\(c\)</span> be the centering constant for time variable, <span class="math inline">\(\alpha_1\)</span> be the linear coefficient for time, and <span class="math inline">\(\alpha_2\)</span> be the quadratic coefficient for time, we define the flipover point as</p>
<p><span class="math display">\[\text{flipover point} = [c - 1/2 (\alpha_1 / \alpha_2)].\]</span></p>
<p>Here’s what that looks like using the posterior samples.</p>
<div class="sourceCode" id="cb1350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1350-1"><a href="extending-the-discrete-time-hazard-model.html#cb1350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1350-2"><a href="extending-the-discrete-time-hazard-model.html#cb1350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">c  =</span> <span class="dv">5</span>,</span>
<span id="cb1350-3"><a href="extending-the-discrete-time-hazard-model.html#cb1350-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">a1 =</span> b_period_5,</span>
<span id="cb1350-4"><a href="extending-the-discrete-time-hazard-model.html#cb1350-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">a2 =</span> b_Iperiod_5E2) <span class="sc">%&gt;%</span> </span>
<span id="cb1350-5"><a href="extending-the-discrete-time-hazard-model.html#cb1350-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">flipover point</span><span class="st">`</span> <span class="ot">=</span> c <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> (a1 <span class="sc">/</span> a2)) <span class="sc">%&gt;%</span> </span>
<span id="cb1350-6"><a href="extending-the-discrete-time-hazard-model.html#cb1350-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1350-7"><a href="extending-the-discrete-time-hazard-model.html#cb1350-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">flipover point</span><span class="st">`</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1350-8"><a href="extending-the-discrete-time-hazard-model.html#cb1350-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb1350-9"><a href="extending-the-discrete-time-hazard-model.html#cb1350-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb1350-10"><a href="extending-the-discrete-time-hazard-model.html#cb1350-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1350-11"><a href="extending-the-discrete-time-hazard-model.html#cb1350-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-27-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Just as each parameter has a posterior distribution, the flipover point, which is a function of two of the parameters, also has a posterior distribution. To understand what this flipover distribution means, it might be helpful to look at it in another way. For that, we’ll employ <code>fitted()</code>.</p>
<div class="sourceCode" id="cb1351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1351-1"><a href="extending-the-discrete-time-hazard-model.html#cb1351-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb1351-2"><a href="extending-the-discrete-time-hazard-model.html#cb1351-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">period =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">12</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1351-3"><a href="extending-the-discrete-time-hazard-model.html#cb1351-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period_5 =</span> period <span class="sc">-</span> <span class="dv">5</span>)</span>
<span id="cb1351-4"><a href="extending-the-discrete-time-hazard-model.html#cb1351-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1351-5"><a href="extending-the-discrete-time-hazard-model.html#cb1351-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1351-6"><a href="extending-the-discrete-time-hazard-model.html#cb1351-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit12<span class="fl">.9</span>,</span>
<span id="cb1351-7"><a href="extending-the-discrete-time-hazard-model.html#cb1351-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb1351-8"><a href="extending-the-discrete-time-hazard-model.html#cb1351-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb1351-9"><a href="extending-the-discrete-time-hazard-model.html#cb1351-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1351-10"><a href="extending-the-discrete-time-hazard-model.html#cb1351-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1351-11"><a href="extending-the-discrete-time-hazard-model.html#cb1351-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1351-12"><a href="extending-the-discrete-time-hazard-model.html#cb1351-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">expand</span>(nd,</span>
<span id="cb1351-13"><a href="extending-the-discrete-time-hazard-model.html#cb1351-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>,</span>
<span id="cb1351-14"><a href="extending-the-discrete-time-hazard-model.html#cb1351-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(period, period_5)))</span>
<span id="cb1351-15"><a href="extending-the-discrete-time-hazard-model.html#cb1351-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1351-16"><a href="extending-the-discrete-time-hazard-model.html#cb1351-16" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb1351-17"><a href="extending-the-discrete-time-hazard-model.html#cb1351-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 484,000
## Columns: 5
## $ name     &lt;chr&gt; &quot;X1&quot;, &quot;X2&quot;, &quot;X3&quot;, &quot;X4&quot;, &quot;X5&quot;, &quot;X6&quot;, &quot;X7&quot;, &quot;X8&quot;, &quot;X9&quot;, &quot;X10&quot;, &quot;X11&quot;, &quot;X12&quot;, &quot;X13&quot;, &quot;X14&quot;, &quot;X…
## $ value    &lt;dbl&gt; -6.718848, -6.570127, -6.423196, -6.278057, -6.134709, -5.993153, -5.853387, -5.715413, -5.…
## $ iter     &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ period   &lt;dbl&gt; 0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1…
## $ period_5 &lt;dbl&gt; -5.0, -4.9, -4.8, -4.7, -4.6, -4.5, -4.4, -4.3, -4.2, -4.1, -4.0, -3.9, -3.8, -3.7, -3.6, -…</code></pre>
<p>Now make a logit hazard spaghetti plot.</p>
<div class="sourceCode" id="cb1353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1353-1"><a href="extending-the-discrete-time-hazard-model.html#cb1353-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb1353-2"><a href="extending-the-discrete-time-hazard-model.html#cb1353-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># how many lines would you like?</span></span>
<span id="cb1353-3"><a href="extending-the-discrete-time-hazard-model.html#cb1353-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1353-4"><a href="extending-the-discrete-time-hazard-model.html#cb1353-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1353-5"><a href="extending-the-discrete-time-hazard-model.html#cb1353-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> value, <span class="at">group =</span> iter)) <span class="sc">+</span></span>
<span id="cb1353-6"><a href="extending-the-discrete-time-hazard-model.html#cb1353-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1353-7"><a href="extending-the-discrete-time-hazard-model.html#cb1353-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;logit hazard&quot;</span>) <span class="sc">+</span></span>
<span id="cb1353-8"><a href="extending-the-discrete-time-hazard-model.html#cb1353-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">11</span>),</span>
<span id="cb1353-9"><a href="extending-the-discrete-time-hazard-model.html#cb1353-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1353-10"><a href="extending-the-discrete-time-hazard-model.html#cb1353-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-29-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>To keep the plot manageable, we filtered to just the first 30 posterior draws. Each was depicted with its own hazard line. Note how each of those hazard lines peaks at a different point along the <span class="math inline">\(x\)</span>-axis. Most peak somewhere around 7.4. Some take on notably higher values.</p>
<p>Now fit a cubic model using <code>period_5</code>, <span class="math inline">\((TIME_j - 5)\)</span>, as the measure of time.</p>
<div class="sourceCode" id="cb1354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1354-1"><a href="extending-the-discrete-time-hazard-model.html#cb1354-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.10</span> <span class="ot">&lt;-</span></span>
<span id="cb1354-2"><a href="extending-the-discrete-time-hazard-model.html#cb1354-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit12<span class="fl">.4</span>,</span>
<span id="cb1354-3"><a href="extending-the-discrete-time-hazard-model.html#cb1354-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> tenure_pp,</span>
<span id="cb1354-4"><a href="extending-the-discrete-time-hazard-model.html#cb1354-4" aria-hidden="true" tabindex="-1"></a>         event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> period_5 <span class="sc">+</span> <span class="fu">I</span>(period_5<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(period_5<span class="sc">^</span><span class="dv">3</span>),</span>
<span id="cb1354-5"><a href="extending-the-discrete-time-hazard-model.html#cb1354-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1354-6"><a href="extending-the-discrete-time-hazard-model.html#cb1354-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1354-7"><a href="extending-the-discrete-time-hazard-model.html#cb1354-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit12.10&quot;</span>)</span></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb1355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1355-1"><a href="extending-the-discrete-time-hazard-model.html#cb1355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.10</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ Intercept + period_5 + I(period_5^2) + I(period_5^3) - 1 
##    Data: tenure_pp (Number of observations: 1474) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept      -1.45      0.12    -1.68    -1.23 1.00     2027     2390
## period_5        0.75      0.10     0.56     0.94 1.00     1981     2332
## Iperiod_5E2    -0.11      0.03    -0.17    -0.07 1.00     1947     1964
## Iperiod_5E3    -0.02      0.01    -0.04     0.00 1.00     1927     2027
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Focusing again on just the posterior means, this yields the following formula for the cubic discrete-time hazard model: <span class="math inline">\(\operatorname{logit} \hat h (t_j) =\;\)</span> -1.4535 <span class="math inline">\(\text{one } +\)</span> 0.7505<span class="math inline">\((\text{time}_j - 5)\)</span> -0.1149<span class="math inline">\((\text{time}_j - 5)^2\)</span> -0.0182<span class="math inline">\((\text{time}_j - 5)^3\)</span>. Now if we let <span class="math inline">\(c\)</span>, <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_2\)</span> retain their meanings from before and further let <span class="math inline">\(\alpha_3\)</span> stand for the cubic term for time, we can define the two flipover points in the cubic logit hazard model as</p>
<p><span class="math display">\[\text{flipover points} = c + \frac{-\alpha_2 \pm \sqrt{\alpha_2^2 - 3 \alpha_1 \alpha_3}}{3 \alpha_3}.\]</span></p>
<p>Do you see that <span class="math inline">\(\pm\)</span> sign in the numerator? That’s what gives us the two points. Now apply the formula to <code>fit12.10</code> and plot.</p>
<div class="sourceCode" id="cb1357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1357-1"><a href="extending-the-discrete-time-hazard-model.html#cb1357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb1357-2"><a href="extending-the-discrete-time-hazard-model.html#cb1357-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span></span>
<span id="cb1357-3"><a href="extending-the-discrete-time-hazard-model.html#cb1357-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit12<span class="fl">.10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1357-4"><a href="extending-the-discrete-time-hazard-model.html#cb1357-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">c  =</span> <span class="dv">5</span>,</span>
<span id="cb1357-5"><a href="extending-the-discrete-time-hazard-model.html#cb1357-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">a1 =</span> b_period_5,</span>
<span id="cb1357-6"><a href="extending-the-discrete-time-hazard-model.html#cb1357-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">a2 =</span> b_Iperiod_5E2,</span>
<span id="cb1357-7"><a href="extending-the-discrete-time-hazard-model.html#cb1357-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">a3 =</span> b_Iperiod_5E3)</span>
<span id="cb1357-8"><a href="extending-the-discrete-time-hazard-model.html#cb1357-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1357-9"><a href="extending-the-discrete-time-hazard-model.html#cb1357-9" aria-hidden="true" tabindex="-1"></a><span class="co"># flipover point with &quot;+&quot; in the numerator</span></span>
<span id="cb1357-10"><a href="extending-the-discrete-time-hazard-model.html#cb1357-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1357-11"><a href="extending-the-discrete-time-hazard-model.html#cb1357-11" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1357-12"><a href="extending-the-discrete-time-hazard-model.html#cb1357-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">flipover point 1</span><span class="st">`</span> <span class="ot">=</span> c <span class="sc">+</span> (<span class="sc">-</span> a2 <span class="sc">+</span> <span class="fu">sqrt</span>(a2<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> a1 <span class="sc">*</span> a3)) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">*</span> a3)) <span class="sc">%&gt;%</span> </span>
<span id="cb1357-13"><a href="extending-the-discrete-time-hazard-model.html#cb1357-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">flipover point 1</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1357-14"><a href="extending-the-discrete-time-hazard-model.html#cb1357-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">flipover point 1</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">50</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">flipover point 1</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1357-15"><a href="extending-the-discrete-time-hazard-model.html#cb1357-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1357-16"><a href="extending-the-discrete-time-hazard-model.html#cb1357-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">flipover point 1</span><span class="st">`</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1357-17"><a href="extending-the-discrete-time-hazard-model.html#cb1357-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeyeh</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>),) <span class="sc">+</span></span>
<span id="cb1357-18"><a href="extending-the-discrete-time-hazard-model.html#cb1357-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1357-19"><a href="extending-the-discrete-time-hazard-model.html#cb1357-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="sc">-</span><span class="dv">30</span>, <span class="at">y =</span> .<span class="dv">85</span>,</span>
<span id="cb1357-20"><a href="extending-the-discrete-time-hazard-model.html#cb1357-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;italic(c)+frac(-alpha[2]+sqrt(alpha[2]^2-3*alpha[1]*alpha[3]), 3*alpha[3])&quot;</span>,</span>
<span id="cb1357-21"><a href="extending-the-discrete-time-hazard-model.html#cb1357-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1357-22"><a href="extending-the-discrete-time-hazard-model.html#cb1357-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1357-23"><a href="extending-the-discrete-time-hazard-model.html#cb1357-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">20</span>))</span>
<span id="cb1357-24"><a href="extending-the-discrete-time-hazard-model.html#cb1357-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1357-25"><a href="extending-the-discrete-time-hazard-model.html#cb1357-25" aria-hidden="true" tabindex="-1"></a><span class="co"># flipover point with &quot;-&quot; in the numerator</span></span>
<span id="cb1357-26"><a href="extending-the-discrete-time-hazard-model.html#cb1357-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1357-27"><a href="extending-the-discrete-time-hazard-model.html#cb1357-27" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1357-28"><a href="extending-the-discrete-time-hazard-model.html#cb1357-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">flipover point 2</span><span class="st">`</span> <span class="ot">=</span> c <span class="sc">+</span> (<span class="sc">-</span> a2 <span class="sc">-</span> <span class="fu">sqrt</span>(a2<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> a1 <span class="sc">*</span> a3)) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">*</span> a3)) <span class="sc">%&gt;%</span> </span>
<span id="cb1357-29"><a href="extending-the-discrete-time-hazard-model.html#cb1357-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">flipover point 2</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1357-30"><a href="extending-the-discrete-time-hazard-model.html#cb1357-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1357-31"><a href="extending-the-discrete-time-hazard-model.html#cb1357-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">flipover point 2</span><span class="st">`</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1357-32"><a href="extending-the-discrete-time-hazard-model.html#cb1357-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeyeh</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb1357-33"><a href="extending-the-discrete-time-hazard-model.html#cb1357-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1357-34"><a href="extending-the-discrete-time-hazard-model.html#cb1357-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">8.2</span>, <span class="at">y =</span> .<span class="dv">85</span>,</span>
<span id="cb1357-35"><a href="extending-the-discrete-time-hazard-model.html#cb1357-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;italic(c)+frac(-alpha[2]-sqrt(alpha[2]^2-3*alpha[1]*alpha[3]), 3*alpha[3])&quot;</span>,</span>
<span id="cb1357-36"><a href="extending-the-discrete-time-hazard-model.html#cb1357-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1357-37"><a href="extending-the-discrete-time-hazard-model.html#cb1357-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span>
<span id="cb1357-38"><a href="extending-the-discrete-time-hazard-model.html#cb1357-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1357-39"><a href="extending-the-discrete-time-hazard-model.html#cb1357-39" aria-hidden="true" tabindex="-1"></a><span class="co"># combine!</span></span>
<span id="cb1357-40"><a href="extending-the-discrete-time-hazard-model.html#cb1357-40" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-31-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The plot on the right looks similar to the flipover plot from <code>fit12.9</code>. But look at the massive uncertainty in the flipover point in the plot on the left. If you play around with the code, you’ll see the <span class="math inline">\(x\)</span>-axis extends far beyond the boundaries in the plot. Another spaghetti plot might help show what’s going on.</p>
<div class="sourceCode" id="cb1358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1358-1"><a href="extending-the-discrete-time-hazard-model.html#cb1358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># redifine the `newdata`</span></span>
<span id="cb1358-2"><a href="extending-the-discrete-time-hazard-model.html#cb1358-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb1358-3"><a href="extending-the-discrete-time-hazard-model.html#cb1358-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">period =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">to =</span> <span class="dv">11</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1358-4"><a href="extending-the-discrete-time-hazard-model.html#cb1358-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period_5 =</span> period <span class="sc">-</span> <span class="dv">5</span>)</span>
<span id="cb1358-5"><a href="extending-the-discrete-time-hazard-model.html#cb1358-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1358-6"><a href="extending-the-discrete-time-hazard-model.html#cb1358-6" aria-hidden="true" tabindex="-1"></a><span class="co"># employ `fitted()` and wrangle</span></span>
<span id="cb1358-7"><a href="extending-the-discrete-time-hazard-model.html#cb1358-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1358-8"><a href="extending-the-discrete-time-hazard-model.html#cb1358-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit12<span class="fl">.10</span>,</span>
<span id="cb1358-9"><a href="extending-the-discrete-time-hazard-model.html#cb1358-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb1358-10"><a href="extending-the-discrete-time-hazard-model.html#cb1358-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb1358-11"><a href="extending-the-discrete-time-hazard-model.html#cb1358-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1358-12"><a href="extending-the-discrete-time-hazard-model.html#cb1358-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1358-13"><a href="extending-the-discrete-time-hazard-model.html#cb1358-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1358-14"><a href="extending-the-discrete-time-hazard-model.html#cb1358-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">expand</span>(nd,</span>
<span id="cb1358-15"><a href="extending-the-discrete-time-hazard-model.html#cb1358-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>,</span>
<span id="cb1358-16"><a href="extending-the-discrete-time-hazard-model.html#cb1358-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(period, period_5)))</span>
<span id="cb1358-17"><a href="extending-the-discrete-time-hazard-model.html#cb1358-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1358-18"><a href="extending-the-discrete-time-hazard-model.html#cb1358-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot!</span></span>
<span id="cb1358-19"><a href="extending-the-discrete-time-hazard-model.html#cb1358-19" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb1358-20"><a href="extending-the-discrete-time-hazard-model.html#cb1358-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iter <span class="sc">&lt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1358-21"><a href="extending-the-discrete-time-hazard-model.html#cb1358-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> value, <span class="at">group =</span> iter)) <span class="sc">+</span></span>
<span id="cb1358-22"><a href="extending-the-discrete-time-hazard-model.html#cb1358-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1358-23"><a href="extending-the-discrete-time-hazard-model.html#cb1358-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;logit hazard&quot;</span>) <span class="sc">+</span></span>
<span id="cb1358-24"><a href="extending-the-discrete-time-hazard-model.html#cb1358-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb1358-25"><a href="extending-the-discrete-time-hazard-model.html#cb1358-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1358-26"><a href="extending-the-discrete-time-hazard-model.html#cb1358-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-32-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>On the region to the right of 0 on the <span class="math inline">\(x\)</span>-axis, the plot looks a lot like the one for the quadratic model. But look at how wildly the lines fan out on the left side of 0. Since that’s the region where we find the second flipover point, all that uncertainty got baked into its marginal posterior. Just because I think it looks cool, here’s a version of that plot with lines corresponding to all 4,000 posterior draws.</p>
<div class="sourceCode" id="cb1359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1359-1"><a href="extending-the-discrete-time-hazard-model.html#cb1359-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb1359-2"><a href="extending-the-discrete-time-hazard-model.html#cb1359-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> value, <span class="at">group =</span> iter)) <span class="sc">+</span></span>
<span id="cb1359-3"><a href="extending-the-discrete-time-hazard-model.html#cb1359-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1359-4"><a href="extending-the-discrete-time-hazard-model.html#cb1359-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;logit hazard&quot;</span>) <span class="sc">+</span></span>
<span id="cb1359-5"><a href="extending-the-discrete-time-hazard-model.html#cb1359-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb1359-6"><a href="extending-the-discrete-time-hazard-model.html#cb1359-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">13</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1359-7"><a href="extending-the-discrete-time-hazard-model.html#cb1359-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-33-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="using-the-complementary-log-log-link-to-specify-a-discrete-time-hazard-model" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Using the complementary log-log link to specify a discrete-time hazard model<a href="extending-the-discrete-time-hazard-model.html#using-the-complementary-log-log-link-to-specify-a-discrete-time-hazard-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far we’ve been using the</p>
<blockquote>
<p>logit transformation [which] represented a natural choice because it allowed us to: (1) specify the model using familiar terminology; (2) use widely available software for estimation; and (3) exploit interpretative strategies with which many empirical researchers are comfortable.</p>
<p>Just like the choice of a completely general specification for the main effect of <em>TIME</em>, use of a logit link is an analytic decision. Nothing about the way in which the model is postulated or fit requires the adoption of this, or any other, particular link function. (p. 419–420, <em>emphasis</em> in the original)</p>
</blockquote>
<p>The <em>complimentary log-log</em> transformation–<em>clog-log</em> for short–is a widely-used alternative. It follows the form</p>
<p><span class="math display">\[\operatorname{clog-log} = \log \big (- \log (1 - p) \big),\]</span></p>
<p>where <span class="math inline">\(p\)</span> is a probability value. In words, “while the logit transformation yields the logarithm of the <em>odds of event occurrence</em>, the clog-log transformation yields <em>the logarithm of the negated logarithm of the probability of event nonoccurrence</em>” (p. 420, <em>emphasis</em> in the original).</p>
<div id="the-clog-log-transformation-when-and-why-it-is-useful." class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> The clog-log transformation: When and why it is useful.<a href="extending-the-discrete-time-hazard-model.html#the-clog-log-transformation-when-and-why-it-is-useful." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here’s our version of Figure 12.2, where we compare the logit and clog-log transformations.</p>
<div class="sourceCode" id="cb1360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1360-1"><a href="extending-the-discrete-time-hazard-model.html#cb1360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data</span></span>
<span id="cb1360-2"><a href="extending-the-discrete-time-hazard-model.html#cb1360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">p =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">00001</span>, <span class="at">to =</span> .<span class="dv">99999</span>, <span class="at">length.out =</span> <span class="fl">1e4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1360-3"><a href="extending-the-discrete-time-hazard-model.html#cb1360-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logit   =</span> <span class="fu">log</span>(p <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p)),</span>
<span id="cb1360-4"><a href="extending-the-discrete-time-hazard-model.html#cb1360-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">cloglog =</span> <span class="fu">log</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> p))) <span class="sc">%&gt;%</span> </span>
<span id="cb1360-5"><a href="extending-the-discrete-time-hazard-model.html#cb1360-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>p) <span class="sc">%&gt;%</span> </span>
<span id="cb1360-6"><a href="extending-the-discrete-time-hazard-model.html#cb1360-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name,</span>
<span id="cb1360-7"><a href="extending-the-discrete-time-hazard-model.html#cb1360-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;logit&quot;</span>, <span class="st">&quot;cloglog&quot;</span>),</span>
<span id="cb1360-8"><a href="extending-the-discrete-time-hazard-model.html#cb1360-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Logit&quot;</span>, <span class="st">&quot;Complementary log-log&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1360-9"><a href="extending-the-discrete-time-hazard-model.html#cb1360-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1360-10"><a href="extending-the-discrete-time-hazard-model.html#cb1360-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb1360-11"><a href="extending-the-discrete-time-hazard-model.html#cb1360-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb1360-12"><a href="extending-the-discrete-time-hazard-model.html#cb1360-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1360-13"><a href="extending-the-discrete-time-hazard-model.html#cb1360-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1360-14"><a href="extending-the-discrete-time-hazard-model.html#cb1360-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb1360-15"><a href="extending-the-discrete-time-hazard-model.html#cb1360-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;transformed hazard probability&quot;</span>, </span>
<span id="cb1360-16"><a href="extending-the-discrete-time-hazard-model.html#cb1360-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb1360-17"><a href="extending-the-discrete-time-hazard-model.html#cb1360-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;hazard probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb1360-18"><a href="extending-the-discrete-time-hazard-model.html#cb1360-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey92&quot;</span>),</span>
<span id="cb1360-19"><a href="extending-the-discrete-time-hazard-model.html#cb1360-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>),</span>
<span id="cb1360-20"><a href="extending-the-discrete-time-hazard-model.html#cb1360-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">85</span>),</span>
<span id="cb1360-21"><a href="extending-the-discrete-time-hazard-model.html#cb1360-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-34-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Both transformations extend to the full <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span> parameter space. But whereas the logit is symmetric around zero and has a memorable point corresponding to <span class="math inline">\(p = .5\)</span> (i.e., 0), the clog-log is asymmetric and has a less-intuitive point corresponding to <span class="math inline">\(p = .5\)</span> (i.e., -0.3665129). Though somewhat odd, the advantage of the clog-log is</p>
<blockquote>
<p>it provides a discrete-time statistical model for hazard that has a built-in <em>proportional hazards</em> assumption, and not a <em>proportional odds</em> assumption (as in the case of the logit link). This would be completely unremarkable except for one thing: it provides a conceptual parallelism between the clog-log discrete-time hazard model and the models that we will ultimately describe for continuous-time survival analysis. (p. 421, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="a-discrete-time-hazard-model-using-the-complementary-log-log-link." class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> A discrete-time hazard model using the complementary log-log link.<a href="extending-the-discrete-time-hazard-model.html#a-discrete-time-hazard-model-using-the-complementary-log-log-link." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Singer and Willett (p. 422):</p>
<blockquote>
<p>Any discrete-time hazard model postulated using a logit link can be rewritten using a clog-log link, simply by substituting transformations of the outcome. For example, we can write a general discrete-time hazard model for <span class="math inline">\(J\)</span> time periods and <span class="math inline">\(P\)</span> substantive predictors as:</p>
</blockquote>
<p><span class="math display">\[\begin{align*}
\operatorname{clog-log} h(t_j) &amp; = [\alpha_1 D_1 + \alpha_2 D_2 + \cdots + \alpha_J D_J] \\
&amp; \;\; + [\beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_P X_P].
\end{align*}\]</span></p>
<p>Now reload the <code>firstsex_pp.csv</code> data to test this baby out.</p>
<div class="sourceCode" id="cb1361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1361-1"><a href="extending-the-discrete-time-hazard-model.html#cb1361-1" aria-hidden="true" tabindex="-1"></a>sex_pp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/firstsex_pp.csv&quot;</span>)</span>
<span id="cb1361-2"><a href="extending-the-discrete-time-hazard-model.html#cb1361-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1361-3"><a href="extending-the-discrete-time-hazard-model.html#cb1361-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sex_pp)</span></code></pre></div>
<pre><code>## Rows: 822
## Columns: 11
## $ id     &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 9, 9, …
## $ period &lt;dbl&gt; 7, 8, 9, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 7, 8…
## $ event  &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, …
## $ d7     &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, …
## $ d8     &lt;dbl&gt; 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, …
## $ d9     &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, …
## $ d10    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …
## $ d11    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, …
## $ d12    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ pt     &lt;dbl&gt; 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, …
## $ pas    &lt;dbl&gt; 1.9788670, 1.9788670, 1.9788670, -0.5454916, -0.5454916, -0.5454916, -0.5454916, -0.5454916, …</code></pre>
<p>Our next task is to recreate Figure 12.3, which shows the “sample hazard functions for the grade of first intercourse data displayed on different scales,” namely the logit and clog-log (p. 423). The key word here is “sample,” meaning we’re not fitting full models. For our version of the corresponding figure from the last chapter (i.e., Figure 11.2 from page 363), we computed the sample logit hazard functions with life tables based on the output from the <code>survival::survfit()</code> function. I am not aware that you can get hazards in the clog-log scale from the <code>survfit()</code> function. The folks at IDRE solved the problem by fitting four maximum likelihood models using the <code>glm()</code> function (see <a href="https://stats.idre.ucla.edu/r/examples/alda/r-applied-longitudinal-data-analysis-ch-12/">here</a>). We’ll follow a similar approach, but with weakly-regularizing priors using the <code>brms::brm()</code> function.</p>
<div class="sourceCode" id="cb1363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1363-1"><a href="extending-the-discrete-time-hazard-model.html#cb1363-1" aria-hidden="true" tabindex="-1"></a><span class="do">## logit</span></span>
<span id="cb1363-2"><a href="extending-the-discrete-time-hazard-model.html#cb1363-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pt == 0</span></span>
<span id="cb1363-3"><a href="extending-the-discrete-time-hazard-model.html#cb1363-3" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.11</span> <span class="ot">&lt;-</span></span>
<span id="cb1363-4"><a href="extending-the-discrete-time-hazard-model.html#cb1363-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> sex_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pt <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1363-5"><a href="extending-the-discrete-time-hazard-model.html#cb1363-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1363-6"><a href="extending-the-discrete-time-hazard-model.html#cb1363-6" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10 <span class="sc">+</span> d11 <span class="sc">+</span> d12,</span>
<span id="cb1363-7"><a href="extending-the-discrete-time-hazard-model.html#cb1363-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1363-8"><a href="extending-the-discrete-time-hazard-model.html#cb1363-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1363-9"><a href="extending-the-discrete-time-hazard-model.html#cb1363-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1363-10"><a href="extending-the-discrete-time-hazard-model.html#cb1363-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.11&quot;</span>)</span>
<span id="cb1363-11"><a href="extending-the-discrete-time-hazard-model.html#cb1363-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1363-12"><a href="extending-the-discrete-time-hazard-model.html#cb1363-12" aria-hidden="true" tabindex="-1"></a><span class="co"># pt == 1</span></span>
<span id="cb1363-13"><a href="extending-the-discrete-time-hazard-model.html#cb1363-13" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.12</span> <span class="ot">&lt;-</span></span>
<span id="cb1363-14"><a href="extending-the-discrete-time-hazard-model.html#cb1363-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> sex_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pt <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb1363-15"><a href="extending-the-discrete-time-hazard-model.html#cb1363-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1363-16"><a href="extending-the-discrete-time-hazard-model.html#cb1363-16" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10 <span class="sc">+</span> d11 <span class="sc">+</span> d12,</span>
<span id="cb1363-17"><a href="extending-the-discrete-time-hazard-model.html#cb1363-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1363-18"><a href="extending-the-discrete-time-hazard-model.html#cb1363-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1363-19"><a href="extending-the-discrete-time-hazard-model.html#cb1363-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1363-20"><a href="extending-the-discrete-time-hazard-model.html#cb1363-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.12&quot;</span>)</span>
<span id="cb1363-21"><a href="extending-the-discrete-time-hazard-model.html#cb1363-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1363-22"><a href="extending-the-discrete-time-hazard-model.html#cb1363-22" aria-hidden="true" tabindex="-1"></a><span class="do">## clog-log</span></span>
<span id="cb1363-23"><a href="extending-the-discrete-time-hazard-model.html#cb1363-23" aria-hidden="true" tabindex="-1"></a><span class="co"># pt == 0</span></span>
<span id="cb1363-24"><a href="extending-the-discrete-time-hazard-model.html#cb1363-24" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.13</span> <span class="ot">&lt;-</span></span>
<span id="cb1363-25"><a href="extending-the-discrete-time-hazard-model.html#cb1363-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> sex_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pt <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1363-26"><a href="extending-the-discrete-time-hazard-model.html#cb1363-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> cloglog),</span>
<span id="cb1363-27"><a href="extending-the-discrete-time-hazard-model.html#cb1363-27" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10 <span class="sc">+</span> d11 <span class="sc">+</span> d12,</span>
<span id="cb1363-28"><a href="extending-the-discrete-time-hazard-model.html#cb1363-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1363-29"><a href="extending-the-discrete-time-hazard-model.html#cb1363-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1363-30"><a href="extending-the-discrete-time-hazard-model.html#cb1363-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1363-31"><a href="extending-the-discrete-time-hazard-model.html#cb1363-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.13&quot;</span>)</span>
<span id="cb1363-32"><a href="extending-the-discrete-time-hazard-model.html#cb1363-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1363-33"><a href="extending-the-discrete-time-hazard-model.html#cb1363-33" aria-hidden="true" tabindex="-1"></a><span class="co"># pt == 1</span></span>
<span id="cb1363-34"><a href="extending-the-discrete-time-hazard-model.html#cb1363-34" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.14</span> <span class="ot">&lt;-</span></span>
<span id="cb1363-35"><a href="extending-the-discrete-time-hazard-model.html#cb1363-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> sex_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pt <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb1363-36"><a href="extending-the-discrete-time-hazard-model.html#cb1363-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> cloglog),</span>
<span id="cb1363-37"><a href="extending-the-discrete-time-hazard-model.html#cb1363-37" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10 <span class="sc">+</span> d11 <span class="sc">+</span> d12,</span>
<span id="cb1363-38"><a href="extending-the-discrete-time-hazard-model.html#cb1363-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1363-39"><a href="extending-the-discrete-time-hazard-model.html#cb1363-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1363-40"><a href="extending-the-discrete-time-hazard-model.html#cb1363-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1363-41"><a href="extending-the-discrete-time-hazard-model.html#cb1363-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.14&quot;</span>)</span></code></pre></div>
<p>The primary line of code that distinguishes <code>fit12.11</code> and <code>fit12.12</code> from <code>fit12.13</code> and <code>fit12.14</code> is <code>family = binomial(link = cloglog)</code>. With the <code>family</code> argument, we switched out the default logit link for the clog-log link. Before we can make our version of Figure 12.5, we will redefine our <code>nd</code> data for <code>fitted()</code>, pump our four fit objects into our custom <code>make_fitted()</code> function from earlier, and wrangle a little.</p>
<div class="sourceCode" id="cb1364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1364-1"><a href="extending-the-discrete-time-hazard-model.html#cb1364-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb1364-2"><a href="extending-the-discrete-time-hazard-model.html#cb1364-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">period =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1364-3"><a href="extending-the-discrete-time-hazard-model.html#cb1364-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d7  =</span> <span class="fu">if_else</span>(period <span class="sc">==</span> <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1364-4"><a href="extending-the-discrete-time-hazard-model.html#cb1364-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">d8  =</span> <span class="fu">if_else</span>(period <span class="sc">==</span> <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1364-5"><a href="extending-the-discrete-time-hazard-model.html#cb1364-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">d9  =</span> <span class="fu">if_else</span>(period <span class="sc">==</span> <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1364-6"><a href="extending-the-discrete-time-hazard-model.html#cb1364-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">d10 =</span> <span class="fu">if_else</span>(period <span class="sc">==</span> <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1364-7"><a href="extending-the-discrete-time-hazard-model.html#cb1364-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">d11 =</span> <span class="fu">if_else</span>(period <span class="sc">==</span> <span class="dv">11</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1364-8"><a href="extending-the-discrete-time-hazard-model.html#cb1364-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">d12 =</span> <span class="fu">if_else</span>(period <span class="sc">==</span> <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb1364-9"><a href="extending-the-discrete-time-hazard-model.html#cb1364-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1364-10"><a href="extending-the-discrete-time-hazard-model.html#cb1364-10" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1364-11"><a href="extending-the-discrete-time-hazard-model.html#cb1364-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">make_fitted</span>(fit12<span class="fl">.11</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),</span>
<span id="cb1364-12"><a href="extending-the-discrete-time-hazard-model.html#cb1364-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.12</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),</span>
<span id="cb1364-13"><a href="extending-the-discrete-time-hazard-model.html#cb1364-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.13</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),</span>
<span id="cb1364-14"><a href="extending-the-discrete-time-hazard-model.html#cb1364-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.14</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1364-15"><a href="extending-the-discrete-time-hazard-model.html#cb1364-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pt   =</span> <span class="fu">rep</span>(<span class="fu">str_c</span>(<span class="st">&quot;pt = &quot;</span>, <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">4</span>),</span>
<span id="cb1364-16"><a href="extending-the-discrete-time-hazard-model.html#cb1364-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">link =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;logit&quot;</span>, <span class="st">&quot;clog-log&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb1364-17"><a href="extending-the-discrete-time-hazard-model.html#cb1364-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1364-18"><a href="extending-the-discrete-time-hazard-model.html#cb1364-18" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 24
## Columns: 13
## $ Estimate  &lt;dbl&gt; -3.6706692, -3.6407969, -2.0493384, -1.9018679, -1.4646795, -1.4876617, -2.0033286, -2.938…
## $ Est.Error &lt;dbl&gt; 0.7488902, 0.7365261, 0.3807953, 0.3840227, 0.3501475, 0.4042828, 0.3020423, 0.4622748, 0.…
## $ Q2.5      &lt;dbl&gt; -5.3764207, -5.3293475, -2.8240043, -2.7003814, -2.1926528, -2.3309166, -2.6308878, -3.926…
## $ Q97.5     &lt;dbl&gt; -2.41270860, -2.42506307, -1.33723119, -1.19372384, -0.81299679, -0.74145934, -1.44619911,…
## $ period    &lt;int&gt; 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 12
## $ d7        &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0
## $ d8        &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0
## $ d9        &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0
## $ d10       &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0
## $ d11       &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0
## $ d12       &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1
## $ pt        &lt;chr&gt; &quot;pt = 0&quot;, &quot;pt = 0&quot;, &quot;pt = 0&quot;, &quot;pt = 0&quot;, &quot;pt = 0&quot;, &quot;pt = 0&quot;, &quot;pt = 1&quot;, &quot;pt = 1&quot;, &quot;pt = 1&quot;, …
## $ link      &lt;chr&gt; &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, &quot;logit&quot;, …</code></pre>
<p>Make our version of Figure 12.3.</p>
<div class="sourceCode" id="cb1366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1366-1"><a href="extending-the-discrete-time-hazard-model.html#cb1366-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb1366-2"><a href="extending-the-discrete-time-hazard-model.html#cb1366-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">group =</span> <span class="fu">interaction</span>(pt, link),</span>
<span id="cb1366-3"><a href="extending-the-discrete-time-hazard-model.html#cb1366-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pt)) <span class="sc">+</span></span>
<span id="cb1366-4"><a href="extending-the-discrete-time-hazard-model.html#cb1366-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">linetype =</span> link)) <span class="sc">+</span></span>
<span id="cb1366-5"><a href="extending-the-discrete-time-hazard-model.html#cb1366-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb1366-6"><a href="extending-the-discrete-time-hazard-model.html#cb1366-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;grade&quot;</span>, <span class="at">breaks =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb1366-7"><a href="extending-the-discrete-time-hazard-model.html#cb1366-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;transformed hazard probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb1366-8"><a href="extending-the-discrete-time-hazard-model.html#cb1366-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1366-9"><a href="extending-the-discrete-time-hazard-model.html#cb1366-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-37-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Our next step is to fit proper models to the data. First, we will refit <code>fit11.8</code> from last chapter. Then we’ll fit the clog-log analogue to the same model. The two models, respectively, follow the form</p>
<p><span class="math display">\[
\begin{align*}
\operatorname{logit} h(t_{ij}) &amp; = [\alpha_7 D_{7ij} + \alpha_8 D_{8ij} + \cdots + \alpha_{12} D_{12ij}] + [\beta_1 \text{PT}_i ] \; \text{and} \\
\operatorname{clog-log} h(t_{ij}) &amp; = [\alpha_7 D_{7ij} + \alpha_8 D_{8ij} + \cdots + \alpha_{12} D_{12ij}] + [\beta_1 \text{PT}_i ].
\end{align*}
\]</span></p>
<p>Fit the models.</p>
<div class="sourceCode" id="cb1367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1367-1"><a href="extending-the-discrete-time-hazard-model.html#cb1367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># logit</span></span>
<span id="cb1367-2"><a href="extending-the-discrete-time-hazard-model.html#cb1367-2" aria-hidden="true" tabindex="-1"></a>fit11<span class="fl">.8</span> <span class="ot">&lt;-</span></span>
<span id="cb1367-3"><a href="extending-the-discrete-time-hazard-model.html#cb1367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> sex_pp,</span>
<span id="cb1367-4"><a href="extending-the-discrete-time-hazard-model.html#cb1367-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1367-5"><a href="extending-the-discrete-time-hazard-model.html#cb1367-5" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10 <span class="sc">+</span> d11 <span class="sc">+</span> d12 <span class="sc">+</span> pt,</span>
<span id="cb1367-6"><a href="extending-the-discrete-time-hazard-model.html#cb1367-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1367-7"><a href="extending-the-discrete-time-hazard-model.html#cb1367-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1367-8"><a href="extending-the-discrete-time-hazard-model.html#cb1367-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">11</span>,</span>
<span id="cb1367-9"><a href="extending-the-discrete-time-hazard-model.html#cb1367-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit11.08&quot;</span>)</span>
<span id="cb1367-10"><a href="extending-the-discrete-time-hazard-model.html#cb1367-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1367-11"><a href="extending-the-discrete-time-hazard-model.html#cb1367-11" aria-hidden="true" tabindex="-1"></a><span class="co"># clog-log</span></span>
<span id="cb1367-12"><a href="extending-the-discrete-time-hazard-model.html#cb1367-12" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.15</span> <span class="ot">&lt;-</span></span>
<span id="cb1367-13"><a href="extending-the-discrete-time-hazard-model.html#cb1367-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> sex_pp,</span>
<span id="cb1367-14"><a href="extending-the-discrete-time-hazard-model.html#cb1367-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> cloglog),</span>
<span id="cb1367-15"><a href="extending-the-discrete-time-hazard-model.html#cb1367-15" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10 <span class="sc">+</span> d11 <span class="sc">+</span> d12 <span class="sc">+</span> pt,</span>
<span id="cb1367-16"><a href="extending-the-discrete-time-hazard-model.html#cb1367-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1367-17"><a href="extending-the-discrete-time-hazard-model.html#cb1367-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1367-18"><a href="extending-the-discrete-time-hazard-model.html#cb1367-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1367-19"><a href="extending-the-discrete-time-hazard-model.html#cb1367-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.15&quot;</span>)</span></code></pre></div>
<p>Both models used the binomial likelihood. They only differed in which link function we used to transform the data. To further explicate, we can more fully write out our Bayesian clog-log model as</p>
<p><span class="math display">\[
\begin{align*}
\text{event}_{ij} &amp; = \operatorname{Binomial}(n = 1, p_{ij}) \\
\operatorname{clog-log} (p_{ij}) &amp; =  [\alpha_7 D_{7ij} + \alpha_8 D_{8ij} + \cdots + \alpha_{12} D_{12ij}] + [\beta_1 \text{PT}_{1i} ] \\
\alpha_7, \alpha_8, ..., \alpha_{12} &amp; \sim \operatorname{Normal}(0, 4) \\
\beta_1 &amp; \sim \operatorname{Normal}(0, 4).
\end{align*}
\]</span></p>
<p>Here are the posterior means for <code>fit11.8</code> and <code>fit12.15</code>, as depicted in the firs three columns of Table 12.3.</p>
<div class="sourceCode" id="cb1368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1368-1"><a href="extending-the-discrete-time-hazard-model.html#cb1368-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span></span>
<span id="cb1368-2"><a href="extending-the-discrete-time-hazard-model.html#cb1368-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">fixef</span>(fit11<span class="fl">.8</span>)  <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;par&quot;</span>),</span>
<span id="cb1368-3"><a href="extending-the-discrete-time-hazard-model.html#cb1368-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">fixef</span>(fit12<span class="fl">.15</span>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;par&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1368-4"><a href="extending-the-discrete-time-hazard-model.html#cb1368-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">link =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;logit&quot;</span>, <span class="st">&quot;clog-log&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb1368-5"><a href="extending-the-discrete-time-hazard-model.html#cb1368-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">par  =</span> <span class="fu">factor</span>(par, <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">&quot;d&quot;</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>), <span class="st">&quot;pt&quot;</span>)))</span>
<span id="cb1368-6"><a href="extending-the-discrete-time-hazard-model.html#cb1368-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1368-7"><a href="extending-the-discrete-time-hazard-model.html#cb1368-7" aria-hidden="true" tabindex="-1"></a>pars <span class="sc">%&gt;%</span></span>
<span id="cb1368-8"><a href="extending-the-discrete-time-hazard-model.html#cb1368-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(par, link, Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1368-9"><a href="extending-the-discrete-time-hazard-model.html#cb1368-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> link,</span>
<span id="cb1368-10"><a href="extending-the-discrete-time-hazard-model.html#cb1368-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1368-11"><a href="extending-the-discrete-time-hazard-model.html#cb1368-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(par, <span class="st">`</span><span class="at">clog-log</span><span class="st">`</span>, logit) <span class="sc">%&gt;%</span> </span>
<span id="cb1368-12"><a href="extending-the-discrete-time-hazard-model.html#cb1368-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 × 3
##   par   `clog-log`  logit
##   &lt;fct&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1 d7        -2.98  -3.02 
## 2 d8        -3.69  -3.73 
## 3 d9        -2.32  -2.29 
## 4 d10       -1.90  -1.83 
## 5 d11       -1.77  -1.65 
## 6 d12       -1.35  -1.18 
## 7 pt         0.765  0.863</code></pre>
<p>They might be easier to compare in a coefficient plot.</p>
<div class="sourceCode" id="cb1370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1370-1"><a href="extending-the-discrete-time-hazard-model.html#cb1370-1" aria-hidden="true" tabindex="-1"></a>pars <span class="sc">%&gt;%</span> </span>
<span id="cb1370-2"><a href="extending-the-discrete-time-hazard-model.html#cb1370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> link, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>)) <span class="sc">+</span></span>
<span id="cb1370-3"><a href="extending-the-discrete-time-hazard-model.html#cb1370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb1370-4"><a href="extending-the-discrete-time-hazard-model.html#cb1370-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb1370-5"><a href="extending-the-discrete-time-hazard-model.html#cb1370-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;transformed hazard&quot;</span>) <span class="sc">+</span></span>
<span id="cb1370-6"><a href="extending-the-discrete-time-hazard-model.html#cb1370-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb1370-7"><a href="extending-the-discrete-time-hazard-model.html#cb1370-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1370-8"><a href="extending-the-discrete-time-hazard-model.html#cb1370-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1370-9"><a href="extending-the-discrete-time-hazard-model.html#cb1370-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> par, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-39-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Instead of comparing them with deviance values, we will compare the two models using Bayesian information criteria. For simplicity, we’ll focus on the LOO.</p>
<div class="sourceCode" id="cb1371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1371-1"><a href="extending-the-discrete-time-hazard-model.html#cb1371-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.15</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.15</span>, <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1371-2"><a href="extending-the-discrete-time-hazard-model.html#cb1371-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1371-3"><a href="extending-the-discrete-time-hazard-model.html#cb1371-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.15</span>, fit11<span class="fl">.8</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit12.15    0.0       0.0  -324.3     17.6         7.1    0.5    648.6   35.2  
## fit11.8    -0.2       0.2  -324.5     17.6         7.2    0.6    649.0   35.3</code></pre>
<div class="sourceCode" id="cb1373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1373-1"><a href="extending-the-discrete-time-hazard-model.html#cb1373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.15</span>, fit11<span class="fl">.8</span>, <span class="at">weights =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.15  fit11.8 
##    0.548    0.452</code></pre>
<p>From a LOO perspective, they’re basically the same. The parameter summaries are also quite similar between the two models. A coefficient plot might make it easy to see. “Numerical similarity is common when fitting identical models with alternate link functions (and net risks of event occurrence are low) and suggests that choice of a link function should depend on other considerations” (p. 423).</p>
<p>We already know from the last chapter that we can convert logits to probabilities with the function</p>
<p><span class="math display">\[p = \frac{1}{1 + e^{- \text{logit}}}.\]</span></p>
<p>The relevant inverse transformation for the clog-log link is</p>
<p><span class="math display">\[p = 1 - e^{\left (- e^{( \text{clog-log})} \right)}.\]</span></p>
<p>Now use those formulas to convert our <code>Estimate</code> values into the hazard metric, as shown in the last two columns of Table 12.3.</p>
<div class="sourceCode" id="cb1375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1375-1"><a href="extending-the-discrete-time-hazard-model.html#cb1375-1" aria-hidden="true" tabindex="-1"></a>pars <span class="sc">%&gt;%</span> </span>
<span id="cb1375-2"><a href="extending-the-discrete-time-hazard-model.html#cb1375-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(par <span class="sc">!=</span> <span class="st">&quot;pt&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1375-3"><a href="extending-the-discrete-time-hazard-model.html#cb1375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Estimate =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(link, <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb1375-4"><a href="extending-the-discrete-time-hazard-model.html#cb1375-4" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> Estimate)),</span>
<span id="cb1375-5"><a href="extending-the-discrete-time-hazard-model.html#cb1375-5" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">exp</span>(Estimate)))) <span class="sc">%&gt;%</span></span>
<span id="cb1375-6"><a href="extending-the-discrete-time-hazard-model.html#cb1375-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(par, link, Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1375-7"><a href="extending-the-discrete-time-hazard-model.html#cb1375-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> link,</span>
<span id="cb1375-8"><a href="extending-the-discrete-time-hazard-model.html#cb1375-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1375-9"><a href="extending-the-discrete-time-hazard-model.html#cb1375-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(par, <span class="st">`</span><span class="at">clog-log</span><span class="st">`</span>, logit) <span class="sc">%&gt;%</span> </span>
<span id="cb1375-10"><a href="extending-the-discrete-time-hazard-model.html#cb1375-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">clog-log - logit</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">clog-log</span><span class="st">`</span> <span class="sc">-</span> logit) <span class="sc">%&gt;%</span> </span>
<span id="cb1375-11"><a href="extending-the-discrete-time-hazard-model.html#cb1375-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   par   `clog-log`  logit `clog-log - logit`
##   &lt;fct&gt;      &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;
## 1 d7        0.0493 0.0467             0.0026
## 2 d8        0.0248 0.0234             0.0014
## 3 d9        0.0938 0.0916             0.0023
## 4 d10       0.139  0.138              0.0009
## 5 d11       0.157  0.160             -0.0035
## 6 d12       0.228  0.234             -0.0061</code></pre>
<p>For kicks, we threw in a column of their differences. The <code>clog-log - logit</code> column highlights how</p>
<blockquote>
<p>in general, fitted hazard functions from models estimated with both link functions will be indistinguishable unless hazard is high, once again suggesting that the quality of the estimates does not provide a rationale for selecting one of these link functions over the other. (p. 424)</p>
</blockquote>
<p>Now focus on the <code>pt</code> parameter for both models.</p>
<blockquote>
<p>In both cases, we antilog [i.e., exponentiate] parameter estimates, but whereas an antilogged [i.e., exponentiated] coefficient from a model with a logit link is an odds ratio, an antilogged coefficient from a model with a clog-log link is a hazard ratio. (p. 424)</p>
</blockquote>
<p>Here’s that in a plot.</p>
<div class="sourceCode" id="cb1377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1377-1"><a href="extending-the-discrete-time-hazard-model.html#cb1377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit11<span class="fl">.8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1377-2"><a href="extending-the-discrete-time-hazard-model.html#cb1377-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_pt <span class="sc">%&gt;%</span> <span class="fu">exp</span>(), <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1377-3"><a href="extending-the-discrete-time-hazard-model.html#cb1377-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>), <span class="at">na.rm =</span> T) <span class="sc">+</span></span>
<span id="cb1377-4"><a href="extending-the-discrete-time-hazard-model.html#cb1377-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;b_pt (exponentiated)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1377-5"><a href="extending-the-discrete-time-hazard-model.html#cb1377-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1377-6"><a href="extending-the-discrete-time-hazard-model.html#cb1377-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;fit11.8 (logit link)&quot;</span>,</span>
<span id="cb1377-7"><a href="extending-the-discrete-time-hazard-model.html#cb1377-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Exponentiating this parameter yields an odds ratio.&quot;</span>) <span class="sc">+</span></span>
<span id="cb1377-8"><a href="extending-the-discrete-time-hazard-model.html#cb1377-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb1377-9"><a href="extending-the-discrete-time-hazard-model.html#cb1377-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-42-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1378-1"><a href="extending-the-discrete-time-hazard-model.html#cb1378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb1378-2"><a href="extending-the-discrete-time-hazard-model.html#cb1378-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1378-3"><a href="extending-the-discrete-time-hazard-model.html#cb1378-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit11<span class="fl">.8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1378-4"><a href="extending-the-discrete-time-hazard-model.html#cb1378-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_pt <span class="sc">%&gt;%</span> <span class="fu">exp</span>(), <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1378-5"><a href="extending-the-discrete-time-hazard-model.html#cb1378-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>), <span class="at">na.rm =</span> T) <span class="sc">+</span></span>
<span id="cb1378-6"><a href="extending-the-discrete-time-hazard-model.html#cb1378-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;b_pt (exponentiated)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1378-7"><a href="extending-the-discrete-time-hazard-model.html#cb1378-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1378-8"><a href="extending-the-discrete-time-hazard-model.html#cb1378-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;fit11.8 (logit link)&quot;</span>,</span>
<span id="cb1378-9"><a href="extending-the-discrete-time-hazard-model.html#cb1378-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Exponentiating this parameter yields an odds ratio.&quot;</span>) <span class="sc">+</span></span>
<span id="cb1378-10"><a href="extending-the-discrete-time-hazard-model.html#cb1378-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb1378-11"><a href="extending-the-discrete-time-hazard-model.html#cb1378-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1378-12"><a href="extending-the-discrete-time-hazard-model.html#cb1378-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1378-13"><a href="extending-the-discrete-time-hazard-model.html#cb1378-13" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb1378-14"><a href="extending-the-discrete-time-hazard-model.html#cb1378-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1378-15"><a href="extending-the-discrete-time-hazard-model.html#cb1378-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit12<span class="fl">.15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1378-16"><a href="extending-the-discrete-time-hazard-model.html#cb1378-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_pt <span class="sc">%&gt;%</span> <span class="fu">exp</span>(), <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1378-17"><a href="extending-the-discrete-time-hazard-model.html#cb1378-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb1378-18"><a href="extending-the-discrete-time-hazard-model.html#cb1378-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;b_pt (exponentiated)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb1378-19"><a href="extending-the-discrete-time-hazard-model.html#cb1378-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1378-20"><a href="extending-the-discrete-time-hazard-model.html#cb1378-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;fit12.15 (clog-log link)&quot;</span>,</span>
<span id="cb1378-21"><a href="extending-the-discrete-time-hazard-model.html#cb1378-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Exponentiating this parameter yields a hazard ratio.&quot;</span>) <span class="sc">+</span></span>
<span id="cb1378-22"><a href="extending-the-discrete-time-hazard-model.html#cb1378-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1378-23"><a href="extending-the-discrete-time-hazard-model.html#cb1378-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1378-24"><a href="extending-the-discrete-time-hazard-model.html#cb1378-24" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb1378-25"><a href="extending-the-discrete-time-hazard-model.html#cb1378-25" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-43-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>For the clog-log model, then,</p>
<blockquote>
<p>in every grade from 7<sup>th</sup> to 12<sup>th</sup>, we estimate the hazard of first intercourse for boys who experienced a parenting transition to be [about] 2.2 times the hazard for their peers raised with both biological parents. This interpretation contrasts with that from the model with a logit link, which suggests that the odds of first intercourse are [about] 2.4 times the <em>odds</em> for boys who experienced a parenting transition. (pp. 424–425, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="choosing-between-logit-and-clog-log-links-for-discrete-time-hazard-models." class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> Choosing between logit and clog-log links for discrete-time hazard models.<a href="extending-the-discrete-time-hazard-model.html#choosing-between-logit-and-clog-log-links-for-discrete-time-hazard-models." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The primary advantage of the clog-log link is that in invoking a proportional hazards assumption it yields a direct analog to the continuous time hazard model…. If you believe that the underlying metric for time is truly continuous and that the only reason you observe discretized values is due to measurement difficulties, a model specified with a clog-log link has much to recommend it….</p>
<p>[Yet,] if data are collected in truly discrete time, the clog-log specification has no particular advantage. As <span class="citation">N. Beck (<a href="#ref-beckModellingSpaceTime1999" role="doc-biblioref">1999</a>)</span>; Beck, Katz, and Tucker <span class="citation">(<a href="#ref-beck1998taking" role="doc-biblioref">1998</a>)</span>; and <span class="citation">Sueyoshi (<a href="#ref-sueyoshi1995class" role="doc-biblioref">1995</a>)</span> argue, the proportional hazards assumption is no more sacred than the proportional odds assumption, and while consistency across models is noble, so, too, is simplicity (which decreases the chances of mistake). (p. 426)</p>
</blockquote>
</div>
</div>
<div id="time-varying-predictors-1" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Time-varying predictors<a href="extending-the-discrete-time-hazard-model.html#time-varying-predictors-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Discrete-time survival analysis adopts naturally to the inclusion of time-varying predictors. Because models are fit using a person-period data set, a time-varying predictor simply takes on its appropriate value for each person in each period” (p. 427).</p>
<div id="assumptions-underlying-a-model-with-time-varying-predictors." class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Assumptions underlying a model with time-varying predictors.<a href="extending-the-discrete-time-hazard-model.html#assumptions-underlying-a-model-with-time-varying-predictors." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the depression data from Wheaton, Rozell, and Hall <span class="citation">(<a href="#ref-wheaton1997impact" role="doc-biblioref">1997</a>)</span>.</p>
<div class="sourceCode" id="cb1379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1379-1"><a href="extending-the-discrete-time-hazard-model.html#cb1379-1" aria-hidden="true" tabindex="-1"></a>depression_pp <span class="ot">&lt;-</span> </span>
<span id="cb1379-2"><a href="extending-the-discrete-time-hazard-model.html#cb1379-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&quot;data/depression_pp.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1379-3"><a href="extending-the-discrete-time-hazard-model.html#cb1379-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert the column names to lower case</span></span>
<span id="cb1379-4"><a href="extending-the-discrete-time-hazard-model.html#cb1379-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(tolower)</span>
<span id="cb1379-5"><a href="extending-the-discrete-time-hazard-model.html#cb1379-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1379-6"><a href="extending-the-discrete-time-hazard-model.html#cb1379-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(depression_pp)</span></code></pre></div>
<pre><code>## Rows: 36,997
## Columns: 22
## $ id        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ onset     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ age       &lt;dbl&gt; 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34…
## $ censor    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ censage   &lt;dbl&gt; 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34…
## $ aged      &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ female    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ nsibs     &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, …
## $ sibs12    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ sibs34    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ sibs56    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ sibs78    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ sibs9plus &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ bigfamily &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ period    &lt;dbl&gt; 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, …
## $ event     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ pd        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ pdnow     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ one       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ age_18    &lt;dbl&gt; -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,…
## $ age_18sq  &lt;dbl&gt; 196, 169, 144, 121, 100, 81, 64, 49, 36, 25, 16, 9, 4, 1, 0, 1, 4, 9, 16, 25, 36, 49, 64, …
## $ age_18cub &lt;dbl&gt; -2744, -2197, -1728, -1331, -1000, -729, -512, -343, -216, -125, -64, -27, -8, -1, 0, 1, 8…</code></pre>
<p>Here is the participant <code>age</code> range.</p>
<div class="sourceCode" id="cb1381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1381-1"><a href="extending-the-discrete-time-hazard-model.html#cb1381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(depression_pp<span class="sc">$</span>age)</span></code></pre></div>
<pre><code>## [1] 17 57</code></pre>
<p>We might count how many participants experienced a parental divorce, <code>pd</code>, like this.</p>
<div class="sourceCode" id="cb1383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1383-1"><a href="extending-the-discrete-time-hazard-model.html#cb1383-1" aria-hidden="true" tabindex="-1"></a>depression_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1383-2"><a href="extending-the-discrete-time-hazard-model.html#cb1383-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1383-3"><a href="extending-the-discrete-time-hazard-model.html#cb1383-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pd =</span> <span class="fu">if_else</span>(<span class="fu">sum</span>(pd) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1383-4"><a href="extending-the-discrete-time-hazard-model.html#cb1383-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1383-5"><a href="extending-the-discrete-time-hazard-model.html#cb1383-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pd) <span class="sc">%&gt;%</span> </span>
<span id="cb1383-6"><a href="extending-the-discrete-time-hazard-model.html#cb1383-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##      pd     n percent
##   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1     0  1248    89.6
## 2     1   145    10.4</code></pre>
<p>Here we fit the discrete hazard model based on a quadratic treatment of <span class="math inline">\(\text{age} - 18\)</span> with and the time-varying predictor <code>pd</code> and without/with the time-invariant predictor <code>female</code>.</p>
<p>1:52</p>
<div class="sourceCode" id="cb1385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1385-1"><a href="extending-the-discrete-time-hazard-model.html#cb1385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.092947 hours</span></span>
<span id="cb1385-2"><a href="extending-the-discrete-time-hazard-model.html#cb1385-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.16</span> <span class="ot">&lt;-</span></span>
<span id="cb1385-3"><a href="extending-the-discrete-time-hazard-model.html#cb1385-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> depression_pp,</span>
<span id="cb1385-4"><a href="extending-the-discrete-time-hazard-model.html#cb1385-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1385-5"><a href="extending-the-discrete-time-hazard-model.html#cb1385-5" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> age_18 <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> pd,</span>
<span id="cb1385-6"><a href="extending-the-discrete-time-hazard-model.html#cb1385-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1385-7"><a href="extending-the-discrete-time-hazard-model.html#cb1385-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1385-8"><a href="extending-the-discrete-time-hazard-model.html#cb1385-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1385-9"><a href="extending-the-discrete-time-hazard-model.html#cb1385-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.16&quot;</span>)</span>
<span id="cb1385-10"><a href="extending-the-discrete-time-hazard-model.html#cb1385-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1385-11"><a href="extending-the-discrete-time-hazard-model.html#cb1385-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.055131 hours</span></span>
<span id="cb1385-12"><a href="extending-the-discrete-time-hazard-model.html#cb1385-12" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.17</span> <span class="ot">&lt;-</span></span>
<span id="cb1385-13"><a href="extending-the-discrete-time-hazard-model.html#cb1385-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> depression_pp,</span>
<span id="cb1385-14"><a href="extending-the-discrete-time-hazard-model.html#cb1385-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1385-15"><a href="extending-the-discrete-time-hazard-model.html#cb1385-15" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> age_18 <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> pd <span class="sc">+</span> female,</span>
<span id="cb1385-16"><a href="extending-the-discrete-time-hazard-model.html#cb1385-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1385-17"><a href="extending-the-discrete-time-hazard-model.html#cb1385-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1385-18"><a href="extending-the-discrete-time-hazard-model.html#cb1385-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1385-19"><a href="extending-the-discrete-time-hazard-model.html#cb1385-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.17&quot;</span>)</span></code></pre></div>
<p>Check the summaries.</p>
<div class="sourceCode" id="cb1386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1386-1"><a href="extending-the-discrete-time-hazard-model.html#cb1386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.16</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + Intercept + age_18 + I(age_18^2) + I(age_18^3) + pd 
##    Data: depression_pp (Number of observations: 36997) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -4.25      0.08    -4.40    -4.10 1.00     1743     1884
## age_18        0.06      0.01     0.04     0.08 1.00     1874     2082
## Iage_18E2    -0.01      0.00    -0.01    -0.01 1.00     2637     2715
## Iage_18E3     0.00      0.00     0.00     0.00 1.00     2290     2451
## pd            0.42      0.16     0.09     0.73 1.00     2333     1984
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1388-1"><a href="extending-the-discrete-time-hazard-model.html#cb1388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.17</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + Intercept + age_18 + I(age_18^2) + I(age_18^3) + pd + female 
##    Data: depression_pp (Number of observations: 36997) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -4.59      0.11    -4.81    -4.38 1.00     1550     1673
## age_18        0.06      0.01     0.04     0.08 1.00     2095     2161
## Iage_18E2    -0.01      0.00    -0.01    -0.01 1.00     3563     3281
## Iage_18E3     0.00      0.00     0.00     0.00 1.00     2955     2815
## pd            0.41      0.16     0.08     0.71 1.00     2113     1779
## female        0.55      0.11     0.33     0.77 1.00     1759     1859
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Before we make our version of Figure 12.4, we’ll need to make an aggregated version of the data, which will allow us to replicate the dots and plus signs. We’ll use the same basic wrangling steps from when we made <code>sex_aggregated</code> from back in Chapter 11.</p>
<div class="sourceCode" id="cb1390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1390-1"><a href="extending-the-discrete-time-hazard-model.html#cb1390-1" aria-hidden="true" tabindex="-1"></a>depression_aggregated <span class="ot">&lt;-</span></span>
<span id="cb1390-2"><a href="extending-the-discrete-time-hazard-model.html#cb1390-2" aria-hidden="true" tabindex="-1"></a>  depression_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1390-3"><a href="extending-the-discrete-time-hazard-model.html#cb1390-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">if_else</span>(event <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;event&quot;</span>, <span class="st">&quot;no_event&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-4"><a href="extending-the-discrete-time-hazard-model.html#cb1390-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_18) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-5"><a href="extending-the-discrete-time-hazard-model.html#cb1390-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(event, pd) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-6"><a href="extending-the-discrete-time-hazard-model.html#cb1390-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1390-7"><a href="extending-the-discrete-time-hazard-model.html#cb1390-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(age_18, event, pd) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-8"><a href="extending-the-discrete-time-hazard-model.html#cb1390-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> event,</span>
<span id="cb1390-9"><a href="extending-the-discrete-time-hazard-model.html#cb1390-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-10"><a href="extending-the-discrete-time-hazard-model.html#cb1390-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pd    =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, pd), <span class="at">levels =</span> <span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>)),</span>
<span id="cb1390-11"><a href="extending-the-discrete-time-hazard-model.html#cb1390-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">age   =</span> age_18 <span class="sc">+</span> <span class="dv">18</span>,</span>
<span id="cb1390-12"><a href="extending-the-discrete-time-hazard-model.html#cb1390-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">total =</span> event <span class="sc">+</span> no_event) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-13"><a href="extending-the-discrete-time-hazard-model.html#cb1390-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> event <span class="sc">/</span> total) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-14"><a href="extending-the-discrete-time-hazard-model.html#cb1390-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logit =</span> <span class="fu">log</span>(proportion <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> proportion)))</span>
<span id="cb1390-15"><a href="extending-the-discrete-time-hazard-model.html#cb1390-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1390-16"><a href="extending-the-discrete-time-hazard-model.html#cb1390-16" aria-hidden="true" tabindex="-1"></a>depression_aggregated</span></code></pre></div>
<pre><code>## # A tibble: 72 × 8
##    age_18 pd     event no_event   age total proportion logit
##     &lt;dbl&gt; &lt;fct&gt;  &lt;int&gt;    &lt;int&gt; &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt; &lt;dbl&gt;
##  1    -14 pd = 0     1     1353     4  1354   0.000739 -7.21
##  2    -14 pd = 1    NA       39     4    NA  NA        NA   
##  3    -13 pd = 0    NA     1344     5    NA  NA        NA   
##  4    -13 pd = 1    NA       48     5    NA  NA        NA   
##  5    -12 pd = 0     4     1333     6  1337   0.00299  -5.81
##  6    -12 pd = 1     1       54     6    55   0.0182   -3.99
##  7    -11 pd = 0     5     1322     7  1327   0.00377  -5.58
##  8    -11 pd = 1    NA       60     7    NA  NA        NA   
##  9    -10 pd = 0     2     1313     8  1315   0.00152  -6.49
## 10    -10 pd = 1     1       66     8    67   0.0149   -4.19
## # ℹ 62 more rows</code></pre>
<p>Now make Figure 12.4.</p>
<div class="sourceCode" id="cb1392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1392-1"><a href="extending-the-discrete-time-hazard-model.html#cb1392-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb1392-2"><a href="extending-the-discrete-time-hazard-model.html#cb1392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">age_18 =</span> <span class="sc">-</span><span class="dv">14</span><span class="sc">:</span><span class="dv">21</span>,</span>
<span id="cb1392-3"><a href="extending-the-discrete-time-hazard-model.html#cb1392-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">pd     =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-4"><a href="extending-the-discrete-time-hazard-model.html#cb1392-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> age_18 <span class="sc">+</span> <span class="dv">18</span>)</span>
<span id="cb1392-5"><a href="extending-the-discrete-time-hazard-model.html#cb1392-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1392-6"><a href="extending-the-discrete-time-hazard-model.html#cb1392-6" aria-hidden="true" tabindex="-1"></a><span class="co"># hazard (top panel)</span></span>
<span id="cb1392-7"><a href="extending-the-discrete-time-hazard-model.html#cb1392-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1392-8"><a href="extending-the-discrete-time-hazard-model.html#cb1392-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit12<span class="fl">.16</span>,</span>
<span id="cb1392-9"><a href="extending-the-discrete-time-hazard-model.html#cb1392-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-10"><a href="extending-the-discrete-time-hazard-model.html#cb1392-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1392-11"><a href="extending-the-discrete-time-hazard-model.html#cb1392-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-12"><a href="extending-the-discrete-time-hazard-model.html#cb1392-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pd =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, pd),</span>
<span id="cb1392-13"><a href="extending-the-discrete-time-hazard-model.html#cb1392-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-14"><a href="extending-the-discrete-time-hazard-model.html#cb1392-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1392-15"><a href="extending-the-discrete-time-hazard-model.html#cb1392-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">group =</span> pd, <span class="at">color =</span> pd)) <span class="sc">+</span></span>
<span id="cb1392-16"><a href="extending-the-discrete-time-hazard-model.html#cb1392-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb1392-17"><a href="extending-the-discrete-time-hazard-model.html#cb1392-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> depression_aggregated,</span>
<span id="cb1392-18"><a href="extending-the-discrete-time-hazard-model.html#cb1392-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> proportion, <span class="at">shape =</span> pd),</span>
<span id="cb1392-19"><a href="extending-the-discrete-time-hazard-model.html#cb1392-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1392-20"><a href="extending-the-discrete-time-hazard-model.html#cb1392-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb1392-21"><a href="extending-the-discrete-time-hazard-model.html#cb1392-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;proportion experiencing event&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.06</span>))</span>
<span id="cb1392-22"><a href="extending-the-discrete-time-hazard-model.html#cb1392-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1392-23"><a href="extending-the-discrete-time-hazard-model.html#cb1392-23" aria-hidden="true" tabindex="-1"></a><span class="co"># logit(hazard) (top panel)</span></span>
<span id="cb1392-24"><a href="extending-the-discrete-time-hazard-model.html#cb1392-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1392-25"><a href="extending-the-discrete-time-hazard-model.html#cb1392-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit12<span class="fl">.16</span>,</span>
<span id="cb1392-26"><a href="extending-the-discrete-time-hazard-model.html#cb1392-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb1392-27"><a href="extending-the-discrete-time-hazard-model.html#cb1392-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-28"><a href="extending-the-discrete-time-hazard-model.html#cb1392-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1392-29"><a href="extending-the-discrete-time-hazard-model.html#cb1392-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-30"><a href="extending-the-discrete-time-hazard-model.html#cb1392-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pd =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, pd),</span>
<span id="cb1392-31"><a href="extending-the-discrete-time-hazard-model.html#cb1392-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-32"><a href="extending-the-discrete-time-hazard-model.html#cb1392-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1392-33"><a href="extending-the-discrete-time-hazard-model.html#cb1392-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">group =</span> pd, <span class="at">color =</span> pd)) <span class="sc">+</span></span>
<span id="cb1392-34"><a href="extending-the-discrete-time-hazard-model.html#cb1392-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb1392-35"><a href="extending-the-discrete-time-hazard-model.html#cb1392-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> depression_aggregated,</span>
<span id="cb1392-36"><a href="extending-the-discrete-time-hazard-model.html#cb1392-36" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> logit, <span class="at">shape =</span> pd),</span>
<span id="cb1392-37"><a href="extending-the-discrete-time-hazard-model.html#cb1392-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1392-38"><a href="extending-the-discrete-time-hazard-model.html#cb1392-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb1392-39"><a href="extending-the-discrete-time-hazard-model.html#cb1392-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;logit(proportion experiencing event)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb1392-40"><a href="extending-the-discrete-time-hazard-model.html#cb1392-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1392-41"><a href="extending-the-discrete-time-hazard-model.html#cb1392-41" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb1392-42"><a href="extending-the-discrete-time-hazard-model.html#cb1392-42" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb1392-43"><a href="extending-the-discrete-time-hazard-model.html#cb1392-43" aria-hidden="true" tabindex="-1"></a>  (p1 <span class="sc">/</span> p2) <span class="sc">&amp;</span> </span>
<span id="cb1392-44"><a href="extending-the-discrete-time-hazard-model.html#cb1392-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">16</span>)) <span class="sc">&amp;</span></span>
<span id="cb1392-45"><a href="extending-the-discrete-time-hazard-model.html#cb1392-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">&amp;</span></span>
<span id="cb1392-46"><a href="extending-the-discrete-time-hazard-model.html#cb1392-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1392-47"><a href="extending-the-discrete-time-hazard-model.html#cb1392-47" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb1392-48"><a href="extending-the-discrete-time-hazard-model.html#cb1392-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-49-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="interpreting-and-displaying-time-varying-predictors-effects." class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Interpreting and displaying time-varying predictors’ effects.<a href="extending-the-discrete-time-hazard-model.html#interpreting-and-displaying-time-varying-predictors-effects." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We jumped the gun a little, but to repeat:</p>
<blockquote>
<p>you can fit a discrete-time hazard model with time-varying predictors using exactly the same strategies presented in chapter 11. In the person-period data set, use a logistic regression routine to regress the event indicator on variables representing the main effect of <em>TIME</em> and the desired predictors. (pp. 434–435, <em>emphasis</em> in the original)</p>
</blockquote>
<p>For example, here is the statistical formula we used when we fit <code>fit12.17</code>:</p>
<p><span class="math display">\[
\begin{align*}
\text{event}_{ij}             &amp; = \operatorname{Binomial}(n = 1, p_{ij}) \\
\operatorname{logit} (p_{ij}) &amp; = [\alpha_0 + \alpha_1 (\text{age}_{ij} - 18) + \alpha_2 (\text{age}_{ij} - 18)^2 + \alpha_3 (\text{age}_{ij} - 18)^3] \\
                              &amp; \; \; + [\beta_1 \text{pd}_{ij} + \beta_2 \text{female}_{i}] \\
\alpha_0, ..., \alpha_3       &amp; \sim \operatorname{Normal}(0, 4) \\
\beta_1 \text{ and } \beta_2  &amp; \sim \operatorname{Normal}(0, 4),
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\operatorname{logit} (p_{ij}) = \operatorname{logit} \hat h(t_{ij})\)</span>. If you’d like to compare our results for those displayed by Singer and Willett in Equation 12.8, here are our posterior means.</p>
<div class="sourceCode" id="cb1393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1393-1"><a href="extending-the-discrete-time-hazard-model.html#cb1393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit12<span class="fl">.17</span>)[, <span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Intercept    age_18 Iage_18E2 Iage_18E3        pd    female 
##   -4.5895    0.0602   -0.0075    0.0002    0.4066    0.5453</code></pre>
<p>The values are pretty close. Though we won’t compare <code>fit12.16</code> and <code>fit12.17</code> using deviance values, we will use information criteria.</p>
<div class="sourceCode" id="cb1395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1395-1"><a href="extending-the-discrete-time-hazard-model.html#cb1395-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.16</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.16</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb1395-2"><a href="extending-the-discrete-time-hazard-model.html#cb1395-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.17</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.17</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb1395-3"><a href="extending-the-discrete-time-hazard-model.html#cb1395-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1395-4"><a href="extending-the-discrete-time-hazard-model.html#cb1395-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.16</span>, fit12<span class="fl">.17</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit12.17     0.0       0.0 -2075.6      86.0          6.0     0.4    4151.3   172.0
## fit12.16   -12.0       5.0 -2087.7      86.4          5.0     0.4    4175.4   172.8</code></pre>
<div class="sourceCode" id="cb1397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1397-1"><a href="extending-the-discrete-time-hazard-model.html#cb1397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.16</span>, fit12<span class="fl">.17</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.16 fit12.17 
##        0        1</code></pre>
<p>Based on both the WAIC difference and the WAIC weights, <code>fit12.17</code> is the clear favorite. From that model, Here’s a plot of the anti-logged (i.e., exponentiated) posteriors for <code>pd</code> and <code>female</code>, which yields their odds ratios.</p>
<div class="sourceCode" id="cb1399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1399-1"><a href="extending-the-discrete-time-hazard-model.html#cb1399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.17</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-2"><a href="extending-the-discrete-time-hazard-model.html#cb1399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(b_pd<span class="sc">:</span>b_female) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-3"><a href="extending-the-discrete-time-hazard-model.html#cb1399-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">odds ratio</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-4"><a href="extending-the-discrete-time-hazard-model.html#cb1399-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1399-5"><a href="extending-the-discrete-time-hazard-model.html#cb1399-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">odds ratio</span><span class="st">`</span>, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb1399-6"><a href="extending-the-discrete-time-hazard-model.html#cb1399-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>), <span class="at">normalize =</span> <span class="st">&quot;xy&quot;</span>) <span class="sc">+</span></span>
<span id="cb1399-7"><a href="extending-the-discrete-time-hazard-model.html#cb1399-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1399-8"><a href="extending-the-discrete-time-hazard-model.html#cb1399-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.4</span>, <span class="fl">2.4</span>)) <span class="sc">+</span></span>
<span id="cb1399-9"><a href="extending-the-discrete-time-hazard-model.html#cb1399-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-52-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Here is our version of Figure 12.5.</p>
<div class="sourceCode" id="cb1400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1400-1"><a href="extending-the-discrete-time-hazard-model.html#cb1400-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb1400-2"><a href="extending-the-discrete-time-hazard-model.html#cb1400-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">female =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1400-3"><a href="extending-the-discrete-time-hazard-model.html#cb1400-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">pd     =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-4"><a href="extending-the-discrete-time-hazard-model.html#cb1400-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">age_18 =</span> <span class="sc">-</span><span class="dv">14</span><span class="sc">:</span><span class="dv">21</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-5"><a href="extending-the-discrete-time-hazard-model.html#cb1400-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> age_18 <span class="sc">+</span> <span class="dv">18</span>)</span>
<span id="cb1400-6"><a href="extending-the-discrete-time-hazard-model.html#cb1400-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1400-7"><a href="extending-the-discrete-time-hazard-model.html#cb1400-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1400-8"><a href="extending-the-discrete-time-hazard-model.html#cb1400-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit12<span class="fl">.17</span>,</span>
<span id="cb1400-9"><a href="extending-the-discrete-time-hazard-model.html#cb1400-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-10"><a href="extending-the-discrete-time-hazard-model.html#cb1400-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1400-11"><a href="extending-the-discrete-time-hazard-model.html#cb1400-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-12"><a href="extending-the-discrete-time-hazard-model.html#cb1400-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">if_else</span>(female <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>),</span>
<span id="cb1400-13"><a href="extending-the-discrete-time-hazard-model.html#cb1400-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pd  =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, pd),</span>
<span id="cb1400-14"><a href="extending-the-discrete-time-hazard-model.html#cb1400-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">str_c</span>(<span class="st">&quot;pd = &quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>))) </span>
<span id="cb1400-15"><a href="extending-the-discrete-time-hazard-model.html#cb1400-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1400-16"><a href="extending-the-discrete-time-hazard-model.html#cb1400-16" aria-hidden="true" tabindex="-1"></a><span class="co"># hazard (top panel)</span></span>
<span id="cb1400-17"><a href="extending-the-discrete-time-hazard-model.html#cb1400-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1400-18"><a href="extending-the-discrete-time-hazard-model.html#cb1400-18" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">%&gt;%</span> </span>
<span id="cb1400-19"><a href="extending-the-discrete-time-hazard-model.html#cb1400-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">group =</span> pd, <span class="at">color =</span> pd, <span class="at">fill =</span> pd)) <span class="sc">+</span></span>
<span id="cb1400-20"><a href="extending-the-discrete-time-hazard-model.html#cb1400-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1400-21"><a href="extending-the-discrete-time-hazard-model.html#cb1400-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1400-22"><a href="extending-the-discrete-time-hazard-model.html#cb1400-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb1400-23"><a href="extending-the-discrete-time-hazard-model.html#cb1400-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb1400-24"><a href="extending-the-discrete-time-hazard-model.html#cb1400-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;fitted hazard&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.04</span>))</span>
<span id="cb1400-25"><a href="extending-the-discrete-time-hazard-model.html#cb1400-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1400-26"><a href="extending-the-discrete-time-hazard-model.html#cb1400-26" aria-hidden="true" tabindex="-1"></a><span class="co"># survival (bottom panel)</span></span>
<span id="cb1400-27"><a href="extending-the-discrete-time-hazard-model.html#cb1400-27" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1400-28"><a href="extending-the-discrete-time-hazard-model.html#cb1400-28" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">%&gt;%</span></span>
<span id="cb1400-29"><a href="extending-the-discrete-time-hazard-model.html#cb1400-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, pd) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-30"><a href="extending-the-discrete-time-hazard-model.html#cb1400-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(Estimate, Q2<span class="fl">.5</span>, Q97<span class="fl">.5</span>), <span class="at">.funs =</span> <span class="sc">~</span><span class="fu">cumprod</span>(<span class="dv">1</span> <span class="sc">-</span> .)) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-31"><a href="extending-the-discrete-time-hazard-model.html#cb1400-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1400-32"><a href="extending-the-discrete-time-hazard-model.html#cb1400-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">group =</span> pd, <span class="at">color =</span> pd, <span class="at">fill =</span> pd)) <span class="sc">+</span></span>
<span id="cb1400-33"><a href="extending-the-discrete-time-hazard-model.html#cb1400-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1400-34"><a href="extending-the-discrete-time-hazard-model.html#cb1400-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb1400-35"><a href="extending-the-discrete-time-hazard-model.html#cb1400-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1400-36"><a href="extending-the-discrete-time-hazard-model.html#cb1400-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb1400-37"><a href="extending-the-discrete-time-hazard-model.html#cb1400-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">*</span> <span class="dv">5</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb1400-38"><a href="extending-the-discrete-time-hazard-model.html#cb1400-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;fitted survival probability&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1400-39"><a href="extending-the-discrete-time-hazard-model.html#cb1400-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1400-40"><a href="extending-the-discrete-time-hazard-model.html#cb1400-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1400-41"><a href="extending-the-discrete-time-hazard-model.html#cb1400-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1400-42"><a href="extending-the-discrete-time-hazard-model.html#cb1400-42" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb1400-43"><a href="extending-the-discrete-time-hazard-model.html#cb1400-43" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb1400-44"><a href="extending-the-discrete-time-hazard-model.html#cb1400-44" aria-hidden="true" tabindex="-1"></a>  (p1 <span class="sc">/</span> p2) <span class="sc">&amp;</span> </span>
<span id="cb1400-45"><a href="extending-the-discrete-time-hazard-model.html#cb1400-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">&amp;</span></span>
<span id="cb1400-46"><a href="extending-the-discrete-time-hazard-model.html#cb1400-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">&amp;</span></span>
<span id="cb1400-47"><a href="extending-the-discrete-time-hazard-model.html#cb1400-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">&amp;</span></span>
<span id="cb1400-48"><a href="extending-the-discrete-time-hazard-model.html#cb1400-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sex)</span>
<span id="cb1400-49"><a href="extending-the-discrete-time-hazard-model.html#cb1400-49" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb1400-50"><a href="extending-the-discrete-time-hazard-model.html#cb1400-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-53-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Note how with this many <code>age</code> levels, our discrete-time models are beginning to look like continuous-time models.</p>
</div>
<div id="two-caveats-the-problems-of-state-and-rate-dependence." class="section level3 hasAnchor" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Two caveats: The problems of state and rate dependence.<a href="extending-the-discrete-time-hazard-model.html#two-caveats-the-problems-of-state-and-rate-dependence." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>A time-varying predictor is <em>state-dependent</em> if its values at time <span class="math inline">\(t_j\)</span> are affected by an individual’s <em>state</em> (event occurrence status) at time <span class="math inline">\(t_j\)</span>: <span class="math inline">\(EVENT_{ij}\)</span>. A time-varying predictor is <em>rate-dependent</em> if its values at time <span class="math inline">\(t_j\)</span> are affected by the individuals value of <em>hazard</em> (the “rate”) at time <span class="math inline">\(t_j\)</span>: <span class="math inline">\(h (t_{ij})\)</span>. (p. 440, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
</div>
<div id="the-linear-additivity-assumption-uncovering-violations-and-simple-solutions" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> The linear additivity assumption: Uncovering violations and simple solutions<a href="extending-the-discrete-time-hazard-model.html#the-linear-additivity-assumption-uncovering-violations-and-simple-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Because the focus on hazard causes you to analyze group level summaries, model violations can be more difficult to discern [than in other kinds of regression models]. We therefore devote this section to introducing practical strategies for diagnosing and correcting violations of the linear additivity assumption. (p. 443)</p>
</blockquote>
<div id="interactions-between-substantive-predictors." class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Interactions between substantive predictors.<a href="extending-the-discrete-time-hazard-model.html#interactions-between-substantive-predictors." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We do not advocate fishing expeditions. Open searches for interactions can be counterproductive, leading to the discovery of many “effects” that are little more than sampling variation. But there <em>are</em> at least two circumstances when a guided search for interactions is crucial:</p>
<ul>
<li><em>When theory (or common sense!) suggests that two (or more) predictors will interact in the prediction of the outcome</em>. If you hypothesize the existence of interactions a priori, your search will be targeted and efficient.</li>
<li><em>When examining the effects of “question” predictor(s), variables whose effects you intend to emphasize in your report</em>. You need to be certain that these predictors’ effects do not differ according ot levels of other important predictors, lest you misinterpret your major findings.</li>
</ul>
<p>With this in mind, we now demonstrate how to (1) explore your data for the possibility of statistical interactions; and (2) include the additional appropriate terms when necessary. (p. 444, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Load the data from Keiley and Martin [-<span class="citation">M. K. Keiley &amp; Martin (<a href="#ref-keileyChildAbuseNeglect2002" role="doc-biblioref">2002</a>)</span>]<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<div class="sourceCode" id="cb1401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1401-1"><a href="extending-the-discrete-time-hazard-model.html#cb1401-1" aria-hidden="true" tabindex="-1"></a>firstarrest_pp <span class="ot">&lt;-</span> </span>
<span id="cb1401-2"><a href="extending-the-discrete-time-hazard-model.html#cb1401-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&quot;data/firstarrest_pp.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1401-3"><a href="extending-the-discrete-time-hazard-model.html#cb1401-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert the column names to lower case</span></span>
<span id="cb1401-4"><a href="extending-the-discrete-time-hazard-model.html#cb1401-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(tolower)</span>
<span id="cb1401-5"><a href="extending-the-discrete-time-hazard-model.html#cb1401-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1401-6"><a href="extending-the-discrete-time-hazard-model.html#cb1401-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(firstarrest_pp)</span></code></pre></div>
<pre><code>## Rows: 15,834
## Columns: 19
## $ id     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, …
## $ time   &lt;dbl&gt; 15, 15, 15, 15, 15, 15, 15, 15, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 17, 17, 17, 17, 1…
## $ censor &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, …
## $ abused &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, …
## $ black  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ ablack &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ d8     &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, …
## $ d9     &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, …
## $ d10    &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ d11    &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ d12    &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, …
## $ d13    &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …
## $ d14    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, …
## $ d15    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, …
## $ d16    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, …
## $ d17    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, …
## $ d18    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ period &lt;dbl&gt; 8, 9, 10, 11, 12, 13, 14, 15, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 8, 9, 10, 11, 12, 13,…
## $ event  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, …</code></pre>
<p>The total <span class="math inline">\(N\)</span> is 1553.</p>
<div class="sourceCode" id="cb1403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1403-1"><a href="extending-the-discrete-time-hazard-model.html#cb1403-1" aria-hidden="true" tabindex="-1"></a>firstarrest_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1403-2"><a href="extending-the-discrete-time-hazard-model.html#cb1403-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1403-3"><a href="extending-the-discrete-time-hazard-model.html#cb1403-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1  1553</code></pre>
<p><span class="math inline">\(n = 887\)</span> were abused.</p>
<div class="sourceCode" id="cb1405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1405-1"><a href="extending-the-discrete-time-hazard-model.html#cb1405-1" aria-hidden="true" tabindex="-1"></a>firstarrest_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1405-2"><a href="extending-the-discrete-time-hazard-model.html#cb1405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(abused <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1405-3"><a href="extending-the-discrete-time-hazard-model.html#cb1405-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1405-4"><a href="extending-the-discrete-time-hazard-model.html#cb1405-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1   887</code></pre>
<p><span class="math inline">\(n = 342\)</span> were arrested between the ages of 8 and 18.</p>
<div class="sourceCode" id="cb1407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1407-1"><a href="extending-the-discrete-time-hazard-model.html#cb1407-1" aria-hidden="true" tabindex="-1"></a>firstarrest_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1407-2"><a href="extending-the-discrete-time-hazard-model.html#cb1407-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(censor <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1407-3"><a href="extending-the-discrete-time-hazard-model.html#cb1407-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1407-4"><a href="extending-the-discrete-time-hazard-model.html#cb1407-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1   342</code></pre>
<p>Since the two focal predictors in this section with be <code>black</code> and <code>abused</code>, here are the counts broken down by both.</p>
<div class="sourceCode" id="cb1409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1409-1"><a href="extending-the-discrete-time-hazard-model.html#cb1409-1" aria-hidden="true" tabindex="-1"></a>firstarrest_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1409-2"><a href="extending-the-discrete-time-hazard-model.html#cb1409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1409-3"><a href="extending-the-discrete-time-hazard-model.html#cb1409-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1409-4"><a href="extending-the-discrete-time-hazard-model.html#cb1409-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1409-5"><a href="extending-the-discrete-time-hazard-model.html#cb1409-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(black, abused) <span class="sc">%&gt;%</span> </span>
<span id="cb1409-6"><a href="extending-the-discrete-time-hazard-model.html#cb1409-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
##   black abused     n percent
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1     0      0   434    27.9
## 2     0      1   605    39.0
## 3     1      0   232    14.9
## 4     1      1   282    18.2</code></pre>
<p>Here’s how to hand compute the values for the sample logit(hazard) functions depicted in the top panels of Figure 12.6.</p>
<div class="sourceCode" id="cb1411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1411-1"><a href="extending-the-discrete-time-hazard-model.html#cb1411-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb1411-2"><a href="extending-the-discrete-time-hazard-model.html#cb1411-2" aria-hidden="true" tabindex="-1"></a>firstarrest_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1411-3"><a href="extending-the-discrete-time-hazard-model.html#cb1411-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">if_else</span>(event <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;event&quot;</span>, <span class="st">&quot;no_event&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1411-4"><a href="extending-the-discrete-time-hazard-model.html#cb1411-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(period)  <span class="sc">%&gt;%</span> </span>
<span id="cb1411-5"><a href="extending-the-discrete-time-hazard-model.html#cb1411-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(event, black, abused) <span class="sc">%&gt;%</span> </span>
<span id="cb1411-6"><a href="extending-the-discrete-time-hazard-model.html#cb1411-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1411-7"><a href="extending-the-discrete-time-hazard-model.html#cb1411-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> event,</span>
<span id="cb1411-8"><a href="extending-the-discrete-time-hazard-model.html#cb1411-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb1411-9"><a href="extending-the-discrete-time-hazard-model.html#cb1411-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(event) <span class="sc">%&gt;%</span> </span>
<span id="cb1411-10"><a href="extending-the-discrete-time-hazard-model.html#cb1411-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total  =</span> event <span class="sc">+</span> no_event,</span>
<span id="cb1411-11"><a href="extending-the-discrete-time-hazard-model.html#cb1411-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">logit  =</span> <span class="fu">log</span>(event <span class="sc">/</span> total <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> event <span class="sc">/</span> total)),</span>
<span id="cb1411-12"><a href="extending-the-discrete-time-hazard-model.html#cb1411-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">race   =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(black <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Black&quot;</span>, <span class="st">&quot;White&quot;</span>),</span>
<span id="cb1411-13"><a href="extending-the-discrete-time-hazard-model.html#cb1411-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>)),</span>
<span id="cb1411-14"><a href="extending-the-discrete-time-hazard-model.html#cb1411-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">abused =</span> <span class="fu">ifelse</span>(abused <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;abused&quot;</span>, <span class="st">&quot;not abused&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1411-15"><a href="extending-the-discrete-time-hazard-model.html#cb1411-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1411-16"><a href="extending-the-discrete-time-hazard-model.html#cb1411-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1411-17"><a href="extending-the-discrete-time-hazard-model.html#cb1411-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> logit)) <span class="sc">+</span></span>
<span id="cb1411-18"><a href="extending-the-discrete-time-hazard-model.html#cb1411-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> abused, <span class="at">group =</span> abused)) <span class="sc">+</span></span>
<span id="cb1411-19"><a href="extending-the-discrete-time-hazard-model.html#cb1411-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1411-20"><a href="extending-the-discrete-time-hazard-model.html#cb1411-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;age&quot;</span>, <span class="at">breaks =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">19</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb1411-21"><a href="extending-the-discrete-time-hazard-model.html#cb1411-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;sample logit(hazard)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1411-22"><a href="extending-the-discrete-time-hazard-model.html#cb1411-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1411-23"><a href="extending-the-discrete-time-hazard-model.html#cb1411-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> race)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-59-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>For kicks and giggles, it might informative to fit a series of subset Bayesian models to make similar versions of those sample hazard functions. Before we fit the models, let’s make our lives easier and make a factor version of our time variable, <code>period</code>.</p>
<div class="sourceCode" id="cb1412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1412-1"><a href="extending-the-discrete-time-hazard-model.html#cb1412-1" aria-hidden="true" tabindex="-1"></a>firstarrest_pp <span class="ot">&lt;-</span></span>
<span id="cb1412-2"><a href="extending-the-discrete-time-hazard-model.html#cb1412-2" aria-hidden="true" tabindex="-1"></a>  firstarrest_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1412-3"><a href="extending-the-discrete-time-hazard-model.html#cb1412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period_f =</span> <span class="fu">factor</span>(period))</span></code></pre></div>
<p>Fit the four subset models.</p>
<div class="sourceCode" id="cb1413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1413-1"><a href="extending-the-discrete-time-hazard-model.html#cb1413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># white, not abused</span></span>
<span id="cb1413-2"><a href="extending-the-discrete-time-hazard-model.html#cb1413-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.18</span> <span class="ot">&lt;-</span></span>
<span id="cb1413-3"><a href="extending-the-discrete-time-hazard-model.html#cb1413-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> firstarrest_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(black <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> abused <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1413-4"><a href="extending-the-discrete-time-hazard-model.html#cb1413-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1413-5"><a href="extending-the-discrete-time-hazard-model.html#cb1413-5" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> period_f,</span>
<span id="cb1413-6"><a href="extending-the-discrete-time-hazard-model.html#cb1413-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1413-7"><a href="extending-the-discrete-time-hazard-model.html#cb1413-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1413-8"><a href="extending-the-discrete-time-hazard-model.html#cb1413-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1413-9"><a href="extending-the-discrete-time-hazard-model.html#cb1413-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.18&quot;</span>)</span>
<span id="cb1413-10"><a href="extending-the-discrete-time-hazard-model.html#cb1413-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1413-11"><a href="extending-the-discrete-time-hazard-model.html#cb1413-11" aria-hidden="true" tabindex="-1"></a><span class="co"># white, abused</span></span>
<span id="cb1413-12"><a href="extending-the-discrete-time-hazard-model.html#cb1413-12" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.19</span> <span class="ot">&lt;-</span></span>
<span id="cb1413-13"><a href="extending-the-discrete-time-hazard-model.html#cb1413-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit12<span class="fl">.18</span>,</span>
<span id="cb1413-14"><a href="extending-the-discrete-time-hazard-model.html#cb1413-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> firstarrest_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(black <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> abused <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb1413-15"><a href="extending-the-discrete-time-hazard-model.html#cb1413-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1413-16"><a href="extending-the-discrete-time-hazard-model.html#cb1413-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1413-17"><a href="extending-the-discrete-time-hazard-model.html#cb1413-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit12.19&quot;</span>)</span>
<span id="cb1413-18"><a href="extending-the-discrete-time-hazard-model.html#cb1413-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1413-19"><a href="extending-the-discrete-time-hazard-model.html#cb1413-19" aria-hidden="true" tabindex="-1"></a><span class="co"># black, not abused</span></span>
<span id="cb1413-20"><a href="extending-the-discrete-time-hazard-model.html#cb1413-20" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.20</span> <span class="ot">&lt;-</span></span>
<span id="cb1413-21"><a href="extending-the-discrete-time-hazard-model.html#cb1413-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit12<span class="fl">.18</span>,</span>
<span id="cb1413-22"><a href="extending-the-discrete-time-hazard-model.html#cb1413-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> firstarrest_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(black <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> abused <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1413-23"><a href="extending-the-discrete-time-hazard-model.html#cb1413-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1413-24"><a href="extending-the-discrete-time-hazard-model.html#cb1413-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1413-25"><a href="extending-the-discrete-time-hazard-model.html#cb1413-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit12.20&quot;</span>)</span>
<span id="cb1413-26"><a href="extending-the-discrete-time-hazard-model.html#cb1413-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1413-27"><a href="extending-the-discrete-time-hazard-model.html#cb1413-27" aria-hidden="true" tabindex="-1"></a><span class="co"># black, abused</span></span>
<span id="cb1413-28"><a href="extending-the-discrete-time-hazard-model.html#cb1413-28" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.21</span> <span class="ot">&lt;-</span></span>
<span id="cb1413-29"><a href="extending-the-discrete-time-hazard-model.html#cb1413-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit12<span class="fl">.18</span>,</span>
<span id="cb1413-30"><a href="extending-the-discrete-time-hazard-model.html#cb1413-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> firstarrest_pp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(black <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> abused <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb1413-31"><a href="extending-the-discrete-time-hazard-model.html#cb1413-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1413-32"><a href="extending-the-discrete-time-hazard-model.html#cb1413-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1413-33"><a href="extending-the-discrete-time-hazard-model.html#cb1413-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit12.21&quot;</span>)</span></code></pre></div>
<p>We might use <code>fitted()</code> via our custom <code>make_fitted()</code> function to perform some of the pre-plotting computation and wrangling.</p>
<div class="sourceCode" id="cb1414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1414-1"><a href="extending-the-discrete-time-hazard-model.html#cb1414-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">period_f =</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">18</span>)</span>
<span id="cb1414-2"><a href="extending-the-discrete-time-hazard-model.html#cb1414-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1414-3"><a href="extending-the-discrete-time-hazard-model.html#cb1414-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this will simplify the `mutate()` code below</span></span>
<span id="cb1414-4"><a href="extending-the-discrete-time-hazard-model.html#cb1414-4" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;constant&quot;</span>, <span class="st">&quot;linear&quot;</span>, <span class="st">&quot;quadratic&quot;</span>, <span class="st">&quot;cubic&quot;</span>, <span class="st">&quot;general&quot;</span>)</span>
<span id="cb1414-5"><a href="extending-the-discrete-time-hazard-model.html#cb1414-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1414-6"><a href="extending-the-discrete-time-hazard-model.html#cb1414-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1414-7"><a href="extending-the-discrete-time-hazard-model.html#cb1414-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">make_fitted</span>(fit12<span class="fl">.18</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),      <span class="co"># white, not abused</span></span>
<span id="cb1414-8"><a href="extending-the-discrete-time-hazard-model.html#cb1414-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.19</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),      <span class="co"># white, abused</span></span>
<span id="cb1414-9"><a href="extending-the-discrete-time-hazard-model.html#cb1414-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.20</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>),      <span class="co"># black, not abused</span></span>
<span id="cb1414-10"><a href="extending-the-discrete-time-hazard-model.html#cb1414-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">make_fitted</span>(fit12<span class="fl">.21</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># black, abused</span></span>
<span id="cb1414-11"><a href="extending-the-discrete-time-hazard-model.html#cb1414-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race  =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb1414-12"><a href="extending-the-discrete-time-hazard-model.html#cb1414-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>)),</span>
<span id="cb1414-13"><a href="extending-the-discrete-time-hazard-model.html#cb1414-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">abuse =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;not abused&quot;</span>, <span class="st">&quot;abused&quot;</span>, <span class="st">&quot;not abused&quot;</span>, <span class="st">&quot;abused&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">4</span>))</span>
<span id="cb1414-14"><a href="extending-the-discrete-time-hazard-model.html#cb1414-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1414-15"><a href="extending-the-discrete-time-hazard-model.html#cb1414-15" aria-hidden="true" tabindex="-1"></a><span class="co"># what have we done?</span></span>
<span id="cb1414-16"><a href="extending-the-discrete-time-hazard-model.html#cb1414-16" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(f)</span></code></pre></div>
<pre><code>## Rows: 44
## Columns: 7
## $ Estimate  &lt;dbl&gt; -6.113737, -7.767396, -5.421275, -4.486981, -7.744434, -4.128871, -3.851241, -3.039893, -3…
## $ Est.Error &lt;dbl&gt; 0.9614576, 1.7504718, 0.6720442, 0.4486308, 1.7498479, 0.3776723, 0.3404120, 0.2335922, 0.…
## $ Q2.5      &lt;dbl&gt; -8.345358, -11.981231, -6.962572, -5.458206, -12.100321, -4.942711, -4.558721, -3.510652, …
## $ Q97.5     &lt;dbl&gt; -4.579547, -5.171702, -4.295233, -3.687680, -5.140699, -3.451226, -3.252522, -2.600993, -3…
## $ period_f  &lt;int&gt; 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 8, 9, …
## $ race      &lt;fct&gt; White, White, White, White, White, White, White, White, White, White, White, White, White,…
## $ abuse     &lt;chr&gt; &quot;not abused&quot;, &quot;not abused&quot;, &quot;not abused&quot;, &quot;not abused&quot;, &quot;not abused&quot;, &quot;not abused&quot;, &quot;not a…</code></pre>
<p>Now plot.</p>
<div class="sourceCode" id="cb1416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1416-1"><a href="extending-the-discrete-time-hazard-model.html#cb1416-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb1416-2"><a href="extending-the-discrete-time-hazard-model.html#cb1416-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period_f, <span class="at">y =</span> Estimate, <span class="at">group =</span> abuse, <span class="at">color =</span> abuse)) <span class="sc">+</span></span>
<span id="cb1416-3"><a href="extending-the-discrete-time-hazard-model.html#cb1416-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1416-4"><a href="extending-the-discrete-time-hazard-model.html#cb1416-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1416-5"><a href="extending-the-discrete-time-hazard-model.html#cb1416-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;age&quot;</span>, <span class="at">breaks =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">19</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb1416-6"><a href="extending-the-discrete-time-hazard-model.html#cb1416-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;sample logit(hazard)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1416-7"><a href="extending-the-discrete-time-hazard-model.html#cb1416-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1416-8"><a href="extending-the-discrete-time-hazard-model.html#cb1416-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> race)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-62-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice how this looks different from the version of the plot, above, in that there are five points with very low values on the <span class="math inline">\(y\)</span>-axis. Did you notice the <code>drop_na(event)</code> line in the code when we computed the sample logit(hazard) values by hand? Those points with missing values in the data are what caused those very low log(hazard) estimates in the models. Next we’ll fit the primary statistical models with both <code>black</code> and <code>abused</code>, without and with their interaction term, based on the full data set. You’ll see that when we use all cases, those odd low logit(hazard) values go away.</p>
<div class="sourceCode" id="cb1417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1417-1"><a href="extending-the-discrete-time-hazard-model.html#cb1417-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.22</span> <span class="ot">&lt;-</span></span>
<span id="cb1417-2"><a href="extending-the-discrete-time-hazard-model.html#cb1417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> firstarrest_pp,</span>
<span id="cb1417-3"><a href="extending-the-discrete-time-hazard-model.html#cb1417-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1417-4"><a href="extending-the-discrete-time-hazard-model.html#cb1417-4" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10  <span class="sc">+</span> d11  <span class="sc">+</span> d12  <span class="sc">+</span> d13  <span class="sc">+</span> d14  <span class="sc">+</span> d15  <span class="sc">+</span> d16  <span class="sc">+</span> d17  <span class="sc">+</span> d18 <span class="sc">+</span> abused <span class="sc">+</span> black,</span>
<span id="cb1417-5"><a href="extending-the-discrete-time-hazard-model.html#cb1417-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1417-6"><a href="extending-the-discrete-time-hazard-model.html#cb1417-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1417-7"><a href="extending-the-discrete-time-hazard-model.html#cb1417-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1417-8"><a href="extending-the-discrete-time-hazard-model.html#cb1417-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.22&quot;</span>)</span>
<span id="cb1417-9"><a href="extending-the-discrete-time-hazard-model.html#cb1417-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1417-10"><a href="extending-the-discrete-time-hazard-model.html#cb1417-10" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.23</span> <span class="ot">&lt;-</span></span>
<span id="cb1417-11"><a href="extending-the-discrete-time-hazard-model.html#cb1417-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit12<span class="fl">.22</span>,</span>
<span id="cb1417-12"><a href="extending-the-discrete-time-hazard-model.html#cb1417-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> firstarrest_pp,</span>
<span id="cb1417-13"><a href="extending-the-discrete-time-hazard-model.html#cb1417-13" aria-hidden="true" tabindex="-1"></a>         event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10  <span class="sc">+</span> d11  <span class="sc">+</span> d12  <span class="sc">+</span> d13  <span class="sc">+</span> d14  <span class="sc">+</span> d15  <span class="sc">+</span> d16  <span class="sc">+</span> d17  <span class="sc">+</span> d18 <span class="sc">+</span> abused <span class="sc">+</span> black <span class="sc">+</span> abused<span class="sc">:</span>black,</span>
<span id="cb1417-14"><a href="extending-the-discrete-time-hazard-model.html#cb1417-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1417-15"><a href="extending-the-discrete-time-hazard-model.html#cb1417-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1417-16"><a href="extending-the-discrete-time-hazard-model.html#cb1417-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit12.23&quot;</span>)</span></code></pre></div>
<p>Let’s compare the models with information criteria.</p>
<div class="sourceCode" id="cb1418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1418-1"><a href="extending-the-discrete-time-hazard-model.html#cb1418-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.22</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.22</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb1418-2"><a href="extending-the-discrete-time-hazard-model.html#cb1418-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.23</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.23</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb1418-3"><a href="extending-the-discrete-time-hazard-model.html#cb1418-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1418-4"><a href="extending-the-discrete-time-hazard-model.html#cb1418-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.22</span>, fit12<span class="fl">.23</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit12.23     0.0       0.0 -1538.7      65.3         13.9     1.0    3077.5   130.6
## fit12.22    -1.0       2.2 -1539.7      65.3         12.9     1.0    3079.5   130.6</code></pre>
<div class="sourceCode" id="cb1420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1420-1"><a href="extending-the-discrete-time-hazard-model.html#cb1420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.22</span>, fit12<span class="fl">.23</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.22 fit12.23 
##    0.268    0.732</code></pre>
<p>Our results diverge a bit from those in the text. For the deviance test on page 446, Singer and Willett reported a difference of <span class="math inline">\(4.05 \; (p &lt; .05, \textit{df} = 1)\)</span> in favor of the full model (i.e., <code>fit12.23</code>). Though both our WAIC difference score and the WAIC weights favor <code>fit12.23</code>, it’s by a hair.</p>
<p>“As in linear (or logistic) regression, we interpret interaction effects by simultaneously considering <em>all</em> the constituent parameters, for the cross-product term and its main-effect components” (p. 446, <em>emphasis</em> in the original). Rather than the point-estimate table Singer and Willett displayed at the bottom of the page, we’ll present the full posterior distributions odds ratios in a faceted plot.</p>
<div class="sourceCode" id="cb1422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1422-1"><a href="extending-the-discrete-time-hazard-model.html#cb1422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.23</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1422-2"><a href="extending-the-discrete-time-hazard-model.html#cb1422-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">abused =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1422-3"><a href="extending-the-discrete-time-hazard-model.html#cb1422-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">black  =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1422-4"><a href="extending-the-discrete-time-hazard-model.html#cb1422-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">odds ratio</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_abused <span class="sc">*</span> abused <span class="sc">+</span> b_black <span class="sc">*</span> black  <span class="sc">+</span> <span class="st">`</span><span class="at">b_abused:black</span><span class="st">`</span> <span class="sc">*</span> abused <span class="sc">*</span> black),</span>
<span id="cb1422-5"><a href="extending-the-discrete-time-hazard-model.html#cb1422-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">abused       =</span> <span class="fu">str_c</span>(<span class="st">&quot;abused = &quot;</span>, abused),</span>
<span id="cb1422-6"><a href="extending-the-discrete-time-hazard-model.html#cb1422-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">black        =</span> <span class="fu">str_c</span>(<span class="st">&quot;black = &quot;</span>, black)) <span class="sc">%&gt;%</span> </span>
<span id="cb1422-7"><a href="extending-the-discrete-time-hazard-model.html#cb1422-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1422-8"><a href="extending-the-discrete-time-hazard-model.html#cb1422-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">odds ratio</span><span class="st">`</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1422-9"><a href="extending-the-discrete-time-hazard-model.html#cb1422-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1422-10"><a href="extending-the-discrete-time-hazard-model.html#cb1422-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1422-11"><a href="extending-the-discrete-time-hazard-model.html#cb1422-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1422-12"><a href="extending-the-discrete-time-hazard-model.html#cb1422-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(abused <span class="sc">~</span> black)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-64-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here’s our version of the lower panel of Figure 12.6.</p>
<div class="sourceCode" id="cb1423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1423-1"><a href="extending-the-discrete-time-hazard-model.html#cb1423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the `newdata`</span></span>
<span id="cb1423-2"><a href="extending-the-discrete-time-hazard-model.html#cb1423-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb1423-3"><a href="extending-the-discrete-time-hazard-model.html#cb1423-3" aria-hidden="true" tabindex="-1"></a>  firstarrest_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1423-4"><a href="extending-the-discrete-time-hazard-model.html#cb1423-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(abused, black, d8, d9, d10, d11, d12, d13, d14, d15, d16, d17, d18, period)</span>
<span id="cb1423-5"><a href="extending-the-discrete-time-hazard-model.html#cb1423-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1423-6"><a href="extending-the-discrete-time-hazard-model.html#cb1423-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use `fitted()` and wrangle</span></span>
<span id="cb1423-7"><a href="extending-the-discrete-time-hazard-model.html#cb1423-7" aria-hidden="true" tabindex="-1"></a><span class="fu">make_fitted</span>(fit12<span class="fl">.23</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1423-8"><a href="extending-the-discrete-time-hazard-model.html#cb1423-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">abused =</span> <span class="fu">ifelse</span>(abused <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;abused&quot;</span>, <span class="st">&quot;not abused&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(),</span>
<span id="cb1423-9"><a href="extending-the-discrete-time-hazard-model.html#cb1423-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex    =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(black <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Black&quot;</span>, <span class="st">&quot;White&quot;</span>),</span>
<span id="cb1423-10"><a href="extending-the-discrete-time-hazard-model.html#cb1423-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1423-11"><a href="extending-the-discrete-time-hazard-model.html#cb1423-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1423-12"><a href="extending-the-discrete-time-hazard-model.html#cb1423-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1423-13"><a href="extending-the-discrete-time-hazard-model.html#cb1423-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb1423-14"><a href="extending-the-discrete-time-hazard-model.html#cb1423-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> abused, <span class="at">color =</span> abused)) <span class="sc">+</span></span>
<span id="cb1423-15"><a href="extending-the-discrete-time-hazard-model.html#cb1423-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1423-16"><a href="extending-the-discrete-time-hazard-model.html#cb1423-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1423-17"><a href="extending-the-discrete-time-hazard-model.html#cb1423-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1423-18"><a href="extending-the-discrete-time-hazard-model.html#cb1423-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1423-19"><a href="extending-the-discrete-time-hazard-model.html#cb1423-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;age&quot;</span>, <span class="at">breaks =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">19</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb1423-20"><a href="extending-the-discrete-time-hazard-model.html#cb1423-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;fitted logit(hazard)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1423-21"><a href="extending-the-discrete-time-hazard-model.html#cb1423-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1423-22"><a href="extending-the-discrete-time-hazard-model.html#cb1423-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1423-23"><a href="extending-the-discrete-time-hazard-model.html#cb1423-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sex)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-65-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="nonlinear-effects." class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Nonlinear effects.<a href="extending-the-discrete-time-hazard-model.html#nonlinear-effects." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>There are two general strategies for exploring the linearity assumption. The simplest approach–although somewhat limited–is to fit additional models, replacing the raw predictor with a re-expressed version. Although the additional models also invoke a linearity constraint, use of re-expressed predictors guarantees that the effects represent nonlinear relationships for the <em>raw</em> predictors. The ladder of power (section 6.2.1) provides a dizzying array of options. The second approach is to categorize each continuous variable into a small number of groups, create a series of dummy variables representing group membership, and visually examine the <em>pattern of parameter estimates for consecutive dummies</em> to deduce the appropriate functional form. If the pattern is linear, retain the predictor in its raw state; if not, explore an alternative specification.</p>
<p>As the first approach is straightforward, we illustrate the second, using the depression onset data presented in section 12.3. (pp. 447–448, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Here’s another look at those <code>depression_pp</code> data.</p>
<div class="sourceCode" id="cb1424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1424-1"><a href="extending-the-discrete-time-hazard-model.html#cb1424-1" aria-hidden="true" tabindex="-1"></a>depression_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1424-2"><a href="extending-the-discrete-time-hazard-model.html#cb1424-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 36,997
## Columns: 22
## $ id        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ onset     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ age       &lt;dbl&gt; 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34…
## $ censor    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ censage   &lt;dbl&gt; 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34…
## $ aged      &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ female    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ nsibs     &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, …
## $ sibs12    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ sibs34    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ sibs56    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ sibs78    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ sibs9plus &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ bigfamily &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ period    &lt;dbl&gt; 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, …
## $ event     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ pd        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ pdnow     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ one       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ age_18    &lt;dbl&gt; -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,…
## $ age_18sq  &lt;dbl&gt; 196, 169, 144, 121, 100, 81, 64, 49, 36, 25, 16, 9, 4, 1, 0, 1, 4, 9, 16, 25, 36, 49, 64, …
## $ age_18cub &lt;dbl&gt; -2744, -2197, -1728, -1331, -1000, -729, -512, -343, -216, -125, -64, -27, -8, -1, 0, 1, 8…</code></pre>
<p>Our three models will be cubic with respect to our time variable, <code>age_18</code>. The focal predictor whose form (non)linear form we’re interested in is <code>nsibs</code>. Singer and Willett’s first model, Model A (see Table 12.4, p. 449), treated <code>nsibs</code> as linear. Fit the model with <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1426-1"><a href="extending-the-discrete-time-hazard-model.html#cb1426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model a (linear)  </span></span>
<span id="cb1426-2"><a href="extending-the-discrete-time-hazard-model.html#cb1426-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.598436 hours</span></span>
<span id="cb1426-3"><a href="extending-the-discrete-time-hazard-model.html#cb1426-3" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.24</span> <span class="ot">&lt;-</span></span>
<span id="cb1426-4"><a href="extending-the-discrete-time-hazard-model.html#cb1426-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> depression_pp,</span>
<span id="cb1426-5"><a href="extending-the-discrete-time-hazard-model.html#cb1426-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1426-6"><a href="extending-the-discrete-time-hazard-model.html#cb1426-6" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> age_18 <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> pd <span class="sc">+</span> female <span class="sc">+</span> nsibs,</span>
<span id="cb1426-7"><a href="extending-the-discrete-time-hazard-model.html#cb1426-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1426-8"><a href="extending-the-discrete-time-hazard-model.html#cb1426-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1426-9"><a href="extending-the-discrete-time-hazard-model.html#cb1426-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1426-10"><a href="extending-the-discrete-time-hazard-model.html#cb1426-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.24&quot;</span>)</span></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb1427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1427-1"><a href="extending-the-discrete-time-hazard-model.html#cb1427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.24</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + Intercept + age_18 + I(age_18^2) + I(age_18^3) + pd + female + nsibs 
##    Data: depression_pp (Number of observations: 36997) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -4.36      0.12    -4.59    -4.12 1.00     2083     2530
## age_18        0.06      0.01     0.04     0.08 1.00     2065     2112
## Iage_18E2    -0.01      0.00    -0.01    -0.01 1.00     4051     3040
## Iage_18E3     0.00      0.00     0.00     0.00 1.00     2935     2930
## pd            0.36      0.16     0.05     0.66 1.00     2307     1925
## female        0.56      0.11     0.35     0.77 1.00     2262     2409
## nsibs        -0.08      0.02    -0.13    -0.04 1.00     2566     2205
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here we invert the antilog of <code>nsibs</code> and summarize the posterior with <code>median_qi()</code>.</p>
<div class="sourceCode" id="cb1429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1429-1"><a href="extending-the-discrete-time-hazard-model.html#cb1429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.24</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1429-2"><a href="extending-the-discrete-time-hazard-model.html#cb1429-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">exp</span>(b_nsibs)) <span class="sc">%&gt;%</span> </span>
<span id="cb1429-3"><a href="extending-the-discrete-time-hazard-model.html#cb1429-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   `1/exp(b_nsibs)` .lower .upper .width .point .interval
##              &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1             1.09   1.04   1.14   0.95 median qi</code></pre>
<p>Singer and Willett described <code>nsibs</code> as “highly skewed” (p. 448). Let’s take a look.</p>
<div class="sourceCode" id="cb1431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1431-1"><a href="extending-the-discrete-time-hazard-model.html#cb1431-1" aria-hidden="true" tabindex="-1"></a>depression_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1431-2"><a href="extending-the-discrete-time-hazard-model.html#cb1431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1431-3"><a href="extending-the-discrete-time-hazard-model.html#cb1431-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1431-4"><a href="extending-the-discrete-time-hazard-model.html#cb1431-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1431-5"><a href="extending-the-discrete-time-hazard-model.html#cb1431-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nsibs)) <span class="sc">+</span></span>
<span id="cb1431-6"><a href="extending-the-discrete-time-hazard-model.html#cb1431-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb1431-7"><a href="extending-the-discrete-time-hazard-model.html#cb1431-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-70-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Yep, sure is. Here’s a way to save Singer and Willett’s discretized version of <code>nsibs</code> and then break the cases down in terms of <span class="math inline">\(n\)</span> and percentage, which matches nicely with the numbers at the bottom of page 449.</p>
<div class="sourceCode" id="cb1432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1432-1"><a href="extending-the-discrete-time-hazard-model.html#cb1432-1" aria-hidden="true" tabindex="-1"></a>depression_pp <span class="ot">&lt;-</span></span>
<span id="cb1432-2"><a href="extending-the-discrete-time-hazard-model.html#cb1432-2" aria-hidden="true" tabindex="-1"></a>  depression_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1432-3"><a href="extending-the-discrete-time-hazard-model.html#cb1432-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nsibs_cat =</span> <span class="fu">case_when</span>(</span>
<span id="cb1432-4"><a href="extending-the-discrete-time-hazard-model.html#cb1432-4" aria-hidden="true" tabindex="-1"></a>    nsibs <span class="sc">==</span> <span class="dv">0</span>         <span class="sc">~</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb1432-5"><a href="extending-the-discrete-time-hazard-model.html#cb1432-5" aria-hidden="true" tabindex="-1"></a>    nsibs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">&quot;1 or 2&quot;</span>,</span>
<span id="cb1432-6"><a href="extending-the-discrete-time-hazard-model.html#cb1432-6" aria-hidden="true" tabindex="-1"></a>    nsibs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>) <span class="sc">~</span> <span class="st">&quot;3 or 4&quot;</span>,</span>
<span id="cb1432-7"><a href="extending-the-discrete-time-hazard-model.html#cb1432-7" aria-hidden="true" tabindex="-1"></a>    nsibs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>) <span class="sc">~</span> <span class="st">&quot;5 or 6&quot;</span>,</span>
<span id="cb1432-8"><a href="extending-the-discrete-time-hazard-model.html#cb1432-8" aria-hidden="true" tabindex="-1"></a>    nsibs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">&quot;7 or 8&quot;</span>,</span>
<span id="cb1432-9"><a href="extending-the-discrete-time-hazard-model.html#cb1432-9" aria-hidden="true" tabindex="-1"></a>    nsibs <span class="sc">&gt;=</span> <span class="dv">9</span>         <span class="sc">~</span> <span class="st">&quot;9 or more&quot;</span></span>
<span id="cb1432-10"><a href="extending-the-discrete-time-hazard-model.html#cb1432-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1432-11"><a href="extending-the-discrete-time-hazard-model.html#cb1432-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1432-12"><a href="extending-the-discrete-time-hazard-model.html#cb1432-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1432-13"><a href="extending-the-discrete-time-hazard-model.html#cb1432-13" aria-hidden="true" tabindex="-1"></a>depression_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1432-14"><a href="extending-the-discrete-time-hazard-model.html#cb1432-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1432-15"><a href="extending-the-discrete-time-hazard-model.html#cb1432-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1432-16"><a href="extending-the-discrete-time-hazard-model.html#cb1432-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1432-17"><a href="extending-the-discrete-time-hazard-model.html#cb1432-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(nsibs_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb1432-18"><a href="extending-the-discrete-time-hazard-model.html#cb1432-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> (<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   nsibs_cat     n percent
##   &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;
## 1 0            98     7  
## 2 1 or 2      672    48.2
## 3 3 or 4      330    23.7
## 4 5 or 6      159    11.4
## 5 7 or 8       72     5.2
## 6 9 or more    62     4.5</code></pre>
<p>Now fit our version of Model B, in which we replace the original linear predictor <code>nsibs</code> with a series of dummies: <code>sibs12</code>, <code>sibs34</code>,…, <code>sibs9plus</code>.</p>
<div class="sourceCode" id="cb1434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1434-1"><a href="extending-the-discrete-time-hazard-model.html#cb1434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model b (nonlinear)  </span></span>
<span id="cb1434-2"><a href="extending-the-discrete-time-hazard-model.html#cb1434-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.346094 hours</span></span>
<span id="cb1434-3"><a href="extending-the-discrete-time-hazard-model.html#cb1434-3" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.25</span> <span class="ot">&lt;-</span></span>
<span id="cb1434-4"><a href="extending-the-discrete-time-hazard-model.html#cb1434-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> depression_pp,</span>
<span id="cb1434-5"><a href="extending-the-discrete-time-hazard-model.html#cb1434-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1434-6"><a href="extending-the-discrete-time-hazard-model.html#cb1434-6" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> age_18 <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> pd <span class="sc">+</span> female <span class="sc">+</span> sibs12 <span class="sc">+</span> sibs34 <span class="sc">+</span> sibs56 <span class="sc">+</span> sibs78 <span class="sc">+</span> sibs9plus,</span>
<span id="cb1434-7"><a href="extending-the-discrete-time-hazard-model.html#cb1434-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1434-8"><a href="extending-the-discrete-time-hazard-model.html#cb1434-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1434-9"><a href="extending-the-discrete-time-hazard-model.html#cb1434-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1434-10"><a href="extending-the-discrete-time-hazard-model.html#cb1434-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.25&quot;</span>)</span></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1435-1"><a href="extending-the-discrete-time-hazard-model.html#cb1435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.25</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + Intercept + age_18 + I(age_18^2) + I(age_18^3) + pd + female + sibs12 + sibs34 + sibs56 + sibs78 + sibs9plus 
##    Data: depression_pp (Number of observations: 36997) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -4.51      0.21    -4.95    -4.12 1.00     1171     1774
## age_18        0.06      0.01     0.04     0.08 1.00     3271     2602
## Iage_18E2    -0.01      0.00    -0.01    -0.01 1.00     5517     2781
## Iage_18E3     0.00      0.00     0.00     0.00 1.00     4190     3636
## pd            0.36      0.16     0.03     0.67 1.00     2489     2324
## female        0.56      0.11     0.36     0.78 1.00     2673     2847
## sibs12        0.03      0.20    -0.35     0.44 1.00     1183     1892
## sibs34        0.02      0.21    -0.38     0.43 1.00     1286     1998
## sibs56       -0.50      0.26    -1.00     0.02 1.00     1458     2047
## sibs78       -0.80      0.35    -1.50    -0.15 1.00     1967     2402
## sibs9plus    -0.68      0.35    -1.37    -0.01 1.00     1932     2301
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>It might be easier to compare the various <code>sibs*</code> coefficients with a coefficient plot.</p>
<div class="sourceCode" id="cb1437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1437-1"><a href="extending-the-discrete-time-hazard-model.html#cb1437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1437-2"><a href="extending-the-discrete-time-hazard-model.html#cb1437-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">contains</span>(<span class="st">&quot;sibs&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1437-3"><a href="extending-the-discrete-time-hazard-model.html#cb1437-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_remove</span>(name, <span class="st">&quot;b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1437-4"><a href="extending-the-discrete-time-hazard-model.html#cb1437-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1437-5"><a href="extending-the-discrete-time-hazard-model.html#cb1437-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb1437-6"><a href="extending-the-discrete-time-hazard-model.html#cb1437-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_interval</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb1437-7"><a href="extending-the-discrete-time-hazard-model.html#cb1437-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="st">&quot;CI level:&quot;</span>, <span class="at">start =</span> .<span class="dv">8</span>, <span class="at">end =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1437-8"><a href="extending-the-discrete-time-hazard-model.html#cb1437-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;sibs coeficients&quot;</span>,</span>
<span id="cb1437-9"><a href="extending-the-discrete-time-hazard-model.html#cb1437-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1437-10"><a href="extending-the-discrete-time-hazard-model.html#cb1437-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1437-11"><a href="extending-the-discrete-time-hazard-model.html#cb1437-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1437-12"><a href="extending-the-discrete-time-hazard-model.html#cb1437-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-73-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here is the breakdown by <code>bigfamily</code>.</p>
<div class="sourceCode" id="cb1438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1438-1"><a href="extending-the-discrete-time-hazard-model.html#cb1438-1" aria-hidden="true" tabindex="-1"></a>depression_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1438-2"><a href="extending-the-discrete-time-hazard-model.html#cb1438-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1438-3"><a href="extending-the-discrete-time-hazard-model.html#cb1438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1438-4"><a href="extending-the-discrete-time-hazard-model.html#cb1438-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1438-5"><a href="extending-the-discrete-time-hazard-model.html#cb1438-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bigfamily) <span class="sc">%&gt;%</span> </span>
<span id="cb1438-6"><a href="extending-the-discrete-time-hazard-model.html#cb1438-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> (<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   bigfamily     n percent
##       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1         0  1100    79.0
## 2         1   293    21.0</code></pre>
<p>Now fit our version of Model C, the dichotomized <code>bigfamily</code> model.</p>
<div class="sourceCode" id="cb1440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1440-1"><a href="extending-the-discrete-time-hazard-model.html#cb1440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model c (dichotomized)  </span></span>
<span id="cb1440-2"><a href="extending-the-discrete-time-hazard-model.html#cb1440-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.560219 hours</span></span>
<span id="cb1440-3"><a href="extending-the-discrete-time-hazard-model.html#cb1440-3" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.26</span> <span class="ot">&lt;-</span></span>
<span id="cb1440-4"><a href="extending-the-discrete-time-hazard-model.html#cb1440-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> depression_pp,</span>
<span id="cb1440-5"><a href="extending-the-discrete-time-hazard-model.html#cb1440-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1440-6"><a href="extending-the-discrete-time-hazard-model.html#cb1440-6" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> age_18 <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(age_18<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> pd <span class="sc">+</span> female <span class="sc">+</span> bigfamily,</span>
<span id="cb1440-7"><a href="extending-the-discrete-time-hazard-model.html#cb1440-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1440-8"><a href="extending-the-discrete-time-hazard-model.html#cb1440-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1440-9"><a href="extending-the-discrete-time-hazard-model.html#cb1440-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1440-10"><a href="extending-the-discrete-time-hazard-model.html#cb1440-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.26&quot;</span>)</span></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb1441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1441-1"><a href="extending-the-discrete-time-hazard-model.html#cb1441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.26</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + Intercept + age_18 + I(age_18^2) + I(age_18^3) + pd + female + bigfamily 
##    Data: depression_pp (Number of observations: 36997) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -4.48      0.11    -4.70    -4.28 1.00     1833     1825
## age_18        0.06      0.01     0.04     0.08 1.00     2532     2480
## Iage_18E2    -0.01      0.00    -0.01    -0.01 1.00     4095     3489
## Iage_18E3     0.00      0.00     0.00     0.00 1.00     3390     3365
## pd            0.36      0.16     0.04     0.67 1.00     2411     2150
## female        0.56      0.11     0.35     0.77 1.00     1804     1972
## bigfamily    -0.61      0.15    -0.91    -0.34 1.00     3291     2267
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The summaries look very similar to the values in the rightmost column of Table 12.4 in the text. Here is a look at the antilog of our <code>bigfamily</code> coefficient.</p>
<div class="sourceCode" id="cb1443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1443-1"><a href="extending-the-discrete-time-hazard-model.html#cb1443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># just to make the x-axis pretty</span></span>
<span id="cb1443-2"><a href="extending-the-discrete-time-hazard-model.html#cb1443-2" aria-hidden="true" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">exp</span>(<span class="fu">fixef</span>(fit12<span class="fl">.26</span>)[<span class="st">&quot;bigfamily&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)]), <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb1443-3"><a href="extending-the-discrete-time-hazard-model.html#cb1443-3" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">exp</span>(<span class="fu">fixef</span>(fit12<span class="fl">.26</span>)[<span class="st">&quot;bigfamily&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)]), <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb1443-4"><a href="extending-the-discrete-time-hazard-model.html#cb1443-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1443-5"><a href="extending-the-discrete-time-hazard-model.html#cb1443-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot!</span></span>
<span id="cb1443-6"><a href="extending-the-discrete-time-hazard-model.html#cb1443-6" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.26</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1443-7"><a href="extending-the-discrete-time-hazard-model.html#cb1443-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">exp</span>(b_bigfamily), <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1443-8"><a href="extending-the-discrete-time-hazard-model.html#cb1443-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1443-9"><a href="extending-the-discrete-time-hazard-model.html#cb1443-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb1443-10"><a href="extending-the-discrete-time-hazard-model.html#cb1443-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;bigfamily odds ratio&quot;</span>, <span class="at">breaks =</span> breaks, <span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb1443-11"><a href="extending-the-discrete-time-hazard-model.html#cb1443-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1443-12"><a href="extending-the-discrete-time-hazard-model.html#cb1443-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-76-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Now compute the WAIC estimates for <code>fit12.24</code> through <code>fit12.26</code> and compare them by their WAIC differences and WAIC weights.</p>
<div class="sourceCode" id="cb1444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1444-1"><a href="extending-the-discrete-time-hazard-model.html#cb1444-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.24</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.24</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb1444-2"><a href="extending-the-discrete-time-hazard-model.html#cb1444-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.25</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb1444-3"><a href="extending-the-discrete-time-hazard-model.html#cb1444-3" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.26</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.26</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb1444-4"><a href="extending-the-discrete-time-hazard-model.html#cb1444-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1444-5"><a href="extending-the-discrete-time-hazard-model.html#cb1444-5" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.24</span>, fit12<span class="fl">.25</span>, fit12<span class="fl">.26</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit12.26     0.0       0.0 -2066.3      85.6          6.9     0.5    4132.7   171.3
## fit12.24    -2.8       2.9 -2069.2      85.8          7.1     0.5    4138.3   171.6
## fit12.25    -3.8       1.1 -2070.2      85.8         11.1     0.7    4140.3   171.7</code></pre>
<div class="sourceCode" id="cb1446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1446-1"><a href="extending-the-discrete-time-hazard-model.html#cb1446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.24</span>, fit12<span class="fl">.25</span>, fit12<span class="fl">.26</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.24 fit12.25 fit12.26 
##    0.054    0.020    0.926</code></pre>
<p>Our WAIC estimates are very similar to the AIC estimates presented in Table 12.4. By both the differences and the weights, <code>fit12.16</code> (Model C) is the best among the three. Though its rank is decisive with the weights, it’s less impressive if you compare the <code>se_diff</code> values with the <code>elpd_diff</code> values. Those suggest there’s a lot of uncertainty in our WAIC differences.</p>
</div>
</div>
<div id="the-proportionality-assumption-uncovering-violations-and-simple-solutions" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> The proportionality assumption: Uncovering violations and simple solutions<a href="extending-the-discrete-time-hazard-model.html#the-proportionality-assumption-uncovering-violations-and-simple-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>All the discrete hazard models postulated so far invoke another common, but restrictive assumption: that each predictor has an identical effect in every time period under study. This constraint, known as the <em>proportionality assumption</em>, stipulates that a predictor’s effect does not depend on the respondent’s duration in the initial state….</p>
<p>Yet is it not possible, even likely, that the effects of some predictors will <em>vary</em> over time? (p. 451, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="discrete-time-hazard-models-that-do-not-invoke-a-proportionality-assumption." class="section level3 hasAnchor" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Discrete-time hazard models that do not invoke a proportionality assumption.<a href="extending-the-discrete-time-hazard-model.html#discrete-time-hazard-models-that-do-not-invoke-a-proportionality-assumption." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>“There are dozens of ways of violating the proportionality assumption” (p. 452). We see three such examples in panels B through D in Figure 12.7. Here’s our version of the plot.</p>
<div class="sourceCode" id="cb1448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1448-1"><a href="extending-the-discrete-time-hazard-model.html#cb1448-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1448-2"><a href="extending-the-discrete-time-hazard-model.html#cb1448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">z =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1448-3"><a href="extending-the-discrete-time-hazard-model.html#cb1448-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1448-4"><a href="extending-the-discrete-time-hazard-model.html#cb1448-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">2.1</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.2</span> <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">1.1</span> <span class="sc">*</span> z,</span>
<span id="cb1448-5"><a href="extending-the-discrete-time-hazard-model.html#cb1448-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">z =</span> <span class="fu">factor</span>(z)) <span class="sc">%&gt;%</span> </span>
<span id="cb1448-6"><a href="extending-the-discrete-time-hazard-model.html#cb1448-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1448-7"><a href="extending-the-discrete-time-hazard-model.html#cb1448-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1448-8"><a href="extending-the-discrete-time-hazard-model.html#cb1448-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size =</span> z))</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb1450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1450-1"><a href="extending-the-discrete-time-hazard-model.html#cb1450-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1450-2"><a href="extending-the-discrete-time-hazard-model.html#cb1450-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">z =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1450-3"><a href="extending-the-discrete-time-hazard-model.html#cb1450-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1450-4"><a href="extending-the-discrete-time-hazard-model.html#cb1450-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">4.8</span> <span class="sc">+</span> <span class="fl">0.28</span> <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> z <span class="sc">+</span> <span class="fl">0.25</span> <span class="sc">*</span> x <span class="sc">*</span> z,</span>
<span id="cb1450-5"><a href="extending-the-discrete-time-hazard-model.html#cb1450-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">z =</span> <span class="fu">factor</span>(z)) <span class="sc">%&gt;%</span> </span>
<span id="cb1450-6"><a href="extending-the-discrete-time-hazard-model.html#cb1450-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1450-7"><a href="extending-the-discrete-time-hazard-model.html#cb1450-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1450-8"><a href="extending-the-discrete-time-hazard-model.html#cb1450-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size =</span> z))</span>
<span id="cb1450-9"><a href="extending-the-discrete-time-hazard-model.html#cb1450-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1450-10"><a href="extending-the-discrete-time-hazard-model.html#cb1450-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1450-11"><a href="extending-the-discrete-time-hazard-model.html#cb1450-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">z =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1450-12"><a href="extending-the-discrete-time-hazard-model.html#cb1450-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1450-13"><a href="extending-the-discrete-time-hazard-model.html#cb1450-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">4.8</span> <span class="sc">+</span> <span class="fl">0.25</span> <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">4.3</span> <span class="sc">*</span> z <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">*</span> z,</span>
<span id="cb1450-14"><a href="extending-the-discrete-time-hazard-model.html#cb1450-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">z =</span> <span class="fu">factor</span>(z)) <span class="sc">%&gt;%</span></span>
<span id="cb1450-15"><a href="extending-the-discrete-time-hazard-model.html#cb1450-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1450-16"><a href="extending-the-discrete-time-hazard-model.html#cb1450-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1450-17"><a href="extending-the-discrete-time-hazard-model.html#cb1450-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size =</span> z))</span>
<span id="cb1450-18"><a href="extending-the-discrete-time-hazard-model.html#cb1450-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1450-19"><a href="extending-the-discrete-time-hazard-model.html#cb1450-19" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1450-20"><a href="extending-the-discrete-time-hazard-model.html#cb1450-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">z1 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1450-21"><a href="extending-the-discrete-time-hazard-model.html#cb1450-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">x  =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1450-22"><a href="extending-the-discrete-time-hazard-model.html#cb1450-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z2 =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb1450-23"><a href="extending-the-discrete-time-hazard-model.html#cb1450-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">y  =</span> <span class="sc">-</span><span class="fl">2.8</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.2</span> <span class="sc">*</span> (x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">1.8</span> <span class="sc">*</span> z1 <span class="sc">+</span> <span class="sc">-</span><span class="fl">1.4</span> <span class="sc">*</span> z1 <span class="sc">*</span> z2,</span>
<span id="cb1450-24"><a href="extending-the-discrete-time-hazard-model.html#cb1450-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">z1 =</span> <span class="fu">factor</span>(z1)) <span class="sc">%&gt;%</span> </span>
<span id="cb1450-25"><a href="extending-the-discrete-time-hazard-model.html#cb1450-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1450-26"><a href="extending-the-discrete-time-hazard-model.html#cb1450-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1450-27"><a href="extending-the-discrete-time-hazard-model.html#cb1450-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size =</span> z1))</span>
<span id="cb1450-28"><a href="extending-the-discrete-time-hazard-model.html#cb1450-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1450-29"><a href="extending-the-discrete-time-hazard-model.html#cb1450-29" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb1450-30"><a href="extending-the-discrete-time-hazard-model.html#cb1450-30" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb1450-31"><a href="extending-the-discrete-time-hazard-model.html#cb1450-31" aria-hidden="true" tabindex="-1"></a>  (p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4) <span class="sc">+</span> </span>
<span id="cb1450-32"><a href="extending-the-discrete-time-hazard-model.html#cb1450-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;A&quot;</span>) </span>
<span id="cb1450-33"><a href="extending-the-discrete-time-hazard-model.html#cb1450-33" aria-hidden="true" tabindex="-1"></a>) <span class="sc">&amp;</span></span>
<span id="cb1450-34"><a href="extending-the-discrete-time-hazard-model.html#cb1450-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)) <span class="sc">&amp;</span></span>
<span id="cb1450-35"><a href="extending-the-discrete-time-hazard-model.html#cb1450-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;time period&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>)) <span class="sc">&amp;</span></span>
<span id="cb1450-36"><a href="extending-the-discrete-time-hazard-model.html#cb1450-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;logit hazard&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">&amp;</span></span>
<span id="cb1450-37"><a href="extending-the-discrete-time-hazard-model.html#cb1450-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb1450-38"><a href="extending-the-discrete-time-hazard-model.html#cb1450-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-78-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In case is wasn’t clear, I just winged it on the equations for the <code>y</code> values in each subplot. If you’d like to annotate the subplots with the arrows and <span class="math inline">\(\beta\)</span> labels as depicted in the original Figure 12.7, consider it a homework exercise.</p>
</div>
<div id="investigating-the-proportionality-assumption-in-practice." class="section level3 hasAnchor" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> Investigating the proportionality assumption in practice.<a href="extending-the-discrete-time-hazard-model.html#investigating-the-proportionality-assumption-in-practice." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the data from Graham’s <span class="citation">(<a href="#ref-graham1997exodus" role="doc-biblioref">1997</a>)</span> dissertation.</p>
<div class="sourceCode" id="cb1451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1451-1"><a href="extending-the-discrete-time-hazard-model.html#cb1451-1" aria-hidden="true" tabindex="-1"></a>mathdropout_pp <span class="ot">&lt;-</span> </span>
<span id="cb1451-2"><a href="extending-the-discrete-time-hazard-model.html#cb1451-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&quot;data/mathdropout_pp.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1451-3"><a href="extending-the-discrete-time-hazard-model.html#cb1451-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert the column names to lower case</span></span>
<span id="cb1451-4"><a href="extending-the-discrete-time-hazard-model.html#cb1451-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(tolower)</span>
<span id="cb1451-5"><a href="extending-the-discrete-time-hazard-model.html#cb1451-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1451-6"><a href="extending-the-discrete-time-hazard-model.html#cb1451-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mathdropout_pp)</span></code></pre></div>
<pre><code>## Rows: 9,558
## Columns: 19
## $ id     &lt;dbl&gt; 201303, 201303, 201304, 201304, 201304, 201305, 201305, 201311, 201311, 201311, 201311, 20131…
## $ lastpd &lt;dbl&gt; 2, 2, 3, 3, 3, 2, 2, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 3, 3, 3, 1, 5, 5, 5, 5, 5, 2, 2, 3, 3, 3, …
## $ female &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ censor &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, …
## $ one    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ hs11   &lt;dbl&gt; 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, …
## $ hs12   &lt;dbl&gt; 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, …
## $ coll1  &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, …
## $ coll2  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …
## $ coll3  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, …
## $ fhs11  &lt;dbl&gt; 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, …
## $ fhs12  &lt;dbl&gt; 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, …
## $ fcoll1 &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, …
## $ fcoll2 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …
## $ fcoll3 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, …
## $ period &lt;dbl&gt; 1, 2, 1, 2, 3, 1, 2, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 1, 1, 2, 3, 4, 5, 1, 2, 1, 2, 3, …
## $ event  &lt;dbl&gt; 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, …
## $ ltime  &lt;dbl&gt; 0, 1, 0, 1, 2, 0, 1, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 0, 0, 1, 2, 3, 4, 0, 1, 0, 1, 2, …
## $ fltime &lt;dbl&gt; 0, 1, 0, 1, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 1, 2, 3, 4, 0, 1, 0, 1, 2, …</code></pre>
<p>The data are composed of <span class="math inline">\(n = 3{,}790\)</span> high school students.</p>
<div class="sourceCode" id="cb1453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1453-1"><a href="extending-the-discrete-time-hazard-model.html#cb1453-1" aria-hidden="true" tabindex="-1"></a>mathdropout_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1453-2"><a href="extending-the-discrete-time-hazard-model.html#cb1453-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1453-3"><a href="extending-the-discrete-time-hazard-model.html#cb1453-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1  3790</code></pre>
<p>Here is the division by <code>female</code>.</p>
<div class="sourceCode" id="cb1455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1455-1"><a href="extending-the-discrete-time-hazard-model.html#cb1455-1" aria-hidden="true" tabindex="-1"></a>mathdropout_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1455-2"><a href="extending-the-discrete-time-hazard-model.html#cb1455-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, female) <span class="sc">%&gt;%</span> </span>
<span id="cb1455-3"><a href="extending-the-discrete-time-hazard-model.html#cb1455-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(female) <span class="sc">%&gt;%</span> </span>
<span id="cb1455-4"><a href="extending-the-discrete-time-hazard-model.html#cb1455-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   female     n percent
##    &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1      0  1875    49.5
## 2      1  1915    50.5</code></pre>
<p>Singer and Willett also wrote: “only 93 men and 39 women took a mathematics class in each of the next five terms” (p. 456). I think this is a typo. Here’s the break down by <code>censor</code> and <code>female</code> at the fifth time period (<code>period == 5</code>).</p>
<div class="sourceCode" id="cb1457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1457-1"><a href="extending-the-discrete-time-hazard-model.html#cb1457-1" aria-hidden="true" tabindex="-1"></a>mathdropout_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1457-2"><a href="extending-the-discrete-time-hazard-model.html#cb1457-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(period <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1457-3"><a href="extending-the-discrete-time-hazard-model.html#cb1457-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(censor, female)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   censor female     n
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
## 1      0      0    39
## 2      0      1    39
## 3      1      0    93
## 4      1      1    51</code></pre>
<p>Fitting the three models displayed in Table 12.5 is a mild extension from our previous models. From a <code>brm()</code> perspective, there’s nothing new, here.</p>
<div class="sourceCode" id="cb1459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1459-1"><a href="extending-the-discrete-time-hazard-model.html#cb1459-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.27</span> <span class="ot">&lt;-</span></span>
<span id="cb1459-2"><a href="extending-the-discrete-time-hazard-model.html#cb1459-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> mathdropout_pp,</span>
<span id="cb1459-3"><a href="extending-the-discrete-time-hazard-model.html#cb1459-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1459-4"><a href="extending-the-discrete-time-hazard-model.html#cb1459-4" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> hs11 <span class="sc">+</span> hs12 <span class="sc">+</span> coll1 <span class="sc">+</span> coll2 <span class="sc">+</span> coll3 <span class="sc">+</span> female,</span>
<span id="cb1459-5"><a href="extending-the-discrete-time-hazard-model.html#cb1459-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1459-6"><a href="extending-the-discrete-time-hazard-model.html#cb1459-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1459-7"><a href="extending-the-discrete-time-hazard-model.html#cb1459-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1459-8"><a href="extending-the-discrete-time-hazard-model.html#cb1459-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.27&quot;</span>)</span>
<span id="cb1459-9"><a href="extending-the-discrete-time-hazard-model.html#cb1459-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1459-10"><a href="extending-the-discrete-time-hazard-model.html#cb1459-10" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.28</span> <span class="ot">&lt;-</span></span>
<span id="cb1459-11"><a href="extending-the-discrete-time-hazard-model.html#cb1459-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> mathdropout_pp,</span>
<span id="cb1459-12"><a href="extending-the-discrete-time-hazard-model.html#cb1459-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1459-13"><a href="extending-the-discrete-time-hazard-model.html#cb1459-13" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> hs11 <span class="sc">+</span> hs12 <span class="sc">+</span> coll1 <span class="sc">+</span> coll2 <span class="sc">+</span> coll3 <span class="sc">+</span> fhs11 <span class="sc">+</span> fhs12 <span class="sc">+</span> fcoll1 <span class="sc">+</span> fcoll2 <span class="sc">+</span> fcoll3,</span>
<span id="cb1459-14"><a href="extending-the-discrete-time-hazard-model.html#cb1459-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1459-15"><a href="extending-the-discrete-time-hazard-model.html#cb1459-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1459-16"><a href="extending-the-discrete-time-hazard-model.html#cb1459-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1459-17"><a href="extending-the-discrete-time-hazard-model.html#cb1459-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.28&quot;</span>)</span>
<span id="cb1459-18"><a href="extending-the-discrete-time-hazard-model.html#cb1459-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1459-19"><a href="extending-the-discrete-time-hazard-model.html#cb1459-19" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.29</span> <span class="ot">&lt;-</span></span>
<span id="cb1459-20"><a href="extending-the-discrete-time-hazard-model.html#cb1459-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> mathdropout_pp,</span>
<span id="cb1459-21"><a href="extending-the-discrete-time-hazard-model.html#cb1459-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1459-22"><a href="extending-the-discrete-time-hazard-model.html#cb1459-22" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> hs11 <span class="sc">+</span> hs12 <span class="sc">+</span> coll1 <span class="sc">+</span> coll2 <span class="sc">+</span> coll3 <span class="sc">+</span> female <span class="sc">+</span> fltime,</span>
<span id="cb1459-23"><a href="extending-the-discrete-time-hazard-model.html#cb1459-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1459-24"><a href="extending-the-discrete-time-hazard-model.html#cb1459-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1459-25"><a href="extending-the-discrete-time-hazard-model.html#cb1459-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">12</span>,</span>
<span id="cb1459-26"><a href="extending-the-discrete-time-hazard-model.html#cb1459-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit12.29&quot;</span>)</span></code></pre></div>
<p>Heads up about the <code>formula</code> for <code>fit12.28</code> (Model B). Many of the examples in the text and the corresponding data sets we’ve been working with included pre-computed interaction terms. We have been quietly ignoring those and making our interactions by hand in our <code>formula</code> arguments. Here we went ahead with the text and just used <code>event | trials(1) ~ 0 + hs11 + hs12 + coll1 + coll2 + coll3 + fhs11 + fhs12 + fcoll1 + fcoll2 + fcoll3</code>. If you wanted a more verbose version of that code, we could have specified either</p>
<ul>
<li><code>event | trials(1) ~ 0 + hs11 + hs12 + coll1 + coll2 + coll3 + female:hs11 + female:hs12 + female:coll1 + female:coll2 + female:coll3</code> or</li>
<li><code>event | trials(1) ~ 0 + hs11 + hs12 + coll1 + coll2 + coll3 + female:(hs11 + hs12 + coll1 + coll2 + coll3)</code>.</li>
</ul>
<p>All three return the same results. Anyway, let’s check the model summaries.</p>
<div class="sourceCode" id="cb1460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1460-1"><a href="extending-the-discrete-time-hazard-model.html#cb1460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.27</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + hs11 + hs12 + coll1 + coll2 + coll3 + female 
##    Data: mathdropout_pp (Number of observations: 9558) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## hs11      -2.13      0.06    -2.24    -2.02 1.00     3274     3212
## hs12      -0.94      0.05    -1.03    -0.85 1.00     3170     3111
## coll1     -1.45      0.06    -1.57    -1.33 1.00     3805     2924
## coll2     -0.62      0.08    -0.77    -0.47 1.00     3927     2854
## coll3     -0.77      0.14    -1.05    -0.50 1.00     5012     3121
## female     0.38      0.05     0.28     0.47 1.00     2601     3117
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1462-1"><a href="extending-the-discrete-time-hazard-model.html#cb1462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.28</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + hs11 + hs12 + coll1 + coll2 + coll3 + fhs11 + fhs12 + fcoll1 + fcoll2 + fcoll3 
##    Data: mathdropout_pp (Number of observations: 9558) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## hs11      -2.01      0.07    -2.15    -1.86 1.00     3929     2636
## hs12      -0.96      0.06    -1.08    -0.85 1.00     4242     3118
## coll1     -1.49      0.09    -1.65    -1.32 1.00     4393     2983
## coll2     -0.71      0.10    -0.91    -0.52 1.00     4290     3270
## coll3     -0.87      0.19    -1.25    -0.49 1.00     4140     3233
## fhs11      0.15      0.10    -0.05     0.35 1.00     3793     2706
## fhs12      0.42      0.08     0.26     0.57 1.00     4180     3169
## fcoll1     0.44      0.12     0.22     0.66 1.00     3704     3113
## fcoll2     0.57      0.14     0.29     0.85 1.00     4466     3450
## fcoll3     0.60      0.29     0.03     1.16 1.00     3934     3034
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1464-1"><a href="extending-the-discrete-time-hazard-model.html#cb1464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit12<span class="fl">.29</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: event | trials(1) ~ 0 + hs11 + hs12 + coll1 + coll2 + coll3 + female + fltime 
##    Data: mathdropout_pp (Number of observations: 9558) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## hs11      -2.05      0.06    -2.17    -1.92 1.00     2486     3112
## hs12      -0.92      0.05    -1.02    -0.83 1.00     2807     2921
## coll1     -1.50      0.07    -1.63    -1.37 1.00     3467     2801
## coll2     -0.72      0.09    -0.89    -0.55 1.00     3033     2710
## coll3     -0.92      0.16    -1.23    -0.62 1.00     3308     3165
## female     0.23      0.08     0.08     0.38 1.00     2014     2564
## fltime     0.12      0.05     0.03     0.21 1.00     2162     2478
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The results are similar to those in Table 12.5. Based on <code>fit12.27</code> (Model A), here is the posterior for the odds ratio for <code>female</code>.</p>
<div class="sourceCode" id="cb1466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1466-1"><a href="extending-the-discrete-time-hazard-model.html#cb1466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.27</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1466-2"><a href="extending-the-discrete-time-hazard-model.html#cb1466-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">exp</span>(b_female), <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1466-3"><a href="extending-the-discrete-time-hazard-model.html#cb1466-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb1466-4"><a href="extending-the-discrete-time-hazard-model.html#cb1466-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1466-5"><a href="extending-the-discrete-time-hazard-model.html#cb1466-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;odds ratio for female&quot;</span>) <span class="sc">+</span></span>
<span id="cb1466-6"><a href="extending-the-discrete-time-hazard-model.html#cb1466-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-84-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>With regard to the interaction terms for <code>fit12.28</code> (Model B), Singer and Willett remarked: “Notice how the estimates rise over time” (p. 457). It might be easiest to observe that in a plot.</p>
<div class="sourceCode" id="cb1467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1467-1"><a href="extending-the-discrete-time-hazard-model.html#cb1467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.28</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1467-2"><a href="extending-the-discrete-time-hazard-model.html#cb1467-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b_f&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1467-3"><a href="extending-the-discrete-time-hazard-model.html#cb1467-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(<span class="fu">str_remove</span>(name, <span class="st">&quot;b_&quot;</span>),</span>
<span id="cb1467-4"><a href="extending-the-discrete-time-hazard-model.html#cb1467-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">&quot;fhs&quot;</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>), <span class="fu">str_c</span>(<span class="st">&quot;fcoll&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb1467-5"><a href="extending-the-discrete-time-hazard-model.html#cb1467-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1467-6"><a href="extending-the-discrete-time-hazard-model.html#cb1467-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb1467-7"><a href="extending-the-discrete-time-hazard-model.html#cb1467-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_interval</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb1467-8"><a href="extending-the-discrete-time-hazard-model.html#cb1467-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="st">&quot;CI level:&quot;</span>, <span class="at">start =</span> .<span class="dv">8</span>, <span class="at">end =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1467-9"><a href="extending-the-discrete-time-hazard-model.html#cb1467-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;interaction terms&quot;</span>,</span>
<span id="cb1467-10"><a href="extending-the-discrete-time-hazard-model.html#cb1467-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1467-11"><a href="extending-the-discrete-time-hazard-model.html#cb1467-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1467-12"><a href="extending-the-discrete-time-hazard-model.html#cb1467-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1467-13"><a href="extending-the-discrete-time-hazard-model.html#cb1467-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-85-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Make and save the subplots for Figure 12.8.</p>
<div class="sourceCode" id="cb1468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1468-1"><a href="extending-the-discrete-time-hazard-model.html#cb1468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Within-group sample hazard functions</span></span>
<span id="cb1468-2"><a href="extending-the-discrete-time-hazard-model.html#cb1468-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1468-3"><a href="extending-the-discrete-time-hazard-model.html#cb1468-3" aria-hidden="true" tabindex="-1"></a>  mathdropout_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1468-4"><a href="extending-the-discrete-time-hazard-model.html#cb1468-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">if_else</span>(event <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;event&quot;</span>, <span class="st">&quot;no_event&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-5"><a href="extending-the-discrete-time-hazard-model.html#cb1468-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(period) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-6"><a href="extending-the-discrete-time-hazard-model.html#cb1468-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(event, female) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-7"><a href="extending-the-discrete-time-hazard-model.html#cb1468-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1468-8"><a href="extending-the-discrete-time-hazard-model.html#cb1468-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> event,</span>
<span id="cb1468-9"><a href="extending-the-discrete-time-hazard-model.html#cb1468-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-10"><a href="extending-the-discrete-time-hazard-model.html#cb1468-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> event <span class="sc">+</span> no_event,</span>
<span id="cb1468-11"><a href="extending-the-discrete-time-hazard-model.html#cb1468-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">logit =</span> <span class="fu">log</span>(event <span class="sc">/</span> total <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> event <span class="sc">/</span> total))) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-12"><a href="extending-the-discrete-time-hazard-model.html#cb1468-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">factor</span>(female,</span>
<span id="cb1468-13"><a href="extending-the-discrete-time-hazard-model.html#cb1468-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>,</span>
<span id="cb1468-14"><a href="extending-the-discrete-time-hazard-model.html#cb1468-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-15"><a href="extending-the-discrete-time-hazard-model.html#cb1468-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1468-16"><a href="extending-the-discrete-time-hazard-model.html#cb1468-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb1468-17"><a href="extending-the-discrete-time-hazard-model.html#cb1468-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> logit)) <span class="sc">+</span></span>
<span id="cb1468-18"><a href="extending-the-discrete-time-hazard-model.html#cb1468-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> female),</span>
<span id="cb1468-19"><a href="extending-the-discrete-time-hazard-model.html#cb1468-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1468-20"><a href="extending-the-discrete-time-hazard-model.html#cb1468-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;sample logit(hazard)&quot;</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1468-21"><a href="extending-the-discrete-time-hazard-model.html#cb1468-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Within-group sample hazard functions&quot;</span>)</span>
<span id="cb1468-22"><a href="extending-the-discrete-time-hazard-model.html#cb1468-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1468-23"><a href="extending-the-discrete-time-hazard-model.html#cb1468-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Model A: Main effect of female</span></span>
<span id="cb1468-24"><a href="extending-the-discrete-time-hazard-model.html#cb1468-24" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb1468-25"><a href="extending-the-discrete-time-hazard-model.html#cb1468-25" aria-hidden="true" tabindex="-1"></a>  mathdropout_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1468-26"><a href="extending-the-discrete-time-hazard-model.html#cb1468-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(female, period, hs11, hs12, coll1, coll2, coll3)</span>
<span id="cb1468-27"><a href="extending-the-discrete-time-hazard-model.html#cb1468-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1468-28"><a href="extending-the-discrete-time-hazard-model.html#cb1468-28" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1468-29"><a href="extending-the-discrete-time-hazard-model.html#cb1468-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_fitted</span>(fit12<span class="fl">.27</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-30"><a href="extending-the-discrete-time-hazard-model.html#cb1468-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">factor</span>(female,</span>
<span id="cb1468-31"><a href="extending-the-discrete-time-hazard-model.html#cb1468-31" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>,</span>
<span id="cb1468-32"><a href="extending-the-discrete-time-hazard-model.html#cb1468-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-33"><a href="extending-the-discrete-time-hazard-model.html#cb1468-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1468-34"><a href="extending-the-discrete-time-hazard-model.html#cb1468-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb1468-35"><a href="extending-the-discrete-time-hazard-model.html#cb1468-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb1468-36"><a href="extending-the-discrete-time-hazard-model.html#cb1468-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> female, <span class="at">color =</span> female)) <span class="sc">+</span></span>
<span id="cb1468-37"><a href="extending-the-discrete-time-hazard-model.html#cb1468-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1468-38"><a href="extending-the-discrete-time-hazard-model.html#cb1468-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1468-39"><a href="extending-the-discrete-time-hazard-model.html#cb1468-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1468-40"><a href="extending-the-discrete-time-hazard-model.html#cb1468-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;fitted logit(hazard)&quot;</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1468-41"><a href="extending-the-discrete-time-hazard-model.html#cb1468-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Model A: Main effect of female&quot;</span>)</span>
<span id="cb1468-42"><a href="extending-the-discrete-time-hazard-model.html#cb1468-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1468-43"><a href="extending-the-discrete-time-hazard-model.html#cb1468-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Model B: Completely general\ninteraction between female and time</span></span>
<span id="cb1468-44"><a href="extending-the-discrete-time-hazard-model.html#cb1468-44" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb1468-45"><a href="extending-the-discrete-time-hazard-model.html#cb1468-45" aria-hidden="true" tabindex="-1"></a>  mathdropout_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1468-46"><a href="extending-the-discrete-time-hazard-model.html#cb1468-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(female, period, hs11, hs12, coll1, coll2, coll3, fhs11, fhs12, fcoll1, fcoll2, fcoll3)</span>
<span id="cb1468-47"><a href="extending-the-discrete-time-hazard-model.html#cb1468-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1468-48"><a href="extending-the-discrete-time-hazard-model.html#cb1468-48" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1468-49"><a href="extending-the-discrete-time-hazard-model.html#cb1468-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_fitted</span>(fit12<span class="fl">.28</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-50"><a href="extending-the-discrete-time-hazard-model.html#cb1468-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">factor</span>(female,</span>
<span id="cb1468-51"><a href="extending-the-discrete-time-hazard-model.html#cb1468-51" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>,</span>
<span id="cb1468-52"><a href="extending-the-discrete-time-hazard-model.html#cb1468-52" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-53"><a href="extending-the-discrete-time-hazard-model.html#cb1468-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1468-54"><a href="extending-the-discrete-time-hazard-model.html#cb1468-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb1468-55"><a href="extending-the-discrete-time-hazard-model.html#cb1468-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb1468-56"><a href="extending-the-discrete-time-hazard-model.html#cb1468-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> female, <span class="at">color =</span> female)) <span class="sc">+</span></span>
<span id="cb1468-57"><a href="extending-the-discrete-time-hazard-model.html#cb1468-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1468-58"><a href="extending-the-discrete-time-hazard-model.html#cb1468-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1468-59"><a href="extending-the-discrete-time-hazard-model.html#cb1468-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1468-60"><a href="extending-the-discrete-time-hazard-model.html#cb1468-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;fitted logit(hazard)&quot;</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1468-61"><a href="extending-the-discrete-time-hazard-model.html#cb1468-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Model B: Completely general</span><span class="sc">\n</span><span class="st">interaction between female and time&quot;</span>)</span>
<span id="cb1468-62"><a href="extending-the-discrete-time-hazard-model.html#cb1468-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1468-63"><a href="extending-the-discrete-time-hazard-model.html#cb1468-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Model C: Interaction\nbetween female and time</span></span>
<span id="cb1468-64"><a href="extending-the-discrete-time-hazard-model.html#cb1468-64" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb1468-65"><a href="extending-the-discrete-time-hazard-model.html#cb1468-65" aria-hidden="true" tabindex="-1"></a>  mathdropout_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1468-66"><a href="extending-the-discrete-time-hazard-model.html#cb1468-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(female, period, hs11, hs12, coll1, coll2, coll3, fltime)</span>
<span id="cb1468-67"><a href="extending-the-discrete-time-hazard-model.html#cb1468-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1468-68"><a href="extending-the-discrete-time-hazard-model.html#cb1468-68" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1468-69"><a href="extending-the-discrete-time-hazard-model.html#cb1468-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_fitted</span>(fit12<span class="fl">.29</span>, <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-70"><a href="extending-the-discrete-time-hazard-model.html#cb1468-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">factor</span>(female,</span>
<span id="cb1468-71"><a href="extending-the-discrete-time-hazard-model.html#cb1468-71" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>,</span>
<span id="cb1468-72"><a href="extending-the-discrete-time-hazard-model.html#cb1468-72" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-73"><a href="extending-the-discrete-time-hazard-model.html#cb1468-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1468-74"><a href="extending-the-discrete-time-hazard-model.html#cb1468-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb1468-75"><a href="extending-the-discrete-time-hazard-model.html#cb1468-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb1468-76"><a href="extending-the-discrete-time-hazard-model.html#cb1468-76" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> female, <span class="at">color =</span> female)) <span class="sc">+</span></span>
<span id="cb1468-77"><a href="extending-the-discrete-time-hazard-model.html#cb1468-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1468-78"><a href="extending-the-discrete-time-hazard-model.html#cb1468-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1468-79"><a href="extending-the-discrete-time-hazard-model.html#cb1468-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1468-80"><a href="extending-the-discrete-time-hazard-model.html#cb1468-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;fitted logit(hazard)&quot;</span>, <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1468-81"><a href="extending-the-discrete-time-hazard-model.html#cb1468-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Model C: Interaction</span><span class="sc">\n</span><span class="st">between female and time&quot;</span>) </span></code></pre></div>
<p>Now combine the subplots, augment them in bulk, and return our version of Figure 12.8.</p>
<div class="sourceCode" id="cb1469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1469-1"><a href="extending-the-discrete-time-hazard-model.html#cb1469-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)) <span class="sc">&amp;</span></span>
<span id="cb1469-2"><a href="extending-the-discrete-time-hazard-model.html#cb1469-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb1469-3"><a href="extending-the-discrete-time-hazard-model.html#cb1469-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;term&quot;</span>, <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb1469-4"><a href="extending-the-discrete-time-hazard-model.html#cb1469-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;HS 11&quot;</span>, <span class="st">&quot;HS 12&quot;</span>, <span class="st">&quot;C 1&quot;</span>, <span class="st">&quot;C 2&quot;</span>, <span class="st">&quot;C 3&quot;</span>)) <span class="sc">&amp;</span></span>
<span id="cb1469-5"><a href="extending-the-discrete-time-hazard-model.html#cb1469-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.3</span>, <span class="dv">0</span>)) <span class="sc">&amp;</span></span>
<span id="cb1469-6"><a href="extending-the-discrete-time-hazard-model.html#cb1469-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-87-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Compute the information criteria for the three models. Since these were a bit faster to compute than for some of the earlier models in this chapter, we’ll go ahead and compute both the LOO and the WAIC.</p>
<div class="sourceCode" id="cb1470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1470-1"><a href="extending-the-discrete-time-hazard-model.html#cb1470-1" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.27</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.27</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1470-2"><a href="extending-the-discrete-time-hazard-model.html#cb1470-2" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.28</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.28</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb1470-3"><a href="extending-the-discrete-time-hazard-model.html#cb1470-3" aria-hidden="true" tabindex="-1"></a>fit12<span class="fl">.29</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit12<span class="fl">.29</span>, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span></code></pre></div>
<p>Now compare the models with information criteria differences and weights.</p>
<div class="sourceCode" id="cb1471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1471-1"><a href="extending-the-discrete-time-hazard-model.html#cb1471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.27</span>, fit12<span class="fl">.28</span>, fit12<span class="fl">.29</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_loo se_elpd_loo p_loo   se_p_loo looic   se_looic
## fit12.29     0.0       0.0 -4906.0     51.3         7.1     0.1   9811.9   102.5 
## fit12.27    -2.0       2.6 -4908.0     51.3         5.8     0.1   9816.0   102.6 
## fit12.28    -2.2       1.2 -4908.2     51.3        10.0     0.2   9816.4   102.7</code></pre>
<div class="sourceCode" id="cb1473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1473-1"><a href="extending-the-discrete-time-hazard-model.html#cb1473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit12<span class="fl">.27</span>, fit12<span class="fl">.28</span>, fit12<span class="fl">.29</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## fit12.29     0.0       0.0 -4906.0      51.3          7.1     0.1    9811.9   102.5
## fit12.27    -2.0       2.6 -4908.0      51.3          5.8     0.1    9816.0   102.6
## fit12.28    -2.2       1.2 -4908.2      51.3         10.0     0.2    9816.3   102.7</code></pre>
<div class="sourceCode" id="cb1475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1475-1"><a href="extending-the-discrete-time-hazard-model.html#cb1475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.27</span>, fit12<span class="fl">.28</span>, fit12<span class="fl">.29</span>, <span class="at">weights =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.27 fit12.28 fit12.29 
##    0.105    0.088    0.806</code></pre>
<div class="sourceCode" id="cb1477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1477-1"><a href="extending-the-discrete-time-hazard-model.html#cb1477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit12<span class="fl">.27</span>, fit12<span class="fl">.28</span>, fit12<span class="fl">.29</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit12.27 fit12.28 fit12.29 
##    0.105    0.089    0.806</code></pre>
<p>You’ll note both the LOO and WAIC estimates are very close to those displayed in Table 12.5. When we take their standard errors into account, <code>fit12.29</code> (Model C) is marginally better than the other two models. <code>fit12.29</code> also took most of the LOO and WAIC weights.</p>
<blockquote>
<p>How do we interpret the gender differential implied by Model C? Because we have centered <em>TIME</em> at 1, the coefficient for <em>FEMALE</em> (0.2275) estimates the differential in time period 1, which here is 11th grade. Antilogging yields 1.26, which leads us to estimate that in 11th grade, the odds of ending one’s mathematics course-taking career are 26% higher for females. (p. 460, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Let’s examine those results with our Bayesian fit.</p>
<div class="sourceCode" id="cb1479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1479-1"><a href="extending-the-discrete-time-hazard-model.html#cb1479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.29</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1479-2"><a href="extending-the-discrete-time-hazard-model.html#cb1479-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">log odds</span><span class="st">`</span> <span class="ot">=</span> b_female,</span>
<span id="cb1479-3"><a href="extending-the-discrete-time-hazard-model.html#cb1479-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">odds ratio</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_female)) <span class="sc">%&gt;%</span> </span>
<span id="cb1479-4"><a href="extending-the-discrete-time-hazard-model.html#cb1479-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">contains</span>(<span class="st">&quot;odds&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1479-5"><a href="extending-the-discrete-time-hazard-model.html#cb1479-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1479-6"><a href="extending-the-discrete-time-hazard-model.html#cb1479-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1479-7"><a href="extending-the-discrete-time-hazard-model.html#cb1479-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>), <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1479-8"><a href="extending-the-discrete-time-hazard-model.html#cb1479-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1479-9"><a href="extending-the-discrete-time-hazard-model.html#cb1479-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;the effects of female in two metrics&quot;</span>) <span class="sc">+</span></span>
<span id="cb1479-10"><a href="extending-the-discrete-time-hazard-model.html#cb1479-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1479-11"><a href="extending-the-discrete-time-hazard-model.html#cb1479-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-90-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now examine the odds ratio for three different educational periods.</p>
<div class="sourceCode" id="cb1480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1480-1"><a href="extending-the-discrete-time-hazard-model.html#cb1480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit12<span class="fl">.29</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1480-2"><a href="extending-the-discrete-time-hazard-model.html#cb1480-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">12th grade</span><span class="st">`</span>              <span class="ot">=</span> <span class="fu">exp</span>(b_female <span class="sc">+</span> b_fltime),</span>
<span id="cb1480-3"><a href="extending-the-discrete-time-hazard-model.html#cb1480-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">1st semester of college</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_female <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> b_fltime),</span>
<span id="cb1480-4"><a href="extending-the-discrete-time-hazard-model.html#cb1480-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">3rd semester of college</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_female <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> b_fltime)) <span class="sc">%&gt;%</span> </span>
<span id="cb1480-5"><a href="extending-the-discrete-time-hazard-model.html#cb1480-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">contains</span>(<span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1480-6"><a href="extending-the-discrete-time-hazard-model.html#cb1480-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1480-7"><a href="extending-the-discrete-time-hazard-model.html#cb1480-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1480-8"><a href="extending-the-discrete-time-hazard-model.html#cb1480-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>), <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1480-9"><a href="extending-the-discrete-time-hazard-model.html#cb1480-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1480-10"><a href="extending-the-discrete-time-hazard-model.html#cb1480-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;The interaction effect in different periods&quot;</span>,</span>
<span id="cb1480-11"><a href="extending-the-discrete-time-hazard-model.html#cb1480-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;odds ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb1480-12"><a href="extending-the-discrete-time-hazard-model.html#cb1480-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1480-13"><a href="extending-the-discrete-time-hazard-model.html#cb1480-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-91-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="the-no-unobserved-heterogeneity-assumption-no-simple-solution" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> The no unobserved heterogeneity assumption: No simple solution<a href="extending-the-discrete-time-hazard-model.html#the-no-unobserved-heterogeneity-assumption-no-simple-solution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>All the hazard models discussed in this book–both the discrete-time models we are discussing now and the continuous-time models we will soon introduce–impose an additional assumption to which we have alluded: the assumption of no unobserved heterogeneity. Every model assumes that the population hazard function for individual <span class="math inline">\(i\)</span> depends only on his or her predictor values. Any pair of individuals who share identical predictor profiles will have identical population functions….</p>
<p>Many data sets will not conform to this assumption. As in the multilevel model for change (and regular regression for that matter), pairs of individuals who share predictor profiles are very likely to have different outcomes….</p>
<p>Unobserved heterogeneity can have serious consequences. In their classic <span class="citation">(<a href="#ref-vaupel1985heterogeneity" role="doc-biblioref">1985</a>)</span> paper, Vaupel and Yaskin elegantly demonstrate what they call “heterogeneity’s ruses”–that ability of unobserved heterogeneity to create the misimpression that a hazard function follows a particular form, when in fact it may not….</p>
<p>Is it possible to fit a hazard model that accounts for unobserved heterogeneity? As you might expect, doing so requires that we have either additional data (for example, data on repeated events within individuals) or that we invoke other–perhaps less tenable–assumptions about the distribution of event time errors <span class="citation">(<a href="#ref-aalen1988heterogeneity" role="doc-biblioref">Aalen, 1988</a>; <a href="#ref-heckman1984longitudinal" role="doc-biblioref">Heckman &amp; Singer, 1984</a>; <a href="#ref-mare1994discrete" role="doc-biblioref">Mare, 1994</a>; <a href="#ref-scheike1997discrete" role="doc-biblioref">Scheike &amp; Jensen, 1997</a>; <a href="#ref-vaupel1979impact" role="doc-biblioref">Vaupel et al., 1979</a>)</span>. As a result, most empirical researchers–and we–proceed ahead, if not ignoring the problem, at least not addressing it. In the remainder of this book, we assume that all heterogeneity is observed and attributable to the predictors included in our models.</p>
</blockquote>
</div>
<div id="residual-analysis" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Residual analysis<a href="extending-the-discrete-time-hazard-model.html#residual-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Before concluding that your model is sound, you should ascertain how well it performs for individual cases. As in regular regression, we [can] address this question by examining residuals.</p>
<p>Residuals compare–usually through subtraction–an outcome’s “observed” value to its model-based “expected” value. For a discrete-time hazard model, a simple difference will not suffice because each person has not a single outcome but a set of outcomes–one for each time period when he or she was at risk. This suggests the need for a residual defined at the <em>person-period</em> level. A further complication is that the observed outcome in every time period has a value of either 0 or 1 while its expected value—the predicted hazard probability—lies between these extremes. (p. 463, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Starting on page 464, Singer and Willett illustrated a residual analysis using Model D from Table 11.3. In the last chapter, we called that <code>fit11.10</code>. Here it is, again.</p>
<div class="sourceCode" id="cb1481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1481-1"><a href="extending-the-discrete-time-hazard-model.html#cb1481-1" aria-hidden="true" tabindex="-1"></a>fit11<span class="fl">.10</span> <span class="ot">&lt;-</span></span>
<span id="cb1481-2"><a href="extending-the-discrete-time-hazard-model.html#cb1481-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> sex_pp,</span>
<span id="cb1481-3"><a href="extending-the-discrete-time-hazard-model.html#cb1481-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1481-4"><a href="extending-the-discrete-time-hazard-model.html#cb1481-4" aria-hidden="true" tabindex="-1"></a>      event <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> d7 <span class="sc">+</span> d8 <span class="sc">+</span> d9 <span class="sc">+</span> d10 <span class="sc">+</span> d11 <span class="sc">+</span> d12 <span class="sc">+</span> pt <span class="sc">+</span> pas,</span>
<span id="cb1481-5"><a href="extending-the-discrete-time-hazard-model.html#cb1481-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">class =</span> b),</span>
<span id="cb1481-6"><a href="extending-the-discrete-time-hazard-model.html#cb1481-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1481-7"><a href="extending-the-discrete-time-hazard-model.html#cb1481-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">11</span>,</span>
<span id="cb1481-8"><a href="extending-the-discrete-time-hazard-model.html#cb1481-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit11.10&quot;</span>)</span></code></pre></div>
<p>With <strong>brms</strong>, users can extract the residuals of a <code>brm()</code> fit with the <code>residuals()</code> function.</p>
<div class="sourceCode" id="cb1482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1482-1"><a href="extending-the-discrete-time-hazard-model.html#cb1482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit11<span class="fl">.10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1482-2"><a href="extending-the-discrete-time-hazard-model.html#cb1482-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code></pre></div>
<pre><code>##  num [1:822, 1:4] -0.0967 -0.0523 0.8177 -0.0837 -0.0445 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:4] &quot;Estimate&quot; &quot;Est.Error&quot; &quot;Q2.5&quot; &quot;Q97.5&quot;</code></pre>
<p>The output is similar to what we get from <code>fitted()</code>. We have a numeric array of 822 rows and 4 columns. There are 822 rows because that is the number of rows in the original data set with which we fit the model, <code>sex_pp</code>.</p>
<div class="sourceCode" id="cb1484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1484-1"><a href="extending-the-discrete-time-hazard-model.html#cb1484-1" aria-hidden="true" tabindex="-1"></a>sex_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1484-2"><a href="extending-the-discrete-time-hazard-model.html#cb1484-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 822
## Columns: 11
## $ id     &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 9, 9, …
## $ period &lt;dbl&gt; 7, 8, 9, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 12, 7, 8, 9, 10, 11, 7, 8…
## $ event  &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, …
## $ d7     &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, …
## $ d8     &lt;dbl&gt; 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, …
## $ d9     &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, …
## $ d10    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …
## $ d11    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, …
## $ d12    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ pt     &lt;dbl&gt; 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, …
## $ pas    &lt;dbl&gt; 1.9788670, 1.9788670, 1.9788670, -0.5454916, -0.5454916, -0.5454916, -0.5454916, -0.5454916, …</code></pre>
<p>Just as we often express the uncertainty in our Bayesian models with parameter summaries from the posterior, we also express the uncertainty of our residuals. Thus, the four columns returned by the <code>residuals()</code> function are the familiar summary columns of <code>Estimate</code>, <code>Est.Error</code>, <code>Q2.5</code>, and <code>Q97.5</code>. On page 465, Singer and Willett showcased the deviance residuals for eight participants. We’re going to diverge from them a little. In the plot, below, we’ll look at the residuals for the first 10 cases in the data, by <code>period</code>.</p>
<div class="sourceCode" id="cb1486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1486-1"><a href="extending-the-discrete-time-hazard-model.html#cb1486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit11<span class="fl">.10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1486-2"><a href="extending-the-discrete-time-hazard-model.html#cb1486-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1486-3"><a href="extending-the-discrete-time-hazard-model.html#cb1486-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sex_pp) <span class="sc">%&gt;%</span></span>
<span id="cb1486-4"><a href="extending-the-discrete-time-hazard-model.html#cb1486-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event  =</span> <span class="fu">factor</span>(event),</span>
<span id="cb1486-5"><a href="extending-the-discrete-time-hazard-model.html#cb1486-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">period =</span> <span class="fu">factor</span>(<span class="fu">str_c</span>(<span class="st">&quot;period &quot;</span>, period),</span>
<span id="cb1486-6"><a href="extending-the-discrete-time-hazard-model.html#cb1486-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">str_c</span>(<span class="st">&quot;period &quot;</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1486-7"><a href="extending-the-discrete-time-hazard-model.html#cb1486-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reduce the number of cases</span></span>
<span id="cb1486-8"><a href="extending-the-discrete-time-hazard-model.html#cb1486-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">&lt;</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1486-9"><a href="extending-the-discrete-time-hazard-model.html#cb1486-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1486-10"><a href="extending-the-discrete-time-hazard-model.html#cb1486-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>, <span class="at">color =</span> event)) <span class="sc">+</span></span>
<span id="cb1486-11"><a href="extending-the-discrete-time-hazard-model.html#cb1486-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1486-12"><a href="extending-the-discrete-time-hazard-model.html#cb1486-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1486-13"><a href="extending-the-discrete-time-hazard-model.html#cb1486-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb1486-14"><a href="extending-the-discrete-time-hazard-model.html#cb1486-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">labels =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="st">&quot;&quot;</span>, <span class="dv">10</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb1486-15"><a href="extending-the-discrete-time-hazard-model.html#cb1486-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;residual&quot;</span>) <span class="sc">+</span></span>
<span id="cb1486-16"><a href="extending-the-discrete-time-hazard-model.html#cb1486-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb1486-17"><a href="extending-the-discrete-time-hazard-model.html#cb1486-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1486-18"><a href="extending-the-discrete-time-hazard-model.html#cb1486-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> period, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-95-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>As is often the case in coefficient plots, the dots are the posterior means and the intersecting lines are the percentile-based 95% intervals. In the <code>sex_pp</code> data, the <code>event</code> variable encodes when participants experience the event within a given time range. Hopefully the color coding highlights how with hazard models, the residuals are always positive when the criterion variable is a 1 and always negative when the criterion is 0.</p>
<p>Now we have a bit of a handle on the output from <code>residuals()</code>, let’s plot in bulk.</p>
<div class="sourceCode" id="cb1487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1487-1"><a href="extending-the-discrete-time-hazard-model.html#cb1487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit11<span class="fl">.10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1487-2"><a href="extending-the-discrete-time-hazard-model.html#cb1487-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1487-3"><a href="extending-the-discrete-time-hazard-model.html#cb1487-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sex_pp) <span class="sc">%&gt;%</span> </span>
<span id="cb1487-4"><a href="extending-the-discrete-time-hazard-model.html#cb1487-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">factor</span>(event)) <span class="sc">%&gt;%</span> </span>
<span id="cb1487-5"><a href="extending-the-discrete-time-hazard-model.html#cb1487-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1487-6"><a href="extending-the-discrete-time-hazard-model.html#cb1487-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>, <span class="at">color =</span> event)) <span class="sc">+</span></span>
<span id="cb1487-7"><a href="extending-the-discrete-time-hazard-model.html#cb1487-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1487-8"><a href="extending-the-discrete-time-hazard-model.html#cb1487-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1487-9"><a href="extending-the-discrete-time-hazard-model.html#cb1487-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb1487-10"><a href="extending-the-discrete-time-hazard-model.html#cb1487-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;residual&quot;</span>) <span class="sc">+</span></span>
<span id="cb1487-11"><a href="extending-the-discrete-time-hazard-model.html#cb1487-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb1487-12"><a href="extending-the-discrete-time-hazard-model.html#cb1487-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-96-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This plot is our analogue to the top portion of Singer and Willett’s Figure 12.9. But whereas we plotted our residual summaries, they plotted the expected values of their <em>deviance residuals</em>. In contrast with the material on page 464, I am not going to discuss deviance residuals or the sums of the squared deviance residuals. Our <strong>brms</strong> workflow offers an alternative. Before we offer our alternative, we might focus on deviance residuals for just a moment:</p>
<blockquote>
<p>Deviance residuals are so named because, when squared, they represent an individual’s contribution to the deviance statistic for that time period. The sum of the squared deviance residuals across all the records in a person-period data set yields the deviance statistic for the specified model….</p>
<p>The absolute value of a deviance residual indicates how well the model fits that person’s data for that period. Large absolute values identify person-period records whose outcomes are poorly predicted. (p. 464)</p>
</blockquote>
<p>Back in Chapter 11, we computed the LOO for <code>fit11.10</code>. Let’s take a look at that.</p>
<div class="sourceCode" id="cb1488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1488-1"><a href="extending-the-discrete-time-hazard-model.html#cb1488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(fit11<span class="fl">.10</span>)</span></code></pre></div>
<pre><code>## 
## Computed from 4000 by 822 log-likelihood matrix
## 
##          Estimate   SE
## elpd_loo   -322.8 17.6
## p_loo         8.3  0.6
## looic       645.6 35.1
## ------
## Monte Carlo SE of elpd_loo is 0.0.
## 
## All Pareto k estimates are good (k &lt; 0.5).
## See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<p>Notice the part of the output that read “All Pareto k estimates are good (k &lt; 0.5).” We can pull those Pareto k estimates like so.</p>
<div class="sourceCode" id="cb1490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1490-1"><a href="extending-the-discrete-time-hazard-model.html#cb1490-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(fit11<span class="fl">.10</span>)<span class="sc">$</span>diagnostics <span class="sc">%&gt;%</span> </span>
<span id="cb1490-2"><a href="extending-the-discrete-time-hazard-model.html#cb1490-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1490-3"><a href="extending-the-discrete-time-hazard-model.html#cb1490-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 822
## Columns: 2
## $ pareto_k &lt;dbl&gt; 0.008061078, 0.085796089, 0.181442984, 0.138530329, -0.048113828, 0.003439661, -0.025045732…
## $ n_eff    &lt;dbl&gt; 2018.803, 2404.460, 1584.098, 5110.548, 5025.786, 5330.718, 5194.354, 4981.467, 4868.271, 4…</code></pre>
<p>We formatted the output for convenience. Notice there are 822 rows–one for each case in the data. Almost like a computational byproduct, <strong>brms</strong> returned <code>pareto_k</code> and <code>n_eff</code> values when we computed the LOO estimates for the model. Our focus will be on the <code>pareto_k</code> column. Here are those <code>pareto_k</code> values in a plot.</p>
<div class="sourceCode" id="cb1492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1492-1"><a href="extending-the-discrete-time-hazard-model.html#cb1492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(fit11<span class="fl">.10</span>)<span class="sc">$</span>diagnostics <span class="sc">%&gt;%</span> </span>
<span id="cb1492-2"><a href="extending-the-discrete-time-hazard-model.html#cb1492-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1492-3"><a href="extending-the-discrete-time-hazard-model.html#cb1492-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># attach the `id` values</span></span>
<span id="cb1492-4"><a href="extending-the-discrete-time-hazard-model.html#cb1492-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sex_pp) <span class="sc">%&gt;%</span> </span>
<span id="cb1492-5"><a href="extending-the-discrete-time-hazard-model.html#cb1492-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1492-6"><a href="extending-the-discrete-time-hazard-model.html#cb1492-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> pareto_k)) <span class="sc">+</span></span>
<span id="cb1492-7"><a href="extending-the-discrete-time-hazard-model.html#cb1492-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb1492-8"><a href="extending-the-discrete-time-hazard-model.html#cb1492-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pareto_k <span class="sc">&gt;</span> .<span class="dv">2</span>),</span>
<span id="cb1492-9"><a href="extending-the-discrete-time-hazard-model.html#cb1492-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> id <span class="sc">+</span> <span class="dv">2</span>, <span class="at">label =</span> id),</span>
<span id="cb1492-10"><a href="extending-the-discrete-time-hazard-model.html#cb1492-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1492-11"><a href="extending-the-discrete-time-hazard-model.html#cb1492-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12_files/figure-html/unnamed-chunk-99-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To learn the technical details about <code>pareto_k</code>, check out Vehtari, Gelman, and Gabry’s <span class="citation">(<a href="#ref-vehtariPracticalBayesianModel2017" role="doc-biblioref">2017</a>)</span> <a href="https://arxiv.org/abs/1507.04544"><em>Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC</em></a> or Vehtari, Simpson, Gelman, Yao, and Gabry’s <span class="citation">(<a href="#ref-vehtari2021pareto" role="doc-biblioref">2021</a>)</span> <a href="https://arxiv.org/abs/1507.02646"><em>Pareto smoothed importance sampling</em></a>. In short, we can use <code>pareto_k</code> values to flag cases that were overly-influential on the model in a way that’s a little like Singer and Willett’s deviance residuals. As pointed out in the <a href="https://CRAN.R-project.org/package=loo/loo.pdf"><strong>loo</strong> reference manual</a> <span class="citation">(<a href="#ref-loo2020RM" role="doc-biblioref">Gabry, 2020</a>)</span>, the makers of the <strong>loo</strong> package warn against <code>pareto_k</code> values when they get much larger than <span class="math inline">\(0.5\)</span>. We should be a little worried by values that exceed the <span class="math inline">\(0.7\)</span> threshold and it’s very likely a problem when they get larger than <span class="math inline">\(1\)</span>. In this case, they’re all below <span class="math inline">\(0.4\)</span> and all is good.</p>
<p>To learn more about <code>pareto_k</code> values and what the <strong>loo</strong> package can do for you, check out Vehtari and Gabry’s <span class="citation">(<a href="#ref-vehtariUsingLooPackage2020" role="doc-biblioref">2020</a>)</span> vignette, <a href="https://CRAN.R-project.org/package=loo/vignettes/loo2-example.html"><em>Using the loo package</em></a>.</p>
</div>
<div id="session-info-11" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="extending-the-discrete-time-hazard-model.html#session-info-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1493-1"><a href="extending-the-discrete-time-hazard-model.html#cb1493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.3.0 (2023-04-21)
## Platform: x86_64-apple-darwin20 (64-bit)
## Running under: macOS Monterey 12.4
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: America/Chicago
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidybayes_3.0.4 patchwork_1.1.2 brms_2.19.0     Rcpp_1.0.10     lubridate_1.9.2 forcats_1.0.0  
##  [7] stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1     readr_2.1.4     tidyr_1.3.0     tibble_3.2.1   
## [13] ggplot2_3.4.2   tidyverse_2.0.0
## 
## loaded via a namespace (and not attached):
##   [1] tensorA_0.36.2       rstudioapi_0.14      jsonlite_1.8.4       magrittr_2.0.3       TH.data_1.1-2       
##   [6] estimability_1.4.1   farver_2.1.1         nloptr_2.0.3         rmarkdown_2.21       vctrs_0.6.2         
##  [11] minqa_1.2.5          base64enc_0.1-3      htmltools_0.5.5      distributional_0.3.2 sass_0.4.6          
##  [16] StanHeaders_2.26.25  bslib_0.4.2          htmlwidgets_1.6.2    plyr_1.8.8           sandwich_3.0-2      
##  [21] emmeans_1.8.6        zoo_1.8-12           cachem_1.0.8         igraph_1.4.2         mime_0.12           
##  [26] lifecycle_1.0.3      pkgconfig_2.0.3      colourpicker_1.2.0   Matrix_1.5-4         R6_2.5.1            
##  [31] fastmap_1.1.1        shiny_1.7.4          digest_0.6.31        colorspace_2.1-0     ps_1.7.5            
##  [36] crosstalk_1.2.0      projpred_2.5.0       labeling_0.4.2       fansi_1.0.4          timechange_0.2.0    
##  [41] abind_1.4-5          mgcv_1.8-42          compiler_4.3.0       bit64_4.0.5          withr_2.5.0         
##  [46] backports_1.4.1      inline_0.3.19        shinystan_2.6.0      gamm4_0.2-6          pkgbuild_1.4.0      
##  [51] highr_0.10           MASS_7.3-58.4        gtools_3.9.4         loo_2.6.0            tools_4.3.0         
##  [56] httpuv_1.6.11        threejs_0.3.3        glue_1.6.2           callr_3.7.3          nlme_3.1-162        
##  [61] promises_1.2.0.1     grid_4.3.0           checkmate_2.2.0      reshape2_1.4.4       generics_0.1.3      
##  [66] gtable_0.3.3         tzdb_0.4.0           hms_1.1.3            utf8_1.2.3           ggdist_3.3.0        
##  [71] pillar_1.9.0         markdown_1.7         vroom_1.6.3          posterior_1.4.1      later_1.3.1         
##  [76] splines_4.3.0        lattice_0.21-8       survival_3.5-5       bit_4.0.5            tidyselect_1.2.0    
##  [81] miniUI_0.1.1.1       knitr_1.42           arrayhelpers_1.1-0   gridExtra_2.3        bookdown_0.34       
##  [86] stats4_4.3.0         xfun_0.39            bridgesampling_1.1-2 matrixStats_0.63.0   DT_0.27             
##  [91] rstan_2.21.8         stringi_1.7.12       boot_1.3-28.1        evaluate_0.21        codetools_0.2-19    
##  [96] cli_3.6.1            RcppParallel_5.1.7   shinythemes_1.2.0    xtable_1.8-4         munsell_0.5.0       
## [101] processx_3.8.1       jquerylib_0.1.4      coda_0.19-4          svUnit_1.0.6         parallel_4.3.0      
## [106] rstantools_2.3.1     ellipsis_0.3.2       prettyunits_1.1.1    dygraphs_1.1.1.6     bayesplot_1.10.0    
## [111] Brobdingnag_1.2-9    lme4_1.1-33          viridisLite_0.4.2    mvtnorm_1.1-3        scales_1.2.1        
## [116] xts_0.13.1           crayon_1.5.2         rlang_1.1.1          multcomp_1.4-23      shinyjs_2.1.0</code></pre>
</div>
<div id="footnote-2" class="section level2 unnumbered hasAnchor">
<h2>Footnote<a href="extending-the-discrete-time-hazard-model.html#footnote-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-aalen1988heterogeneity" class="csl-entry">
Aalen, O. O. (1988). Heterogeneity in survival analysis. <em>Statistics in Medicine</em>, <em>7</em>(11), 1121–1137. <a href="https://doi.org/10.1002/sim.4780071105">https://doi.org/10.1002/sim.4780071105</a>
</div>
<div id="ref-beckModellingSpaceTime1999" class="csl-entry">
Beck, N. (1999). Modelling space and time: <span>The</span> event history approach. In E. Scarbrough &amp; E. Tanenbaum (Eds.), <em>Research strategies in social science: <span>A</span> guide to new approaches</em>. <span>Oxford University Press</span>. <a href="https://doi.org/10.1093/0198292376.001.0001">https://doi.org/10.1093/0198292376.001.0001</a>
</div>
<div id="ref-beck1998taking" class="csl-entry">
Beck, Nathaniel, Katz, J. N., &amp; Tucker, R. (1998). Taking time seriously: <span class="nocase">Time-series-cross-section</span> analysis with a binary dependent variable. <em>American Journal of Political Science</em>, <em>42</em>(4), 1260–1288. <a href="https://doi.org/10.2307/2991857">https://doi.org/10.2307/2991857</a>
</div>
<div id="ref-loo2020RM" class="csl-entry">
Gabry, J. (2020). <em><span class="nocase">loo</span> reference manual, <span>Version</span> 2.4.1</em>. <a href="https://CRAN.R-project.org/package=loo/loo.pdf">https://CRAN.R-project.org/package=loo/loo.pdf</a>
</div>
<div id="ref-gamseEvaluationSpencerPostdoctoral1997" class="csl-entry">
Gamse, B. C., &amp; Conger, D. (1997). <em>An evaluation of the <span>Spencer</span> post-doctoral dissertation program</em>. <span>Abt Associates</span>.
</div>
<div id="ref-graham1997exodus" class="csl-entry">
Graham, S. E. (1997). <em>The exodus from mathematics: <span>When</span> and why?</em> [PhD thesis]. Harvard Graduate School of Education.
</div>
<div id="ref-heckman1984longitudinal" class="csl-entry">
Heckman, J., &amp; Singer, B. S. (Eds.). (1984). <em>Longitudinal analysis of labor market data</em>. <span>Cambridge University Press</span>. <a href="https://doi.org/10.1017/CCOL0521304539">https://doi.org/10.1017/CCOL0521304539</a>
</div>
<div id="ref-keileyChildAbuseNeglect2002" class="csl-entry">
Keiley, M. K., &amp; Martin, N. C. (2002). <em>Child abuse, neglect, and juvenile delinquency: <span>How</span> <span>“new”</span> statistical approaches can inform our understanding of <span>“old”</span> questions reanalysis of <span>Widom</span>, 1989</em> [Manuscript Submitted for Publication].
</div>
<div id="ref-mare1994discrete" class="csl-entry">
Mare, R. D. (1994). Discrete-time bivariate hazards with unobserved heterogeneity: <span>A</span> partially observed contingency table approach. <em>Sociological Methodology</em>, 341–383. <a href="https://doi.org/10.2307/270987">https://doi.org/10.2307/270987</a>
</div>
<div id="ref-scheike1997discrete" class="csl-entry">
Scheike, T. H., &amp; Jensen, T. K. (1997). A discrete survival model with random effects: An application to time to pregnancy. <em>Biometrics</em>, 318–329. <a href="https://doi.org/10.2307/2533117">https://doi.org/10.2307/2533117</a>
</div>
<div id="ref-singerAppliedLongitudinalData2003" class="csl-entry">
Singer, J. D., &amp; Willett, J. B. (2003). <em>Applied longitudinal data analysis: <span>Modeling</span> change and event occurrence</em>. <span>Oxford University Press, USA</span>. <a href="https://oxford.universitypressscholarship.com/view/10.1093/acprof:oso/9780195152968.001.0001/acprof-9780195152968">https://oxford.universitypressscholarship.com/view/10.1093/acprof:oso/9780195152968.001.0001/acprof-9780195152968</a>
</div>
<div id="ref-sueyoshi1995class" class="csl-entry">
Sueyoshi, G. T. (1995). A class of binary response models for grouped duration data. <em>Journal of Applied Econometrics</em>, <em>10</em>(4), 411–431. <a href="https://doi.org/10.1002/jae.3950100406">https://doi.org/10.1002/jae.3950100406</a>
</div>
<div id="ref-vaupel1979impact" class="csl-entry">
Vaupel, J. W., Manton, K. G., &amp; Stallard, E. (1979). The impact of heterogeneity in individual frailty on the dynamics of mortality. <em>Demography</em>, <em>16</em>(3), 439–454. <a href="https://doi.org/10.2307/2061224">https://doi.org/10.2307/2061224</a>
</div>
<div id="ref-vaupel1985heterogeneity" class="csl-entry">
Vaupel, J. W., &amp; Yashin, A. I. (1985). Heterogeneity’s ruses: <span>Some</span> surprising effects of selection on population dynamics. <em>The American Statistician</em>, <em>39</em>(3), 176–185. <a href="https://doi.org/10.1080/00031305.1985.10479424">https://doi.org/10.1080/00031305.1985.10479424</a>
</div>
<div id="ref-vehtariUsingLooPackage2020" class="csl-entry">
Vehtari, A., &amp; Gabry, J. (2020). <em>Using the loo package (version <span><span class="math inline">\(&gt;\)</span></span>= 2.0.0)</em>. <a href="https://CRAN.R-project.org/package=loo/vignettes/loo2-example.html">https://CRAN.R-project.org/package=loo/vignettes/loo2-example.html</a>
</div>
<div id="ref-vehtariPracticalBayesianModel2017" class="csl-entry">
Vehtari, A., Gelman, A., &amp; Gabry, J. (2017). Practical <span>Bayesian</span> model evaluation using leave-one-out cross-validation and <span>WAIC</span>. <em>Statistics and Computing</em>, <em>27</em>(5), 1413–1432. <a href="https://doi.org/10.1007/s11222-016-9696-4">https://doi.org/10.1007/s11222-016-9696-4</a>
</div>
<div id="ref-vehtari2021pareto" class="csl-entry">
Vehtari, A., Simpson, D., Gelman, A., Yao, Y., &amp; Gabry, J. (2021). <em>Pareto smoothed importance sampling</em>. <a href="https://arxiv.org/abs/1507.02646">https://arxiv.org/abs/1507.02646</a>
</div>
<div id="ref-wheaton1997impact" class="csl-entry">
Wheaton, B., Roszell, P., &amp; Hall, K. (1997). The impact of twenty childhood and adult traumatic stressors on the risk of psychiatric disorder. In I. H. Gotlib &amp; B. Wheaton (Eds.), <em>Stress and adversity over the life course: <span>Trajectories</span> and turning points</em> (pp. 50–72). <span>Cambridge University Press</span>. <a href="https://doi.org/10.1017/CBO9780511527623">https://doi.org/10.1017/CBO9780511527623</a>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>In their reference section, Singer and Willett indicated this was a manuscript submitted for publication. To my knowledge, it was never published.<a href="extending-the-discrete-time-hazard-model.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fitting-basic-discrete-time-hazard-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="describing-continuous-time-event-occurrence-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
