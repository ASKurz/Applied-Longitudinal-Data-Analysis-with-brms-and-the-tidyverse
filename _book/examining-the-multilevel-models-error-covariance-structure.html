<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Examining the Multilevel Model’s Error Covariance Structure | Applied longitudinal data analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Examining the Multilevel Model’s Error Covariance Structure | Applied longitudinal data analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  <meta name="github-repo" content="ASKurz/Applied-Longitudinal-Data-Analysis-with-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Examining the Multilevel Model’s Error Covariance Structure | Applied longitudinal data analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is a reworking of Singer and Willett’s classic (2003) text within a contemporary Bayesian framework with emphasis of the brms and tidyverse packages within the R computational framework." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2023-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modeling-discontinuous-and-nonlinear-change.html"/>
<link rel="next" href="modeling-change-using-covariance-structure-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html"><i class="fa fa-check"></i><b>1</b> A Framework for Investigating Change over Time</a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#when-might-you-study-change-over-time"><i class="fa fa-check"></i><b>1.1</b> When might you study change over time?</a></li>
<li class="chapter" data-level="1.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#distinguishing-between-two-types-of-questions-about-change"><i class="fa fa-check"></i><b>1.2</b> Distinguishing between two types of questions about change</a></li>
<li class="chapter" data-level="1.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#three-important-features-of-a-study-of-change"><i class="fa fa-check"></i><b>1.3</b> Three important features of a study of change</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#multiple-waves-of-data."><i class="fa fa-check"></i><b>1.3.1</b> Multiple waves of data.</a></li>
<li class="chapter" data-level="1.3.2" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-sensible-metric-for-time."><i class="fa fa-check"></i><b>1.3.2</b> A sensible metric for time.</a></li>
<li class="chapter" data-level="1.3.3" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#a-continuous-outcome-that-changes-systematically-over-time."><i class="fa fa-check"></i><b>1.3.3</b> A continuous outcome that changes systematically over time.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-change-over-time.html"><a href="a-framework-for-investigating-change-over-time.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html"><i class="fa fa-check"></i><b>2</b> Exploring Longitudinal Data on Change</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#creating-a-longitudinal-data-set"><i class="fa fa-check"></i><b>2.1</b> Creating a longitudinal data set</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-level-data-set."><i class="fa fa-check"></i><b>2.1.1</b> The person-level data set.</a></li>
<li class="chapter" data-level="2.1.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#the-person-period-data-set."><i class="fa fa-check"></i><b>2.1.2</b> The person-period data set.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#descriptive-analysis-of-individual-change-over-time"><i class="fa fa-check"></i><b>2.2</b> Descriptive analysis of individual change over time</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#empirical-growth-plots."><i class="fa fa-check"></i><b>2.2.1</b> Empirical growth plots.</a></li>
<li class="chapter" data-level="2.2.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-a-trajectory-to-summarize-each-persons-empirical-growth-record."><i class="fa fa-check"></i><b>2.2.2</b> Using a trajectory to summarize each person’s empirical growth record.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-differences-in-change-across-people"><i class="fa fa-check"></i><b>2.3</b> Exploring differences in change across people</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#examining-the-entire-set-of-smooth-trajectories."><i class="fa fa-check"></i><b>2.3.1</b> Examining the entire set of smooth trajectories.</a></li>
<li class="chapter" data-level="2.3.2" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#using-the-results-of-model-fitting-to-frame-questions-about-change."><i class="fa fa-check"></i><b>2.3.2</b> Using the results of model fitting to frame questions about change.</a></li>
<li class="chapter" data-level="2.3.3" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#exploring-the-relationship-between-change-and-time-invariant-predictors."><i class="fa fa-check"></i><b>2.3.3</b> Exploring the relationship between change and time-invariant predictors.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#improving-the-precision-and-reliability-of-ols-single-level-bayesian-estimated-rates-of-change-lessons-for-research-design"><i class="fa fa-check"></i><b>2.4</b> Improving the precision and reliability of <del>OLS</del> single-level-Bayesian-estimated rates of change: Lessons for research design</a></li>
<li class="chapter" data-level="" data-path="exploring-longitudinal-data-on-change.html"><a href="exploring-longitudinal-data-on-change.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>3</b> Introducing the Multilevel Model for Change</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#what-is-the-purpose-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>3.1</b> What is the purpose of the multilevel model for change?</a></li>
<li class="chapter" data-level="3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-1-submodel-for-individual-change"><i class="fa fa-check"></i><b>3.2</b> The level-1 submodel for individual change</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-structural-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.1</b> The structural part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-stochastic-part-of-the-level-1-submodel."><i class="fa fa-check"></i><b>3.2.2</b> The stochastic part of the level-1 submodel.</a></li>
<li class="chapter" data-level="3.2.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#relating-the-level-1-submodel-to-the-ols-exploratory-methods-of-chapter-2."><i class="fa fa-check"></i><b>3.2.3</b> Relating the level-1 submodel to the OLS exploratory methods of chapter 2.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-level-2-submodel-for-systematic-interindividual-differences-in-change"><i class="fa fa-check"></i><b>3.3</b> The level-2 submodel for systematic interindividual differences in change</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#structural-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.1</b> Structural components of the level-2 submodel.</a></li>
<li class="chapter" data-level="3.3.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#stochastic-components-of-the-level-2-submodel."><i class="fa fa-check"></i><b>3.3.2</b> Stochastic components of the level-2 submodel.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#fitting-the-multilevel-model-for-change-to-data"><i class="fa fa-check"></i><b>3.4</b> Fitting the multilevel model for change to data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#the-advantages-of-maximum-likelihood-bayesian-estimation."><i class="fa fa-check"></i><b>3.4.1</b> The advantages of <del>maximum likelihood</del> Bayesian estimation.</a></li>
<li class="chapter" data-level="3.4.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#using-maximum-likelihood-modern-bayesian-methods-to-fit-a-multilevel-model."><i class="fa fa-check"></i><b>3.4.2</b> Using <del>maximum likelihood</del> modern Bayesian methods to fit a multilevel model.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-fixed-effects"><i class="fa fa-check"></i><b>3.5</b> Examining estimated fixed effects</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-estimated-fixed-effects."><i class="fa fa-check"></i><b>3.5.1</b> Interpreting estimated fixed effects.</a></li>
<li class="chapter" data-level="3.5.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-fixed-effects."><i class="fa fa-check"></i><b>3.5.2</b> Single parameter tests for the fixed effects.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#examining-estimated-variance-components"><i class="fa fa-check"></i><b>3.6</b> Examining estimated variance components</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#interpreting-the-estimated-variance-components."><i class="fa fa-check"></i><b>3.6.1</b> Interpreting the estimated variance components.</a></li>
<li class="chapter" data-level="3.6.2" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#single-parameter-tests-for-the-variance-components."><i class="fa fa-check"></i><b>3.6.2</b> Single parameter tests for the variance components.</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#bonus-how-did-you-simulate-that-data"><i class="fa fa-check"></i><b>3.7</b> Bonus: How did you simulate that data?</a></li>
<li class="chapter" data-level="" data-path="introducing-the-multilevel-model-for-change.html"><a href="introducing-the-multilevel-model-for-change.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html"><i class="fa fa-check"></i><b>4</b> Doing Data Analysis with the Multilevel Model for Change</a>
<ul>
<li class="chapter" data-level="4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#example-changes-in-adolescent-alcohol-use"><i class="fa fa-check"></i><b>4.1</b> Example: Changes in adolescent alcohol use</a></li>
<li class="chapter" data-level="4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-composite-specification-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>4.2</b> The composite specification of the multilevel model for change</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-structural-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.1</b> The structural component of the composite model.</a></li>
<li class="chapter" data-level="4.2.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-stochastic-component-of-the-composite-model."><i class="fa fa-check"></i><b>4.2.2</b> The stochastic component of the composite model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#methods-of-estimation-revisited"><i class="fa fa-check"></i><b>4.3</b> Methods of estimation, revisited</a></li>
<li class="chapter" data-level="4.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#first-steps-fitting-two-unconditional-multilevel-models-for-change"><i class="fa fa-check"></i><b>4.4</b> First steps: Fitting two unconditional multilevel models for change</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-means-model."><i class="fa fa-check"></i><b>4.4.1</b> The unconditional means model.</a></li>
<li class="chapter" data-level="4.4.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-unconditional-growth-model."><i class="fa fa-check"></i><b>4.4.2</b> The unconditional growth model.</a></li>
<li class="chapter" data-level="4.4.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#quantifying-the-proportion-of-outcome-variation-explained."><i class="fa fa-check"></i><b>4.4.3</b> Quantifying the proportion of outcome variation “explained.”</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#practical-data-analytic-strategies-for-model-building"><i class="fa fa-check"></i><b>4.5</b> Practical data analytic strategies for model building</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#a-taxonomy-of-statistical-models."><i class="fa fa-check"></i><b>4.5.1</b> A taxonomy of statistical models.</a></li>
<li class="chapter" data-level="4.5.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#interpreting-fitted-models."><i class="fa fa-check"></i><b>4.5.2</b> Interpreting fitted models.</a></li>
<li class="chapter" data-level="4.5.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#displaying-prototypical-change-trajectories."><i class="fa fa-check"></i><b>4.5.3</b> Displaying prototypical change trajectories.</a></li>
<li class="chapter" data-level="4.5.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#recentering-predictors-to-improve-interpretation."><i class="fa fa-check"></i><b>4.5.4</b> Recentering predictors to improve interpretation.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#comparing-models-using-deviance-statistics"><i class="fa fa-check"></i><b>4.6</b> Comparing models using deviance statistics</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#the-deviance-statistic."><i class="fa fa-check"></i><b>4.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="4.6.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#when-and-how-can-you-compare-deviance-statistics"><i class="fa fa-check"></i><b>4.6.2</b> When and how can you compare deviance statistics?</a></li>
<li class="chapter" data-level="4.6.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#implementing-deviance-based-hypothesis-tests."><i class="fa fa-check"></i><b>4.6.3</b> Implementing deviance-based hypothesis tests.</a></li>
<li class="chapter" data-level="4.6.4" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#aic-and-bic-waic-and-loo-statistics-comparing-nonnested-models-using-information-criteria-and-cross-validation."><i class="fa fa-check"></i><b>4.6.4</b> <del>AIC and BIC</del> WAIC and LOO statistics: Comparing nonnested models using information criteria [and cross validation].</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#using-wald-statistics-to-test-composite-hypotheses-about-fixed-effects"><i class="fa fa-check"></i><b>4.7</b> Using Wald statistics to test composite hypotheses about fixed effects</a></li>
<li class="chapter" data-level="4.8" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#evaluating-the-tenability-of-a-models-assumptions"><i class="fa fa-check"></i><b>4.8</b> Evaluating the tenability of a model’s assumptions</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-functional-form."><i class="fa fa-check"></i><b>4.8.1</b> Checking functional form.</a></li>
<li class="chapter" data-level="4.8.2" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-normality."><i class="fa fa-check"></i><b>4.8.2</b> Checking normality.</a></li>
<li class="chapter" data-level="4.8.3" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#checking-homoscedasticity."><i class="fa fa-check"></i><b>4.8.3</b> Checking homoscedasticity.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#model-based-empirical-bayes-estimates-of-the-individual-growth-parameters"><i class="fa fa-check"></i><b>4.9</b> Model-based (Empirical Bayes) estimates of the individual growth parameters</a></li>
<li class="chapter" data-level="" data-path="doing-data-analysis-with-the-multilevel-model-for-change.html"><a href="doing-data-analysis-with-the-multilevel-model-for-change.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html"><i class="fa fa-check"></i><b>5</b> Treating Time More Flexibly</a>
<ul>
<li class="chapter" data-level="5.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#variably-spaced-measurement-occasions"><i class="fa fa-check"></i><b>5.1</b> Variably spaced measurement occasions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#the-structure-of-variably-spaced-data-sets."><i class="fa fa-check"></i><b>5.1.1</b> The structure of variably spaced data sets.</a></li>
<li class="chapter" data-level="5.1.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#postulating-and-fitting-multilevel-models-with-variably-spaced-waves-of-data."><i class="fa fa-check"></i><b>5.1.2</b> Postulating and fitting multilevel models with variably spaced waves of data.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#varying-numbers-of-measurement-occasions"><i class="fa fa-check"></i><b>5.2</b> Varying numbers of measurement occasions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#analyzing-data-sets-in-which-the-number-of-waves-per-person-varies."><i class="fa fa-check"></i><b>5.2.1</b> Analyzing data sets in which the number of waves per person varies.</a></li>
<li class="chapter" data-level="5.2.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#practical-problems-that-may-arise-when-analyzing-unbalanced-data-sets."><i class="fa fa-check"></i><b>5.2.2</b> Practical problems that may arise when analyzing unbalanced data sets.</a></li>
<li class="chapter" data-level="5.2.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#distinguishing-among-different-types-of-missingness."><i class="fa fa-check"></i><b>5.2.3</b> Distinguishing among different types of missingness.</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#time-varying-predictors"><i class="fa fa-check"></i><b>5.3</b> Time-varying predictors</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#including-the-main-effect-of-a-time-varying-predictor."><i class="fa fa-check"></i><b>5.3.1</b> Including the main effect of a time-varying predictor.</a></li>
<li class="chapter" data-level="5.3.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#allowing-the-effect-of-a-time-varying-predictor-to-vary-over-time."><i class="fa fa-check"></i><b>5.3.2</b> Allowing the effect of a time-varying predictor to vary over time.</a></li>
<li class="chapter" data-level="5.3.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-time-varying-predictors."><i class="fa fa-check"></i><b>5.3.3</b> Recentering time-varying predictors.</a></li>
<li class="chapter" data-level="5.3.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#an-important-caveat-the-problem-of-reciprocal-causation."><i class="fa fa-check"></i><b>5.3.4</b> An important caveat: The problem of reciprocal causation.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#recentering-the-effect-of-time"><i class="fa fa-check"></i><b>5.4</b> Recentering the effect of <em>TIME</em></a></li>
<li class="chapter" data-level="" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html"><i class="fa fa-check"></i><b>6</b> Modeling Discontinuous and Nonlinear Change</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#discontinuous-individual-change"><i class="fa fa-check"></i><b>6.1</b> Discontinuous individual change</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#alternative-discontinuous-level-1-models-for-change."><i class="fa fa-check"></i><b>6.1.1</b> Alternative discontinuous level-1 models for change.</a></li>
<li class="chapter" data-level="6.1.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#selecting-among-the-alternative-discontinuous-models."><i class="fa fa-check"></i><b>6.1.2</b> Selecting among the alternative discontinuous models.</a></li>
<li class="chapter" data-level="6.1.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#further-extensions-of-the-discontinuous-growth-model."><i class="fa fa-check"></i><b>6.1.3</b> Further extensions of the discontinuous growth model.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#using-transformations-to-model-nonlinear-individual-change"><i class="fa fa-check"></i><b>6.2</b> Using transformations to model nonlinear individual change</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-ladder-of-transformations-and-the-rule-of-the-bulge."><i class="fa fa-check"></i><b>6.2.1</b> The ladder of transformations and the rule of the bulge.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#representing-individual-change-using-a-polynomial-function-of-time"><i class="fa fa-check"></i><b>6.3</b> Representing individual change using a polynomial function of TIME</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-shapes-of-polynomial-individual-change-trajectories."><i class="fa fa-check"></i><b>6.3.1</b> The shapes of polynomial individual change trajectories.</a></li>
<li class="chapter" data-level="6.3.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#selecting-a-suitable-level-1-polynomial-trajectory-for-change."><i class="fa fa-check"></i><b>6.3.2</b> Selecting a suitable level-1 polynomial trajectory for change.</a></li>
<li class="chapter" data-level="6.3.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#testing-higher-order-terms-in-a-polynomial-level-1-model."><i class="fa fa-check"></i><b>6.3.3</b> Testing higher order terms in a polynomial level-1 model.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#truly-nonlinear-trajectories"><i class="fa fa-check"></i><b>6.4</b> Truly nonlinear trajectories</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#what-do-we-mean-by-truly-nonlinear-models"><i class="fa fa-check"></i><b>6.4.1</b> What do we mean by truly nonlinear models?</a></li>
<li class="chapter" data-level="6.4.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#the-logistic-individual-growth-curve."><i class="fa fa-check"></i><b>6.4.2</b> The logistic individual growth curve.</a></li>
<li class="chapter" data-level="6.4.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#a-survey-of-truly-nonlinear-change-trajectories."><i class="fa fa-check"></i><b>6.4.3</b> A survey of truly nonlinear change trajectories.</a></li>
<li class="chapter" data-level="6.4.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#from-substantive-theory-to-mathematical-representations-of-individual-growth."><i class="fa fa-check"></i><b>6.4.4</b> From substantive theory to mathematical representations of individual growth.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#bonus-the-logistic-growth-model"><i class="fa fa-check"></i><b>6.5</b> Bonus: The logistic growth model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#we-need-data."><i class="fa fa-check"></i><b>6.5.1</b> We need data.</a></li>
<li class="chapter" data-level="6.5.2" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#have-you-heard-of-the-generalized-linear-mixed-model"><i class="fa fa-check"></i><b>6.5.2</b> Have you heard of the generalized linear [mixed] model?</a></li>
<li class="chapter" data-level="6.5.3" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#define-the-simple-logistic-multilevel-growth-model."><i class="fa fa-check"></i><b>6.5.3</b> Define the simple logistic multilevel growth model.</a></li>
<li class="chapter" data-level="6.5.4" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#ease-into-the-model-with-a-prior-predictive-check."><i class="fa fa-check"></i><b>6.5.4</b> Ease into the model with a prior predictive check.</a></li>
<li class="chapter" data-level="6.5.5" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#you-may-want-more."><i class="fa fa-check"></i><b>6.5.5</b> You may want more.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="modeling-discontinuous-and-nonlinear-change.html"><a href="modeling-discontinuous-and-nonlinear-change.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html"><i class="fa fa-check"></i><b>7</b> Examining the Multilevel Model’s Error Covariance Structure</a>
<ul>
<li class="chapter" data-level="7.1" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#the-standard-specification-of-the-multilevel-model-for-change"><i class="fa fa-check"></i><b>7.1</b> The “standard” specification of the multilevel model for change</a></li>
<li class="chapter" data-level="7.2" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#using-the-composite-model-to-understand-assumptions-about-the-error-covariance-matrix"><i class="fa fa-check"></i><b>7.2</b> Using the composite model to understand assumptions about the error covariance matrix</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#variance-of-the-composite-residual."><i class="fa fa-check"></i><b>7.2.1</b> Variance of the composite residual.</a></li>
<li class="chapter" data-level="7.2.2" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#covariance-of-the-composite-residuals."><i class="fa fa-check"></i><b>7.2.2</b> Covariance of the composite residuals.</a></li>
<li class="chapter" data-level="7.2.3" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#autocorrelation-of-the-composite-residuals."><i class="fa fa-check"></i><b>7.2.3</b> Autocorrelation of the composite residuals.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#postulating-an-alternative-error-covariance-structure"><i class="fa fa-check"></i><b>7.3</b> Postulating an alternative error covariance structure</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#unstructured-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.1</b> Unstructured error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.2" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#compound-symmetric-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.2</b> Compound symmetric error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.3" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#heterogeneous-compound-symmetric-error-covariance-matrix-."><i class="fa fa-check"></i><b>7.3.3</b> Heterogeneous compound symmetric error covariance matrix .</a></li>
<li class="chapter" data-level="7.3.4" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#autoregressive-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.4</b> Autoregressive error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.5" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#heterogeneous-autoregressive-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.5</b> Heterogeneous autoregressive error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.6" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#toeplitz-error-covariance-matrix."><i class="fa fa-check"></i><b>7.3.6</b> Toeplitz error covariance matrix.</a></li>
<li class="chapter" data-level="7.3.7" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#does-choosing-the-correct-error-covariance-structure-really-matter"><i class="fa fa-check"></i><b>7.3.7</b> Does choosing the “correct” error covariance structure really matter?</a></li>
<li class="chapter" data-level="7.3.8" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#bonus-did-we-trade-multilevel-for-multivariate"><i class="fa fa-check"></i><b>7.3.8</b> Bonus: Did we trade multilevel for multivariate?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="examining-the-multilevel-models-error-covariance-structure.html"><a href="examining-the-multilevel-models-error-covariance-structure.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html"><i class="fa fa-check"></i><b>8</b> Modeling Change Using Covariance Structure Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="modeling-change-using-covariance-structure-analysis.html"><a href="modeling-change-using-covariance-structure-analysis.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html"><i class="fa fa-check"></i><b>9</b> A Framework for Investigating Event Occurrence</a>
<ul>
<li class="chapter" data-level="9.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#should-you-conduct-a-survival-analysis-the-whether-and-when-test"><i class="fa fa-check"></i><b>9.1</b> Should you conduct a survival analysis? The “whether” and “when” test</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#time-to-relapse-among-recently-treated-alcoholics."><i class="fa fa-check"></i><b>9.1.1</b> Time to relapse among recently treated alcoholics.</a></li>
<li class="chapter" data-level="9.1.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#length-of-stay-in-teaching."><i class="fa fa-check"></i><b>9.1.2</b> Length of stay in teaching.</a></li>
<li class="chapter" data-level="9.1.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#age-at-first-suicide-ideation."><i class="fa fa-check"></i><b>9.1.3</b> Age at first suicide ideation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#framing-a-research-question-about-event-occurrence"><i class="fa fa-check"></i><b>9.2</b> Framing a research question about event occurrence</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#defining-event-occurrence."><i class="fa fa-check"></i><b>9.2.1</b> Defining event occurrence.</a></li>
<li class="chapter" data-level="9.2.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#identifying-the-beginning-of-time."><i class="fa fa-check"></i><b>9.2.2</b> Identifying the “beginning of time.”</a></li>
<li class="chapter" data-level="9.2.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#specifying-a-metric-for-time."><i class="fa fa-check"></i><b>9.2.3</b> Specifying a metric for time.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#censoring-how-complete-are-the-data-on-event-occurrence"><i class="fa fa-check"></i><b>9.3</b> Censoring: How complete are the data on event occurrence?</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-and-why-does-censoring-arise"><i class="fa fa-check"></i><b>9.3.1</b> How and why does censoring arise?</a></li>
<li class="chapter" data-level="9.3.2" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#different-types-of-censoring."><i class="fa fa-check"></i><b>9.3.2</b> Different types of censoring.</a></li>
<li class="chapter" data-level="9.3.3" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#how-does-censoring-affect-statistical-analysis"><i class="fa fa-check"></i><b>9.3.3</b> How does censoring affect statistical analysis?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="a-framework-for-investigating-event-occurrence.html"><a href="a-framework-for-investigating-event-occurrence.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html"><i class="fa fa-check"></i><b>10</b> Describing Discrete-Time Event Occurrence Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-life-table"><i class="fa fa-check"></i><b>10.1</b> The life table</a></li>
<li class="chapter" data-level="10.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-framework-for-characterizing-the-distribution-of-discrete-time-event-occurrence-data"><i class="fa fa-check"></i><b>10.2</b> A framework for characterizing the distribution of discrete-time event occurrence data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-function."><i class="fa fa-check"></i><b>10.2.1</b> Survivor function.</a></li>
<li class="chapter" data-level="10.2.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#median-lifetime."><i class="fa fa-check"></i><b>10.2.2</b> Median lifetime.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#developing-intuition-about-hazard-functions-survivor-functions-and-median-lifetimes"><i class="fa fa-check"></i><b>10.3</b> Developing intuition about hazard functions, survivor functions, and median lifetimes</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#identifying-periods-of-high-and-low-risk-using-hazard-functions."><i class="fa fa-check"></i><b>10.3.1</b> Identifying periods of high and low risk using hazard functions.</a></li>
<li class="chapter" data-level="10.3.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#survivor-functions-as-a-context-for-evaluating-the-magnitude-of-hazard."><i class="fa fa-check"></i><b>10.3.2</b> Survivor functions as a context for evaluating the magnitude of hazard.</a></li>
<li class="chapter" data-level="10.3.3" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#strengths-and-limitations-of-estimated-median-lifetimes."><i class="fa fa-check"></i><b>10.3.3</b> Strengths and limitations of estimated median lifetimes.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#quantifying-the-effects-of-sampling-variation"><i class="fa fa-check"></i><b>10.4</b> Quantifying the effects of sampling variation</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-standard-error-of-the-estimated-hazard-probabilities."><i class="fa fa-check"></i><b>10.4.1</b> The standard error of the estimated hazard probabilities.</a></li>
<li class="chapter" data-level="10.4.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#standard-error-of-the-estimated-survival-probabilities."><i class="fa fa-check"></i><b>10.4.2</b> Standard error of the estimated survival probabilities.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#a-simple-and-useful-strategy-for-constructing-the-life-table"><i class="fa fa-check"></i><b>10.5</b> A simple and useful strategy for constructing the life table</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#the-person-period-data-set.-1"><i class="fa fa-check"></i><b>10.5.1</b> The person-period data set.</a></li>
<li class="chapter" data-level="10.5.2" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#using-the-person-period-data-set-to-construct-the-life-table."><i class="fa fa-check"></i><b>10.5.2</b> Using the person-period data set to construct the life table.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#bonus-fit-the-discrete-time-hazard-models-with-brms"><i class="fa fa-check"></i><b>10.6</b> Bonus: Fit the discrete-time hazard models with <strong>brms</strong></a></li>
<li class="chapter" data-level="" data-path="describing-discrete-time-event-occurrence-data.html"><a href="describing-discrete-time-event-occurrence-data.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html"><i class="fa fa-check"></i><b>11</b> Fitting Basic Discrete-Time Hazard Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#toward-a-statistical-model-for-discrete-time-hazard"><i class="fa fa-check"></i><b>11.1</b> Toward a statistical model for discrete-time hazard</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#plots-of-within-group-hazard-functions-and-survivor-functions."><i class="fa fa-check"></i><b>11.1.1</b> Plots of within-group hazard functions and survivor functions.</a></li>
<li class="chapter" data-level="11.1.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-kind-of-statistical-model-do-these-graphs-suggest"><i class="fa fa-check"></i><b>11.1.2</b> What kind of statistical model do these graphs suggest?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#formal-representation-of-the-population-discrete-time-hazard-model"><i class="fa fa-check"></i><b>11.2</b> Formal representation of the population discrete-time hazard model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#what-do-the-parameters-represent"><i class="fa fa-check"></i><b>11.2.1</b> What do the parameters represent?</a></li>
<li class="chapter" data-level="11.2.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#an-alternative-representation-of-the-model."><i class="fa fa-check"></i><b>11.2.2</b> An alternative representation of the model.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-a-discrete-time-hazard-model-to-data"><i class="fa fa-check"></i><b>11.3</b> Fitting a discrete-time hazard model to data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#adding-predictors-to-the-person-period-data-set."><i class="fa fa-check"></i><b>11.3.1</b> Adding predictors to the person-period data set.</a></li>
<li class="chapter" data-level="11.3.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#maximum-likelihood-estimates-and-bayesian-posteriors-for-the-discrete-time-hazard-model."><i class="fa fa-check"></i><b>11.3.2</b> Maximum likelihood estimates [and Bayesian posteriors] for the discrete-time hazard model.</a></li>
<li class="chapter" data-level="11.3.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#fitting-the-discrete-time-hazard-model-to-data."><i class="fa fa-check"></i><b>11.3.3</b> Fitting the discrete-time hazard model to data.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#interpreting-parameter-estimates"><i class="fa fa-check"></i><b>11.4</b> Interpreting parameter estimates</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-time-indicators."><i class="fa fa-check"></i><b>11.4.1</b> The time indicators.</a></li>
<li class="chapter" data-level="11.4.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#dichotomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.2</b> Dichotomous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#continuous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.3</b> Continuous substantive predictors.</a></li>
<li class="chapter" data-level="11.4.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#polytomous-substantive-predictors."><i class="fa fa-check"></i><b>11.4.4</b> Polytomous substantive predictors.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#displaying-fitted-hazard-and-survivor-functions"><i class="fa fa-check"></i><b>11.5</b> Displaying fitted hazard and survivor functions</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#a-strategy-for-a-single-categorical-substantive-predictor."><i class="fa fa-check"></i><b>11.5.1</b> A strategy for a single categorical substantive predictor.</a></li>
<li class="chapter" data-level="11.5.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#extending-this-strategy-to-multiple-predictors-some-of-which-are-continuous."><i class="fa fa-check"></i><b>11.5.2</b> Extending this strategy to multiple predictors (some of which are continuous).</a></li>
<li class="chapter" data-level="11.5.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#two-cautions-when-interpreting-fitted-hazard-and-survivor-functions."><i class="fa fa-check"></i><b>11.5.3</b> Two cautions when interpreting fitted hazard and survivor functions.</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-models-using-deviance-statistics-and-information-criteria"><i class="fa fa-check"></i><b>11.6</b> Comparing models using <del>deviance statistics and</del> information criteria</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-deviance-statistic.-1"><i class="fa fa-check"></i><b>11.6.1</b> The deviance statistic.</a></li>
<li class="chapter" data-level="11.6.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-individual-predictors."><i class="fa fa-check"></i><b>11.6.2</b> Deviance-based hypothesis tests for individual predictors.</a></li>
<li class="chapter" data-level="11.6.3" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#deviance-based-hypothesis-tests-for-groups-of-predictors."><i class="fa fa-check"></i><b>11.6.3</b> Deviance-based hypothesis tests for groups of predictors.</a></li>
<li class="chapter" data-level="11.6.4" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#comparing-nonnested-models-using-waic-and-loo."><i class="fa fa-check"></i><b>11.6.4</b> Comparing nonnested models using [WAIC and LOO].</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#statistical-inference-using-uncertainty-in-the-bayesian-posterior"><i class="fa fa-check"></i><b>11.7</b> Statistical inference using [uncertainty in the Bayesian posterior]</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#the-wald-chi-square-statistic."><i class="fa fa-check"></i><b>11.7.1</b> The <del>Wald chi-square statistic</del>.</a></li>
<li class="chapter" data-level="11.7.2" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#asymmetric-credible-intervals-for-parameters-and-odds-ratios."><i class="fa fa-check"></i><b>11.7.2</b> [Asymmetric credible intervals] for parameters and odds ratios.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="fitting-basic-discrete-time-hazard-models.html"><a href="fitting-basic-discrete-time-hazard-models.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html"><i class="fa fa-check"></i><b>12</b> Extending the Discrete-Time Hazard Model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#alternative-specification-for-the-main-effect-of-time"><i class="fa fa-check"></i><b>12.1</b> Alternative specification for the “main effect” of <em>TIME</em></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#an-ordered-series-of-polynomial-specifications-for-time."><i class="fa fa-check"></i><b>12.1.1</b> An ordered series of polynomial specifications for <em>TIME</em>.</a></li>
<li class="chapter" data-level="12.1.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#criteria-for-comparing-alternative-specification."><i class="fa fa-check"></i><b>12.1.2</b> Criteria for comparing alternative specification.</a></li>
<li class="chapter" data-level="12.1.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-parameters-from-linear-quadratic-and-cubic-specifications."><i class="fa fa-check"></i><b>12.1.3</b> Interpreting parameters from linear, quadratic, and cubic specifications.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#using-the-complementary-log-log-link-to-specify-a-discrete-time-hazard-model"><i class="fa fa-check"></i><b>12.2</b> Using the complementary log-log link to specify a discrete-time hazard model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-clog-log-transformation-when-and-why-it-is-useful."><i class="fa fa-check"></i><b>12.2.1</b> The clog-log transformation: When and why it is useful.</a></li>
<li class="chapter" data-level="12.2.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#a-discrete-time-hazard-model-using-the-complementary-log-log-link."><i class="fa fa-check"></i><b>12.2.2</b> A discrete-time hazard model using the complementary log-log link.</a></li>
<li class="chapter" data-level="12.2.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#choosing-between-logit-and-clog-log-links-for-discrete-time-hazard-models."><i class="fa fa-check"></i><b>12.2.3</b> Choosing between logit and clog-log links for discrete-time hazard models.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#time-varying-predictors-1"><i class="fa fa-check"></i><b>12.3</b> Time-varying predictors</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#assumptions-underlying-a-model-with-time-varying-predictors."><i class="fa fa-check"></i><b>12.3.1</b> Assumptions underlying a model with time-varying predictors.</a></li>
<li class="chapter" data-level="12.3.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interpreting-and-displaying-time-varying-predictors-effects."><i class="fa fa-check"></i><b>12.3.2</b> Interpreting and displaying time-varying predictors’ effects.</a></li>
<li class="chapter" data-level="12.3.3" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#two-caveats-the-problems-of-state-and-rate-dependence."><i class="fa fa-check"></i><b>12.3.3</b> Two caveats: The problems of state and rate dependence.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-linear-additivity-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.4</b> The linear additivity assumption: Uncovering violations and simple solutions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#interactions-between-substantive-predictors."><i class="fa fa-check"></i><b>12.4.1</b> Interactions between substantive predictors.</a></li>
<li class="chapter" data-level="12.4.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#nonlinear-effects."><i class="fa fa-check"></i><b>12.4.2</b> Nonlinear effects.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-proportionality-assumption-uncovering-violations-and-simple-solutions"><i class="fa fa-check"></i><b>12.5</b> The proportionality assumption: Uncovering violations and simple solutions</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#discrete-time-hazard-models-that-do-not-invoke-a-proportionality-assumption."><i class="fa fa-check"></i><b>12.5.1</b> Discrete-time hazard models that do not invoke a proportionality assumption.</a></li>
<li class="chapter" data-level="12.5.2" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#investigating-the-proportionality-assumption-in-practice."><i class="fa fa-check"></i><b>12.5.2</b> Investigating the proportionality assumption in practice.</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#the-no-unobserved-heterogeneity-assumption-no-simple-solution"><i class="fa fa-check"></i><b>12.6</b> The no unobserved heterogeneity assumption: No simple solution</a></li>
<li class="chapter" data-level="12.7" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#residual-analysis"><i class="fa fa-check"></i><b>12.7</b> Residual analysis</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="extending-the-discrete-time-hazard-model.html"><a href="extending-the-discrete-time-hazard-model.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html"><i class="fa fa-check"></i><b>13</b> Describing Continuous-Time Event Occurrence Data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#a-framework-for-characterizing-the-distribution-of-continuous-time-event-data"><i class="fa fa-check"></i><b>13.1</b> A framework for characterizing the distribution of continuous-time event data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#salient-features-of-continuous-time-event-occurrence-data."><i class="fa fa-check"></i><b>13.1.1</b> Salient features of continuous-time event occurrence data.</a></li>
<li class="chapter" data-level="13.1.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-survivor-function."><i class="fa fa-check"></i><b>13.1.2</b> The survivor function.</a></li>
<li class="chapter" data-level="13.1.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-hazard-function."><i class="fa fa-check"></i><b>13.1.3</b> The hazard function.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#grouped-methods-for-estimating-continuous-time-survivor-and-hazard-functions"><i class="fa fa-check"></i><b>13.2</b> Grouped methods for estimating continuous-time survivor and hazard functions</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#constructing-a-grouped-life-table."><i class="fa fa-check"></i><b>13.2.1</b> Constructing a grouped life table.</a></li>
<li class="chapter" data-level="13.2.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-discrete-time-method."><i class="fa fa-check"></i><b>13.2.2</b> The discrete-time method.</a></li>
<li class="chapter" data-level="13.2.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-actuarial-method."><i class="fa fa-check"></i><b>13.2.3</b> The actuarial method.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-kaplan-meier-method-of-estimating-the-continuous-time-survivor-function"><i class="fa fa-check"></i><b>13.3</b> The Kaplan-Meier method of estimating the continuous-time survivor function</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#fitting-a-bayesian-kaplan-meier-model"><i class="fa fa-check"></i><b>13.3.1</b> Fitting a Bayesian Kaplan-Meier model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#the-cumulative-hazard-function"><i class="fa fa-check"></i><b>13.4</b> The cumulative hazard function</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#understanding-the-meaning-of-cumulative-hazard."><i class="fa fa-check"></i><b>13.4.1</b> Understanding the meaning of cumulative hazard.</a></li>
<li class="chapter" data-level="13.4.2" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#estimating-the-cumulative-hazard-function."><i class="fa fa-check"></i><b>13.4.2</b> Estimating the cumulative hazard function.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#kernel-smoothed-estimates-of-the-hazard-function"><i class="fa fa-check"></i><b>13.5</b> Kernel-smoothed estimates of the hazard function</a></li>
<li class="chapter" data-level="13.6" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#developing-an-intuition-about-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions"><i class="fa fa-check"></i><b>13.6</b> Developing an intuition about continuous-time survivor, cumulative hazard, and kernel-smoothed hazard functions</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#bonus-bayesians-can-compare-continuous-time-survivor-cumulative-hazard-and-kernel-smoothed-hazard-functions-too."><i class="fa fa-check"></i><b>13.6.1</b> Bonus: Bayesians can compare continuous-time survivor, cumulative hazard, and kernel-smoothed hazard functions, too.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="describing-continuous-time-event-occurrence-data.html"><a href="describing-continuous-time-event-occurrence-data.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Applied longitudinal data analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examining-the-multilevel-models-error-covariance-structure" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Examining the Multilevel Model’s Error Covariance Structure<a href="examining-the-multilevel-models-error-covariance-structure.html#examining-the-multilevel-models-error-covariance-structure" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>In this chapter…, we focus on the model’s <em>random</em> effects as embodied in its error covariance structure. Doing so allows us to both describe the particular error covariance structure that the “standard” multilevel model for change invokes and it also allows us to broaden its representation to other—sometimes more tenable assumptions—about its behavior. <span class="citation">(<a href="#ref-singerAppliedLongitudinalData2003" role="doc-biblioref">Singer &amp; Willett, 2003, p. 243</a>, <em>emphasis</em> in the original)</span></p>
</blockquote>
<div id="the-standard-specification-of-the-multilevel-model-for-change" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> The “standard” specification of the multilevel model for change<a href="examining-the-multilevel-models-error-covariance-structure.html#the-standard-specification-of-the-multilevel-model-for-change" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load the <code>opposites_pp</code> data <span class="citation">(<a href="#ref-willett1988QuestionsAndAnswers" role="doc-biblioref">Willett, 1988</a>)</span>.</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb911-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb911-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb911-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb911-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb911-3" aria-hidden="true" tabindex="-1"></a>opposites_pp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;~/Dropbox/Recoding Applied Longitudinal Data Analysis/data/opposites_pp.csv&quot;</span>)</span>
<span id="cb911-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb911-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb911-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb911-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(opposites_pp)</span></code></pre></div>
<pre><code>## Rows: 140
## Columns: 6
## $ id   &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8,…
## $ time &lt;dbl&gt; 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3,…
## $ opp  &lt;dbl&gt; 205, 217, 268, 302, 219, 243, 279, 302, 142, 212, 250, 289, 206, 230, 248, 273, 190, 220, 229, …
## $ cog  &lt;dbl&gt; 137, 137, 137, 137, 123, 123, 123, 123, 129, 129, 129, 129, 125, 125, 125, 125, 81, 81, 81, 81,…
## $ ccog &lt;dbl&gt; 23.5429, 23.5429, 23.5429, 23.5429, 9.5429, 9.5429, 9.5429, 9.5429, 15.5429, 15.5429, 15.5429, …
## $ wave &lt;dbl&gt; 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4,…</code></pre>
<p><span class="citation">Willett (<a href="#ref-willett1988QuestionsAndAnswers" role="doc-biblioref">1988</a>)</span> clarified these data were simulated for pedagogical purposes, which will become important later on. For now, here’s our version of Table 7.1.</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb913-1" aria-hidden="true" tabindex="-1"></a>opposites_pp <span class="sc">%&gt;%</span> </span>
<span id="cb913-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb913-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_c</span>(<span class="st">&quot;opp&quot;</span>, wave)) <span class="sc">%&gt;%</span> </span>
<span id="cb913-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb913-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name, opp, cog) <span class="sc">%&gt;%</span> </span>
<span id="cb913-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb913-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb913-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb913-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> opp) <span class="sc">%&gt;%</span> </span>
<span id="cb913-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb913-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, <span class="fu">starts_with</span>(<span class="st">&quot;opp&quot;</span>), cog) <span class="sc">%&gt;%</span> </span>
<span id="cb913-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb913-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 6
##       id  opp1  opp2  opp3  opp4   cog
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1   205   217   268   302   137
##  2     2   219   243   279   302   123
##  3     3   142   212   250   289   129
##  4     4   206   230   248   273   125
##  5     5   190   220   229   220    81
##  6     6   165   205   207   263   110
##  7     7   170   182   214   268    99
##  8     8    96   131   159   213   113
##  9     9   138   156   197   200   104
## 10    10   216   252   274   298    96</code></pre>
<p>The data are composed of 35 people’s scores on a cognitive task, across 4 time points.</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb915-1" aria-hidden="true" tabindex="-1"></a>opposites_pp <span class="sc">%&gt;%</span> </span>
<span id="cb915-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb915-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(id)</span></code></pre></div>
<pre><code>## # A tibble: 35 × 2
##       id     n
##    &lt;dbl&gt; &lt;int&gt;
##  1     1     4
##  2     2     4
##  3     3     4
##  4     4     4
##  5     5     4
##  6     6     4
##  7     7     4
##  8     8     4
##  9     9     4
## 10    10     4
## # ℹ 25 more rows</code></pre>
<p>Our first model will serve as a comparison model for all that follow. We’ll often refer to it as the <em>standard</em> multilevel model for change. You’ll see why in a bit. It follows the form</p>
<p><span class="math display">\[
\begin{align*}
\text{opp}_{ij} &amp; = \pi_{0i} + \pi_{1i} \text{time}_{ij} + \epsilon_{ij}\\
\pi_{0i} &amp; = \gamma_{00} + \gamma_{01} (\text{cog}_i - \overline{\text{cog}}) + \zeta_{0i}\\
\pi_{1i} &amp; = \gamma_{10} + \gamma_{11} (\text{cog}_i - \overline{\text{cog}}) + \zeta_{1i} \\
\epsilon_{ij} &amp; \stackrel{iid}{\sim} \operatorname{Normal}(0, \sigma_\epsilon) \\
\begin{bmatrix} \zeta_{0i} \\ \zeta_{1i} \end{bmatrix} &amp; \stackrel{iid}{\sim} \operatorname{Normal} \left (
\begin{bmatrix} 0 \\ 0 \end{bmatrix}, \mathbf D \mathbf\Omega \mathbf D&#39; \right ) \\
\mathbf D      &amp; = \begin{bmatrix} \sigma_0 &amp; 0 \\ 0 &amp; \sigma_1 \end{bmatrix} \\
\mathbf \Omega &amp; = \begin{bmatrix} 1 &amp; \rho_{01} \\ \rho_{01} &amp; 1 \end{bmatrix},
\end{align*}
\]</span></p>
<p>where the <span class="math inline">\((\text{cog}_i - \overline{\text{cog}})\)</span> notation is meant to indicate we are mean centering the time-invariant covariate <span class="math inline">\(\text{cog}_i\)</span>. In the data, the mean-centered version is saved as <code>ccog</code>.</p>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb917-1" aria-hidden="true" tabindex="-1"></a>opposites_pp <span class="sc">%&gt;%</span> </span>
<span id="cb917-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb917-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb917-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb917-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb917-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb917-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ccog)) <span class="sc">+</span></span>
<span id="cb917-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb917-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb917-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb917-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-5-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>To keep things simple, we’ll be using <strong>brms</strong> default priors for all the models in this chapter. Fit the model.</p>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb918-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb918-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-3" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb918-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp, </span>
<span id="cb918-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb918-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-6" aria-hidden="true" tabindex="-1"></a>      opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> ccog <span class="sc">+</span> time<span class="sc">:</span>ccog <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> id),</span>
<span id="cb918-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb918-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb918-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb918-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.01&quot;</span>)</span></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb919-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.1</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: opp ~ 0 + Intercept + time + ccog + time:ccog + (1 + time | id) 
##    Data: opposites_pp (Number of observations: 140) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Group-Level Effects: 
## ~id (Number of levels: 35) 
##                     Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sd(Intercept)         36.042     5.020   27.666   47.287 1.003     1325     1922
## sd(time)              10.687     1.806    7.547   14.642 1.001     1327     2307
## cor(Intercept,time)   -0.443     0.159   -0.711   -0.098 1.002     1798     2536
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept  164.108     6.453  151.639  177.065 1.004     1153     1783
## time        26.988     2.093   22.810   31.235 1.004     1629     2086
## ccog        -0.129     0.521   -1.162    0.881 1.002     1337     2211
## time:ccog    0.434     0.167    0.095    0.761 1.002     1997     2570
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma   12.898     1.112   10.968   15.285 1.000     1702     2746
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>If you’re curious, here’s the summary of our <span class="math inline">\(\sigma\)</span> parameters transformed to the variance/covariance metric.</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb921-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb921-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-3" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sigma[epsilon]^2&quot;</span>, <span class="st">&quot;sigma[0]^2&quot;</span>, <span class="st">&quot;sigma[1]^2&quot;</span>, <span class="st">&quot;sigma[0][1]&quot;</span>)</span>
<span id="cb921-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb921-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span></span>
<span id="cb921-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb921-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="ot">=</span> sd_id__Intercept<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb921-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="ot">=</span> sd_id__time<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb921-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb921-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="ot">=</span> sd_id__Intercept <span class="sc">*</span> sd_id__time <span class="sc">*</span> cor_id__Intercept__time)</span>
<span id="cb921-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb921-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-12" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb921-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb921-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb921-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb921-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb921-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb921-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 7
##   name             value .lower .upper .width .point .interval
##   &lt;fct&gt;            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 sigma[epsilon]^2  164.  120.   234.    0.95 median qi       
## 2 sigma[0]^2       1261.  765.  2236.    0.95 median qi       
## 3 sigma[1]^2        112.   57.0  214.    0.95 median qi       
## 4 sigma[0][1]      -166. -399.   -28.1   0.95 median qi</code></pre>
</div>
<div id="using-the-composite-model-to-understand-assumptions-about-the-error-covariance-matrix" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Using the composite model to understand assumptions about the error covariance matrix<a href="examining-the-multilevel-models-error-covariance-structure.html#using-the-composite-model-to-understand-assumptions-about-the-error-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dropping the terms specifying the distributional assumptions, we can reexpress the model formula, from above, in the composite format as</p>
<p><span class="math display">\[
\begin{align*}
\text{opp}_{ij} &amp; = [\gamma_{00} + \gamma_{10} \text{time}_{ij} + \gamma_{01} (\text{cog}_i - \overline{\text{cog}}) + \gamma_{11} (\text{cog}_i - \overline{\text{cog}}) \times \text{time}_{ij}] \\
&amp; \;\;\; + [\zeta_{0i} + \zeta_{1i} \text{time}_{ij} + \epsilon_{ij}],
\end{align*}
\]</span></p>
<p>where we’ve divided up the structural and stochastic components with our use of brackets. We might think of the terms of the stochastic portion as a <em>composite residual</em>, <span class="math inline">\(r_{ij} = [\epsilon_{ij} + \zeta_{0i} + \zeta_{1i} \text{time}_{ij}]\)</span>. Thus, we can rewrite the composite equation with the composite residual term <span class="math inline">\(r_{ij}\)</span> as</p>
<p><span class="math display">\[
\text{opp}_{ij} = [\gamma_{00} + \gamma_{10} \text{time}_{ij} + \gamma_{01} (\text{cog}_i - \overline{\text{cog}}) + \gamma_{11} (\text{cog}_i - \overline{\text{cog}}) \times \text{time}_{ij}] + r_{ij}.
\]</span></p>
<p>If we were willing to presume, as in OLS or single-level Bayesian regression, that all residuals are independent and normally distributed, we could express that in statistical notation as</p>
<p><span class="math display">\[\begin{align*}
\begin{bmatrix} r_{11} \\ r_{12} \\ r_{13} \\ r_{14} \\ r_{21} \\ r_{22} \\ r_{23} \\ r_{24} \\ \vdots \\ r_{n1} \\ r_{n2} \\ r_{n3} \\ r_{n4} \end{bmatrix} &amp; \sim \mathcal{N}

\begin{pmatrix}

\begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ \vdots \\ 0 \\ 0 \\ 0 \\ 0 \\ \end{bmatrix},

\begin{bmatrix}
\sigma_r^2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \sigma_r^2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sigma_r^2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sigma_r^2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\

0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_r^2 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_r^2 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_r^2 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_r^2 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\

\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \\

0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; \sigma_r^2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; \sigma_r^2 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; \sigma_r^2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_r^2
\end{bmatrix}

\end{pmatrix},
\end{align*}\]</span></p>
<p>where <span class="math inline">\(r_{ij}\)</span> is the <span class="math inline">\(i\)</span>th person’s residual on the <span class="math inline">\(j\)</span>th time point. The variance/covariance matrix <span class="math inline">\(\mathbf \Sigma\)</span> is diagonal (i.e., all the off-diagonal elements are 0’s) and <em>homoscedastic</em> (i.e., all the diagonal elements are the same value, <span class="math inline">\(\sigma_r^2\)</span>).</p>
<p>These assumptions are absurd for longitudinal data, which is why we don’t analyze such data with single-level models. If we were to make the less restrictive assumptions that, within people, the residuals were <em>correlated over time</em> and were <em>heteroscedastic</em>, we could express that as</p>
<p><span class="math display">\[\begin{align*}
\begin{bmatrix} r_{11} \\ r_{12} \\ r_{13} \\ r_{14} \\ r_{21} \\ r_{22} \\ r_{23} \\ r_{24} \\ \vdots \\ r_{n1} \\ r_{n2} \\ r_{n3} \\ r_{n4} \end{bmatrix} &amp; \sim \mathcal{N}

\begin{pmatrix}

\begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ \vdots \\ 0 \\ 0 \\ 0 \\ 0 \\ \end{bmatrix},

\begin{bmatrix}
\sigma_{r_1}^2 &amp; \sigma_{r_1 r_2} &amp; \sigma_{r_1 r_3} &amp; \sigma_{r_1 r_4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\sigma_{r_2 r_1} &amp; \sigma_{r_2}^2 &amp; \sigma_{r_2 r_3} &amp; \sigma_{r_2 r_4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\sigma_{r_3 r_1} &amp; \sigma_{r_3 r_2} &amp; \sigma_{r_3}^2 &amp; \sigma_{r_3 r_4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\sigma_{r_4 r_1} &amp; \sigma_{r_4 r_2} &amp; \sigma_{r_4 r_3} &amp; \sigma_{r_4}^2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\

0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_{r_1}^2 &amp; \sigma_{r_1 r_2} &amp; \sigma_{r_1 r_3} &amp; \sigma_{r_1 r_4} &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_{r_2 r_1} &amp; \sigma_{r_2}^2 &amp; \sigma_{r_2 r_3} &amp; \sigma_{r_2 r_4} &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_{r_3 r_1} &amp; \sigma_{r_3 r_2} &amp; \sigma_{r_3}^2 &amp; \sigma_{r_3 r_4} &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_{r_4 r_1} &amp; \sigma_{r_4 r_2} &amp; \sigma_{r_4 r_3} &amp; \sigma_{r_4}^2 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\

\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \\

0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; \sigma_{r_1}^2 &amp; \sigma_{r_1 r_2} &amp; \sigma_{r_1 r_3} &amp; \sigma_{r_1 r_4} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; \sigma_{r_2 r_1} &amp; \sigma_{r_2}^2 &amp; \sigma_{r_2 r_3} &amp; \sigma_{r_2 r_4} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; \sigma_{r_3 r_1} &amp; \sigma_{r_3 r_2} &amp; \sigma_{r_3}^2 &amp; \sigma_{r_3 r_4} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; \sigma_{r_4 r_1} &amp; \sigma_{r_4 r_2} &amp; \sigma_{r_4 r_3} &amp; \sigma_{r_4}^2
\end{bmatrix}

\end{pmatrix}.
\end{align*}\]</span></p>
<p>this kind of structure can be called <em>block diagonal</em>, which means the off-diagonal elements are zero between persons, but allowed to be non-zero within persons (i.e., within blocks). The zero elements between person blocks explicate how the residuals are independent between persons. Notice that the variances on the diagonal vary across the four time points (i.e., <span class="math inline">\(\sigma_{r_1}^2, \dots, \sigma_{r_4}^2\)</span>). Yet also notice that the block for one person is identical to the block for all others. Thus, this model allows for <em>heterogeneity</em> across time within persons, but <em>homogeneity</em> between persons.</p>
<p>We can express this in the more compact notation,</p>
<p><span class="math display">\[\begin{align*}
r &amp; \sim \mathcal{N}
\begin{pmatrix} \mathbf 0,

\begin{bmatrix}

\mathbf{\Sigma}_r &amp; \mathbf 0 &amp; \mathbf 0 &amp; \dots &amp; \mathbf 0 \\
\mathbf 0 &amp; \mathbf{\Sigma}_r &amp; \mathbf 0 &amp; \dots &amp; \mathbf 0 \\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf{\Sigma}_r &amp; \dots &amp; \mathbf 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \mathbf 0 \\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \mathbf{\Sigma}_r

\end{bmatrix}

\end{pmatrix}, \;\;\; \text{where} \\

\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma_{r_1}^2 &amp; \sigma_{r_1 r_2} &amp; \sigma_{r_1 r_3} &amp; \sigma_{r_1 r_4} \\
  \sigma_{r_2 r_1} &amp; \sigma_{r_2}^2 &amp; \sigma_{r_2 r_3} &amp; \sigma_{r_2 r_4} \\
  \sigma_{r_3 r_1} &amp; \sigma_{r_3 r_2} &amp; \sigma_{r_3}^2 &amp; \sigma_{r_3 r_4} \\
  \sigma_{r_4 r_1} &amp; \sigma_{r_4 r_2} &amp; \sigma_{r_4 r_3} &amp; \sigma_{r_4}^2 \end{bmatrix}.

\end{align*}\]</span></p>
<p>The bulk of the rest of the material in this chapter will focus around how different models handle <span class="math inline">\(\mathbf{\Sigma}_r\)</span>. The <em>standard</em> multilevel growth model has one way. There are many others.</p>
<div id="variance-of-the-composite-residual." class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Variance of the composite residual.<a href="examining-the-multilevel-models-error-covariance-structure.html#variance-of-the-composite-residual." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Under the conventional multilevel growth model</p>
<p><span class="math display">\[
\begin{align*}
\sigma_{r_j}^2 &amp; = \operatorname{Var} \left ( \epsilon_{ij} + \zeta_{0i} + \zeta_{1i} \text{time}_j \right ) \\
&amp; = \sigma_\epsilon^2 + \sigma_0^2 + 2 \sigma_{01} \text{time}_j + \sigma_1^2 \text{time}_j^2.
\end{align*}
\]</span></p>
<p>Here’s how to use our posterior samples to compute <span class="math inline">\(\sigma_{r_1}^2, \dots, \sigma_{r_4}^2\)</span>.</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb923-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb923-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(iter, <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span>),</span>
<span id="cb923-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb923-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> time <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb923-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_c</span>(<span class="st">&quot;sigma[italic(r)[&quot;</span>, time <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;]]^2&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb923-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb923-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> r, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb923-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb923-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;marginal posterior&quot;</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb923-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">labels =</span> ggplot2<span class="sc">:::</span>parse_safe) <span class="sc">+</span></span>
<span id="cb923-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">4.2</span>)) <span class="sc">+</span></span>
<span id="cb923-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb923-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>As is often the case with variance parameters, the posteriors show marked right skew. Here are the numeric summaries.</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb924-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb924-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(iter, <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span>),</span>
<span id="cb924-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb924-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> time <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb924-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_c</span>(<span class="st">&quot;sigma[italic(r)[&quot;</span>, time <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;]]^2&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb924-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb924-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb924-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(r)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 7
##   name                      r .lower .upper .width .point .interval
##   &lt;chr&gt;                 &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 sigma[italic(r)[1]]^2 1430.   938.  2388.   0.95 median qi       
## 2 sigma[italic(r)[2]]^2 1201.   807.  2011.   0.95 median qi       
## 3 sigma[italic(r)[3]]^2 1203.   798.  1972.   0.95 median qi       
## 4 sigma[italic(r)[4]]^2 1416.   923.  2424.   0.95 median qi</code></pre>
<p>Though our precise numeric values are different from those in the text, we see the same overall pattern. Using our posterior medians, we can update <span class="math inline">\(\mathbf{\Sigma}_r\)</span> to</p>
<p><span class="math display">\[
\begin{align*}
\hat{\mathbf{\Sigma}}_r &amp; = \begin{bmatrix}
  1430 &amp; \hat{\sigma}_{r_1 r_2} &amp; \hat{\sigma}_{r_1 r_3} &amp; \hat{\sigma}_{r_1 r_4} \\
  \hat{\sigma}_{r_2 r_1} &amp; 1201 &amp; \hat{\sigma}_{r_2 r_3} &amp; \hat{\sigma}_{r_2 r_4} \\
  \hat{\sigma}_{r_3 r_1} &amp; \hat{\sigma}_{r_3 r_2} &amp; 1203 &amp; \hat{\sigma}_{r_3 r_4} \\
  \hat{\sigma}_{r_4 r_1} &amp; \hat{\sigma}_{r_4 r_2} &amp; \hat{\sigma}_{r_4 r_3} &amp; 1416 \end{bmatrix}.
\end{align*}
\]</span></p>
<blockquote>
<p>For the opposites-naming data, composite residual variance is greatest at the beginning and end of data collection and smaller in between. And, while not outrageously heteroscedastic, this situation is clearly beyond the bland homoscedasticity that we routinely assume for residuals in cross-sectional data. (p. 252)</p>
</blockquote>
<p>If you work through the equation at the beginning of this section–which I am not going to do, here–, you’ll see that the standard multilevel growth model is set up such that the residual variance follows a quadratic function with time. To give a sense, here we plot the expected <span class="math inline">\(\sigma_r^2\)</span> values over a wider and more continuous range of time values.</p>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb926-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb926-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb926-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb926-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb926-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(iter, <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>, <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span>),</span>
<span id="cb926-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">4.2</span>, <span class="at">to =</span> <span class="fl">6.6</span>, <span class="at">length.out =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb926-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> time <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb926-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb926-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> r, <span class="at">group =</span> iter)) <span class="sc">+</span></span>
<span id="cb926-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb926-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb926-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(sigma[<span class="fu">italic</span>(r)]<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb926-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb926-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="st">&quot;50 posterior draws showing the quadratic shape of &quot;</span><span class="sc">*</span>sigma[<span class="fu">italic</span>(r)[time]]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb926-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb926-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-10-1.png" width="456" style="display: block; margin: auto;" /></p>
<p>Since we have 4,000 posterior draws for all the parameters, we also have 4,000 posterior draws for the quadratic curve. Here we just show 50. The curve is at its minimum at <span class="math inline">\(\text{time} = -(\sigma_{01} / \sigma_1^2)\)</span>. Since we have posterior distributions for <span class="math inline">\(\sigma_{01}\)</span> and <span class="math inline">\(\sigma_1^2\)</span>, we’ll also have a posterior distribution for the minimum point. Here it is.</p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb927-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minimum =</span> <span class="sc">-</span><span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb927-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb927-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> minimum, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb927-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb927-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;time&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.2</span>, <span class="fl">6.6</span>)) <span class="sc">+</span></span>
<span id="cb927-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb927-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(Minimum<span class="sc">~</span>value<span class="sc">~</span>(<span class="sc">-</span>sigma[<span class="dv">0</span>][<span class="dv">1</span>]<span class="sc">/</span>sigma[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb927-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb927-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-11-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>If we plug those minimum time values into the equation for <span class="math inline">\(\sigma_{r_\text{time}}^2\)</span>, we’ll get the posterior distribution for the minimum variance value.</p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb928-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minimum =</span> <span class="sc">-</span><span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb928-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> minimum <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> minimum<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb928-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb928-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> r, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb928-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb928-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(sigma[<span class="fu">italic</span>(r)[time]]<span class="sc">^</span><span class="dv">2</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb928-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb928-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Minimum variance&quot;</span>) <span class="sc">+</span></span>
<span id="cb928-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb928-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-12-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Here’s the numeric summary.</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb929-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb929-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb929-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minimum =</span> <span class="sc">-</span><span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb929-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb929-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> minimum <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> minimum<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb929-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb929-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(r)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##       r .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 1136.   765.  1838.   0.95 median qi</code></pre>
</div>
<div id="covariance-of-the-composite-residuals." class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Covariance of the composite residuals.<a href="examining-the-multilevel-models-error-covariance-structure.html#covariance-of-the-composite-residuals." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to the variances in <span class="math inline">\(\mathbf{\Sigma}_r\)</span>, we might focus on the off-diagonal covariances, too. We can define the covariance between two time points <span class="math inline">\(\sigma_{r_j, r_{j&#39;}}\)</span> as</p>
<p><span class="math display">\[
\sigma_{r_j, r_{j&#39;}} = \sigma_0^2 + \sigma_{01} (t_j + t_{j&#39;}) + \sigma_1^2 t_j t_{j&#39;},
\]</span></p>
<p>where <span class="math inline">\(\sigma_0^2\)</span>, <span class="math inline">\(\sigma_{01}\)</span> and <span class="math inline">\(\sigma_1^2\)</span> all have their usual interpretation, and <span class="math inline">\(t_j\)</span> and <span class="math inline">\(t_{j&#39;}\)</span> are the numeric values for whatever variable is used to index time in the model, which is <code>time</code> in the case of <code>fit7.1</code>. Here we compute and plot the marginal posteriors for all <span class="math inline">\(4 \times 4 = 16\)</span> parameters.</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange the panels</span></span>
<span id="cb931-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-2" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> </span>
<span id="cb931-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;sigma[italic(r)[1]]^2&quot;</span>, <span class="st">&quot;sigma[italic(r)[1]][italic(r)[2]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[1]][italic(r)[3]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[1]][italic(r)[4]]&quot;</span>, </span>
<span id="cb931-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[italic(r)[2]][italic(r)[1]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[2]]^2&quot;</span>, <span class="st">&quot;sigma[italic(r)[2]][italic(r)[3]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[2]][italic(r)[4]]&quot;</span>, </span>
<span id="cb931-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[italic(r)[3]][italic(r)[1]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[3]][italic(r)[2]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[3]]^2&quot;</span>, <span class="st">&quot;sigma[italic(r)[3]][italic(r)[4]]&quot;</span>, </span>
<span id="cb931-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[italic(r)[4]][italic(r)[1]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[4]][italic(r)[2]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[4]][italic(r)[3]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[4]]^2&quot;</span>)</span>
<span id="cb931-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb931-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-8" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb931-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span></span>
<span id="cb931-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-10" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">%&gt;%</span> </span>
<span id="cb931-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">0</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb931-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">1</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb931-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb931-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[epsilon]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">3</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb931-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-15" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb931-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[2]][italic(r)[1]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span>,</span>
<span id="cb931-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[3]][italic(r)[1]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">+</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">0</span>,</span>
<span id="cb931-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[4]][italic(r)[1]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">3</span> <span class="sc">+</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">0</span>,</span>
<span id="cb931-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[3]][italic(r)[2]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span>,</span>
<span id="cb931-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[4]][italic(r)[2]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">1</span>,</span>
<span id="cb931-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[4]][italic(r)[3]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb931-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-22" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb931-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[1]][italic(r)[2]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">0</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span>,</span>
<span id="cb931-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[1]][italic(r)[3]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">0</span> <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb931-25"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[2]][italic(r)[3]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb931-26"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[1]][italic(r)[4]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">0</span> <span class="sc">+</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb931-27"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[2]][italic(r)[4]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">3</span>,</span>
<span id="cb931-28"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[3]][italic(r)[4]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[0]^2</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[0][1]</span><span class="st">`</span> <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">3</span>)</span>
<span id="cb931-29"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb931-30"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-30" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb931-31"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;italic&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb931-32"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb931-33"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb931-34"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb931-35"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb931-36"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb931-37"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb931-38"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;marginal posterior&quot;</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb931-39"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb931-40"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4000</span>),</span>
<span id="cb931-41"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb931-42"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb931-43"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb931-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>It might be helpful to reduce the complexity of this plot by focusing on the posterior medians. With a little help from <code>geom_tile()</code> and <code>geom_text()</code>, we’ll make a plot version of the matrix at the top of page 255 in the text.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb932-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;italic&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb932-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb932-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb932-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb932-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb932-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb932-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb932-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb932-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb932-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb932-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">&quot;posterior</span><span class="sc">\n</span><span class="st">median&quot;</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb932-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb932-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb932-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Sigma)[<span class="fu">italic</span>(r)]<span class="sc">*</span><span class="st">&quot; for the standard multilevel model for change&quot;</span>)) <span class="sc">+</span></span>
<span id="cb932-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb932-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb932-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Although our posterior median values differ a bit from the REML values reported in the text, the overall pattern holds. Hopefully the coloring in the plot helps highlight what Singer and Willett described as a “‘band diagonal’ structure, in which the overall magnitude of the residual covariances tends to decline in diagonal ‘bands’ the further you get from the main diagonal” (p. 255).</p>
<p>One of the consequences for this structure is that in cases where both <span class="math inline">\(\sigma_1^2 \rightarrow 0\)</span> and <span class="math inline">\(\sigma_{01} \rightarrow 0\)</span>, the residual covariance matrix becomes <em>compound symmetric</em>, which is:</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma_\epsilon^2 + \sigma_0^2 &amp; \sigma_0^2 &amp; \sigma_0^2 &amp; \sigma_0^2 \\
  \sigma_0^2 &amp; \sigma_\epsilon^2 + \sigma_0^2 &amp; \sigma_0^2 &amp; \sigma_0^2 \\
  \sigma_0^2 &amp; \sigma_0^2 &amp; \sigma_\epsilon^2 + \sigma_0^2 &amp; \sigma_0^2 \\
  \sigma_0^2 &amp; \sigma_0^2 &amp; \sigma_0^2 &amp; \sigma_\epsilon^2 + \sigma_0^2 \end{bmatrix}.
\end{align*}
\]</span></p>
<blockquote>
<p>Compound symmetric error covariance structures are particularly common in longitudinal data, especially if the slopes of the change trajectories do not differ much asroc people. Regardless of these special cases, however, the most sensible question to ask of your data is whether the error covariance structure that the “standard” multilevel model for change demands is realistic when applied to data in practice? The answer to this question will determine whether the standard model can be applied ubiquitously, as question we soon address. (pp. 255–256)</p>
</blockquote>
</div>
<div id="autocorrelation-of-the-composite-residuals." class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Autocorrelation of the composite residuals.<a href="examining-the-multilevel-models-error-covariance-structure.html#autocorrelation-of-the-composite-residuals." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use the following equation to convert our <span class="math inline">\(\mathbf{\Sigma}_r\)</span> into a correlation matrix:</p>
<p><span class="math display">\[\rho_{r_j r_{j^\prime}} = \sigma_{r_j r_{j^\prime}} \Big / \sqrt{\sigma_{r_j}^2 \sigma_{r_{j^\prime}}^2}.\]</span></p>
<p>Here we use the formula and plot the posteriors.</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange the panels</span></span>
<span id="cb933-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-2" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> </span>
<span id="cb933-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;sigma[italic(r)[1]]&quot;</span>, <span class="st">&quot;rho[italic(r)[1]][italic(r)[2]]&quot;</span>, <span class="st">&quot;rho[italic(r)[1]][italic(r)[3]]&quot;</span>, <span class="st">&quot;rho[italic(r)[1]][italic(r)[4]]&quot;</span>, </span>
<span id="cb933-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;rho[italic(r)[2]][italic(r)[1]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[2]]&quot;</span>, <span class="st">&quot;rho[italic(r)[2]][italic(r)[3]]&quot;</span>, <span class="st">&quot;rho[italic(r)[2]][italic(r)[4]]&quot;</span>, </span>
<span id="cb933-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;rho[italic(r)[3]][italic(r)[1]]&quot;</span>, <span class="st">&quot;rho[italic(r)[3]][italic(r)[2]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[3]]&quot;</span>, <span class="st">&quot;rho[italic(r)[3]][italic(r)[4]]&quot;</span>, </span>
<span id="cb933-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;rho[italic(r)[4]][italic(r)[1]]&quot;</span>, <span class="st">&quot;rho[italic(r)[4]][italic(r)[2]]&quot;</span>, <span class="st">&quot;rho[italic(r)[4]][italic(r)[3]]&quot;</span>, <span class="st">&quot;sigma[italic(r)[4]]&quot;</span>)</span>
<span id="cb933-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb933-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-8" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span></span>
<span id="cb933-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-9" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">%&gt;%</span> </span>
<span id="cb933-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;italic&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb933-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb933-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[2]][italic(r)[1]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[2]][italic(r)[1]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span>),</span>
<span id="cb933-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[3]][italic(r)[1]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[3]][italic(r)[1]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span>),</span>
<span id="cb933-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[4]][italic(r)[1]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[4]][italic(r)[1]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span>),</span>
<span id="cb933-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-15" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb933-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[1]][italic(r)[2]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[1]][italic(r)[2]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span>),</span>
<span id="cb933-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[2]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb933-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[3]][italic(r)[2]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[3]][italic(r)[2]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span>),</span>
<span id="cb933-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[4]][italic(r)[2]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[4]][italic(r)[2]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span>),</span>
<span id="cb933-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-20" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb933-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[1]][italic(r)[3]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[1]][italic(r)[3]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span>),</span>
<span id="cb933-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[2]][italic(r)[3]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[2]][italic(r)[3]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span>),</span>
<span id="cb933-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[3]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb933-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[4]][italic(r)[3]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[4]][italic(r)[3]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span>),</span>
<span id="cb933-25"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-25" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb933-26"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[1]][italic(r)[4]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[1]][italic(r)[4]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span>),</span>
<span id="cb933-27"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[2]][italic(r)[4]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[2]][italic(r)[4]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[2]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span>),</span>
<span id="cb933-28"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">rho[italic(r)[3]][italic(r)[4]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[3]][italic(r)[4]]</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[3]]^2</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span>),</span>
<span id="cb933-29"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[italic(r)[4]]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="st">`</span><span class="at">sigma[italic(r)[4]]^2</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb933-30"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb933-31"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-31" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb933-32"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">sigma[italic(r)[4]]</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb933-33"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb933-34"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb933-35"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb933-36"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb933-37"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb933-38"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb933-39"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;marginal posterior&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb933-40"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">/</span> <span class="dv">4</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.25&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;.75&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb933-41"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb933-42"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb933-43"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb933-44"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb933-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>As before, it might be helpful to reduce the complexity of this plot by focusing on the posterior medians. We’ll make a plot version of the correlation matrix in the middle of page 256 in the text.</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb934-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">sigma[italic(r)[1]]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">sigma[italic(r)[4]]</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb934-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb934-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb934-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb934-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb934-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb934-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb934-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb934-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb934-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb934-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">&quot;posterior</span><span class="sc">\n</span><span class="st">median&quot;</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb934-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb934-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb934-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Omega)[<span class="fu">italic</span>(r)]<span class="sc">*</span><span class="st">&quot; for the standard multilevel model for change&quot;</span>)) <span class="sc">+</span></span>
<span id="cb934-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb934-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb934-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The correlation matrix has an even more pronounced band-diagonal structure. Thus even though the standard multilevel model of change does not contain an explicit autocorrelation parameter <span class="math inline">\(\rho\)</span>, the model does account for residual autocorrelation. We might take this even further. Notice the parameters <span class="math inline">\(\rho_{r_2, r_1}\)</span>, <span class="math inline">\(\rho_{r_3, r_2}\)</span>, and <span class="math inline">\(\rho_{r_4, r_3}\)</span> are all autocorrelations of the first order, and further note how similar their posterior medians all are. Here’s a summary of the average of those three parameters, which we’ll just call <span class="math inline">\(\rho\)</span>.</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb935-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="sc">%&gt;%</span> </span>
<span id="cb935-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb935-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># take the average of the three parameters</span></span>
<span id="cb935-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb935-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">rho =</span> (<span class="st">`</span><span class="at">rho[italic(r)[2]][italic(r)[1]]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rho[italic(r)[3]][italic(r)[2]]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rho[italic(r)[4]][italic(r)[3]]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb935-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb935-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># summarize</span></span>
<span id="cb935-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb935-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##     rho .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 0.827  0.736  0.897   0.95 median qi</code></pre>
<p>If you look at the “estimate” column in Table 7.3 (pp. 258–259), you’ll see the <span class="math inline">\(\hat \rho\)</span> values for the autoregressive and heterogeneous-autoregressive models are very similar to the <span class="math inline">\(\hat \rho\)</span> posterior we just computed for the standard multilevel model of change. The standard multilevel model of change accounts for autocorrelation, but it does so without an explicit <span class="math inline">\(\rho\)</span> parameter.</p>
</div>
</div>
<div id="postulating-an-alternative-error-covariance-structure" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Postulating an alternative error covariance structure<a href="examining-the-multilevel-models-error-covariance-structure.html#postulating-an-alternative-error-covariance-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Singer and Willett wrote:</p>
<blockquote>
<p>it is easy to specify alternative covariance structures for the composite residual and determine analytically which specification—the “standard” or an alternative—fits best. You already possess the analytic tools and skills needed for this work. (p. 257)</p>
</blockquote>
<p>Frequentest <strong>R</strong> users would likely do this with the <a href="https://CRAN.R-project.org/package=nlme"><strong>nlme</strong> package</a> <span class="citation">(<a href="#ref-R-nlme" role="doc-biblioref">Pinheiro et al., 2021</a>)</span>. Recent additions to <strong>brms</strong> makes this largely possible, but not completely so. The six error structures listed in this section were:</p>
<ul>
<li>unstructured,</li>
<li>compound symmetric,</li>
<li>heterogeneous compound symmetric,</li>
<li>autoregressive,</li>
<li>heterogeneous autoregressive, and</li>
<li>Toeplitz.</li>
</ul>
<p>The Toeplitz structure is not currently available with <strong>brms</strong>, but we can experiment with the first five. For details, see <a href="https://github.com/paul-buerkner/brms/issues/403">issue #403</a> in the <strong>brms</strong> GitHub repo.</p>
<div id="unstructured-error-covariance-matrix." class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Unstructured error covariance matrix.<a href="examining-the-multilevel-models-error-covariance-structure.html#unstructured-error-covariance-matrix." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Models using an unstructured error covariance matrix include <span class="math inline">\(k (k + 1) / 2\)</span> variance/covariance parameters, where <span class="math inline">\(k\)</span> is the number of time waves in the data. In the case of our <code>opposites_pp</code> data, we can compute the number of parameters as follows.</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb937-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb937-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb937-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb937-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb937-3" aria-hidden="true" tabindex="-1"></a>k <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>We end up with 4 variances and 6 covariances. Following the notation Singer and Willett used in the upper left corner of Table 7.3 (p. 258), we can express this as</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma_1^2 &amp; \sigma_{12} &amp; \sigma_{13} &amp; \sigma_{14} \\
  \sigma_{21} &amp; \sigma_2^2 &amp; \sigma_{23} &amp; \sigma_{24} \\
  \sigma_{31} &amp; \sigma_{32} &amp; \sigma_3^2 &amp; \sigma_{34} \\
  \sigma_{41} &amp; \sigma_{42} &amp; \sigma_{43} &amp; \sigma_4^2 \end{bmatrix}.
\end{align*}
\]</span></p>
<blockquote>
<p>The great appeal of an unstructured error covariance structure is that it places no restrictions on the structure of <span class="math inline">\(\mathbf{\Sigma}_r\)</span>. For a given set of fixed effects, its deviance statistic will always be the smallest of any error covariance structure. If you have just a few waves of data, this choice can be attractive. But if you have many waves, it can require an exorbitant number of parameters… [However,] the “standard” model requires only 3 variance components (<span class="math inline">\(\sigma_0^2\)</span>, <span class="math inline">\(\sigma_1^2\)</span>, and <span class="math inline">\(\sigma_\epsilon^2\)</span>) and one covariance component, <span class="math inline">\(\sigma_{01}\)</span>. (p. 260)</p>
</blockquote>
<p>To fit the unstructured model with <strong>brms</strong>, we use the <code>unstr()</code> function. Notice how we’ve dropped the usual <code>(1 + time | id)</code> syntax. Instead, we indicate the data are temporally structured by the <code>time</code> variable by setting <code>time = time</code> within <code>unstr()</code>, and we indicate the data are grouped by <code>id</code> by setting <code>gr = id</code>, also within <code>unstr()</code>. Also, notice we’ve wrapped the entire model formula within the <code>bf()</code> function. The second line within the <code>bf()</code> function has <code>sigma</code> on the left side of the <code>~</code> operator, which is something we haven’t seen before. With that line, we have allowed the residual variance <span class="math inline">\(\sigma_\epsilon\)</span> to vary across time points. By default, <strong>brms</strong> will use the log link, to insure the model for <span class="math inline">\(\sigma_{\epsilon j}\)</span> will never predict negative variances.</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb939-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp, </span>
<span id="cb939-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb939-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> ccog <span class="sc">+</span> time<span class="sc">:</span>ccog <span class="sc">+</span> <span class="fu">unstr</span>(<span class="at">time =</span> time, <span class="at">gr =</span> id),</span>
<span id="cb939-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-5" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(time)),</span>
<span id="cb939-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb939-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb939-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb939-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.02&quot;</span>)</span></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb940-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.2</span>, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">robust =</span> T)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = log 
## Formula: opp ~ 0 + Intercept + time + ccog + time:ccog + unstr(time = time, gr = id) 
##          sigma ~ 0 + factor(time)
##    Data: opposites_pp (Number of observations: 140) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Correlation Structures:
##              Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## cortime(0,1)    0.748     0.072    0.573    0.864 1.001     2397     2618
## cortime(0,2)    0.657     0.091    0.433    0.800 1.001     2268     2688
## cortime(1,2)    0.806     0.058    0.660    0.895 1.002     2384     3055
## cortime(0,3)    0.332     0.142    0.027    0.575 1.000     2444     2994
## cortime(1,3)    0.638     0.094    0.415    0.787 1.000     2570     2949
## cortime(2,3)    0.733     0.076    0.540    0.847 1.001     2693     2998
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept          165.633     5.743  154.338  176.999 1.001     3294     2707
## time                26.571     2.076   22.396   30.535 1.005     2907     2548
## ccog                -0.088     0.477   -1.005    0.829 1.000     3473     2811
## time:ccog            0.457     0.162    0.118    0.798 1.000     3401     2863
## sigma_factortime0    3.571     0.121    3.354    3.824 1.000     2127     2671
## sigma_factortime1    3.454     0.114    3.248    3.685 1.000     1863     2632
## sigma_factortime2    3.497     0.108    3.291    3.723 1.001     1794     2332
## sigma_factortime3    3.518     0.115    3.308    3.763 1.001     2177     2812
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>There’s a lot of exciting things going on in that output. We’ll start with the bottom 4 rows in the <code>Population-Level Effects</code> section, which contains our the summaries for our <span class="math inline">\(\log (\sigma_{\epsilon j})\)</span> parameters. To get them out of the log metric, we exponentiate. Here’s a quick conversion.</p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb942-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit7<span class="fl">.2</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span></code></pre></div>
<pre><code>##                   Estimate     Q2.5    Q97.5
## sigma_factortime0 35.74347 28.62747 45.79190
## sigma_factortime1 31.77577 25.72651 39.85576
## sigma_factortime2 33.04557 26.86645 41.40652
## sigma_factortime3 33.87739 27.32708 43.06749</code></pre>
<p>Now let’s address the new <code>Correlation Structures</code> section of the <code>print()</code> output. Just as <strong>brms</strong> decomposes the typical multilevel model level-2 variance/covariance matrix <span class="math inline">\(\mathbf{\Sigma}\)</span> as</p>
<p><span class="math display">\[
\begin{align*}
\mathbf \Sigma &amp; = \mathbf D \mathbf \Omega \mathbf D, \text{where} \\
\mathbf D      &amp; = \begin{bmatrix} \sigma_0 &amp; 0 \\ 0 &amp; \sigma_1 \end{bmatrix} \text{and} \\
\mathbf \Omega &amp; = \begin{bmatrix} 1 &amp; \rho \\ \rho &amp; 1 \end{bmatrix},
\end{align*}
\]</span></p>
<p>the same kind of thing happens when we fit a model with an unstructured variance/covariance matrix with the <code>unstr()</code> function. The <code>print()</code> output returned posterior summaries for the elements of the correlation matrix <span class="math inline">\(\mathbf \Omega\)</span> in the <code>Correlation Structures</code> section, and it returned posterior summaries for the elements of the diagonal matrix of standard deviations <span class="math inline">\(\mathbf D\)</span> in the last four rows of the <code>Population-Level Effects</code> section. But notice that instead of <span class="math inline">\(2 \times 2\)</span> matrices like we got with our conventional growth model <code>fit7.1</code>, both <span class="math inline">\(\mathbf D\)</span> and <span class="math inline">\(\mathbf \Omega\)</span> are now <span class="math inline">\(4 \times 4\)</span> matrices right out of the gate. Thus if we use the posterior medians from the <code>print()</code> output as our point estimates, we can express the <span class="math inline">\(\hat{\mathbf \Sigma}\)</span> matrix from our unstructured <code>fit7.2</code> model as</p>
<p><span class="math display">\[
\begin{align*}
\mathbf \Sigma &amp; = \mathbf D \mathbf \Omega \mathbf D \\
\hat{\mathbf D} &amp; = \begin{bmatrix}
  35.6 &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; 31.6  &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 33.0 &amp; 0 \\
  0 &amp; 0 &amp; 0 &amp; 33.7
  \end{bmatrix} \\
\hat{\mathbf \Omega} &amp; = \begin{bmatrix}
  1 &amp; .75 &amp; .66 &amp; .33 \\
  .75 &amp; 1 &amp; .81 &amp; .64 \\
  .66 &amp; .81 &amp; 1 &amp; .73 \\
  .33 &amp; .64 &amp; .73 &amp; 1
  \end{bmatrix}.
\end{align*}
\]</span></p>
<p>Here’s how to compute and summarize the <span class="math inline">\(\mathbf D\)</span> and <span class="math inline">\(\mathbf \Omega\)</span> parameters with the <code>as_draws_df()</code> output.</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb944-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-2" aria-hidden="true" tabindex="-1"></a>sigma.us <span class="ot">&lt;-</span></span>
<span id="cb944-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb944-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime0),</span>
<span id="cb944-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime1),</span>
<span id="cb944-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime2),</span>
<span id="cb944-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime3),</span>
<span id="cb944-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb944-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[12]</span><span class="st">`</span> <span class="ot">=</span> cortime__0__1,</span>
<span id="cb944-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[13]</span><span class="st">`</span> <span class="ot">=</span> cortime__0__2,</span>
<span id="cb944-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[14]</span><span class="st">`</span> <span class="ot">=</span> cortime__0__3,</span>
<span id="cb944-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[23]</span><span class="st">`</span> <span class="ot">=</span> cortime__1__2,</span>
<span id="cb944-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[24]</span><span class="st">`</span> <span class="ot">=</span> cortime__1__3,</span>
<span id="cb944-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[34]</span><span class="st">`</span> <span class="ot">=</span> cortime__2__3,</span>
<span id="cb944-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb944-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[21]</span><span class="st">`</span> <span class="ot">=</span> cortime__0__1, </span>
<span id="cb944-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[31]</span><span class="st">`</span> <span class="ot">=</span> cortime__0__2, </span>
<span id="cb944-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[32]</span><span class="st">`</span> <span class="ot">=</span> cortime__1__2, </span>
<span id="cb944-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[41]</span><span class="st">`</span> <span class="ot">=</span> cortime__0__3, </span>
<span id="cb944-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[42]</span><span class="st">`</span> <span class="ot">=</span> cortime__1__3, </span>
<span id="cb944-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">rho[43]</span><span class="st">`</span> <span class="ot">=</span> cortime__2__3)</span>
<span id="cb944-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb944-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-23" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize</span></span>
<span id="cb944-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-24" aria-hidden="true" tabindex="-1"></a>sigma.us <span class="sc">%&gt;%</span> </span>
<span id="cb944-25"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb944-26"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb944-27"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb944-28"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb944-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 16 × 7
##    name     value .lower .upper .width .point .interval
##    &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1 rho[12]   0.75   0.57   0.86   0.95 median qi       
##  2 rho[13]   0.66   0.43   0.8    0.95 median qi       
##  3 rho[14]   0.33   0.03   0.57   0.95 median qi       
##  4 rho[21]   0.75   0.57   0.86   0.95 median qi       
##  5 rho[23]   0.81   0.66   0.89   0.95 median qi       
##  6 rho[24]   0.64   0.42   0.79   0.95 median qi       
##  7 rho[31]   0.66   0.43   0.8    0.95 median qi       
##  8 rho[32]   0.81   0.66   0.89   0.95 median qi       
##  9 rho[34]   0.73   0.54   0.85   0.95 median qi       
## 10 rho[41]   0.33   0.03   0.57   0.95 median qi       
## 11 rho[42]   0.64   0.42   0.79   0.95 median qi       
## 12 rho[43]   0.73   0.54   0.85   0.95 median qi       
## 13 sigma[1] 35.6   28.6   45.8    0.95 median qi       
## 14 sigma[2] 31.6   25.7   39.9    0.95 median qi       
## 15 sigma[3] 33     26.9   41.4    0.95 median qi       
## 16 sigma[4] 33.7   27.3   43.1    0.95 median qi</code></pre>
<p>Since Singer and Willett preferred the variance/covariance parameterization for <span class="math inline">\(\mathbf \Sigma\)</span>, we’ll practice wrangling the posterior draws to transform our results into that metric, too.</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform</span></span>
<span id="cb946-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-2" aria-hidden="true" tabindex="-1"></a>sigma.us <span class="ot">&lt;-</span> sigma.us <span class="sc">%&gt;%</span> </span>
<span id="cb946-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb946-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[12]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[12]</span><span class="st">`</span>,</span>
<span id="cb946-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[13]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[13]</span><span class="st">`</span>,</span>
<span id="cb946-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[14]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[14]</span><span class="st">`</span>,</span>
<span id="cb946-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-7" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb946-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[21]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[21]</span><span class="st">`</span>,</span>
<span id="cb946-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[2]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb946-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[23]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[23]</span><span class="st">`</span>,</span>
<span id="cb946-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[24]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[24]</span><span class="st">`</span>,</span>
<span id="cb946-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-12" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb946-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[31]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[31]</span><span class="st">`</span>,</span>
<span id="cb946-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[32]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[32]</span><span class="st">`</span>,</span>
<span id="cb946-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[3]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb946-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[34]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[34]</span><span class="st">`</span>,</span>
<span id="cb946-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb946-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[41]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[41]</span><span class="st">`</span>,</span>
<span id="cb946-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[42]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[42]</span><span class="st">`</span>,</span>
<span id="cb946-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[43]</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">rho[43]</span><span class="st">`</span>,</span>
<span id="cb946-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[4]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb946-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb946-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-23" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize</span></span>
<span id="cb946-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-24" aria-hidden="true" tabindex="-1"></a>sigma.us <span class="sc">%&gt;%</span> </span>
<span id="cb946-25"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb946-26"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb946-27"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb946-28"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb946-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 16 × 7
##    name       value .lower .upper .width .point .interval
##    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1 sigma[12]   834.  493.   1421.   0.95 median qi       
##  2 sigma[13]   757.  418.   1302.   0.95 median qi       
##  3 sigma[14]   391.   29.4   874.   0.95 median qi       
##  4 sigma[1]^2 1264.  820.   2097.   0.95 median qi       
##  5 sigma[21]   834.  493.   1421.   0.95 median qi       
##  6 sigma[23]   834.  515.   1373.   0.95 median qi       
##  7 sigma[24]   674.  362.   1174.   0.95 median qi       
##  8 sigma[2]^2 1000.  662.   1588.   0.95 median qi       
##  9 sigma[31]   757.  418.   1302.   0.95 median qi       
## 10 sigma[32]   834.  515.   1373.   0.95 median qi       
## 11 sigma[34]   807.  471.   1373.   0.95 median qi       
## 12 sigma[3]^2 1089.  722.   1714.   0.95 median qi       
## 13 sigma[41]   391.   29.4   874.   0.95 median qi       
## 14 sigma[42]   674.  362.   1174.   0.95 median qi       
## 15 sigma[43]   807.  471.   1373.   0.95 median qi       
## 16 sigma[4]^2 1136.  747.   1855.   0.95 median qi</code></pre>
<p>But again, I suspect it will be easier to appreciate our posterior <span class="math inline">\(\hat{\mathbf \Sigma}\)</span> in a tile plot. Here’s a summary using the posterior medians, similar to what Singer and Willett reported in the rightmost column of Table 7.3.</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-1" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> </span>
<span id="cb948-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;sigma[1]^2&quot;</span>, <span class="st">&quot;sigma[12]&quot;</span>, <span class="st">&quot;sigma[13]&quot;</span>, <span class="st">&quot;sigma[14]&quot;</span>, </span>
<span id="cb948-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[21]&quot;</span>, <span class="st">&quot;sigma[2]^2&quot;</span>, <span class="st">&quot;sigma[23]&quot;</span>, <span class="st">&quot;sigma[24]&quot;</span>, </span>
<span id="cb948-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[31]&quot;</span>, <span class="st">&quot;sigma[32]&quot;</span>, <span class="st">&quot;sigma[3]^2&quot;</span>, <span class="st">&quot;sigma[34]&quot;</span>, </span>
<span id="cb948-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[41]&quot;</span>, <span class="st">&quot;sigma[42]&quot;</span>, <span class="st">&quot;sigma[43]&quot;</span>, <span class="st">&quot;sigma[4]^2&quot;</span>)</span>
<span id="cb948-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb948-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-7" aria-hidden="true" tabindex="-1"></a>sigma.us <span class="sc">%&gt;%</span> </span>
<span id="cb948-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb948-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb948-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb948-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb948-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb948-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb948-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb948-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb948-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">color =</span> value <span class="sc">&lt;</span> <span class="dv">1</span>),</span>
<span id="cb948-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb948-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">&quot;posterior</span><span class="sc">\n</span><span class="st">median&quot;</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb948-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb948-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb948-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb948-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Sigma)[<span class="fu">italic</span>(r)]<span class="sc">*</span><span class="st">&quot; for the unstructured model&quot;</span>)) <span class="sc">+</span></span>
<span id="cb948-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb948-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb948-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-25-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>In case you’re curious, here’s the variance/covariance matrix from the sample data.</p>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb949-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb949-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.2</span><span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb949-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb949-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, time, opp) <span class="sc">%&gt;%</span> </span>
<span id="cb949-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb949-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> time, <span class="at">values_from =</span> opp) <span class="sc">%&gt;%</span> </span>
<span id="cb949-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb949-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> </span>
<span id="cb949-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb949-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb949-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb949-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##      0    1    2    3
## 0 1309  976  922  563
## 1  976 1125 1021  856
## 2  922 1021 1292 1081
## 3  563  856 1081 1415</code></pre>
<p>The <strong>brms</strong> default priors are weakly regularizing, particularly the LKJ prior for the correlation matrix <span class="math inline">\(\mathbf \Omega\)</span>, and I believe this is why the values from our model are systemically lower that the sample statistics. If you find this upsetting, collect more data, which hill help the likelihood dominate the prior.</p>
</div>
<div id="compound-symmetric-error-covariance-matrix." class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Compound symmetric error covariance matrix.<a href="examining-the-multilevel-models-error-covariance-structure.html#compound-symmetric-error-covariance-matrix." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>“A <em>compound symmetric</em> error covariance matrix requires just two parameters, labeled <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\sigma_1^2\)</span> in table 7.3” (p. 260). From the table, we see that matrix follows the form</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma^2 + \sigma_1^2 &amp; \sigma_1^2 &amp; \sigma_1^2 &amp; \sigma_1^2 \\
  \sigma_1^2 &amp; \sigma^2 + \sigma_1^2 &amp; \sigma_1^2 &amp; \sigma_1^2 \\
  \sigma_1^2 &amp; \sigma_1^2 &amp; \sigma^2 + \sigma_1^2 &amp; \sigma_1^2 \\
  \sigma_1^2 &amp; \sigma_1^2 &amp; \sigma_1^2 &amp; \sigma^2 + \sigma_1^2 \end{bmatrix},
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\sigma_1^2\)</span> does not have the same meaning we’ve become accustomed to (i.e., the level-2 variance in linear change over time). The meaning of <span class="math inline">\(\sigma^2\)</span> might also be a little opaque. Happily, there’s another way to express this matrix, which is a modification of the heterogeneous compound symmetric matrix we see listed in Table 7.3. That alternative is:</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma_\epsilon^2 &amp; \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 \rho \\
  \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 &amp; \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 \rho \\
  \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 &amp; \sigma_\epsilon^2 \rho \\
  \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 \rho &amp; \sigma_\epsilon^2 \end{bmatrix},
\end{align*}
\]</span></p>
<p>where the term on the diagonal, <span class="math inline">\(\sigma_\epsilon^2\)</span>, is the residual variance, which is constrained to equality across all four time points. In all cells in the off-diagonal, we see <span class="math inline">\(\sigma_\epsilon^2\)</span> multiplied by <span class="math inline">\(\rho\)</span>. In this parameterization, <span class="math inline">\(\rho\)</span> is the correlation between time points, and that correlation is constrained to equality across all possible pairs of time points. Although this notation is a little different from the notation used in the text, I believe it will help us interpret our model. As we’ll see, <strong>brms</strong> uses this alternative parameterization.</p>
<p>To fit the compound symmetric model with <strong>brms</strong>, we use the <code>cosy()</code> function. Notice how like with the unstructured model <code>fit7.2</code>, we’ve dropped the usual <code>(1 + time | id)</code> syntax. Instead, we impose compound symmetry <em>within persons</em> by setting <code>gr = id</code> within <code>cosy()</code>.</p>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb951-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb951-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb951-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp,</span>
<span id="cb951-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb951-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb951-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb951-4" aria-hidden="true" tabindex="-1"></a>      opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> ccog <span class="sc">+</span> time<span class="sc">:</span>ccog <span class="sc">+</span> <span class="fu">cosy</span>(<span class="at">gr =</span> id),</span>
<span id="cb951-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb951-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb951-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb951-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb951-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb951-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.03&quot;</span>)</span></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb952-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.3</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: opp ~ 0 + Intercept + time + ccog + time:ccog + cosy(gr = id) 
##    Data: opposites_pp (Number of observations: 140) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Correlation Structures:
##      Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## cosy    0.721     0.062    0.589    0.833 1.000     2265     2832
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept  164.433     5.687  152.939  175.457 1.002     4023     3118
## time        26.958     1.381   24.257   29.657 1.000     4178     3075
## ccog        -0.107     0.460   -0.997    0.787 1.001     4436     3065
## time:ccog    0.432     0.113    0.215    0.649 1.001     4604     3215
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma   35.540     3.650   29.615   43.813 1.001     2442     2406
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>See that new <code>cosy</code> row? That’s <span class="math inline">\(\rho\)</span>, the residual correlation among the time points. The <code>sigma</code> row on the bottom has it’s typical interpretation, it’s the residual standard deviation, what we typically call <span class="math inline">\(\sigma_\epsilon\)</span>. Square it and you’ll have what we called <span class="math inline">\(\sigma_\epsilon^2\)</span> in the matrix, above. Okay, since our <strong>brms</strong> model is parameterized differently from what Singer and Willett reported in the text (see Table 7.3, p. 258), we’ll wrangle the posterior draws a bit.</p>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-1" aria-hidden="true" tabindex="-1"></a>sigma.cs <span class="ot">&lt;-</span></span>
<span id="cb954-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb954-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">rho                    =</span> cosy,</span>
<span id="cb954-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sigma_e                =</span> sigma,</span>
<span id="cb954-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma^2 + sigma[1]^2</span><span class="st">`</span> <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb954-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="ot">=</span> rho <span class="sc">*</span> sigma_e<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb954-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">sigma^2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma^2 + sigma[1]^2</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>)</span>
<span id="cb954-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb954-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-9" aria-hidden="true" tabindex="-1"></a><span class="co"># what did we do?</span></span>
<span id="cb954-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb954-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sigma.cs)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##     rho sigma_e `sigma^2 + sigma[1]^2` `sigma[1]^2` `sigma^2`
##   &lt;dbl&gt;   &lt;dbl&gt;                  &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;
## 1 0.696    31.9                  1018.         709.      309.
## 2 0.707    32.5                  1057.         748.      309.
## 3 0.668    32.8                  1073.         717.      356.
## 4 0.756    37.6                  1411.        1067.      344.
## 5 0.763    36.0                  1294.         987.      307.
## 6 0.746    36.0                  1294.         966.      328.</code></pre>
<p>Here’s the numeric summary.</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb956-1" aria-hidden="true" tabindex="-1"></a>sigma.cs <span class="sc">%&gt;%</span> </span>
<span id="cb956-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb956-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb956-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb956-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb956-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb956-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb956-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb956-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 7
##   name                   value .lower  .upper .width .point .interval
##   &lt;chr&gt;                  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 rho                     0.73   0.59    0.83   0.95 median qi       
## 2 sigma[1]^2            888.   532.   1572.     0.95 median qi       
## 3 sigma^2               337.   263.    451.     0.95 median qi       
## 4 sigma^2 + sigma[1]^2 1232.   877.   1920.     0.95 median qi       
## 5 sigma_e                35.1   29.6    43.8    0.95 median qi</code></pre>
<p>To simplify, we might pull the posterior medians for <span class="math inline">\(\sigma^2 + \sigma_1^2\)</span> and <span class="math inline">\(\sigma_1^2\)</span>. We’ll call them <code>diagonal</code> and <code>off_diagonal</code>, respectively.</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb958-1" aria-hidden="true" tabindex="-1"></a>diagonal <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.cs<span class="sc">$</span><span class="st">`</span><span class="at">sigma^2 + sigma[1]^2</span><span class="st">`</span>)</span>
<span id="cb958-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb958-2" aria-hidden="true" tabindex="-1"></a>off_diagonal <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.cs<span class="sc">$</span><span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span>)</span></code></pre></div>
<p>Now we have them, we can make our colored version of the <span class="math inline">\(\mathbf{\Sigma}_r\)</span> Singer and Willett reported in the rightmost column of Table 7.3.</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb959-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb959-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">if_else</span>(row <span class="sc">==</span> col, diagonal, off_diagonal)) <span class="sc">%&gt;%</span> </span>
<span id="cb959-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb959-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">fct_rev</span>(col)) <span class="sc">%&gt;%</span> </span>
<span id="cb959-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb959-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> row, <span class="at">y =</span> col)) <span class="sc">+</span></span>
<span id="cb959-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb959-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb959-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">&quot;posterior</span><span class="sc">\n</span><span class="st">median&quot;</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb959-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb959-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb959-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Sigma)[<span class="fu">italic</span>(r)]<span class="sc">*</span><span class="st">&quot; for the compound symmetric model&quot;</span>)) <span class="sc">+</span></span>
<span id="cb959-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb959-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-31-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
<div id="heterogeneous-compound-symmetric-error-covariance-matrix-." class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Heterogeneous compound symmetric error covariance matrix .<a href="examining-the-multilevel-models-error-covariance-structure.html#heterogeneous-compound-symmetric-error-covariance-matrix-." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we extend the compound symmetric matrix by allowing the residual variances to vary across the time waves. Thus, instead of a single <span class="math inline">\(\sigma_\epsilon^2\)</span> parameter, we’ll have <span class="math inline">\(\sigma_1^2\)</span> through <span class="math inline">\(\sigma_4^2\)</span>. However, we still have a single correlation parameter <span class="math inline">\(\rho\)</span>. We can express this as</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma_1^2 &amp; \sigma_1 \sigma_2 \rho &amp; \sigma_1 \sigma_3 \rho &amp; \sigma_1 \sigma_4 \rho \\
  \sigma_2 \sigma_1 \rho &amp; \sigma_1^2 &amp; \sigma_2 \sigma_3 \rho &amp; \sigma_2 \sigma_4 \rho \\
  \sigma_3 \sigma_1 \rho &amp; \sigma_3 \sigma_2 \rho &amp; \sigma_3^2 &amp; \sigma_3 \sigma_4 \rho \\
  \sigma_4 \sigma_1 \rho &amp; \sigma_4 \sigma_2 \rho &amp; \sigma_4 \sigma_3 \rho &amp; \sigma_4^2 \end{bmatrix},
\end{align*}
\]</span></p>
<p>where, even though the correlation is the same in all cells, the covariances will differ because they are based on different combinations of the <span class="math inline">\(\sigma\)</span> parameters. To fit this model with <strong>brms</strong>, we will continue to use <code>cosy(gr = id)</code>. But now we wrap the entire model <code>formula</code> within the <code>bf()</code> function and allow the residual standard deviations to vary across he waves with the line <code>sigma ~ 0 + factor(time)</code>.</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb960-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp,</span>
<span id="cb960-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb960-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> ccog <span class="sc">+</span> time<span class="sc">:</span>ccog <span class="sc">+</span> <span class="fu">cosy</span>(<span class="at">gr =</span> id),</span>
<span id="cb960-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-5" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(time)), </span>
<span id="cb960-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb960-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb960-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb960-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.04&quot;</span>)</span></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb961-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.4</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = log 
## Formula: opp ~ 0 + Intercept + time + ccog + time:ccog + cosy(gr = id) 
##          sigma ~ 0 + factor(time)
##    Data: opposites_pp (Number of observations: 140) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Correlation Structures:
##      Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## cosy    0.720     0.060    0.594    0.828 1.003     1851     2390
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept          164.125     5.670  153.113  175.163 1.001     3548     3002
## time                26.969     1.458   24.104   29.786 1.000     3560     3165
## ccog                -0.186     0.480   -1.133    0.752 1.000     3543     2918
## time:ccog            0.440     0.122    0.208    0.683 1.001     3485     3164
## sigma_factortime0    3.640     0.122    3.413    3.896 1.002     2136     2899
## sigma_factortime1    3.494     0.117    3.277    3.741 1.003     2184     2614
## sigma_factortime2    3.528     0.116    3.310    3.767 1.004     2147     2631
## sigma_factortime3    3.594     0.121    3.378    3.849 1.003     2165     2560
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>If you look at the second row in the output, you’ll see that the <strong>brms</strong> default was to model <span class="math inline">\(\log(\sigma_j)\)</span>. Thus, you’ll have to exponentiate those posteriors to get them in their natural metric. Here’s a quick conversion.</p>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb963-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit7<span class="fl">.4</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span></code></pre></div>
<pre><code>##                   Estimate     Q2.5    Q97.5
## sigma_factortime0 38.10989 30.36652 49.18362
## sigma_factortime1 32.90615 26.48896 42.11996
## sigma_factortime2 34.07236 27.37209 43.26927
## sigma_factortime3 36.38293 29.30780 46.93631</code></pre>
<p>To get the marginal posteriors for the full <span class="math inline">\(\mathbf{\Sigma}_r\)</span> matrix, we’ll want to work directly with the output from <code>as_draws_df()</code>.</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-1" aria-hidden="true" tabindex="-1"></a>sigma.hcs <span class="ot">&lt;-</span></span>
<span id="cb965-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb965-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime0),</span>
<span id="cb965-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime1),</span>
<span id="cb965-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime2),</span>
<span id="cb965-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime3),</span>
<span id="cb965-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-7" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb965-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">rho          =</span> cosy,</span>
<span id="cb965-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb965-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime0)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb965-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[2]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime1)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb965-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[3]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime2)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb965-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma[4]^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_factortime3)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb965-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">sigma[2]*sigma[1]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[3]*sigma[1]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[4]*sigma[1]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-17" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb965-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[1]*sigma[2]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[3]*sigma[2]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[4]*sigma[2]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-21" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb965-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[1]*sigma[3]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[2]*sigma[3]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[4]*sigma[3]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-25"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-25" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb965-26"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[1]*sigma[4]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-27"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[2]*sigma[4]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[2]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> rho,</span>
<span id="cb965-28"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">sigma[3]*sigma[4]*rho</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">sigma[3]</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">sigma[4]</span><span class="st">`</span> <span class="sc">*</span> rho)</span>
<span id="cb965-29"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb965-30"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-30" aria-hidden="true" tabindex="-1"></a><span class="co"># what did we do?</span></span>
<span id="cb965-31"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb965-31" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sigma.hcs)</span></code></pre></div>
<pre><code>## Rows: 4,000
## Columns: 21
## $ `sigma[1]`              &lt;dbl&gt; 41.13724, 33.60224, 42.36335, 45.88432, 32.06087, 34.74853, 38.26811, 29.828…
## $ `sigma[2]`              &lt;dbl&gt; 30.65009, 34.93099, 34.32485, 35.16067, 31.28381, 29.23170, 29.89308, 26.083…
## $ `sigma[3]`              &lt;dbl&gt; 38.48143, 34.95699, 46.66269, 43.97816, 31.19888, 31.98744, 30.18341, 26.872…
## $ `sigma[4]`              &lt;dbl&gt; 36.18515, 33.68567, 44.92193, 42.97743, 34.08200, 31.70020, 29.48331, 33.833…
## $ rho                     &lt;dbl&gt; 0.7486510, 0.7430958, 0.7551732, 0.7636550, 0.6220704, 0.5995972, 0.6115675,…
## $ `sigma[1]^2`            &lt;dbl&gt; 1692.2721, 1129.1104, 1794.6532, 2105.3707, 1027.8993, 1207.4601, 1464.4485,…
## $ `sigma[2]^2`            &lt;dbl&gt; 939.4279, 1220.1739, 1178.1951, 1236.2728, 978.6765, 854.4923, 893.5961, 680…
## $ `sigma[3]^2`            &lt;dbl&gt; 1480.8203, 1221.9914, 2177.4063, 1934.0790, 973.3700, 1023.1961, 911.0379, 7…
## $ `sigma[4]^2`            &lt;dbl&gt; 1309.3648, 1134.7245, 2017.9800, 1847.0591, 1161.5825, 1004.9030, 869.2656, …
## $ `sigma[2]*sigma[1]*rho` &lt;dbl&gt; 943.9440, 872.2157, 1098.1090, 1232.0225, 623.9279, 609.0460, 699.6037, 515.…
## $ `sigma[3]*sigma[1]*rho` &lt;dbl&gt; 1185.1291, 872.8650, 1492.8170, 1540.9857, 622.2341, 666.4621, 706.3983, 530…
## $ `sigma[4]*sigma[1]*rho` &lt;dbl&gt; 1114.4096, 841.1205, 1437.1274, 1505.9200, 679.7354, 660.4776, 690.0136, 668…
## $ `sigma[1]*sigma[2]*rho` &lt;dbl&gt; 943.9440, 872.2157, 1098.1090, 1232.0225, 623.9279, 609.0460, 699.6037, 515.…
## $ `sigma[3]*sigma[2]*rho` &lt;dbl&gt; 883.0033, 907.3812, 1209.5530, 1180.8411, 607.1529, 560.6517, 551.8020, 464.…
## $ `sigma[4]*sigma[2]*rho` &lt;dbl&gt; 830.3123, 874.3814, 1164.4306, 1153.9707, 663.2605, 555.6173, 539.0031, 584.…
## $ `sigma[1]*sigma[3]*rho` &lt;dbl&gt; 1185.1291, 872.8650, 1492.8170, 1540.9857, 622.2341, 666.4621, 706.3983, 530…
## $ `sigma[2]*sigma[3]*rho` &lt;dbl&gt; 883.0033, 907.3812, 1209.5530, 1180.8411, 607.1529, 560.6517, 551.8020, 464.…
## $ `sigma[4]*sigma[3]*rho` &lt;dbl&gt; 1042.4636, 875.0323, 1582.9775, 1443.3602, 661.4600, 607.9966, 544.2380, 601…
## $ `sigma[1]*sigma[4]*rho` &lt;dbl&gt; 1114.4096, 841.1205, 1437.1274, 1505.9200, 679.7354, 660.4776, 690.0136, 668…
## $ `sigma[2]*sigma[4]*rho` &lt;dbl&gt; 830.3123, 874.3814, 1164.4306, 1153.9707, 663.2605, 555.6173, 539.0031, 584.…
## $ `sigma[3]*sigma[4]*rho` &lt;dbl&gt; 1042.4636, 875.0323, 1582.9775, 1443.3602, 661.4600, 607.9966, 544.2380, 601…</code></pre>
<p>Here’s the numeric summary.</p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb967-1" aria-hidden="true" tabindex="-1"></a>sigma.hcs <span class="sc">%&gt;%</span> </span>
<span id="cb967-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb967-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb967-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb967-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb967-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb967-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb967-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb967-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 21 × 7
##    name                    value .lower  .upper .width .point .interval
##    &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1 rho                      0.72   0.59    0.83   0.95 median qi       
##  2 sigma[1]                37.9   30.4    49.2    0.95 median qi       
##  3 sigma[1]*sigma[2]*rho  892.   533.   1561.     0.95 median qi       
##  4 sigma[1]*sigma[3]*rho  924.   547.   1607.     0.95 median qi       
##  5 sigma[1]*sigma[4]*rho  992.   585.   1714.     0.95 median qi       
##  6 sigma[1]^2            1439.   922.   2419.     0.95 median qi       
##  7 sigma[2]                32.7   26.5    42.1    0.95 median qi       
##  8 sigma[2]*sigma[1]*rho  892.   533.   1561.     0.95 median qi       
##  9 sigma[2]*sigma[3]*rho  802.   476.   1384.     0.95 median qi       
## 10 sigma[2]*sigma[4]*rho  854.   512.   1486.     0.95 median qi       
## # ℹ 11 more rows</code></pre>
<p>That’s a lot of information to wade through. Here we simplify the picture by making our plot version of the matrix Singer and Willett reported in the rightmost column of Table 7.3.</p>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange the panels</span></span>
<span id="cb969-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-2" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> </span>
<span id="cb969-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;sigma[1]^2&quot;</span>, <span class="st">&quot;sigma[1]*sigma[2]*rho&quot;</span>, <span class="st">&quot;sigma[1]*sigma[3]*rho&quot;</span>, <span class="st">&quot;sigma[1]*sigma[4]*rho&quot;</span>, </span>
<span id="cb969-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[2]*sigma[1]*rho&quot;</span>, <span class="st">&quot;sigma[2]^2&quot;</span>, <span class="st">&quot;sigma[2]*sigma[3]*rho&quot;</span>, <span class="st">&quot;sigma[2]*sigma[4]*rho&quot;</span>, </span>
<span id="cb969-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[3]*sigma[1]*rho&quot;</span>, <span class="st">&quot;sigma[3]*sigma[2]*rho&quot;</span>, <span class="st">&quot;sigma[3]^2&quot;</span>, <span class="st">&quot;sigma[3]*sigma[4]*rho&quot;</span>, </span>
<span id="cb969-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sigma[4]*sigma[1]*rho&quot;</span>, <span class="st">&quot;sigma[4]*sigma[2]*rho&quot;</span>, <span class="st">&quot;sigma[4]*sigma[3]*rho&quot;</span>, <span class="st">&quot;sigma[4]^2&quot;</span>)</span>
<span id="cb969-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb969-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb969-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-9" aria-hidden="true" tabindex="-1"></a>sigma.hcs <span class="sc">%&gt;%</span> </span>
<span id="cb969-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">sigma[1]^2</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">sigma[3]*sigma[4]*rho</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb969-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb969-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb969-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb969-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb969-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb969-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb969-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb969-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb969-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb969-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">&quot;posterior</span><span class="sc">\n</span><span class="st">median&quot;</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb969-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb969-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb969-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Sigma)[<span class="fu">italic</span>(r)]<span class="sc">*</span><span class="st">&quot; for the heterogeneous compound symmetric model&quot;</span>)) <span class="sc">+</span></span>
<span id="cb969-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb969-25"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb969-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-36-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="autoregressive-error-covariance-matrix." class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Autoregressive error covariance matrix.<a href="examining-the-multilevel-models-error-covariance-structure.html#autoregressive-error-covariance-matrix." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first-order autoregressive has a strict “band-diagonal” structure governed by two parameters, which Singer and Willett called <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\rho\)</span>. From Table 7.3 (p. 260), we see that matrix follows the form</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma^2 &amp; \sigma^2 \rho &amp; \sigma^2 \rho^2 &amp; \sigma^2 \rho^3 \\
  \sigma^2 \rho &amp; \sigma^2 &amp; \sigma^2 \rho &amp; \sigma^2 \rho^2 \\
  \sigma^2 \rho^2 &amp; \sigma^2 \rho &amp; \sigma^2 &amp; \sigma^2 \rho \\
  \sigma^2 \rho^3 &amp; \sigma^2 \rho^2 &amp; \sigma^2 \rho &amp; \sigma^2 \end{bmatrix},
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\rho\)</span> is the correlation of one time point to the one immediately before or after, after conditioning on the liner model. In a similar way, <span class="math inline">\(\rho^2\)</span> is the correlation between time points with one degree of separation (e.g., time 1 with time 3) and <span class="math inline">\(\rho^3\)</span> is the correlation between the first and fourth time point. The other parameter, <span class="math inline">\(\sigma^2\)</span> is the residual variance after conditioning on the linear model.</p>
<p>Once can fit this model with <strong>brms</strong> using a version of the <code>ar()</code> syntax. However, the model will follow a slightly different parameterization, following the form:</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho^2 &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho^3 \\
  \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho^2 \\
  \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho^2 &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho \\
  \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho^3 &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho^2 &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2 \rho &amp; \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2
  \end{bmatrix},\\
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\sigma_\epsilon\)</span> is the residual variance after conditioning on both the linear model AND the autoregressive correlation <span class="math inline">\(\rho\)</span>. It’s not clear to me why <strong>brms</strong> is parameterized this way, but this is what we’ve got. The main point to get is that what Singer and Willett called <span class="math inline">\(\sigma\)</span> in their autoregressive model, we’ll have to call <span class="math inline">\(\sigma_\epsilon \Big / \sqrt{1 - \rho^2}\)</span>. Thus, if you substitute our verbose <strong>brms</strong> term <span class="math inline">\(\sigma_\epsilon \Big / \sqrt{1 - \rho^2}\)</span> for Singer and Willett’s compact term <span class="math inline">\(\sigma\)</span>, you’ll see the hellish matrix above is the same as the much simpler one before it.</p>
<p>To fit the first-order autoregressive model with <strong>brms</strong>, we use the <code>ar()</code> function. As with the last few models, notice how we continue to omit the <code>(1 + time | id)</code> syntax. Instead, we impose the autoregressive structure <em>within persons</em> by setting <code>gr = id</code> within <code>ar()</code>. We also set <code>cov = TRUE</code>.</p>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb970-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.5</span> <span class="ot">&lt;-</span></span>
<span id="cb970-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb970-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp,</span>
<span id="cb970-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb970-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb970-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb970-4" aria-hidden="true" tabindex="-1"></a>      opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> ccog <span class="sc">+</span> time<span class="sc">:</span>ccog <span class="sc">+</span> <span class="fu">ar</span>(<span class="at">gr =</span> id, <span class="at">cov =</span> <span class="cn">TRUE</span>),</span>
<span id="cb970-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb970-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb970-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb970-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb970-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb970-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.05&quot;</span>)</span></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb971-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.5</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: opp ~ 0 + Intercept + time + ccog + time:ccog + ar(gr = id, cov = TRUE) 
##    Data: opposites_pp (Number of observations: 140) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Correlation Structures:
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## ar[1]    0.816     0.041    0.730    0.889 1.000     3651     2814
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept  164.394     6.122  152.165  176.435 1.002     4574     3109
## time        27.217     1.908   23.488   30.865 1.003     4100     2987
## ccog        -0.030     0.497   -0.990    0.942 1.000     4652     3058
## time:ccog    0.420     0.153    0.123    0.718 1.000     4815     2911
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma   20.319     1.370   17.874   23.232 1.003     4084     2672
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The <code>ar[1]</code> row in our summary is <span class="math inline">\(\rho\)</span>. As we discussed just before fitting the model, the <code>sigma</code> line is the summary for what I’m calling <span class="math inline">\(\sigma_\epsilon\)</span>, which is the residual standard deviation after conditioning on both the linear model AND <span class="math inline">\(\rho\)</span>. If we rename the <span class="math inline">\(\sigma^2\)</span> parameter in the text as <span class="math inline">\(\sigma_\text{Singer &amp; Willett (2003)}^2\)</span>, we can convert our <span class="math inline">\(\sigma_\epsilon\)</span> parameter to that metric using the formula</p>
<p><span class="math display">\[\sigma_\text{Singer &amp; Willett (2003)}^2 = \left (\sigma_\epsilon \Big / \sqrt{1 - \rho^2} \right )^2.\]</span></p>
<p>With that formula in hand, we’re ready to compute the marginal posteriors for the full <span class="math inline">\(\mathbf{\Sigma}_r\)</span> matrix, saving the results as <code>sigma.ar</code>.</p>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-1" aria-hidden="true" tabindex="-1"></a>sigma.ar <span class="ot">&lt;-</span></span>
<span id="cb973-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb973-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma_e =</span> sigma,</span>
<span id="cb973-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma   =</span> sigma_e <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">ar[1]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb973-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">rho             =</span> <span class="st">`</span><span class="at">ar[1]</span><span class="st">`</span>,</span>
<span id="cb973-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma^2</span><span class="st">`</span>       <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb973-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma^2 rho</span><span class="st">`</span>   <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> rho,</span>
<span id="cb973-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma^2 rho^2</span><span class="st">`</span> <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> rho<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb973-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb973-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma^2 rho^3</span><span class="st">`</span> <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> rho<span class="sc">^</span><span class="dv">3</span>)</span></code></pre></div>
<p>Here’s the numeric summary.</p>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb974-1" aria-hidden="true" tabindex="-1"></a>sigma.ar <span class="sc">%&gt;%</span> </span>
<span id="cb974-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb974-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb974-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb974-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb974-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb974-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb974-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb974-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 7
##   name            value .lower  .upper .width .point .interval
##   &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 rho              0.82   0.73    0.89   0.95 median qi       
## 2 sigma^2       1247.   890.   1903.     0.95 median qi       
## 3 sigma^2 rho   1019.   668    1687.     0.95 median qi       
## 4 sigma^2 rho^2  831.   499.   1484.     0.95 median qi       
## 5 sigma^2 rho^3  680.   369.   1311      0.95 median qi</code></pre>
<p>To simplify, we might pull the posterior medians for <span class="math inline">\(\sigma^2\)</span> through <span class="math inline">\(\sigma^2 \rho^3\)</span>.</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb976-1" aria-hidden="true" tabindex="-1"></a>s2   <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.ar<span class="sc">$</span><span class="st">`</span><span class="at">sigma^2</span><span class="st">`</span>)</span>
<span id="cb976-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb976-2" aria-hidden="true" tabindex="-1"></a>s2p  <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.ar<span class="sc">$</span><span class="st">`</span><span class="at">sigma^2 rho</span><span class="st">`</span>)</span>
<span id="cb976-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb976-3" aria-hidden="true" tabindex="-1"></a>s2p2 <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.ar<span class="sc">$</span><span class="st">`</span><span class="at">sigma^2 rho^2</span><span class="st">`</span>)</span>
<span id="cb976-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb976-4" aria-hidden="true" tabindex="-1"></a>s2p3 <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.ar<span class="sc">$</span><span class="st">`</span><span class="at">sigma^2 rho^3</span><span class="st">`</span>)</span></code></pre></div>
<p>Now we have them, we can make our colored version of the <span class="math inline">\(\mathbf{\Sigma}_r\)</span> Singer and Willett reported in the rightmost column of Table 7.3.</p>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb977-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb977-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb977-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">c</span>(s2, s2p, s2p2, s2p3,</span>
<span id="cb977-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-4" aria-hidden="true" tabindex="-1"></a>                   s2p, s2, s2p, s2p2,</span>
<span id="cb977-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-5" aria-hidden="true" tabindex="-1"></a>                   s2p2, s2p, s2, s2p,</span>
<span id="cb977-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-6" aria-hidden="true" tabindex="-1"></a>                   s2p3, s2p2, s2p, s2)) <span class="sc">%&gt;%</span> </span>
<span id="cb977-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb977-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">col   =</span> <span class="fu">fct_rev</span>(col)) <span class="sc">%&gt;%</span> </span>
<span id="cb977-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb977-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> row, <span class="at">y =</span> col)) <span class="sc">+</span></span>
<span id="cb977-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb977-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb977-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">&quot;posterior</span><span class="sc">\n</span><span class="st">median&quot;</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb977-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb977-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb977-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Sigma)[<span class="fu">italic</span>(r)]<span class="sc">*</span><span class="st">&quot; for the autoregressive model&quot;</span>)) <span class="sc">+</span></span>
<span id="cb977-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb977-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-41-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>With this presentation, that strict band-diagonal structure really pops.</p>
</div>
<div id="heterogeneous-autoregressive-error-covariance-matrix." class="section level3 hasAnchor" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Heterogeneous autoregressive error covariance matrix.<a href="examining-the-multilevel-models-error-covariance-structure.html#heterogeneous-autoregressive-error-covariance-matrix." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the heterogeneous autoregressive error covariance matrix, we relax the assumption that the variances on the diagonal of the <span class="math inline">\(\mathbf{\Sigma}_r\)</span> matrix are constant across waves. From Table 7.3 (p. 260), we see that matrix follows the form</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma_1^2 &amp; \sigma_1 \sigma_2 \rho &amp; \sigma_1 \sigma_3 \rho^2 &amp; \sigma_1 \sigma_4 \rho^3 \\
  \sigma_2 \sigma_1 \rho &amp; \sigma_2^2 &amp; \sigma_2 \sigma_3 \rho &amp; \sigma_2 \sigma_4 \rho^2 \\
  \sigma_3 \sigma_1 \rho^2 &amp; \sigma_3 \sigma_2 \rho &amp; \sigma_3^2 &amp; \sigma_3 \sigma_4 \rho \\
  \sigma_4 \sigma_1 \rho^3 &amp; \sigma_4 \sigma_2 \rho^2 &amp; \sigma_4 \sigma_3 \rho &amp; \sigma_4^2 \end{bmatrix},
\end{align*}
\]</span></p>
<p>where, as before, <span class="math inline">\(\rho\)</span> is the correlation of one time point to the one immediately before or after, after conditioning on the liner model. To fit this model with <strong>brms</strong>, we continue to use the <code>ar(gr = id, cov = TRUE)</code> syntax. The only adjustment is we now wrap the <code>formula</code> within the <code>bf()</code> function and add a second line for <code>sigma</code>.</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.6</span> <span class="ot">&lt;-</span></span>
<span id="cb978-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp,</span>
<span id="cb978-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb978-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> time <span class="sc">+</span> ccog <span class="sc">+</span> time<span class="sc">:</span>ccog <span class="sc">+</span> <span class="fu">ar</span>(<span class="at">gr =</span> id, <span class="at">cov =</span> <span class="cn">TRUE</span>),</span>
<span id="cb978-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-5" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(time)), </span>
<span id="cb978-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb978-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb978-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb978-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.06&quot;</span>)</span></code></pre></div>
<p>Inspect the parameter summary.</p>
<div class="sourceCode" id="cb979"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb979-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb979-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.6</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = log 
## Formula: opp ~ 0 + Intercept + time + ccog + time:ccog + ar(gr = id, cov = TRUE) 
##          sigma ~ 0 + factor(time)
##    Data: opposites_pp (Number of observations: 140) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Correlation Structures:
##       Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## ar[1]    0.808     0.041    0.721    0.881 1.001     3564     2753
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## Intercept          164.572     6.174  152.309  176.850 1.001     4594     3340
## time                27.171     1.998   23.184   31.162 1.001     3796     2622
## ccog                -0.121     0.484   -1.078    0.823 1.002     3890     2999
## time:ccog            0.431     0.157    0.134    0.738 1.000     4145     3186
## sigma_factortime0    3.068     0.106    2.873    3.290 1.001     3789     2765
## sigma_factortime1    2.969     0.087    2.807    3.147 1.000     3088     2704
## sigma_factortime2    3.014     0.086    2.854    3.190 1.001     3286     3145
## sigma_factortime3    3.028     0.102    2.839    3.238 1.002     3863     3005
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here are summaries for the four <span class="math inline">\(\sigma_\epsilon\)</span> posteriors, after exponentiation.</p>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb981-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit7<span class="fl">.6</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span></code></pre></div>
<pre><code>##                   Estimate     Q2.5    Q97.5
## sigma_factortime0 21.49858 17.68502 26.83905
## sigma_factortime1 19.46950 16.55493 23.25568
## sigma_factortime2 20.36495 17.35231 24.29690
## sigma_factortime3 20.64833 17.09583 25.47358</code></pre>
<p>Extending our workflow from the last section, here how we might compute the marginal posteriors for the full <span class="math inline">\(\mathbf{\Sigma}_r\)</span> matrix, saving the results as <code>sigma.har</code>.</p>
<div class="sourceCode" id="cb983"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb983-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-1" aria-hidden="true" tabindex="-1"></a>sigma.har <span class="ot">&lt;-</span></span>
<span id="cb983-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb983-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma_1e =</span> <span class="fu">exp</span>(b_sigma_factortime0),</span>
<span id="cb983-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_2e =</span> <span class="fu">exp</span>(b_sigma_factortime1),</span>
<span id="cb983-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_3e =</span> <span class="fu">exp</span>(b_sigma_factortime2),</span>
<span id="cb983-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_4e =</span> <span class="fu">exp</span>(b_sigma_factortime3)) <span class="sc">%&gt;%</span> </span>
<span id="cb983-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma_1 =</span> sigma_1e <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">ar[1]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb983-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_2 =</span> sigma_2e <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">ar[1]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb983-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_3 =</span> sigma_3e <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">ar[1]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb983-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_4 =</span> sigma_4e <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="st">`</span><span class="at">ar[1]</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb983-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">rho =</span> <span class="st">`</span><span class="at">ar[1]</span><span class="st">`</span>,</span>
<span id="cb983-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-12" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb983-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_1^2</span><span class="st">`</span> <span class="ot">=</span> sigma_1<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb983-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_2^2</span><span class="st">`</span> <span class="ot">=</span> sigma_2<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb983-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_3^2</span><span class="st">`</span> <span class="ot">=</span> sigma_3<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb983-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_4^2</span><span class="st">`</span> <span class="ot">=</span> sigma_4<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb983-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb983-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_2 sigma_1 rho</span><span class="st">`</span>   <span class="ot">=</span> sigma_2 <span class="sc">*</span> sigma_1 <span class="sc">*</span> rho,</span>
<span id="cb983-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_3 sigma_1 rho^2</span><span class="st">`</span> <span class="ot">=</span> sigma_3 <span class="sc">*</span> sigma_1 <span class="sc">*</span> rho<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb983-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_4 sigma_1 rho^3</span><span class="st">`</span> <span class="ot">=</span> sigma_4 <span class="sc">*</span> sigma_1 <span class="sc">*</span> rho<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb983-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_3 sigma_2 rho</span><span class="st">`</span>   <span class="ot">=</span> sigma_3 <span class="sc">*</span> sigma_2 <span class="sc">*</span> rho,</span>
<span id="cb983-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_4 sigma_2 rho^2</span><span class="st">`</span> <span class="ot">=</span> sigma_4 <span class="sc">*</span> sigma_2 <span class="sc">*</span> rho<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb983-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb983-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">sigma_4 sigma_3 rho</span><span class="st">`</span>   <span class="ot">=</span> sigma_4 <span class="sc">*</span> sigma_3 <span class="sc">*</span> rho)</span></code></pre></div>
<p>Here’s the numeric summary.</p>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb984-1" aria-hidden="true" tabindex="-1"></a>sigma.har <span class="sc">%&gt;%</span> </span>
<span id="cb984-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb984-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb984-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb984-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb984-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb984-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb984-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb984-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 11 × 7
##    name                    value .lower  .upper .width .point .interval
##    &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
##  1 rho                      0.81   0.72    0.88   0.95 median qi       
##  2 sigma_1^2             1348.   885.   2241.     0.95 median qi       
##  3 sigma_2 sigma_1 rho    983.   625.   1678.     0.95 median qi       
##  4 sigma_2^2             1106.   727.   1814.     0.95 median qi       
##  5 sigma_3 sigma_1 rho^2  831.   496.   1498.     0.95 median qi       
##  6 sigma_3 sigma_2 rho    932.   587.   1605.     0.95 median qi       
##  7 sigma_3^2             1211.   793.   1972.     0.95 median qi       
##  8 sigma_4 sigma_1 rho^3  680.   374.   1276.     0.95 median qi       
##  9 sigma_4 sigma_2 rho^2  762.   451.   1352.     0.95 median qi       
## 10 sigma_4 sigma_3 rho    993.   632.   1637.     0.95 median qi       
## 11 sigma_4^2             1248.   809.   2028.     0.95 median qi</code></pre>
<p>As in the last section, we might pull the posterior medians for <span class="math inline">\(\sigma1^2\)</span> through <span class="math inline">\(\sigma_4^2\)</span>.</p>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-1" aria-hidden="true" tabindex="-1"></a>s12   <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_1^2</span><span class="st">`</span>)</span>
<span id="cb986-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-2" aria-hidden="true" tabindex="-1"></a>s22   <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_2^2</span><span class="st">`</span>)</span>
<span id="cb986-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-3" aria-hidden="true" tabindex="-1"></a>s32   <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_3^2</span><span class="st">`</span>)</span>
<span id="cb986-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-4" aria-hidden="true" tabindex="-1"></a>s42   <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_4^2</span><span class="st">`</span>)</span>
<span id="cb986-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb986-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-6" aria-hidden="true" tabindex="-1"></a>s2s1p  <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_2 sigma_1 rho</span><span class="st">`</span>)</span>
<span id="cb986-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb986-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-8" aria-hidden="true" tabindex="-1"></a>s3s1p2 <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_3 sigma_1 rho^2</span><span class="st">`</span>)</span>
<span id="cb986-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-9" aria-hidden="true" tabindex="-1"></a>s3s2p  <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_3 sigma_2 rho</span><span class="st">`</span>)</span>
<span id="cb986-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb986-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-11" aria-hidden="true" tabindex="-1"></a>s4s1p3 <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_4 sigma_1 rho^3</span><span class="st">`</span>)</span>
<span id="cb986-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-12" aria-hidden="true" tabindex="-1"></a>s4s2p2 <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_4 sigma_2 rho^2</span><span class="st">`</span>)</span>
<span id="cb986-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb986-13" aria-hidden="true" tabindex="-1"></a>s4s3p  <span class="ot">&lt;-</span> <span class="fu">median</span>(sigma.har<span class="sc">$</span><span class="st">`</span><span class="at">sigma_4 sigma_3 rho</span><span class="st">`</span>)</span></code></pre></div>
<p>Now we have them, we can make our colored version of the <span class="math inline">\(\mathbf{\Sigma}_r\)</span> Singer and Willett reported in the rightmost column of Table 7.3.</p>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb987-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb987-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb987-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">c</span>(s12, s2s1p, s3s1p2, s4s1p3,</span>
<span id="cb987-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-4" aria-hidden="true" tabindex="-1"></a>                   s2s1p, s22, s3s2p, s4s2p2,</span>
<span id="cb987-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-5" aria-hidden="true" tabindex="-1"></a>                   s3s1p2, s3s2p, s32, s4s3p,</span>
<span id="cb987-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-6" aria-hidden="true" tabindex="-1"></a>                   s4s1p3, s4s2p2, s4s3p, s42)) <span class="sc">%&gt;%</span> </span>
<span id="cb987-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="at">digits =</span> <span class="dv">0</span>),</span>
<span id="cb987-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">col   =</span> <span class="fu">fct_rev</span>(col)) <span class="sc">%&gt;%</span> </span>
<span id="cb987-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb987-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> row, <span class="at">y =</span> col)) <span class="sc">+</span></span>
<span id="cb987-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb987-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb987-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="st">&quot;posterior</span><span class="sc">\n</span><span class="st">median&quot;</span>, <span class="at">option =</span> <span class="st">&quot;A&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb987-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb987-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb987-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Sigma)[<span class="fu">italic</span>(r)]<span class="sc">*</span><span class="st">&quot; for the heterogeneous autoregressive model&quot;</span>)) <span class="sc">+</span></span>
<span id="cb987-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb987-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-47-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Even though there’s still a strict band diagonal correlation structure, the heterogeneous variances allow for differences among the covariances within the bands.</p>
</div>
<div id="toeplitz-error-covariance-matrix." class="section level3 hasAnchor" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> Toeplitz error covariance matrix.<a href="examining-the-multilevel-models-error-covariance-structure.html#toeplitz-error-covariance-matrix." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Handy as it is, <strong>brms</strong> is not yet set up to fit models with the Toeplitz error covariance matrix, at this time. For details, see <strong>brms</strong> GitHub <a href="https://github.com/paul-buerkner/brms/issues/403#issuecomment-381404989">issue #403</a>.</p>
</div>
<div id="does-choosing-the-correct-error-covariance-structure-really-matter" class="section level3 hasAnchor" number="7.3.7">
<h3><span class="header-section-number">7.3.7</span> Does choosing the “correct” error covariance structure really matter?<a href="examining-the-multilevel-models-error-covariance-structure.html#does-choosing-the-correct-error-covariance-structure-really-matter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we have all our models, we might compare them with information criteria, as was done in the text. Here we’ll use the WAIC. First, compute and save the WAIC estimates.</p>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb988-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit7<span class="fl">.1</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb988-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb988-2" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit7<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb988-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb988-3" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit7<span class="fl">.3</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb988-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb988-4" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit7<span class="fl">.4</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb988-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb988-5" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit7<span class="fl">.5</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span>
<span id="cb988-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb988-6" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit7<span class="fl">.6</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>)</span></code></pre></div>
<p>Now compare the models using WAIC differences and WAIC weights.</p>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb989-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit7<span class="fl">.1</span>, fit7<span class="fl">.2</span>, fit7<span class="fl">.3</span>, fit7<span class="fl">.4</span>, fit7<span class="fl">.5</span>, fit7<span class="fl">.6</span>, <span class="at">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##        elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic   se_waic
## fit7.1    0.0       0.0  -585.5       6.1         46.5    3.4    1171.1   12.2 
## fit7.5  -22.2       4.3  -607.7       8.5          3.4    0.5    1215.4   17.1 
## fit7.2  -22.9       2.9  -608.4       7.7         14.5    1.7    1216.8   15.3 
## fit7.6  -25.0       4.3  -610.5       8.8          6.7    1.1    1221.0   17.6 
## fit7.3  -40.6       6.0  -626.2       8.1          4.5    0.7    1252.3   16.2 
## fit7.4  -42.4       5.5  -627.9       7.8          6.8    0.8    1255.8   15.6</code></pre>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb991-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit7<span class="fl">.1</span>, fit7<span class="fl">.2</span>, fit7<span class="fl">.3</span>, fit7<span class="fl">.4</span>, fit7<span class="fl">.5</span>, fit7<span class="fl">.6</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit7.1 fit7.2 fit7.3 fit7.4 fit7.5 fit7.6 
##      1      0      0      0      0      0</code></pre>
<p>By both methods of comparison, the <em>standard</em> multilevel model for change was the clear winner.</p>
<blockquote>
<p>Perhaps most important, consider how choice of an error covariance structure affects our ability to address our research questions, especially given that it is the <em>fixed effects</em>–and not the <em>variance components</em>–that usually embody these questions. Some might say that refining the error covariance structure for the multilevel model for change is akin to rearranging the deck chairs on the <em>Titanic</em>–it rarely fundamentally changes our parameter estimates. Indeed, regardless of the error structure chosen, estimates of the fixed effects are unbiased and may not be affected much by choices made in the stochastic part of the model (providing that neither the data, nor the error structure, are idiosyncratic). (p. 264, <em>emphasis</em> in the original)</p>
</blockquote>
<p>For more on the idea that researchers generally just care about fixed effects, see the paper by <span class="citation">McNeish et al. (<a href="#ref-mcneishOnTheUnnecessaryUbiquity2017" role="doc-biblioref">2017</a>)</span>, <a href="https://doi.org/10.1037/met0000078"><em>On the unnecessary ubiquity of hierarchical linear modeling</em></a>. Although I can’t disagree with the logic presented by Singer and Willett, or by McNeish and colleagues, I’m uneasy with this perspective for a couple reasons. First, I suspect part of the reason researchers don’t theorize about variances and covariances is because those are difficult metrics for many of us to think about. Happily, <strong>brms</strong> makes these more accessible by parameterizing them as standard deviations and correlations.</p>
<p>Second, in many disciplines, including my own (clinical psychology), multilevel models are still exotic and researchers just aren’t used to thinking in their terms. But I see this as more of a reason to spread the multilevel gospel than to down emphasize variance parameters. In my opinion, which is heavily influenced by <a href="https://elevanth.org/blog/2017/08/24/multilevel-regression-as-default/">McElreath’s</a>, it would be great if someday soon, researchers used multilevel models (longitudinal or otherwise) as the default rather than the exception.</p>
<p>Third, I actually care about random effects. If you go back and compare the models from this chapter, it was only the multilevel growth model (<code>fit7.1</code>) that assigned person-specific intercepts and slopes. In clinical psychology, this matters! I want a model that allows me to make plots like this:</p>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 35 person-specific growth trajectories</span></span>
<span id="cb993-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb993-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-3" aria-hidden="true" tabindex="-1"></a>  opposites_pp <span class="sc">%&gt;%</span> </span>
<span id="cb993-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, ccog) <span class="sc">%&gt;%</span> </span>
<span id="cb993-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(id, ccog),</span>
<span id="cb993-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb993-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb993-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit7<span class="fl">.1</span>, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb993-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb993-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb993-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> Estimate, <span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb993-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb993-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;35 person-specific growth trajectories&quot;</span>,</span>
<span id="cb993-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;day&quot;</span>,</span>
<span id="cb993-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;opposites naming task&quot;</span>) <span class="sc">+</span></span>
<span id="cb993-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb993-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-50-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 35 person-specific intercept and slope parameters</span></span>
<span id="cb994-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">coef</span>(fit7<span class="fl">.1</span>)<span class="sc">$</span>id[, , <span class="st">&quot;Intercept&quot;</span>],</span>
<span id="cb994-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coef</span>(fit7<span class="fl">.1</span>)<span class="sc">$</span>id[, , <span class="st">&quot;time&quot;</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb994-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb994-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;intercepts&quot;</span>, <span class="st">&quot;slopes&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb994-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb994-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb994-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb994-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb994-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> id)) <span class="sc">+</span></span>
<span id="cb994-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb994-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb994-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;35 person-specific intercept and slope parameters&quot;</span>,</span>
<span id="cb994-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>) <span class="sc">+</span></span>
<span id="cb994-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb994-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb994-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-50-2.png" width="384" style="display: block; margin: auto;" /></p>
<p>Of all the models we fit, only the standard multilevel model for change allows us to drill down all the way to the individual participants and this was accomplished by how it parameterized <span class="math inline">\(\mathbf{\Sigma}_r\)</span>. Even your substantive theory isn’t built around the subtleties in the <span class="math inline">\(4 \times 4 = 16\)</span> cells in the <span class="math inline">\(\mathbf{\Sigma}_r\)</span>, it still matters that our <code>fit7.1</code> parameterized them by way of <span class="math inline">\(\sigma_\epsilon\)</span>, <span class="math inline">\(\sigma_0\)</span>, <span class="math inline">\(\sigma_1\)</span>, and <span class="math inline">\(\rho_{01}\)</span>.</p>
<p>But Singer and Willett went on:</p>
<blockquote>
<p>But refining our hypotheses about the error covariance structure <em>does</em> affect the <em>precision</em> of estimates of the fixed effects and will therefore impact hypothesis testing and confidence interval construction. (p. 264, <em>emphasis</em> in the original)</p>
</blockquote>
<p>I’m going to showcase this in a coefficient plot, rather than the way the authors did in their Table 7.4. First, we’ll want a custom wrangling function. Let’s call it <code>gamma_summary()</code>.</p>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-1" aria-hidden="true" tabindex="-1"></a>gamma_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(brmsfit) {</span>
<span id="cb995-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb995-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixef</span>(brmsfit)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, ] <span class="sc">%&gt;%</span> </span>
<span id="cb995-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb995-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gamma =</span> <span class="fu">c</span>(<span class="st">&quot;gamma[0][0]&quot;</span>, <span class="st">&quot;gamma[1][0]&quot;</span>, <span class="st">&quot;gamma[0][1]&quot;</span>, <span class="st">&quot;gamma[1][1]&quot;</span>))</span>
<span id="cb995-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb995-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb995-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb995-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb995-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gamma_summary</span>(fit7<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##              Estimate Est.Error         Q2.5       Q97.5       gamma
## Intercept 164.1077730 6.4531957 151.63917320 177.0652489 gamma[0][0]
## time       26.9878037 2.0932513  22.80959495  31.2354433 gamma[1][0]
## ccog       -0.1287983 0.5206337  -1.16248699   0.8813408 gamma[0][1]
## time:ccog   0.4337499 0.1672927   0.09452261   0.7611580 gamma[1][1]</code></pre>
<p>Now wrangle and plot.</p>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-1" aria-hidden="true" tabindex="-1"></a>type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;standard growth model&quot;</span>, <span class="st">&quot;unstructured&quot;</span>, <span class="st">&quot;compound symmetric&quot;</span>, <span class="st">&quot;heterogeneous compound symmetric&quot;</span>, <span class="st">&quot;autoregressive&quot;</span>, <span class="st">&quot;heterogeneous autoregressive&quot;</span>)</span>
<span id="cb997-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb997-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">fit  =</span> <span class="fu">str_c</span>(<span class="st">&quot;fit7.&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)),</span>
<span id="cb997-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels =</span> type)) <span class="sc">%&gt;%</span> </span>
<span id="cb997-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type  =</span> <span class="fu">fct_rev</span>(type),</span>
<span id="cb997-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">gamma =</span> <span class="fu">map</span>(fit, <span class="sc">~</span><span class="fu">get</span>(.) <span class="sc">%&gt;%</span> <span class="fu">gamma_summary</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb997-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(gamma) <span class="sc">%&gt;%</span> </span>
<span id="cb997-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb997-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> type)) <span class="sc">+</span></span>
<span id="cb997-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="fl">1.25</span>) <span class="sc">+</span></span>
<span id="cb997-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;marginal posterior&quot;</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb997-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Parameter precision can vary across model types.&quot;</span>,</span>
<span id="cb997-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb997-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb997-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb997-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb997-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb997-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gamma, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">labeller =</span> label_parsed, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-52-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Yep, the way we parameterize <span class="math inline">\(\mathbf{\Sigma}_r\)</span> might have subtle consequences for the widths of our marginal <span class="math inline">\(\gamma\)</span> posteriors. This can matter a lot when you’re analyzing data from, say, a clinical trial where lives may depend on the results of your analysis. Rearrange the deck chairs on your <em>Titanic</em> with caution, friends. Someone might trip and hurt themselves.</p>
</div>
<div id="bonus-did-we-trade-multilevel-for-multivariate" class="section level3 hasAnchor" number="7.3.8">
<h3><span class="header-section-number">7.3.8</span> Bonus: Did we trade multilevel for multivariate?<a href="examining-the-multilevel-models-error-covariance-structure.html#bonus-did-we-trade-multilevel-for-multivariate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far in this chapter, only the first model <code>fit7.1</code> used the conventional <strong>brms</strong> multilevel syntax, such as <code>(1 + time | id)</code>. The other five models used the <code>unstr()</code>, <code>cosy()</code>, or <code>ar()</code> helper functions, instead. Singer and Willett didn’t exactly come out and say it this way, but in a sense, <code>fit7.1</code> is the only multilevel model we’ve fit so far in this chapter. <span class="citation">Mallinckrod et al. (<a href="#ref-mallinckrod2008recommendations" role="doc-biblioref">2008</a>)</span> made the point more clearly:</p>
<blockquote>
<p>A simple formulation of the general linear mixed model… can be implemented in which the random effects are not explicitly modeled, but rather are included as part of the marginal covariance matrix… leading them to what could alternatively be described as a multivariate normal model. (p. 306)</p>
</blockquote>
<p>Thus we might think of all our models after <code>fit7.1</code> as special kinds of multivariate panel models. To help make this easier to see, let’s first fit a simplified version of the unstructured model, following the form</p>
<p><span class="math display">\[
\begin{align*}
\text{opp}_{ij} &amp; \sim \operatorname{Normal}(\mu_j, \mathbf{\Sigma}_r) \\
\mu_j &amp; = \pi_{0j} \\
\mathbf{\Sigma}_r &amp; = \begin{bmatrix}
  \sigma_1^2 &amp; \sigma_{12} &amp; \sigma_{13} &amp; \sigma_{14} \\
  \sigma_{21} &amp; \sigma_2^2 &amp; \sigma_{23} &amp; \sigma_{24} \\
  \sigma_{31} &amp; \sigma_{32} &amp; \sigma_3^2 &amp; \sigma_{34} \\
  \sigma_{41} &amp; \sigma_{42} &amp; \sigma_{43} &amp; \sigma_4^2 \end{bmatrix},
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\pi_{0j}\)</span> is the intercept, which is estimated separately for each of the 4 <span class="math inline">\(j\)</span> time points, and <span class="math inline">\(\mathbf{\Sigma}_r\)</span> is the unstructured variance/covariance matrix. To fit those separate <span class="math inline">\(\pi_{0j}\)</span> intercepts with <code>brm()</code>, we use the syntax of <code>0 + factor(time)</code> in the <span class="math inline">\(\mu_j\)</span> portion of the model. Otherwise, the syntax is much the same as with the first unstructured model <code>fit7.2</code>.</p>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb998-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.7</span> <span class="ot">&lt;-</span></span>
<span id="cb998-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp, </span>
<span id="cb998-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb998-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(time) <span class="sc">+</span> <span class="fu">unstr</span>(<span class="at">time =</span> time, <span class="at">gr =</span> id),</span>
<span id="cb998-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-5" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(time)),</span>
<span id="cb998-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb998-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb998-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb998-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.07&quot;</span>)</span></code></pre></div>
<p>Check the parameter summary.</p>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb999-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.7</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = log 
## Formula: opp ~ 0 + factor(time) + unstr(time = time, gr = id) 
##          sigma ~ 0 + factor(time)
##    Data: opposites_pp (Number of observations: 140) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Correlation Structures:
##              Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## cortime(0,1)    0.739     0.078    0.556    0.858 1.002     1975     2336
## cortime(0,2)    0.624     0.098    0.407    0.787 1.001     2190     2566
## cortime(1,2)    0.780     0.066    0.628    0.884 1.002     2666     3057
## cortime(0,3)    0.288     0.144   -0.014    0.550 1.001     2263     2490
## cortime(1,3)    0.585     0.105    0.352    0.762 1.001     2471     3004
## cortime(2,3)    0.734     0.076    0.565    0.854 1.001     3141     3107
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## factortime0        164.394     6.069  153.024  176.217 1.002     2371     2917
## factortime1        192.009     5.515  181.216  202.614 1.002     1972     2296
## factortime2        216.654     5.865  204.734  228.130 1.002     1961     2089
## factortime3        246.064     6.443  233.261  258.609 1.000     2426     2532
## sigma_factortime0    3.570     0.113    3.364    3.801 1.000     2453     2397
## sigma_factortime1    3.464     0.108    3.264    3.694 1.002     2202     2341
## sigma_factortime2    3.527     0.108    3.326    3.750 1.002     2236     2461
## sigma_factortime3    3.611     0.112    3.401    3.835 1.002     2558     2808
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Once again, those 4 <code>sigma_</code> parameters were fit using the log link. Here they are after exponentiation.</p>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1001-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1001-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit7<span class="fl">.7</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span></code></pre></div>
<pre><code>##                   Estimate     Q2.5    Q97.5
## sigma_factortime0 35.50063 28.89688 44.72506
## sigma_factortime1 31.93331 26.14629 40.19886
## sigma_factortime2 34.01411 27.83327 42.54170
## sigma_factortime3 36.99593 29.99889 46.29403</code></pre>
<p>All we’ve really done is fit an unconditional multivariate normal model for <code>opp</code>, across the four time points. To see, compare the posterior point estimates in the <code>Population-Level Effects</code> section (or their exponentiated values, above), to the sample means and SD’s for <code>opp</code> over <code>time</code>.</p>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1003-1" aria-hidden="true" tabindex="-1"></a>opposites_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1003-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1003-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span> </span>
<span id="cb1003-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1003-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">m =</span> <span class="fu">mean</span>(opp),</span>
<span id="cb1003-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1003-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">s =</span> <span class="fu">sd</span>(opp))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##    time     m     s
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0  164.  36.2
## 2     1  192   33.5
## 3     2  217.  35.9
## 4     3  246.  37.6</code></pre>
<p>In a similar way, the correlations in the <code>Correlation Structures</code> part of the <code>print()</code> output are really just regularized sample correlations. Compare them to the un-regularized Pearson’s correlation estimates.</p>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1005-1" aria-hidden="true" tabindex="-1"></a>opposites_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1005-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1005-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, time, opp) <span class="sc">%&gt;%</span> </span>
<span id="cb1005-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1005-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> time, <span class="at">values_from =</span> opp) <span class="sc">%&gt;%</span> </span>
<span id="cb1005-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1005-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> </span>
<span id="cb1005-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1005-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1005-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1005-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##       0     1     2     3
## 0 1.000 0.804 0.709 0.414
## 1 0.804 1.000 0.847 0.678
## 2 0.709 0.847 1.000 0.800
## 3 0.414 0.678 0.800 1.000</code></pre>
<p>The reason for the regularization, by the way, is because of the default LKJ(1) prior. That prior is more strongly regularizing as you increase the dimensions of the correlation matrix. In the case of a <span class="math inline">\(4 \times 4\)</span> matrix, the LKJ will definitely push the individual correlations toward zero, particularly in the case of a modestly-sized data set like <code>opposites_pp</code>.</p>
<p>But anyway, we can fit basically the same model by explicitly using the <strong>brms</strong> multivariate syntax, as outlined in Bürkner’s <span class="citation">(<a href="#ref-Bürkner2022Multivariate" role="doc-biblioref">2022a</a>)</span> vignette, <em>Estimating multivariate models with brms</em>. Before we can fit a more conventional multivariate model to the data, we’ll need to convert <code>opposites_pp</code> to the wide format, which we’ll call <code>opposites_wide</code>.</p>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-1" aria-hidden="true" tabindex="-1"></a>opposites_wide <span class="ot">&lt;-</span></span>
<span id="cb1007-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-2" aria-hidden="true" tabindex="-1"></a>  opposites_pp <span class="sc">%&gt;%</span> </span>
<span id="cb1007-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">str_c</span>(<span class="st">&quot;t&quot;</span>, time)) <span class="sc">%&gt;%</span> </span>
<span id="cb1007-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>wave) <span class="sc">%&gt;%</span> </span>
<span id="cb1007-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> time, <span class="at">values_from =</span> opp)</span>
<span id="cb1007-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1007-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-7" aria-hidden="true" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb1007-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1007-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(opposites_wide)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##      id   cog   ccog    t0    t1    t2    t3
##   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1   137  23.5    205   217   268   302
## 2     2   123   9.54   219   243   279   302
## 3     3   129  15.5    142   212   250   289
## 4     4   125  11.5    206   230   248   273
## 5     5    81 -32.5    190   220   229   220
## 6     6   110  -3.46   165   205   207   263</code></pre>
<p>Now we’re ready to fit a multivariate model to our 4 variables <code>t0</code> through <code>t3</code>. To do so, we place all 4 variables within the <code>mvbind()</code> function, and we nest the entire model formula within the <code>bf()</code> function. Also notice we are explicitly asking for residual correlations by setting <code>set_rescor(TRUE)</code>.</p>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1009-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.8</span> <span class="ot">&lt;-</span></span>
<span id="cb1009-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_wide, </span>
<span id="cb1009-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1009-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(<span class="fu">mvbind</span>(t0, t1, t2, t3) <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1009-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_rescor</span>(<span class="cn">TRUE</span>),</span>
<span id="cb1009-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1009-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb1009-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1009-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.08&quot;</span>)</span></code></pre></div>
<p>Review the model summary.</p>
<div class="sourceCode" id="cb1010"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1010-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1010-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit7<span class="fl">.8</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  Family: MV(gaussian, gaussian, gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity
##          mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: t0 ~ 1 
##          t1 ~ 1 
##          t2 ~ 1 
##          t3 ~ 1 
##    Data: opposites_wide (Number of observations: 35) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## t0_Intercept  164.637     6.108  152.708  176.571 1.000     1966     2289
## t1_Intercept  192.169     5.475  181.626  203.058 1.002     1941     2259
## t2_Intercept  216.885     5.734  205.411  228.061 1.001     1919     2133
## t3_Intercept  246.290     6.256  233.790  258.523 1.003     2237     2729
## 
## Family Specific Parameters: 
##          Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma_t0   35.874     4.214   28.927   45.298 1.000     2484     2589
## sigma_t1   32.181     3.643   25.959   40.146 1.000     2220     2729
## sigma_t2   34.295     3.830   27.770   43.252 1.001     2147     2341
## sigma_t3   37.500     4.437   29.950   47.075 1.001     2521     2859
## 
## Residual Correlations: 
##               Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## rescor(t0,t1)    0.738     0.078    0.558    0.862 1.002     2173     3269
## rescor(t0,t2)    0.622     0.099    0.402    0.788 1.001     2014     2169
## rescor(t1,t2)    0.781     0.067    0.633    0.886 1.000     2621     3241
## rescor(t0,t3)    0.285     0.146   -0.020    0.551 1.001     2125     2457
## rescor(t1,t3)    0.584     0.108    0.343    0.763 1.000     2729     2909
## rescor(t2,t3)    0.737     0.077    0.564    0.862 1.000     2697     3068
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The results are very similar to those for <code>fit7.7</code>, above, with a few small differences. First, we now have a <code>Residual Correlations</code> section instead of a <code>Correlation Structures</code>. The output of the two is basically the same, though. The various <code>sigma_</code> parameters are now in their own <code>Family Specific Parameters</code>, instead of in the bottom fo the <code>Population-Level Effects</code> section. You’ll also note the <code>sigma_</code> parameters are all in their natural metric, rather than the log metric. This is because, by default, <strong>brms</strong> used the log link for the syntax we used for <code>fit7.7</code>, but used the identity link for the syntax we used for <code>fit7.8</code>.</p>
<p>Even if you take these small formatting-type differences into account, a careful eye will notice the parameter summaries are still a little different between these two models. The reason is the defualt priors were a little different. Take a look:</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1012-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1012-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.7</span><span class="sc">$</span>prior</span></code></pre></div>
<pre><code>##                 prior    class        coef group resp  dpar nlpar lb ub       source
##                (flat)        b                                               default
##                (flat)        b factortime0                              (vectorized)
##                (flat)        b factortime1                              (vectorized)
##                (flat)        b factortime2                              (vectorized)
##                (flat)        b factortime3                              (vectorized)
##                (flat)        b                        sigma                  default
##                (flat)        b factortime0            sigma             (vectorized)
##                (flat)        b factortime1            sigma             (vectorized)
##                (flat)        b factortime2            sigma             (vectorized)
##                (flat)        b factortime3            sigma             (vectorized)
##  lkj_corr_cholesky(1) Lcortime                                               default</code></pre>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1014-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.8</span><span class="sc">$</span>prior</span></code></pre></div>
<pre><code>##                    prior     class coef group resp dpar nlpar lb ub  source
##  student_t(3, 166, 35.6) Intercept              t0                  default
##    student_t(3, 196, 43) Intercept              t1                  default
##  student_t(3, 215, 32.6) Intercept              t2                  default
##  student_t(3, 246, 47.4) Intercept              t3                  default
##     lkj_corr_cholesky(1)   Lrescor                                  default
##    student_t(3, 0, 35.6)     sigma              t0             0    default
##      student_t(3, 0, 43)     sigma              t1             0    default
##    student_t(3, 0, 32.6)     sigma              t2             0    default
##    student_t(3, 0, 47.4)     sigma              t3             0    default</code></pre>
<p>I’m not going to break down exactly why <strong>brms</strong> made different default prior choices for these models, but experienced <strong>brms</strong> users should find these results very predictable, particularly due to our use of the <code>0 + factor(time)</code> syntax in the <code>fit7.7</code> model. Know your software defaults, friends. So let’s try fitting these two models one more time, but with a couple adjustments. First, we will explicitly set the priors based on the defaults used by <code>fit7.8</code>. We will manually request the identity link for the <code>sigma_</code> parameters in <code>fit7.7</code>. We will also increase the post-warmup draws for both models, to help account for MCMC sampling error.</p>
<p>Now fit the models.</p>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unstructures</span></span>
<span id="cb1016-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-2" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.7</span>b <span class="ot">&lt;-</span></span>
<span id="cb1016-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_pp, </span>
<span id="cb1016-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">brmsfamily</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">link =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">link_sigma =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb1016-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(opp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(time) <span class="sc">+</span> <span class="fu">unstr</span>(<span class="at">time =</span> time, <span class="at">gr =</span> id),</span>
<span id="cb1016-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-6" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">factor</span>(time)),</span>
<span id="cb1016-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">166</span>, <span class="fl">35.6</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime0),</span>
<span id="cb1016-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">196</span>, <span class="fl">43.0</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime1),</span>
<span id="cb1016-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">215</span>, <span class="fl">32.6</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime2),</span>
<span id="cb1016-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">246</span>, <span class="fl">47.4</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime3),</span>
<span id="cb1016-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-11" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1016-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">35.6</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime0, <span class="at">dpar =</span> sigma),</span>
<span id="cb1016-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">43.0</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime1, <span class="at">dpar =</span> sigma),</span>
<span id="cb1016-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">32.6</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime2, <span class="at">dpar =</span> sigma),</span>
<span id="cb1016-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">47.4</span>), <span class="at">class =</span> b, <span class="at">coef =</span> factortime3, <span class="at">dpar =</span> sigma),</span>
<span id="cb1016-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-16" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1016-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">1</span>), <span class="at">class =</span> cortime)),</span>
<span id="cb1016-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">13500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1016-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb1016-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.07b&quot;</span>)</span>
<span id="cb1016-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1016-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-22" aria-hidden="true" tabindex="-1"></a><span class="co"># multivariate</span></span>
<span id="cb1016-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-23" aria-hidden="true" tabindex="-1"></a>fit7<span class="fl">.8</span>b <span class="ot">&lt;-</span></span>
<span id="cb1016-24"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> opposites_wide, </span>
<span id="cb1016-25"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1016-26"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(<span class="fu">mvbind</span>(t0, t1, t2, t3) <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1016-27"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_rescor</span>(<span class="cn">TRUE</span>),</span>
<span id="cb1016-28"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">166</span>, <span class="fl">35.6</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> t0),</span>
<span id="cb1016-29"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">196</span>, <span class="fl">43.0</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> t1),</span>
<span id="cb1016-30"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">215</span>, <span class="fl">32.6</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> t2),</span>
<span id="cb1016-31"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-31" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">246</span>, <span class="fl">47.4</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> t3),</span>
<span id="cb1016-32"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-32" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1016-33"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">35.6</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> t0),</span>
<span id="cb1016-34"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-34" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">43.0</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> t1),</span>
<span id="cb1016-35"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-35" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">32.6</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> t2),</span>
<span id="cb1016-36"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-36" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">47.4</span>), <span class="at">class =</span> sigma, <span class="at">resp =</span> t3),</span>
<span id="cb1016-37"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-37" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1016-38"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">1</span>), <span class="at">class =</span> rescor)),</span>
<span id="cb1016-39"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">13500</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1016-40"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">7</span>,</span>
<span id="cb1016-41"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1016-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit07.08b&quot;</span>)</span></code></pre></div>
<p>This time, let’s just compare the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> posteriors in a coefficient plot.</p>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1017-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb1017-2"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb1017-3"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.7</span>b) <span class="sc">%&gt;%</span></span>
<span id="cb1017-4"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;factortime&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1017-5"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">&quot;mu_&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>), <span class="fu">str_c</span>(<span class="st">&quot;sigma_&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>))),</span>
<span id="cb1017-6"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit7<span class="fl">.8</span>b) <span class="sc">%&gt;%</span></span>
<span id="cb1017-7"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b_&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;sigma_&quot;</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb1017-8"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">&quot;mu_&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>), <span class="fu">str_c</span>(<span class="st">&quot;sigma_&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>)))</span>
<span id="cb1017-9"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1017-10"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb1017-11"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;fit7.7b&quot;</span>, <span class="st">&quot;fit7.8b&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1017-12"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>fit) <span class="sc">%&gt;%</span> </span>
<span id="cb1017-13"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(name, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;par&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1017-14"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fit, par, time) <span class="sc">%&gt;%</span> </span>
<span id="cb1017-15"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb1017-16"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1017-17"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1017-18"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">y =</span> time, <span class="at">group =</span> fit, <span class="at">color =</span> fit)) <span class="sc">+</span></span>
<span id="cb1017-19"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb1017-20"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">end =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1017-21"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;posterior&quot;</span>) <span class="sc">+</span></span>
<span id="cb1017-22"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> par, <span class="at">labeller =</span> label_parsed, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb1017-23"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1017-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="07_files/figure-html/unnamed-chunk-62-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now the results between the two methods are very similar. If you wanted to, you could make a similar kind of plot for the two versions of the correlation matrix, too. Thus, the various models Singer and Willett introduced in this chapter are special multivariate alternatives to the standard multilevel approach we’ve preferred up to this point. Cool, huh?</p>
</div>
</div>
<div id="session-info-6" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="examining-the-multilevel-models-error-covariance-structure.html#session-info-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="examining-the-multilevel-models-error-covariance-structure.html#cb1018-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.3.0 (2023-04-21)
## Platform: x86_64-apple-darwin20 (64-bit)
## Running under: macOS Monterey 12.4
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: America/Chicago
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidybayes_3.0.4 brms_2.19.0     Rcpp_1.0.10     lubridate_1.9.2 forcats_1.0.0   stringr_1.5.0  
##  [7] dplyr_1.1.2     purrr_1.0.1     readr_2.1.4     tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2  
## [13] tidyverse_2.0.0
## 
## loaded via a namespace (and not attached):
##   [1] tensorA_0.36.2       rstudioapi_0.14      jsonlite_1.8.4       magrittr_2.0.3       TH.data_1.1-2       
##   [6] estimability_1.4.1   farver_2.1.1         nloptr_2.0.3         rmarkdown_2.21       vctrs_0.6.2         
##  [11] minqa_1.2.5          base64enc_0.1-3      htmltools_0.5.5      distributional_0.3.2 sass_0.4.6          
##  [16] StanHeaders_2.26.25  bslib_0.4.2          htmlwidgets_1.6.2    plyr_1.8.8           sandwich_3.0-2      
##  [21] emmeans_1.8.6        zoo_1.8-12           cachem_1.0.8         igraph_1.4.2         mime_0.12           
##  [26] lifecycle_1.0.3      pkgconfig_2.0.3      colourpicker_1.2.0   Matrix_1.5-4         R6_2.5.1            
##  [31] fastmap_1.1.1        shiny_1.7.4          digest_0.6.31        colorspace_2.1-0     ps_1.7.5            
##  [36] crosstalk_1.2.0      projpred_2.5.0       labeling_0.4.2       fansi_1.0.4          timechange_0.2.0    
##  [41] abind_1.4-5          mgcv_1.8-42          compiler_4.3.0       bit64_4.0.5          withr_2.5.0         
##  [46] backports_1.4.1      inline_0.3.19        shinystan_2.6.0      gamm4_0.2-6          pkgbuild_1.4.0      
##  [51] highr_0.10           MASS_7.3-58.4        gtools_3.9.4         loo_2.6.0            tools_4.3.0         
##  [56] httpuv_1.6.11        threejs_0.3.3        glue_1.6.2           callr_3.7.3          nlme_3.1-162        
##  [61] promises_1.2.0.1     grid_4.3.0           checkmate_2.2.0      reshape2_1.4.4       generics_0.1.3      
##  [66] diffobj_0.3.5        gtable_0.3.3         tzdb_0.4.0           hms_1.1.3            utf8_1.2.3          
##  [71] ggdist_3.3.0         pillar_1.9.0         markdown_1.7         vroom_1.6.3          posterior_1.4.1     
##  [76] later_1.3.1          splines_4.3.0        lattice_0.21-8       survival_3.5-5       bit_4.0.5           
##  [81] tidyselect_1.2.0     miniUI_0.1.1.1       knitr_1.42           arrayhelpers_1.1-0   gridExtra_2.3       
##  [86] bookdown_0.34        stats4_4.3.0         xfun_0.39            bridgesampling_1.1-2 matrixStats_0.63.0  
##  [91] DT_0.27              rstan_2.21.8         stringi_1.7.12       boot_1.3-28.1        evaluate_0.21       
##  [96] codetools_0.2-19     cli_3.6.1            RcppParallel_5.1.7   shinythemes_1.2.0    xtable_1.8-4        
## [101] munsell_0.5.0        processx_3.8.1       jquerylib_0.1.4      coda_0.19-4          svUnit_1.0.6        
## [106] parallel_4.3.0       rstantools_2.3.1     ellipsis_0.3.2       prettyunits_1.1.1    dygraphs_1.1.1.6    
## [111] bayesplot_1.10.0     Brobdingnag_1.2-9    lme4_1.1-33          viridisLite_0.4.2    mvtnorm_1.1-3       
## [116] scales_1.2.1         xts_0.13.1           crayon_1.5.2         rlang_1.1.1          multcomp_1.4-23     
## [121] shinyjs_2.1.0</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Bürkner2022Multivariate" class="csl-entry">
Bürkner, P.-C. (2022a). <em>Estimating multivariate models with brms</em>. <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_multivariate.html">https://CRAN.R-project.org/package=brms/vignettes/brms_multivariate.html</a>
</div>
<div id="ref-mallinckrod2008recommendations" class="csl-entry">
Mallinckrod, C. H., Lane, P. W., Schnell, D., Peng, Y., &amp; Mancuso, J. P. (2008). Recommendations for the primary analysis of continuous endpoints in longitudinal clinical trials. <em>Drug Information Journal</em>, <em>42</em>(4), 303–319. <a href="https://doi.org/10.1177/009286150804200402">https://doi.org/10.1177/009286150804200402</a>
</div>
<div id="ref-mcneishOnTheUnnecessaryUbiquity2017" class="csl-entry">
McNeish, D., Stapleton, L. M., &amp; Silverman, R. D. (2017). On the unnecessary ubiquity of hierarchical linear modeling. <em>Psychological Methods</em>, <em>22</em>(1), 114. <a href="https://doi.org/10.1037/met0000078">https://doi.org/10.1037/met0000078</a>
</div>
<div id="ref-R-nlme" class="csl-entry">
Pinheiro, J., Bates, D., &amp; R-core. (2021). <em><span class="nocase">nlme</span>: <span>Linear</span> and nonlinear mixed effects models</em> [Manual]. <a href="https://CRAN.R-project.org/package=nlme">https://CRAN.R-project.org/package=nlme</a>
</div>
<div id="ref-singerAppliedLongitudinalData2003" class="csl-entry">
Singer, J. D., &amp; Willett, J. B. (2003). <em>Applied longitudinal data analysis: <span>Modeling</span> change and event occurrence</em>. <span>Oxford University Press, USA</span>. <a href="https://oxford.universitypressscholarship.com/view/10.1093/acprof:oso/9780195152968.001.0001/acprof-9780195152968">https://oxford.universitypressscholarship.com/view/10.1093/acprof:oso/9780195152968.001.0001/acprof-9780195152968</a>
</div>
<div id="ref-willett1988QuestionsAndAnswers" class="csl-entry">
Willett, J. B. (1988). Chapter 9: <span>Questions</span> and answers in the measurement of change. <em>Review of Research in Education</em>, <em>15</em>, 345–422. <a href="https://doi.org/10.2307/1167368">https://doi.org/10.2307/1167368</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modeling-discontinuous-and-nonlinear-change.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-change-using-covariance-structure-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
